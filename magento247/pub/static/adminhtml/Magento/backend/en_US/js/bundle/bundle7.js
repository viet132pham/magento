require.config({"config": {
        "jsbuild":{"jquery/jstree/jquery.jstree.js":"/*globals jQuery, define, module, exports, require, window, document, postMessage */\n(function (factory) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(['jquery'], factory);\n    }\n    else if(typeof module !== 'undefined' && module.exports) {\n        module.exports = factory(require('jquery'));\n    }\n    else {\n        factory(jQuery);\n    }\n}(function ($, undefined) {\n    \"use strict\";\n    /*!\n * jsTree 3.3.16\n * http://jstree.com/\n *\n * Copyright (c) 2014 Ivan Bozhanov (http://vakata.com)\n *\n * Licensed same as jquery - under the terms of the MIT License\n *   http://www.opensource.org/licenses/mit-license.php\n */\n    /*!\n * if using jslint please allow for the jQuery global and use following options:\n * jslint: loopfunc: true, browser: true, ass: true, bitwise: true, continue: true, nomen: true, plusplus: true, regexp: true, unparam: true, todo: true, white: true\n */\n    /*jshint -W083 */\n\n    // prevent another load? maybe there is a better way?\n    if($.jstree) {\n        return;\n    }\n\n    /**\n     * ### jsTree core functionality\n     */\n\n        // internal variables\n    var instance_counter = 0,\n        ccp_node = false,\n        ccp_mode = false,\n        ccp_inst = false,\n        themes_loaded = [],\n        src = $('script:last').attr('src'),\n        document = window.document; // local variable is always faster to access then a global\n\n    var setImmediate = window.setImmediate;\n    var Promise = window.Promise;\n    if (!setImmediate && Promise) {\n        // Good enough approximation of setImmediate\n        setImmediate = function (cb, arg) {\n            Promise.resolve(arg).then(cb);\n        };\n    }\n\n    /**\n     * holds all jstree related functions and variables, including the actual class and methods to create, access and manipulate instances.\n     * @name $.jstree\n     */\n    $.jstree = {\n        /**\n         * specifies the jstree version in use\n         * @name $.jstree.version\n         */\n        version : '3.3.16',\n        /**\n         * holds all the default options used when creating new instances\n         * @name $.jstree.defaults\n         */\n        defaults : {\n            /**\n             * configure which plugins will be active on an instance. Should be an array of strings, where each element is a plugin name. The default is `[]`\n             * @name $.jstree.defaults.plugins\n             */\n            plugins : []\n        },\n        /**\n         * stores all loaded jstree plugins (used internally)\n         * @name $.jstree.plugins\n         */\n        plugins : {},\n        path : src && src.indexOf('/') !== -1 ? src.replace(/\\/[^\\/]+$/,'') : '',\n        idregex : /[\\\\:&!^|()\\[\\]<>@*'+~#\";.,=\\- \\/${}%?`]/g,\n        root : '#'\n    };\n\n    /**\n     * creates a jstree instance\n     * @name $.jstree.create(el [, options])\n     * @param {DOMElement|jQuery|String} el the element to create the instance on, can be jQuery extended or a selector\n     * @param {Object} options options for this instance (extends `$.jstree.defaults`)\n     * @return {jsTree} the new instance\n     */\n    $.jstree.create = function (el, options) {\n        var tmp = new $.jstree.core(++instance_counter),\n            opt = options;\n        options = $.extend(true, {}, $.jstree.defaults, options);\n        if(opt && opt.plugins) {\n            options.plugins = opt.plugins;\n        }\n        $.each(options.plugins, function (i, k) {\n            if(i !== 'core') {\n                tmp = tmp.plugin(k, options[k]);\n            }\n        });\n        $(el).data('jstree', tmp);\n        tmp.init(el, options);\n        return tmp;\n    };\n    /**\n     * remove all traces of jstree from the DOM and destroy all instances\n     * @name $.jstree.destroy()\n     */\n    $.jstree.destroy = function () {\n        $('.jstree:jstree').jstree('destroy');\n        $(document).off('.jstree');\n    };\n    /**\n     * the jstree class constructor, used only internally\n     * @private\n     * @name $.jstree.core(id)\n     * @param {Number} id this instance's index\n     */\n    $.jstree.core = function (id) {\n        this._id = id;\n        this._cnt = 0;\n        this._wrk = null;\n        this._data = {\n            core : {\n                themes : {\n                    name : false,\n                    dots : false,\n                    icons : false,\n                    ellipsis : false\n                },\n                selected : [],\n                last_error : {},\n                working : false,\n                worker_queue : [],\n                focused : null\n            }\n        };\n    };\n    /**\n     * get a reference to an existing instance\n     *\n     * __Examples__\n     *\n     *\t// provided a container with an ID of \"tree\", and a nested node with an ID of \"branch\"\n     *\t// all of there will return the same instance\n     *\t$.jstree.reference('tree');\n     *\t$.jstree.reference('#tree');\n     *\t$.jstree.reference($('#tree'));\n     *\t$.jstree.reference(document.getElementByID('tree'));\n     *\t$.jstree.reference('branch');\n     *\t$.jstree.reference('#branch');\n     *\t$.jstree.reference($('#branch'));\n     *\t$.jstree.reference(document.getElementByID('branch'));\n     *\n     * @name $.jstree.reference(needle)\n     * @param {DOMElement|jQuery|String} needle\n     * @return {jsTree|null} the instance or `null` if not found\n     */\n    $.jstree.reference = function (needle) {\n        var tmp = null,\n            obj = null;\n        if(needle && needle.id && (!needle.tagName || !needle.nodeType)) { needle = needle.id; }\n\n        if(!obj || !obj.length) {\n            try { obj = $(needle); } catch (ignore) { }\n        }\n        if(!obj || !obj.length) {\n            try { obj = $('#' + needle.replace($.jstree.idregex,'\\\\$&')); } catch (ignore) { }\n        }\n        if(obj && obj.length && (obj = obj.closest('.jstree')).length && (obj = obj.data('jstree'))) {\n            tmp = obj;\n        }\n        else {\n            $('.jstree').each(function () {\n                var inst = $(this).data('jstree');\n                if(inst && inst._model.data[needle]) {\n                    tmp = inst;\n                    return false;\n                }\n            });\n        }\n        return tmp;\n    };\n    /**\n     * Create an instance, get an instance or invoke a command on a instance.\n     *\n     * If there is no instance associated with the current node a new one is created and `arg` is used to extend `$.jstree.defaults` for this new instance. There would be no return value (chaining is not broken).\n     *\n     * If there is an existing instance and `arg` is a string the command specified by `arg` is executed on the instance, with any additional arguments passed to the function. If the function returns a value it will be returned (chaining could break depending on function).\n     *\n     * If there is an existing instance and `arg` is not a string the instance itself is returned (similar to `$.jstree.reference`).\n     *\n     * In any other case - nothing is returned and chaining is not broken.\n     *\n     * __Examples__\n     *\n     *\t$('#tree1').jstree(); // creates an instance\n     *\t$('#tree2').jstree({ plugins : [] }); // create an instance with some options\n     *\t$('#tree1').jstree('open_node', '#branch_1'); // call a method on an existing instance, passing additional arguments\n     *\t$('#tree2').jstree(); // get an existing instance (or create an instance)\n     *\t$('#tree2').jstree(true); // get an existing instance (will not create new instance)\n     *\t$('#branch_1').jstree().select_node('#branch_1'); // get an instance (using a nested element and call a method)\n     *\n     * @name $().jstree([arg])\n     * @param {String|Object} arg\n     * @return {Mixed}\n     */\n    $.fn.jstree = function (arg) {\n        // check for string argument\n        var is_method\t= (typeof arg === 'string'),\n            args\t\t= Array.prototype.slice.call(arguments, 1),\n            result\t\t= null;\n        if(arg === true && !this.length) { return false; }\n        this.each(function () {\n            // get the instance (if there is one) and method (if it exists)\n            var instance = $.jstree.reference(this),\n                method = is_method && instance ? instance[arg] : null;\n            // if calling a method, and method is available - execute on the instance\n            result = is_method && method ?\n                method.apply(instance, args) :\n                null;\n            // if there is no instance and no method is being called - create one\n            if(!instance && !is_method && (arg === undefined || $.isPlainObject(arg))) {\n                $.jstree.create(this, arg);\n            }\n            // if there is an instance and no method is called - return the instance\n            if( (instance && !is_method) || arg === true ) {\n                result = instance || false;\n            }\n            // if there was a method call which returned a result - break and return the value\n            if(result !== null && result !== undefined) {\n                return false;\n            }\n        });\n        // if there was a method call with a valid return value - return that, otherwise continue the chain\n        return result !== null && result !== undefined ?\n            result : this;\n    };\n    /**\n     * used to find elements containing an instance\n     *\n     * __Examples__\n     *\n     *\t$('div:jstree').each(function () {\n     *\t\t$(this).jstree('destroy');\n     *\t});\n     *\n     * @name $(':jstree')\n     * @return {jQuery}\n     */\n    $.expr.pseudos.jstree = $.expr.createPseudo(function(search) {\n        return function(a) {\n            return $(a).hasClass('jstree') &&\n                $(a).data('jstree') !== undefined;\n        };\n    });\n\n    /**\n     * stores all defaults for the core\n     * @name $.jstree.defaults.core\n     */\n    $.jstree.defaults.core = {\n        /**\n         * data configuration\n         *\n         * If left as `false` the HTML inside the jstree container element is used to populate the tree (that should be an unordered list with list items).\n         *\n         * You can also pass in a HTML string or a JSON array here.\n         *\n         * It is possible to pass in a standard jQuery-like AJAX config and jstree will automatically determine if the response is JSON or HTML and use that to populate the tree.\n         * In addition to the standard jQuery ajax options here you can supply functions for `data` and `url`, the functions will be run in the current instance's scope and a param will be passed indicating which node is being loaded, the return value of those functions will be used.\n         *\n         * The last option is to specify a function, that function will receive the node being loaded as argument and a second param which is a function which should be called with the result.\n         *\n         * __Examples__\n         *\n         *\t// AJAX\n         *\t$('#tree').jstree({\n         *\t\t'core' : {\n         *\t\t\t'data' : {\n         *\t\t\t\t'url' : '/get/children/',\n         *\t\t\t\t'data' : function (node) {\n         *\t\t\t\t\treturn { 'id' : node.id };\n         *\t\t\t\t}\n         *\t\t\t}\n         *\t\t});\n         *\n         *\t// direct data\n         *\t$('#tree').jstree({\n         *\t\t'core' : {\n         *\t\t\t'data' : [\n         *\t\t\t\t'Simple root node',\n         *\t\t\t\t{\n         *\t\t\t\t\t'id' : 'node_2',\n         *\t\t\t\t\t'text' : 'Root node with options',\n         *\t\t\t\t\t'state' : { 'opened' : true, 'selected' : true },\n         *\t\t\t\t\t'children' : [ { 'text' : 'Child 1' }, 'Child 2']\n         *\t\t\t\t}\n         *\t\t\t]\n         *\t\t}\n         *\t});\n         *\n         *\t// function\n         *\t$('#tree').jstree({\n         *\t\t'core' : {\n         *\t\t\t'data' : function (obj, callback) {\n         *\t\t\t\tcallback.call(this, ['Root 1', 'Root 2']);\n         *\t\t\t}\n         *\t\t});\n         *\n         * @name $.jstree.defaults.core.data\n         */\n        data\t\t\t: false,\n        /**\n         * configure the various strings used throughout the tree\n         *\n         * You can use an object where the key is the string you need to replace and the value is your replacement.\n         * Another option is to specify a function which will be called with an argument of the needed string and should return the replacement.\n         * If left as `false` no replacement is made.\n         *\n         * __Examples__\n         *\n         *\t$('#tree').jstree({\n         *\t\t'core' : {\n         *\t\t\t'strings' : {\n         *\t\t\t\t'Loading ...' : 'Please wait ...'\n         *\t\t\t}\n         *\t\t}\n         *\t});\n         *\n         * @name $.jstree.defaults.core.strings\n         */\n        strings\t\t\t: false,\n        /**\n         * determines what happens when a user tries to modify the structure of the tree\n         * If left as `false` all operations like create, rename, delete, move or copy are prevented.\n         * You can set this to `true` to allow all interactions or use a function to have better control.\n         *\n         * __Examples__\n         *\n         *\t$('#tree').jstree({\n         *\t\t'core' : {\n         *\t\t\t'check_callback' : function (operation, node, node_parent, node_position, more) {\n         *\t\t\t\t// operation can be 'create_node', 'rename_node', 'delete_node', 'move_node', 'copy_node' or 'edit'\n         *\t\t\t\t// in case of 'rename_node' node_position is filled with the new node name\n         *\t\t\t\treturn operation === 'rename_node' ? true : false;\n         *\t\t\t}\n         *\t\t}\n         *\t});\n         *\n         * @name $.jstree.defaults.core.check_callback\n         */\n        check_callback\t: false,\n        /**\n         * a callback called with a single object parameter in the instance's scope when something goes wrong (operation prevented, ajax failed, etc)\n         * @name $.jstree.defaults.core.error\n         */\n        error\t\t\t: $.noop,\n        /**\n         * the open / close animation duration in milliseconds - set this to `false` to disable the animation (default is `200`)\n         * @name $.jstree.defaults.core.animation\n         */\n        animation\t\t: 200,\n        /**\n         * a boolean indicating if multiple nodes can be selected\n         * @name $.jstree.defaults.core.multiple\n         */\n        multiple\t\t: true,\n        /**\n         * theme configuration object\n         * @name $.jstree.defaults.core.themes\n         */\n        themes\t\t\t: {\n            /**\n             * the name of the theme to use (if left as `false` the default theme is used)\n             * @name $.jstree.defaults.core.themes.name\n             */\n            name\t\t\t: false,\n            /**\n             * the URL of the theme's CSS file, leave this as `false` if you have manually included the theme CSS (recommended). You can set this to `true` too which will try to autoload the theme.\n             * @name $.jstree.defaults.core.themes.url\n             */\n            url\t\t\t\t: false,\n            /**\n             * the location of all jstree themes - only used if `url` is set to `true`\n             * @name $.jstree.defaults.core.themes.dir\n             */\n            dir\t\t\t\t: false,\n            /**\n             * a boolean indicating if connecting dots are shown\n             * @name $.jstree.defaults.core.themes.dots\n             */\n            dots\t\t\t: true,\n            /**\n             * a boolean indicating if node icons are shown\n             * @name $.jstree.defaults.core.themes.icons\n             */\n            icons\t\t\t: true,\n            /**\n             * a boolean indicating if node ellipsis should be shown - this only works with a fixed with on the container\n             * @name $.jstree.defaults.core.themes.ellipsis\n             */\n            ellipsis\t\t: false,\n            /**\n             * a boolean indicating if the tree background is striped\n             * @name $.jstree.defaults.core.themes.stripes\n             */\n            stripes\t\t\t: false,\n            /**\n             * a string (or boolean `false`) specifying the theme variant to use (if the theme supports variants)\n             * @name $.jstree.defaults.core.themes.variant\n             */\n            variant\t\t\t: false,\n            /**\n             * a boolean specifying if a reponsive version of the theme should kick in on smaller screens (if the theme supports it). Defaults to `false`.\n             * @name $.jstree.defaults.core.themes.responsive\n             */\n            responsive\t\t: false\n        },\n        /**\n         * if left as `true` all parents of all selected nodes will be opened once the tree loads (so that all selected nodes are visible to the user)\n         * @name $.jstree.defaults.core.expand_selected_onload\n         */\n        expand_selected_onload : true,\n        /**\n         * if left as `true` web workers will be used to parse incoming JSON data where possible, so that the UI will not be blocked by large requests. Workers are however about 30% slower. Defaults to `true`\n         * @name $.jstree.defaults.core.worker\n         */\n        worker : true,\n        /**\n         * Force node text to plain text (and escape HTML). Defaults to `false`\n         * @name $.jstree.defaults.core.force_text\n         */\n        force_text : false,\n        /**\n         * Should the node be toggled if the text is double clicked. Defaults to `true`\n         * @name $.jstree.defaults.core.dblclick_toggle\n         */\n        dblclick_toggle : true,\n        /**\n         * Should the loaded nodes be part of the state. Defaults to `false`\n         * @name $.jstree.defaults.core.loaded_state\n         */\n        loaded_state : false,\n        /**\n         * Should the last active node be focused when the tree container is blurred and the focused again. This helps working with screen readers. Defaults to `true`\n         * @name $.jstree.defaults.core.restore_focus\n         */\n        restore_focus : true,\n        /**\n         * Force to compute and set \"aria-setsize\" and \"aria-posinset\" explicitly for each treeitem.\n         * Some browsers may compute incorrect elements position and produce wrong announcements for screen readers. Defaults to `false`\n         * @name $.jstree.defaults.core.compute_elements_positions\n         */\n        compute_elements_positions : false,\n        /**\n         * Default keyboard shortcuts (an object where each key is the button name or combo - like 'enter', 'ctrl-space', 'p', etc and the value is the function to execute in the instance's scope)\n         * @name $.jstree.defaults.core.keyboard\n         */\n        keyboard : {\n            'ctrl-space': function (e) {\n                // aria defines space only with Ctrl\n                e.type = \"click\";\n                $(e.currentTarget).trigger(e);\n            },\n            'enter': function (e) {\n                // enter\n                e.type = \"click\";\n                $(e.currentTarget).trigger(e);\n            },\n            'left': function (e) {\n                // left\n                e.preventDefault();\n                if(this.is_open(e.currentTarget)) {\n                    this.close_node(e.currentTarget);\n                }\n                else {\n                    var o = this.get_parent(e.currentTarget);\n                    if(o && o.id !== $.jstree.root) { this.get_node(o, true).children('.jstree-anchor').trigger('focus'); }\n                }\n            },\n            'up': function (e) {\n                // up\n                e.preventDefault();\n                var o = this.get_prev_dom(e.currentTarget);\n                if(o && o.length) { o.children('.jstree-anchor').trigger('focus'); }\n            },\n            'right': function (e) {\n                // right\n                e.preventDefault();\n                if(this.is_closed(e.currentTarget)) {\n                    this.open_node(e.currentTarget, function (o) { this.get_node(o, true).children('.jstree-anchor').trigger('focus'); });\n                }\n                else if (this.is_open(e.currentTarget)) {\n                    var o = this.get_node(e.currentTarget, true).children('.jstree-children')[0];\n                    if(o) { $(this._firstChild(o)).children('.jstree-anchor').trigger('focus'); }\n                }\n            },\n            'down': function (e) {\n                // down\n                e.preventDefault();\n                var o = this.get_next_dom(e.currentTarget);\n                if(o && o.length) { o.children('.jstree-anchor').trigger('focus'); }\n            },\n            '*': function (e) {\n                // aria defines * on numpad as open_all - not very common\n                this.open_all();\n            },\n            'home': function (e) {\n                // home\n                e.preventDefault();\n                var o = this._firstChild(this.get_container_ul()[0]);\n                if(o) { $(o).children('.jstree-anchor').filter(':visible').trigger('focus'); }\n            },\n            'end': function (e) {\n                // end\n                e.preventDefault();\n                this.element.find('.jstree-anchor').filter(':visible').last().trigger('focus');\n            },\n            'f2': function (e) {\n                // f2 - safe to include - if check_callback is false it will fail\n                e.preventDefault();\n                this.edit(e.currentTarget);\n            }\n        },\n        /**\n         * Should reselecting an already selected node trigger the select and changed callbacks\n         * @name $.jstree.defaults.core.allow_reselect\n         */\n        allow_reselect : false\n    };\n    $.jstree.core.prototype = {\n        /**\n         * used to decorate an instance with a plugin. Used internally.\n         * @private\n         * @name plugin(deco [, opts])\n         * @param  {String} deco the plugin to decorate with\n         * @param  {Object} opts options for the plugin\n         * @return {jsTree}\n         */\n        plugin : function (deco, opts) {\n            var Child = $.jstree.plugins[deco];\n            if(Child) {\n                this._data[deco] = {};\n                Child.prototype = this;\n                return new Child(opts, this);\n            }\n            return this;\n        },\n        /**\n         * initialize the instance. Used internally.\n         * @private\n         * @name init(el, optons)\n         * @param {DOMElement|jQuery|String} el the element we are transforming\n         * @param {Object} options options for this instance\n         * @trigger init.jstree, loading.jstree, loaded.jstree, ready.jstree, changed.jstree\n         */\n        init : function (el, options) {\n            this._model = {\n                data : {},\n                changed : [],\n                force_full_redraw : false,\n                redraw_timeout : false,\n                default_state : {\n                    loaded : true,\n                    opened : false,\n                    selected : false,\n                    disabled : false\n                }\n            };\n            this._model.data[$.jstree.root] = {\n                id : $.jstree.root,\n                parent : null,\n                parents : [],\n                children : [],\n                children_d : [],\n                state : { loaded : false }\n            };\n\n            this.element = $(el).addClass('jstree jstree-' + this._id);\n            this.settings = options;\n\n            this._data.core.ready = false;\n            this._data.core.loaded = false;\n            this._data.core.rtl = (this.element.css(\"direction\") === \"rtl\");\n            this.element[this._data.core.rtl ? 'addClass' : 'removeClass'](\"jstree-rtl\");\n            this.element.attr('role','tree');\n            if(this.settings.core.multiple) {\n                this.element.attr('aria-multiselectable', true);\n            }\n            if(!this.element.attr('tabindex')) {\n                this.element.attr('tabindex','0');\n            }\n\n            this.bind();\n            /**\n             * triggered after all events are bound\n             * @event\n             * @name init.jstree\n             */\n            this.trigger(\"init\");\n\n            this._data.core.original_container_html = this.element.find(\" > ul > li\").clone(true);\n            this._data.core.original_container_html\n                .find(\"li\").addBack()\n                .contents().filter(function() {\n                return this.nodeType === 3 && (!this.nodeValue || /^\\s+$/.test(this.nodeValue));\n            })\n                .remove();\n            this.element.html(\"<\"+\"ul class='jstree-container-ul jstree-children' role='group'><\"+\"li id='j\"+this._id+\"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none'><i class='jstree-icon jstree-ocl'></i><\"+\"a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>\" + this.get_string(\"Loading ...\") + \"</a></li></ul>\");\n            this.element.attr('aria-activedescendant','j' + this._id + '_loading');\n            this._data.core.li_height = this.get_container_ul().children(\"li\").first().outerHeight() || 24;\n            this._data.core.node = this._create_prototype_node();\n            /**\n             * triggered after the loading text is shown and before loading starts\n             * @event\n             * @name loading.jstree\n             */\n            this.trigger(\"loading\");\n            this.load_node($.jstree.root);\n        },\n        /**\n         * destroy an instance\n         * @name destroy()\n         * @param  {Boolean} keep_html if not set to `true` the container will be emptied, otherwise the current DOM elements will be kept intact\n         */\n        destroy : function (keep_html) {\n            /**\n             * triggered before the tree is destroyed\n             * @event\n             * @name destroy.jstree\n             */\n            this.trigger(\"destroy\");\n            if(this._wrk) {\n                try {\n                    window.URL.revokeObjectURL(this._wrk);\n                    this._wrk = null;\n                }\n                catch (ignore) { }\n            }\n            if(!keep_html) { this.element.empty(); }\n            this.teardown();\n        },\n        /**\n         * Create a prototype node\n         * @name _create_prototype_node()\n         * @return {DOMElement}\n         */\n        _create_prototype_node : function () {\n            var _node = document.createElement('LI'), _temp1, _temp2;\n            _node.setAttribute('role', 'none');\n            _temp1 = document.createElement('I');\n            _temp1.className = 'jstree-icon jstree-ocl';\n            _temp1.setAttribute('role', 'presentation');\n            _node.appendChild(_temp1);\n            _temp1 = document.createElement('A');\n            _temp1.className = 'jstree-anchor';\n            _temp1.setAttribute('href','#');\n            _temp1.setAttribute('tabindex','-1');\n            _temp1.setAttribute('role', 'treeitem');\n            _temp2 = document.createElement('I');\n            _temp2.className = 'jstree-icon jstree-themeicon';\n            _temp2.setAttribute('role', 'presentation');\n            _temp1.appendChild(_temp2);\n            _node.appendChild(_temp1);\n            _temp1 = _temp2 = null;\n\n            return _node;\n        },\n        _kbevent_to_func : function (e) {\n            var keys = {\n                8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 19: \"Pause\", 27: \"Esc\",\n                32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\", 36: \"Home\",\n                37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"Print\", 45: \"Insert\",\n                46: \"Delete\", 96: \"Numpad0\", 97: \"Numpad1\", 98: \"Numpad2\", 99 : \"Numpad3\",\n                100: \"Numpad4\", 101: \"Numpad5\", 102: \"Numpad6\", 103: \"Numpad7\",\n                104: \"Numpad8\", 105: \"Numpad9\", '-13': \"NumpadEnter\", 112: \"F1\",\n                113: \"F2\", 114: \"F3\", 115: \"F4\", 116: \"F5\", 117: \"F6\", 118: \"F7\",\n                119: \"F8\", 120: \"F9\", 121: \"F10\", 122: \"F11\", 123: \"F12\", 144: \"Numlock\",\n                145: \"Scrolllock\", 16: 'Shift', 17: 'Ctrl', 18: 'Alt',\n                48: '0',  49: '1',  50: '2',  51: '3',  52: '4', 53:  '5',\n                54: '6',  55: '7',  56: '8',  57: '9',  59: ';',  61: '=', 65:  'a',\n                66: 'b',  67: 'c',  68: 'd',  69: 'e',  70: 'f',  71: 'g', 72:  'h',\n                73: 'i',  74: 'j',  75: 'k',  76: 'l',  77: 'm',  78: 'n', 79:  'o',\n                80: 'p',  81: 'q',  82: 'r',  83: 's',  84: 't',  85: 'u', 86:  'v',\n                87: 'w',  88: 'x',  89: 'y',  90: 'z', 107: '+', 109: '-', 110: '.',\n                186: ';', 187: '=', 188: ',', 189: '-', 190: '.', 191: '/', 192: '`',\n                219: '[', 220: '\\\\',221: ']', 222: \"'\", 111: '/', 106: '*', 173: '-'\n            };\n            var parts = [];\n            if (e.ctrlKey) { parts.push('ctrl'); }\n            if (e.altKey) { parts.push('alt'); }\n            if (e.shiftKey) { parts.push('shift'); }\n            parts.push(keys[e.which] ? keys[e.which].toLowerCase() : e.which);\n            parts = parts.sort().join('-').toLowerCase();\n            if (parts === 'shift-shift' || parts === 'ctrl-ctrl' || parts === 'alt-alt') {\n                return null;\n            }\n\n            var kb = this.settings.core.keyboard, i, tmp;\n            for (i in kb) {\n                if (kb.hasOwnProperty(i)) {\n                    tmp = i;\n                    if (tmp !== '-' && tmp !== '+') {\n                        tmp = tmp.replace('--', '-MINUS').replace('+-', '-MINUS').replace('++', '-PLUS').replace('-+', '-PLUS');\n                        tmp = tmp.split(/-|\\+/).sort().join('-').replace('MINUS', '-').replace('PLUS', '+').toLowerCase();\n                    }\n                    if (tmp === parts) {\n                        return kb[i];\n                    }\n                }\n            }\n            return null;\n        },\n        /**\n         * part of the destroying of an instance. Used internally.\n         * @private\n         * @name teardown()\n         */\n        teardown : function () {\n            this.unbind();\n            this.element\n                .removeClass('jstree')\n                .removeData('jstree')\n                .find(\"[class^='jstree']\")\n                .addBack()\n                .attr(\"class\", function () { return this.className.replace(/jstree[^ ]*|$/ig,''); });\n            this.element = null;\n        },\n        /**\n         * bind all events. Used internally.\n         * @private\n         * @name bind()\n         */\n        bind : function () {\n            var word = '',\n                tout = null,\n                was_click = 0;\n            this.element\n                .on(\"dblclick.jstree\", function (e) {\n                    if(e.target.tagName && e.target.tagName.toLowerCase() === \"input\") { return true; }\n                    if(document.selection && document.selection.empty) {\n                        document.selection.empty();\n                    }\n                    else {\n                        if(window.getSelection) {\n                            var sel = window.getSelection();\n                            try {\n                                sel.removeAllRanges();\n                                sel.collapse();\n                            } catch (ignore) { }\n                        }\n                    }\n                })\n                .on(\"mousedown.jstree\", function (e) {\n                    if(e.target === this.element[0]) {\n                        e.preventDefault(); // prevent losing focus when clicking scroll arrows (FF, Chrome)\n                        was_click = +(new Date()); // ie does not allow to prevent losing focus\n                    }\n                }.bind(this))\n                .on(\"mousedown.jstree\", \".jstree-ocl\", function (e) {\n                    e.preventDefault(); // prevent any node inside from losing focus when clicking the open/close icon\n                })\n                .on(\"click.jstree\", \".jstree-ocl\", function (e) {\n                    this.toggle_node(e.target);\n                }.bind(this))\n                .on(\"dblclick.jstree\", \".jstree-anchor\", function (e) {\n                    if(e.target.tagName && e.target.tagName.toLowerCase() === \"input\") { return true; }\n                    if(this.settings.core.dblclick_toggle) {\n                        this.toggle_node(e.target);\n                    }\n                }.bind(this))\n                .on(\"click.jstree\", \".jstree-anchor\", function (e) {\n                    e.preventDefault();\n                    if(e.currentTarget !== document.activeElement) { $(e.currentTarget).trigger('focus'); }\n                    this.activate_node(e.currentTarget, e);\n                }.bind(this))\n                .on('keydown.jstree', '.jstree-anchor', function (e) {\n                    if(e.target.tagName && e.target.tagName.toLowerCase() === \"input\") { return true; }\n                    if(this._data.core.rtl) {\n                        if(e.which === 37) { e.which = 39; }\n                        else if(e.which === 39) { e.which = 37; }\n                    }\n                    var f = this._kbevent_to_func(e);\n                    if (f) {\n                        var r = f.call(this, e);\n                        if (r === false || r === true) {\n                            return r;\n                        }\n                    }\n                }.bind(this))\n                .on(\"load_node.jstree\", function (e, data) {\n                    if(data.status) {\n                        if(data.node.id === $.jstree.root && !this._data.core.loaded) {\n                            this._data.core.loaded = true;\n                            if(this._firstChild(this.get_container_ul()[0])) {\n                                this.element.attr('aria-activedescendant',this._firstChild(this.get_container_ul()[0]).id);\n                            }\n                            /**\n                             * triggered after the root node is loaded for the first time\n                             * @event\n                             * @name loaded.jstree\n                             */\n                            this.trigger(\"loaded\");\n                        }\n                        if(!this._data.core.ready) {\n                            setTimeout(function() {\n                                if(this.element && !this.get_container_ul().find('.jstree-loading').length) {\n                                    this._data.core.ready = true;\n                                    if(this._data.core.selected.length) {\n                                        if(this.settings.core.expand_selected_onload) {\n                                            var tmp = [], i, j;\n                                            for(i = 0, j = this._data.core.selected.length; i < j; i++) {\n                                                tmp = tmp.concat(this._model.data[this._data.core.selected[i]].parents);\n                                            }\n                                            tmp = $.vakata.array_unique(tmp);\n                                            for(i = 0, j = tmp.length; i < j; i++) {\n                                                this.open_node(tmp[i], false, 0);\n                                            }\n                                        }\n                                        this.trigger('changed', { 'action' : 'ready', 'selected' : this._data.core.selected });\n                                    }\n                                    /**\n                                     * triggered after all nodes are finished loading\n                                     * @event\n                                     * @name ready.jstree\n                                     */\n                                    this.trigger(\"ready\");\n                                }\n                            }.bind(this), 0);\n                        }\n                    }\n                }.bind(this))\n                // quick searching when the tree is focused\n                .on('keypress.jstree', function (e) {\n                    if(e.target.tagName && e.target.tagName.toLowerCase() === \"input\") { return true; }\n                    if(tout) { clearTimeout(tout); }\n                    tout = setTimeout(function () {\n                        word = '';\n                    }, 500);\n\n                    var chr = String.fromCharCode(e.which).toLowerCase(),\n                        col = this.element.find('.jstree-anchor').filter(':visible'),\n                        ind = col.index(document.activeElement) || 0,\n                        end = false;\n                    word += chr;\n\n                    // match for whole word from current node down (including the current node)\n                    if(word.length > 1) {\n                        col.slice(ind).each(function (i, v) {\n                            if($(v).text().toLowerCase().indexOf(word) === 0) {\n                                $(v).trigger('focus');\n                                end = true;\n                                return false;\n                            }\n                        }.bind(this));\n                        if(end) { return; }\n\n                        // match for whole word from the beginning of the tree\n                        col.slice(0, ind).each(function (i, v) {\n                            if($(v).text().toLowerCase().indexOf(word) === 0) {\n                                $(v).trigger('focus');\n                                end = true;\n                                return false;\n                            }\n                        }.bind(this));\n                        if(end) { return; }\n                    }\n                    // list nodes that start with that letter (only if word consists of a single char)\n                    if(new RegExp('^' + chr.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&') + '+$').test(word)) {\n                        // search for the next node starting with that letter\n                        col.slice(ind + 1).each(function (i, v) {\n                            if($(v).text().toLowerCase().charAt(0) === chr) {\n                                $(v).trigger('focus');\n                                end = true;\n                                return false;\n                            }\n                        }.bind(this));\n                        if(end) { return; }\n\n                        // search from the beginning\n                        col.slice(0, ind + 1).each(function (i, v) {\n                            if($(v).text().toLowerCase().charAt(0) === chr) {\n                                $(v).trigger('focus');\n                                end = true;\n                                return false;\n                            }\n                        }.bind(this));\n                        if(end) { return; }\n                    }\n                }.bind(this))\n                // THEME RELATED\n                .on(\"init.jstree\", function () {\n                    var s = this.settings.core.themes;\n                    this._data.core.themes.dots\t\t\t= s.dots;\n                    this._data.core.themes.stripes\t\t= s.stripes;\n                    this._data.core.themes.icons\t\t= s.icons;\n                    this._data.core.themes.ellipsis\t\t= s.ellipsis;\n                    this.set_theme(s.name || \"default\", s.url);\n                    this.set_theme_variant(s.variant);\n                }.bind(this))\n                .on(\"loading.jstree\", function () {\n                    this[ this._data.core.themes.dots ? \"show_dots\" : \"hide_dots\" ]();\n                    this[ this._data.core.themes.icons ? \"show_icons\" : \"hide_icons\" ]();\n                    this[ this._data.core.themes.stripes ? \"show_stripes\" : \"hide_stripes\" ]();\n                    this[ this._data.core.themes.ellipsis ? \"show_ellipsis\" : \"hide_ellipsis\" ]();\n                }.bind(this))\n                .on('blur.jstree', '.jstree-anchor', function (e) {\n                    this._data.core.focused = null;\n                    $(e.currentTarget).filter('.jstree-hovered').trigger('mouseleave');\n                    this.element.attr('tabindex', '0');\n                    $(e.currentTarget).attr('tabindex', '-1');\n                }.bind(this))\n                .on('focus.jstree', '.jstree-anchor', function (e) {\n                    var tmp = this.get_node(e.currentTarget);\n                    if(tmp && (tmp.id || tmp.id === 0)) {\n                        this._data.core.focused = tmp.id;\n                    }\n                    this.element.find('.jstree-hovered').not(e.currentTarget).trigger('mouseleave');\n                    $(e.currentTarget).trigger('mouseenter');\n                    this.element.attr('tabindex', '-1');\n                    $(e.currentTarget).attr('tabindex', '0');\n                }.bind(this))\n                .on('focus.jstree', function () {\n                    if(+(new Date()) - was_click > 500 && !this._data.core.focused && this.settings.core.restore_focus) {\n                        was_click = 0;\n                        var act = this.get_node(this.element.attr('aria-activedescendant'), true);\n                        if(act) {\n                            act.find('> .jstree-anchor').trigger('focus');\n                        }\n                    }\n                }.bind(this))\n                .on('mouseenter.jstree', '.jstree-anchor', function (e) {\n                    this.hover_node(e.currentTarget);\n                }.bind(this))\n                .on('mouseleave.jstree', '.jstree-anchor', function (e) {\n                    this.dehover_node(e.currentTarget);\n                }.bind(this));\n        },\n        /**\n         * part of the destroying of an instance. Used internally.\n         * @private\n         * @name unbind()\n         */\n        unbind : function () {\n            this.element.off('.jstree');\n            $(document).off('.jstree-' + this._id);\n        },\n        /**\n         * trigger an event. Used internally.\n         * @private\n         * @name trigger(ev [, data])\n         * @param  {String} ev the name of the event to trigger\n         * @param  {Object} data additional data to pass with the event\n         */\n        trigger : function (ev, data) {\n            if(!data) {\n                data = {};\n            }\n            data.instance = this;\n            this.element.triggerHandler(ev.replace('.jstree','') + '.jstree', data);\n        },\n        /**\n         * returns the jQuery extended instance container\n         * @name get_container()\n         * @return {jQuery}\n         */\n        get_container : function () {\n            return this.element;\n        },\n        /**\n         * returns the jQuery extended main UL node inside the instance container. Used internally.\n         * @private\n         * @name get_container_ul()\n         * @return {jQuery}\n         */\n        get_container_ul : function () {\n            return this.element.children(\".jstree-children\").first();\n        },\n        /**\n         * gets string replacements (localization). Used internally.\n         * @private\n         * @name get_string(key)\n         * @param  {String} key\n         * @return {String}\n         */\n        get_string : function (key) {\n            var a = this.settings.core.strings;\n            if($.vakata.is_function(a)) { return a.call(this, key); }\n            if(a && a[key]) { return a[key]; }\n            return key;\n        },\n        /**\n         * gets the first child of a DOM node. Used internally.\n         * @private\n         * @name _firstChild(dom)\n         * @param  {DOMElement} dom\n         * @return {DOMElement}\n         */\n        _firstChild : function (dom) {\n            dom = dom ? dom.firstChild : null;\n            while(dom !== null && dom.nodeType !== 1) {\n                dom = dom.nextSibling;\n            }\n            return dom;\n        },\n        /**\n         * gets the next sibling of a DOM node. Used internally.\n         * @private\n         * @name _nextSibling(dom)\n         * @param  {DOMElement} dom\n         * @return {DOMElement}\n         */\n        _nextSibling : function (dom) {\n            dom = dom ? dom.nextSibling : null;\n            while(dom !== null && dom.nodeType !== 1) {\n                dom = dom.nextSibling;\n            }\n            return dom;\n        },\n        /**\n         * gets the previous sibling of a DOM node. Used internally.\n         * @private\n         * @name _previousSibling(dom)\n         * @param  {DOMElement} dom\n         * @return {DOMElement}\n         */\n        _previousSibling : function (dom) {\n            dom = dom ? dom.previousSibling : null;\n            while(dom !== null && dom.nodeType !== 1) {\n                dom = dom.previousSibling;\n            }\n            return dom;\n        },\n        /**\n         * get the JSON representation of a node (or the actual jQuery extended DOM node) by using any input (child DOM element, ID string, selector, etc)\n         * @name get_node(obj [, as_dom])\n         * @param  {mixed} obj\n         * @param  {Boolean} as_dom\n         * @return {Object|jQuery}\n         */\n        get_node : function (obj, as_dom) {\n            if(obj && (obj.id || obj.id === 0)) {\n                obj = obj.id;\n            }\n            if (obj instanceof $ && obj.length && obj[0].id) {\n                obj = obj[0].id;\n            }\n            var dom;\n            try {\n                if(this._model.data[obj]) {\n                    obj = this._model.data[obj];\n                }\n                else if(typeof obj === \"string\" && this._model.data[obj.replace(/^#/, '')]) {\n                    obj = this._model.data[obj.replace(/^#/, '')];\n                }\n                else if(typeof obj === \"string\" && (dom = $('#' + obj.replace($.jstree.idregex,'\\\\$&'), this.element)).length && this._model.data[dom.closest('.jstree-node').attr('id')]) {\n                    obj = this._model.data[dom.closest('.jstree-node').attr('id')];\n                }\n                else if((dom = this.element.find(obj)).length && this._model.data[dom.closest('.jstree-node').attr('id')]) {\n                    obj = this._model.data[dom.closest('.jstree-node').attr('id')];\n                }\n                else if((dom = this.element.find(obj)).length && dom.hasClass('jstree')) {\n                    obj = this._model.data[$.jstree.root];\n                }\n                else {\n                    return false;\n                }\n\n                if(as_dom) {\n                    obj = obj.id === $.jstree.root ? this.element : $('#' + obj.id.replace($.jstree.idregex,'\\\\$&'), this.element);\n                }\n                return obj;\n            } catch (ex) { return false; }\n        },\n        /**\n         * get the path to a node, either consisting of node texts, or of node IDs, optionally glued together (otherwise an array)\n         * @name get_path(obj [, glue, ids])\n         * @param  {mixed} obj the node\n         * @param  {String} glue if you want the path as a string - pass the glue here (for example '/'), if a falsy value is supplied here, an array is returned\n         * @param  {Boolean} ids if set to true build the path using ID, otherwise node text is used\n         * @return {mixed}\n         */\n        get_path : function (obj, glue, ids) {\n            obj = obj.parents ? obj : this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root || !obj.parents) {\n                return false;\n            }\n            var i, j, p = [];\n            p.push(ids ? obj.id : obj.text);\n            for(i = 0, j = obj.parents.length; i < j; i++) {\n                p.push(ids ? obj.parents[i] : this.get_text(obj.parents[i]));\n            }\n            p = p.reverse().slice(1);\n            return glue ? p.join(glue) : p;\n        },\n        /**\n         * get the next visible node that is below the `obj` node. If `strict` is set to `true` only sibling nodes are returned.\n         * @name get_next_dom(obj [, strict])\n         * @param  {mixed} obj\n         * @param  {Boolean} strict\n         * @return {jQuery}\n         */\n        get_next_dom : function (obj, strict) {\n            var tmp;\n            obj = this.get_node(obj, true);\n            if(obj[0] === this.element[0]) {\n                tmp = this._firstChild(this.get_container_ul()[0]);\n                while (tmp && tmp.offsetHeight === 0) {\n                    tmp = this._nextSibling(tmp);\n                }\n                return tmp ? $(tmp) : false;\n            }\n            if(!obj || !obj.length) {\n                return false;\n            }\n            if(strict) {\n                tmp = obj[0];\n                do {\n                    tmp = this._nextSibling(tmp);\n                } while (tmp && tmp.offsetHeight === 0);\n                return tmp ? $(tmp) : false;\n            }\n            if(obj.hasClass(\"jstree-open\")) {\n                tmp = this._firstChild(obj.children('.jstree-children')[0]);\n                while (tmp && tmp.offsetHeight === 0) {\n                    tmp = this._nextSibling(tmp);\n                }\n                if(tmp !== null) {\n                    return $(tmp);\n                }\n            }\n            tmp = obj[0];\n            do {\n                tmp = this._nextSibling(tmp);\n            } while (tmp && tmp.offsetHeight === 0);\n            if(tmp !== null) {\n                return $(tmp);\n            }\n            return obj.parentsUntil(\".jstree\",\".jstree-node\").nextAll(\".jstree-node:visible\").first();\n        },\n        /**\n         * get the previous visible node that is above the `obj` node. If `strict` is set to `true` only sibling nodes are returned.\n         * @name get_prev_dom(obj [, strict])\n         * @param  {mixed} obj\n         * @param  {Boolean} strict\n         * @return {jQuery}\n         */\n        get_prev_dom : function (obj, strict) {\n            var tmp;\n            obj = this.get_node(obj, true);\n            if(obj[0] === this.element[0]) {\n                tmp = this.get_container_ul()[0].lastChild;\n                while (tmp && tmp.offsetHeight === 0) {\n                    tmp = this._previousSibling(tmp);\n                }\n                return tmp ? $(tmp) : false;\n            }\n            if(!obj || !obj.length) {\n                return false;\n            }\n            if(strict) {\n                tmp = obj[0];\n                do {\n                    tmp = this._previousSibling(tmp);\n                } while (tmp && tmp.offsetHeight === 0);\n                return tmp ? $(tmp) : false;\n            }\n            tmp = obj[0];\n            do {\n                tmp = this._previousSibling(tmp);\n            } while (tmp && tmp.offsetHeight === 0);\n            if(tmp !== null) {\n                obj = $(tmp);\n                while(obj.hasClass(\"jstree-open\")) {\n                    obj = obj.children(\".jstree-children\").first().children(\".jstree-node:visible:last\");\n                }\n                return obj;\n            }\n            tmp = obj[0].parentNode.parentNode;\n            return tmp && tmp.className && tmp.className.indexOf('jstree-node') !== -1 ? $(tmp) : false;\n        },\n        /**\n         * get the parent ID of a node\n         * @name get_parent(obj)\n         * @param  {mixed} obj\n         * @return {String}\n         */\n        get_parent : function (obj) {\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            return obj.parent;\n        },\n        /**\n         * get a jQuery collection of all the children of a node (node must be rendered), returns false on error\n         * @name get_children_dom(obj)\n         * @param  {mixed} obj\n         * @return {jQuery}\n         */\n        get_children_dom : function (obj) {\n            obj = this.get_node(obj, true);\n            if(obj[0] === this.element[0]) {\n                return this.get_container_ul().children(\".jstree-node\");\n            }\n            if(!obj || !obj.length) {\n                return false;\n            }\n            return obj.children(\".jstree-children\").children(\".jstree-node\");\n        },\n        /**\n         * checks if a node has children\n         * @name is_parent(obj)\n         * @param  {mixed} obj\n         * @return {Boolean}\n         */\n        is_parent : function (obj) {\n            obj = this.get_node(obj);\n            return obj && (obj.state.loaded === false || obj.children.length > 0);\n        },\n        /**\n         * checks if a node is loaded (its children are available)\n         * @name is_loaded(obj)\n         * @param  {mixed} obj\n         * @return {Boolean}\n         */\n        is_loaded : function (obj) {\n            obj = this.get_node(obj);\n            return obj && obj.state.loaded;\n        },\n        /**\n         * check if a node is currently loading (fetching children)\n         * @name is_loading(obj)\n         * @param  {mixed} obj\n         * @return {Boolean}\n         */\n        is_loading : function (obj) {\n            obj = this.get_node(obj);\n            return obj && obj.state && obj.state.loading;\n        },\n        /**\n         * check if a node is opened\n         * @name is_open(obj)\n         * @param  {mixed} obj\n         * @return {Boolean}\n         */\n        is_open : function (obj) {\n            obj = this.get_node(obj);\n            return obj && obj.state.opened;\n        },\n        /**\n         * check if a node is in a closed state\n         * @name is_closed(obj)\n         * @param  {mixed} obj\n         * @return {Boolean}\n         */\n        is_closed : function (obj) {\n            obj = this.get_node(obj);\n            return obj && this.is_parent(obj) && !obj.state.opened;\n        },\n        /**\n         * check if a node has no children\n         * @name is_leaf(obj)\n         * @param  {mixed} obj\n         * @return {Boolean}\n         */\n        is_leaf : function (obj) {\n            return !this.is_parent(obj);\n        },\n        /**\n         * loads a node (fetches its children using the `core.data` setting). Multiple nodes can be passed to by using an array.\n         * @name load_node(obj [, callback])\n         * @param  {mixed} obj\n         * @param  {function} callback a function to be executed once loading is complete, the function is executed in the instance's scope and receives two arguments - the node and a boolean status\n         * @return {Boolean}\n         * @trigger load_node.jstree\n         */\n        load_node : function (obj, callback) {\n            var dom = this.get_node(obj, true), k, l, i, j, c;\n            if($.vakata.is_array(obj)) {\n                this._load_nodes(obj.slice(), callback);\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj) {\n                if(callback) { callback.call(this, obj, false); }\n                return false;\n            }\n            // if(obj.state.loading) { } // the node is already loading - just wait for it to load and invoke callback? but if called implicitly it should be loaded again?\n            if(obj.state.loaded) {\n                obj.state.loaded = false;\n                for(i = 0, j = obj.parents.length; i < j; i++) {\n                    this._model.data[obj.parents[i]].children_d = $.vakata.array_filter(this._model.data[obj.parents[i]].children_d, function (v) {\n                        return $.inArray(v, obj.children_d) === -1;\n                    });\n                }\n                for(k = 0, l = obj.children_d.length; k < l; k++) {\n                    if(this._model.data[obj.children_d[k]].state.selected) {\n                        c = true;\n                    }\n                    delete this._model.data[obj.children_d[k]];\n                }\n                if (c) {\n                    this._data.core.selected = $.vakata.array_filter(this._data.core.selected, function (v) {\n                        return $.inArray(v, obj.children_d) === -1;\n                    });\n                }\n                obj.children = [];\n                obj.children_d = [];\n                if(c) {\n                    this.trigger('changed', { 'action' : 'load_node', 'node' : obj, 'selected' : this._data.core.selected });\n                }\n            }\n            obj.state.failed = false;\n            obj.state.loading = true;\n            if (obj.id !== $.jstree.root) {\n                dom.children(\".jstree-anchor\").attr('aria-busy', true);\n            } else {\n                dom.attr('aria-busy', true);\n            }\n            dom.addClass(\"jstree-loading\");\n            this._load_node(obj, function (status) {\n                obj = this._model.data[obj.id];\n                obj.state.loading = false;\n                obj.state.loaded = status;\n                obj.state.failed = !obj.state.loaded;\n                var dom = this.get_node(obj, true), i = 0, j = 0, m = this._model.data, has_children = false;\n                for(i = 0, j = obj.children.length; i < j; i++) {\n                    if(m[obj.children[i]] && !m[obj.children[i]].state.hidden) {\n                        has_children = true;\n                        break;\n                    }\n                }\n                if(obj.state.loaded && dom && dom.length) {\n                    dom.removeClass('jstree-closed jstree-open jstree-leaf');\n                    if (!has_children) {\n                        dom.addClass('jstree-leaf');\n                    }\n                    else {\n                        if (obj.id !== '#') {\n                            dom.addClass(obj.state.opened ? 'jstree-open' : 'jstree-closed');\n                        }\n                    }\n                }\n                if (obj.id !== $.jstree.root) {\n                    dom.children(\".jstree-anchor\").attr('aria-busy', false);\n                } else {\n                    dom.attr('aria-busy', false);\n                }\n                dom.removeClass(\"jstree-loading\");\n                /**\n                 * triggered after a node is loaded\n                 * @event\n                 * @name load_node.jstree\n                 * @param {Object} node the node that was loading\n                 * @param {Boolean} status was the node loaded successfully\n                 */\n                this.trigger('load_node', { \"node\" : obj, \"status\" : status });\n                if(callback) {\n                    callback.call(this, obj, status);\n                }\n            }.bind(this));\n            return true;\n        },\n        /**\n         * load an array of nodes (will also load unavailable nodes as soon as they appear in the structure). Used internally.\n         * @private\n         * @name _load_nodes(nodes [, callback])\n         * @param  {array} nodes\n         * @param  {function} callback a function to be executed once loading is complete, the function is executed in the instance's scope and receives one argument - the array passed to _load_nodes\n         */\n        _load_nodes : function (nodes, callback, is_callback, force_reload) {\n            var r = true,\n                c = function () { this._load_nodes(nodes, callback, true); },\n                m = this._model.data, i, j, tmp = [];\n            for(i = 0, j = nodes.length; i < j; i++) {\n                if(m[nodes[i]] && ( (!m[nodes[i]].state.loaded && !m[nodes[i]].state.failed) || (!is_callback && force_reload) )) {\n                    if(!this.is_loading(nodes[i])) {\n                        this.load_node(nodes[i], c);\n                    }\n                    r = false;\n                }\n            }\n            if(r) {\n                for(i = 0, j = nodes.length; i < j; i++) {\n                    if(m[nodes[i]] && m[nodes[i]].state.loaded) {\n                        tmp.push(nodes[i]);\n                    }\n                }\n                if(callback && !callback.done) {\n                    callback.call(this, tmp);\n                    callback.done = true;\n                }\n            }\n        },\n        /**\n         * loads all unloaded nodes\n         * @name load_all([obj, callback])\n         * @param {mixed} obj the node to load recursively, omit to load all nodes in the tree\n         * @param {function} callback a function to be executed once loading all the nodes is complete,\n         * @trigger load_all.jstree\n         */\n        load_all : function (obj, callback) {\n            if(!obj) { obj = $.jstree.root; }\n            obj = this.get_node(obj);\n            if(!obj) { return false; }\n            var to_load = [],\n                m = this._model.data,\n                c = m[obj.id].children_d,\n                i, j;\n            if(obj.state && !obj.state.loaded) {\n                to_load.push(obj.id);\n            }\n            for(i = 0, j = c.length; i < j; i++) {\n                if(m[c[i]] && m[c[i]].state && !m[c[i]].state.loaded) {\n                    to_load.push(c[i]);\n                }\n            }\n            if(to_load.length) {\n                this._load_nodes(to_load, function () {\n                    this.load_all(obj, callback);\n                });\n            }\n            else {\n                /**\n                 * triggered after a load_all call completes\n                 * @event\n                 * @name load_all.jstree\n                 * @param {Object} node the recursively loaded node\n                 */\n                if(callback) { callback.call(this, obj); }\n                this.trigger('load_all', { \"node\" : obj });\n            }\n        },\n        /**\n         * handles the actual loading of a node. Used only internally.\n         * @private\n         * @name _load_node(obj [, callback])\n         * @param  {mixed} obj\n         * @param  {function} callback a function to be executed once loading is complete, the function is executed in the instance's scope and receives one argument - a boolean status\n         * @return {Boolean}\n         */\n        _load_node : function (obj, callback) {\n            var s = this.settings.core.data, t;\n            var notTextOrCommentNode = function notTextOrCommentNode () {\n                return this.nodeType !== 3 && this.nodeType !== 8;\n            };\n            // use original HTML\n            if(!s) {\n                if(obj.id === $.jstree.root) {\n                    return this._append_html_data(obj, this._data.core.original_container_html.clone(true), function (status) {\n                        callback.call(this, status);\n                    });\n                }\n                else {\n                    return callback.call(this, false);\n                }\n                // return callback.call(this, obj.id === $.jstree.root ? this._append_html_data(obj, this._data.core.original_container_html.clone(true)) : false);\n            }\n            if($.vakata.is_function(s)) {\n                return s.call(this, obj, function (d) {\n                    if(d === false) {\n                        callback.call(this, false);\n                    }\n                    else {\n                        this[typeof d === 'string' ? '_append_html_data' : '_append_json_data'](obj, typeof d === 'string' ? $($.parseHTML(d)).filter(notTextOrCommentNode) : d, function (status) {\n                            callback.call(this, status);\n                        });\n                    }\n                    // return d === false ? callback.call(this, false) : callback.call(this, this[typeof d === 'string' ? '_append_html_data' : '_append_json_data'](obj, typeof d === 'string' ? $(d) : d));\n                }.bind(this));\n            }\n            if(typeof s === 'object') {\n                if(s.url) {\n                    s = $.extend(true, {}, s);\n                    if($.vakata.is_function(s.url)) {\n                        s.url = s.url.call(this, obj);\n                    }\n                    if($.vakata.is_function(s.data)) {\n                        s.data = s.data.call(this, obj);\n                    }\n                    return $.ajax(s)\n                        .done(function (d,t,x) {\n                            var type = x.getResponseHeader('Content-Type');\n                            if((type && type.indexOf('json') !== -1) || typeof d === \"object\") {\n                                return this._append_json_data(obj, d, function (status) { callback.call(this, status); });\n                                //return callback.call(this, this._append_json_data(obj, d));\n                            }\n                            if((type && type.indexOf('html') !== -1) || typeof d === \"string\") {\n                                return this._append_html_data(obj, $($.parseHTML(d)).filter(notTextOrCommentNode), function (status) { callback.call(this, status); });\n                                // return callback.call(this, this._append_html_data(obj, $(d)));\n                            }\n                            this._data.core.last_error = { 'error' : 'ajax', 'plugin' : 'core', 'id' : 'core_04', 'reason' : 'Could not load node', 'data' : JSON.stringify({ 'id' : obj.id, 'xhr' : x }) };\n                            this.settings.core.error.call(this, this._data.core.last_error);\n                            return callback.call(this, false);\n                        }.bind(this))\n                        .fail(function (f) {\n                            this._data.core.last_error = { 'error' : 'ajax', 'plugin' : 'core', 'id' : 'core_04', 'reason' : 'Could not load node', 'data' : JSON.stringify({ 'id' : obj.id, 'xhr' : f }) };\n                            callback.call(this, false);\n                            this.settings.core.error.call(this, this._data.core.last_error);\n                        }.bind(this));\n                }\n                if ($.vakata.is_array(s)) {\n                    t = $.extend(true, [], s);\n                } else if ($.isPlainObject(s)) {\n                    t = $.extend(true, {}, s);\n                } else {\n                    t = s;\n                }\n                if(obj.id === $.jstree.root) {\n                    return this._append_json_data(obj, t, function (status) {\n                        callback.call(this, status);\n                    });\n                }\n                else {\n                    this._data.core.last_error = { 'error' : 'nodata', 'plugin' : 'core', 'id' : 'core_05', 'reason' : 'Could not load node', 'data' : JSON.stringify({ 'id' : obj.id }) };\n                    this.settings.core.error.call(this, this._data.core.last_error);\n                    return callback.call(this, false);\n                }\n                //return callback.call(this, (obj.id === $.jstree.root ? this._append_json_data(obj, t) : false) );\n            }\n            if(typeof s === 'string') {\n                if(obj.id === $.jstree.root) {\n                    return this._append_html_data(obj, $($.parseHTML(s)).filter(notTextOrCommentNode), function (status) {\n                        callback.call(this, status);\n                    });\n                }\n                else {\n                    this._data.core.last_error = { 'error' : 'nodata', 'plugin' : 'core', 'id' : 'core_06', 'reason' : 'Could not load node', 'data' : JSON.stringify({ 'id' : obj.id }) };\n                    this.settings.core.error.call(this, this._data.core.last_error);\n                    return callback.call(this, false);\n                }\n                //return callback.call(this, (obj.id === $.jstree.root ? this._append_html_data(obj, $(s)) : false) );\n            }\n            return callback.call(this, false);\n        },\n        /**\n         * adds a node to the list of nodes to redraw. Used only internally.\n         * @private\n         * @name _node_changed(obj [, callback])\n         * @param  {mixed} obj\n         */\n        _node_changed : function (obj) {\n            obj = this.get_node(obj);\n            if (obj && $.inArray(obj.id, this._model.changed) === -1) {\n                this._model.changed.push(obj.id);\n            }\n        },\n        /**\n         * appends HTML content to the tree. Used internally.\n         * @private\n         * @name _append_html_data(obj, data)\n         * @param  {mixed} obj the node to append to\n         * @param  {String} data the HTML string to parse and append\n         * @trigger model.jstree, changed.jstree\n         */\n        _append_html_data : function (dom, data, cb) {\n            dom = this.get_node(dom);\n            dom.children = [];\n            dom.children_d = [];\n            var dat = data.is('ul') ? data.children() : data,\n                par = dom.id,\n                chd = [],\n                dpc = [],\n                m = this._model.data,\n                p = m[par],\n                s = this._data.core.selected.length,\n                tmp, i, j;\n            dat.each(function (i, v) {\n                tmp = this._parse_model_from_html($(v), par, p.parents.concat());\n                if(tmp) {\n                    chd.push(tmp);\n                    dpc.push(tmp);\n                    if(m[tmp].children_d.length) {\n                        dpc = dpc.concat(m[tmp].children_d);\n                    }\n                }\n            }.bind(this));\n            p.children = chd;\n            p.children_d = dpc;\n            for(i = 0, j = p.parents.length; i < j; i++) {\n                m[p.parents[i]].children_d = m[p.parents[i]].children_d.concat(dpc);\n            }\n            /**\n             * triggered when new data is inserted to the tree model\n             * @event\n             * @name model.jstree\n             * @param {Array} nodes an array of node IDs\n             * @param {String} parent the parent ID of the nodes\n             */\n            this.trigger('model', { \"nodes\" : dpc, 'parent' : par });\n            if(par !== $.jstree.root) {\n                this._node_changed(par);\n                this.redraw();\n            }\n            else {\n                this.get_container_ul().children('.jstree-initial-node').remove();\n                this.redraw(true);\n            }\n            if(this._data.core.selected.length !== s) {\n                this.trigger('changed', { 'action' : 'model', 'selected' : this._data.core.selected });\n            }\n            cb.call(this, true);\n        },\n        /**\n         * appends JSON content to the tree. Used internally.\n         * @private\n         * @name _append_json_data(obj, data)\n         * @param  {mixed} obj the node to append to\n         * @param  {String} data the JSON object to parse and append\n         * @param  {Boolean} force_processing internal param - do not set\n         * @trigger model.jstree, changed.jstree\n         */\n        _append_json_data : function (dom, data, cb, force_processing) {\n            if(this.element === null) { return; }\n            dom = this.get_node(dom);\n            dom.children = [];\n            dom.children_d = [];\n            // *%$@!!!\n            if(data.d) {\n                data = data.d;\n                if(typeof data === \"string\") {\n                    data = JSON.parse(data);\n                }\n            }\n            if(!$.vakata.is_array(data)) { data = [data]; }\n            var w = null,\n                args = {\n                    'df'\t: this._model.default_state,\n                    'dat'\t: data,\n                    'par'\t: dom.id,\n                    'm'\t\t: this._model.data,\n                    't_id'\t: this._id,\n                    't_cnt'\t: this._cnt,\n                    'sel'\t: this._data.core.selected\n                },\n                inst = this,\n                func = function (data, undefined) {\n                    if(data.data) { data = data.data; }\n                    var dat = data.dat,\n                        par = data.par,\n                        chd = [],\n                        dpc = [],\n                        add = [],\n                        df = data.df,\n                        t_id = data.t_id,\n                        t_cnt = data.t_cnt,\n                        m = data.m,\n                        p = m[par],\n                        sel = data.sel,\n                        tmp, i, j, rslt,\n                        parse_flat = function (d, p, ps) {\n                            if(!ps) { ps = []; }\n                            else { ps = ps.concat(); }\n                            if(p) { ps.unshift(p); }\n                            var tid = d.id.toString(),\n                                i, j, c, e,\n                                tmp = {\n                                    id\t\t\t: tid,\n                                    text\t\t: d.text || '',\n                                    icon\t\t: d.icon !== undefined ? d.icon : true,\n                                    parent\t\t: p,\n                                    parents\t\t: ps,\n                                    children\t: d.children || [],\n                                    children_d\t: d.children_d || [],\n                                    data\t\t: d.data,\n                                    state\t\t: { },\n                                    li_attr\t\t: { id : false },\n                                    a_attr\t\t: { href : '#' },\n                                    original\t: false\n                                };\n                            for(i in df) {\n                                if(df.hasOwnProperty(i)) {\n                                    tmp.state[i] = df[i];\n                                }\n                            }\n                            if(d && d.data && d.data.jstree && d.data.jstree.icon) {\n                                tmp.icon = d.data.jstree.icon;\n                            }\n                            if(tmp.icon === undefined || tmp.icon === null || tmp.icon === \"\") {\n                                tmp.icon = true;\n                            }\n                            if(d && d.data) {\n                                tmp.data = d.data;\n                                if(d.data.jstree) {\n                                    for(i in d.data.jstree) {\n                                        if(d.data.jstree.hasOwnProperty(i)) {\n                                            tmp.state[i] = d.data.jstree[i];\n                                        }\n                                    }\n                                }\n                            }\n                            if(d && typeof d.state === 'object') {\n                                for (i in d.state) {\n                                    if(d.state.hasOwnProperty(i)) {\n                                        tmp.state[i] = d.state[i];\n                                    }\n                                }\n                            }\n                            if(d && typeof d.li_attr === 'object') {\n                                for (i in d.li_attr) {\n                                    if(d.li_attr.hasOwnProperty(i)) {\n                                        tmp.li_attr[i] = d.li_attr[i];\n                                    }\n                                }\n                            }\n                            if(!tmp.li_attr.id) {\n                                tmp.li_attr.id = tid;\n                            }\n                            if(d && typeof d.a_attr === 'object') {\n                                for (i in d.a_attr) {\n                                    if(d.a_attr.hasOwnProperty(i)) {\n                                        tmp.a_attr[i] = d.a_attr[i];\n                                    }\n                                }\n                            }\n                            if(d && d.children && d.children === true) {\n                                tmp.state.loaded = false;\n                                tmp.children = [];\n                                tmp.children_d = [];\n                            }\n                            m[tmp.id] = tmp;\n                            for(i = 0, j = tmp.children.length; i < j; i++) {\n                                c = parse_flat(m[tmp.children[i]], tmp.id, ps);\n                                e = m[c];\n                                tmp.children_d.push(c);\n                                if(e.children_d.length) {\n                                    tmp.children_d = tmp.children_d.concat(e.children_d);\n                                }\n                            }\n                            delete d.data;\n                            delete d.children;\n                            m[tmp.id].original = d;\n                            if(tmp.state.selected) {\n                                add.push(tmp.id);\n                            }\n                            return tmp.id;\n                        },\n                        parse_nest = function (d, p, ps) {\n                            if(!ps) { ps = []; }\n                            else { ps = ps.concat(); }\n                            if(p) { ps.unshift(p); }\n                            var tid = false, i, j, c, e, tmp;\n                            do {\n                                tid = 'j' + t_id + '_' + (++t_cnt);\n                            } while(m[tid]);\n\n                            tmp = {\n                                id\t\t\t: false,\n                                text\t\t: typeof d === 'string' ? d : '',\n                                icon\t\t: typeof d === 'object' && d.icon !== undefined ? d.icon : true,\n                                parent\t\t: p,\n                                parents\t\t: ps,\n                                children\t: [],\n                                children_d\t: [],\n                                data\t\t: null,\n                                state\t\t: { },\n                                li_attr\t\t: { id : false },\n                                a_attr\t\t: { href : '#' },\n                                original\t: false\n                            };\n                            for(i in df) {\n                                if(df.hasOwnProperty(i)) {\n                                    tmp.state[i] = df[i];\n                                }\n                            }\n                            if(d && (d.id || d.id === 0)) { tmp.id = d.id.toString(); }\n                            if(d && d.text) { tmp.text = d.text; }\n                            if(d && d.data && d.data.jstree && d.data.jstree.icon) {\n                                tmp.icon = d.data.jstree.icon;\n                            }\n                            if(tmp.icon === undefined || tmp.icon === null || tmp.icon === \"\") {\n                                tmp.icon = true;\n                            }\n                            if(d && d.data) {\n                                tmp.data = d.data;\n                                if(d.data.jstree) {\n                                    for(i in d.data.jstree) {\n                                        if(d.data.jstree.hasOwnProperty(i)) {\n                                            tmp.state[i] = d.data.jstree[i];\n                                        }\n                                    }\n                                }\n                            }\n                            if(d && typeof d.state === 'object') {\n                                for (i in d.state) {\n                                    if(d.state.hasOwnProperty(i)) {\n                                        tmp.state[i] = d.state[i];\n                                    }\n                                }\n                            }\n                            if(d && typeof d.li_attr === 'object') {\n                                for (i in d.li_attr) {\n                                    if(d.li_attr.hasOwnProperty(i)) {\n                                        tmp.li_attr[i] = d.li_attr[i];\n                                    }\n                                }\n                            }\n                            if(tmp.li_attr.id && !(tmp.id || tmp.id === 0)) {\n                                tmp.id = tmp.li_attr.id.toString();\n                            }\n                            if(!(tmp.id || tmp.id === 0)) {\n                                tmp.id = tid;\n                            }\n                            if(!tmp.li_attr.id) {\n                                tmp.li_attr.id = tmp.id;\n                            }\n                            if(d && typeof d.a_attr === 'object') {\n                                for (i in d.a_attr) {\n                                    if(d.a_attr.hasOwnProperty(i)) {\n                                        tmp.a_attr[i] = d.a_attr[i];\n                                    }\n                                }\n                            }\n                            if(d && d.children && d.children.length) {\n                                for(i = 0, j = d.children.length; i < j; i++) {\n                                    c = parse_nest(d.children[i], tmp.id, ps);\n                                    e = m[c];\n                                    tmp.children.push(c);\n                                    if(e.children_d.length) {\n                                        tmp.children_d = tmp.children_d.concat(e.children_d);\n                                    }\n                                }\n                                tmp.children_d = tmp.children_d.concat(tmp.children);\n                            }\n                            if(d && d.children && d.children === true) {\n                                tmp.state.loaded = false;\n                                tmp.children = [];\n                                tmp.children_d = [];\n                            }\n                            delete d.data;\n                            delete d.children;\n                            tmp.original = d;\n                            m[tmp.id] = tmp;\n                            if(tmp.state.selected) {\n                                add.push(tmp.id);\n                            }\n                            return tmp.id;\n                        };\n\n                    if(dat.length && dat[0].id !== undefined && dat[0].parent !== undefined) {\n                        // Flat JSON support (for easy import from DB):\n                        // 1) convert to object (foreach)\n                        for(i = 0, j = dat.length; i < j; i++) {\n                            if(!dat[i].children) {\n                                dat[i].children = [];\n                            }\n                            if(!dat[i].state) {\n                                dat[i].state = {};\n                            }\n                            m[dat[i].id.toString()] = dat[i];\n                        }\n                        // 2) populate children (foreach)\n                        for(i = 0, j = dat.length; i < j; i++) {\n                            if (!m[dat[i].parent.toString()]) {\n                                if (typeof inst !== \"undefined\") {\n                                    inst._data.core.last_error = { 'error' : 'parse', 'plugin' : 'core', 'id' : 'core_07', 'reason' : 'Node with invalid parent', 'data' : JSON.stringify({ 'id' : dat[i].id.toString(), 'parent' : dat[i].parent.toString() }) };\n                                    inst.settings.core.error.call(inst, inst._data.core.last_error);\n                                }\n                                continue;\n                            }\n\n                            m[dat[i].parent.toString()].children.push(dat[i].id.toString());\n                            // populate parent.children_d\n                            p.children_d.push(dat[i].id.toString());\n                        }\n                        // 3) normalize && populate parents and children_d with recursion\n                        for(i = 0, j = p.children.length; i < j; i++) {\n                            tmp = parse_flat(m[p.children[i]], par, p.parents.concat());\n                            dpc.push(tmp);\n                            if(m[tmp].children_d.length) {\n                                dpc = dpc.concat(m[tmp].children_d);\n                            }\n                        }\n                        for(i = 0, j = p.parents.length; i < j; i++) {\n                            m[p.parents[i]].children_d = m[p.parents[i]].children_d.concat(dpc);\n                        }\n                        // ?) three_state selection - p.state.selected && t - (if three_state foreach(dat => ch) -> foreach(parents) if(parent.selected) child.selected = true;\n                        rslt = {\n                            'cnt' : t_cnt,\n                            'mod' : m,\n                            'sel' : sel,\n                            'par' : par,\n                            'dpc' : dpc,\n                            'add' : add\n                        };\n                    }\n                    else {\n                        for(i = 0, j = dat.length; i < j; i++) {\n                            tmp = parse_nest(dat[i], par, p.parents.concat());\n                            if(tmp) {\n                                chd.push(tmp);\n                                dpc.push(tmp);\n                                if(m[tmp].children_d.length) {\n                                    dpc = dpc.concat(m[tmp].children_d);\n                                }\n                            }\n                        }\n                        p.children = chd;\n                        p.children_d = dpc;\n                        for(i = 0, j = p.parents.length; i < j; i++) {\n                            m[p.parents[i]].children_d = m[p.parents[i]].children_d.concat(dpc);\n                        }\n                        rslt = {\n                            'cnt' : t_cnt,\n                            'mod' : m,\n                            'sel' : sel,\n                            'par' : par,\n                            'dpc' : dpc,\n                            'add' : add\n                        };\n                    }\n                    if(typeof window === 'undefined' || typeof window.document === 'undefined') {\n                        postMessage(rslt);\n                    }\n                    else {\n                        return rslt;\n                    }\n                },\n                rslt = function (rslt, worker) {\n                    if(this.element === null) { return; }\n                    this._cnt = rslt.cnt;\n                    var i, m = this._model.data;\n                    for (i in m) {\n                        if (m.hasOwnProperty(i) && m[i].state && m[i].state.loading && rslt.mod[i]) {\n                            rslt.mod[i].state.loading = true;\n                        }\n                    }\n                    this._model.data = rslt.mod; // breaks the reference in load_node - careful\n\n                    if(worker) {\n                        var j, a = rslt.add, r = rslt.sel, s = this._data.core.selected.slice();\n                        m = this._model.data;\n                        // if selection was changed while calculating in worker\n                        if(r.length !== s.length || $.vakata.array_unique(r.concat(s)).length !== r.length) {\n                            // deselect nodes that are no longer selected\n                            for(i = 0, j = r.length; i < j; i++) {\n                                if($.inArray(r[i], a) === -1 && $.inArray(r[i], s) === -1) {\n                                    m[r[i]].state.selected = false;\n                                }\n                            }\n                            // select nodes that were selected in the mean time\n                            for(i = 0, j = s.length; i < j; i++) {\n                                if($.inArray(s[i], r) === -1) {\n                                    m[s[i]].state.selected = true;\n                                }\n                            }\n                        }\n                    }\n                    if(rslt.add.length) {\n                        this._data.core.selected = this._data.core.selected.concat(rslt.add);\n                    }\n\n                    this.trigger('model', { \"nodes\" : rslt.dpc, 'parent' : rslt.par });\n\n                    if(rslt.par !== $.jstree.root) {\n                        this._node_changed(rslt.par);\n                        this.redraw();\n                    }\n                    else {\n                        // this.get_container_ul().children('.jstree-initial-node').remove();\n                        this.redraw(true);\n                    }\n                    if(rslt.add.length) {\n                        this.trigger('changed', { 'action' : 'model', 'selected' : this._data.core.selected });\n                    }\n\n                    // If no worker, try to mimic worker behavioour, by invoking cb asynchronously\n                    if (!worker && setImmediate) {\n                        setImmediate(function(){\n                            cb.call(inst, true);\n                        });\n                    }\n                    else {\n                        cb.call(inst, true);\n                    }\n                };\n            if(this.settings.core.worker && window.Blob && window.URL && window.Worker) {\n                try {\n                    if(this._wrk === null) {\n                        this._wrk = window.URL.createObjectURL(\n                            new window.Blob(\n                                ['self.onmessage = ' + func.toString()],\n                                {type:\"text/javascript\"}\n                            )\n                        );\n                    }\n                    if(!this._data.core.working || force_processing) {\n                        this._data.core.working = true;\n                        w = new window.Worker(this._wrk);\n                        w.onmessage = function (e) {\n                            rslt.call(this, e.data, true);\n                            try { w.terminate(); w = null; } catch(ignore) { }\n                            if(this._data.core.worker_queue.length) {\n                                this._append_json_data.apply(this, this._data.core.worker_queue.shift());\n                            }\n                            else {\n                                this._data.core.working = false;\n                            }\n                        }.bind(this);\n                        w.onerror = function (e) {\n                            rslt.call(this, func(args), false);\n                            if(this._data.core.worker_queue.length) {\n                                this._append_json_data.apply(this, this._data.core.worker_queue.shift());\n                            }\n                            else {\n                                this._data.core.working = false;\n                            }\n                        }.bind(this);\n                        if(!args.par) {\n                            if(this._data.core.worker_queue.length) {\n                                this._append_json_data.apply(this, this._data.core.worker_queue.shift());\n                            }\n                            else {\n                                this._data.core.working = false;\n                            }\n                        }\n                        else {\n                            w.postMessage(args);\n                        }\n                    }\n                    else {\n                        this._data.core.worker_queue.push([dom, data, cb, true]);\n                    }\n                }\n                catch(e) {\n                    rslt.call(this, func(args), false);\n                    if(this._data.core.worker_queue.length) {\n                        this._append_json_data.apply(this, this._data.core.worker_queue.shift());\n                    }\n                    else {\n                        this._data.core.working = false;\n                    }\n                }\n            }\n            else {\n                rslt.call(this, func(args), false);\n            }\n        },\n        /**\n         * parses a node from a jQuery object and appends them to the in memory tree model. Used internally.\n         * @private\n         * @name _parse_model_from_html(d [, p, ps])\n         * @param  {jQuery} d the jQuery object to parse\n         * @param  {String} p the parent ID\n         * @param  {Array} ps list of all parents\n         * @return {String} the ID of the object added to the model\n         */\n        _parse_model_from_html : function (d, p, ps) {\n            if(!ps) { ps = []; }\n            else { ps = [].concat(ps); }\n            if(p) { ps.unshift(p); }\n            var c, e, m = this._model.data,\n                data = {\n                    id\t\t\t: false,\n                    text\t\t: false,\n                    icon\t\t: true,\n                    parent\t\t: p,\n                    parents\t\t: ps,\n                    children\t: [],\n                    children_d\t: [],\n                    data\t\t: null,\n                    state\t\t: { },\n                    li_attr\t\t: { id : false },\n                    a_attr\t\t: { href : '#' },\n                    original\t: false\n                }, i, tmp, tid;\n            for(i in this._model.default_state) {\n                if(this._model.default_state.hasOwnProperty(i)) {\n                    data.state[i] = this._model.default_state[i];\n                }\n            }\n            tmp = $.vakata.attributes(d, true);\n            $.each(tmp, function (i, v) {\n                v = $.vakata.trim(v);\n                if(!v.length) { return true; }\n                data.li_attr[i] = v;\n                if(i === 'id') {\n                    data.id = v.toString();\n                }\n            });\n            tmp = d.children('a').first();\n            if(tmp.length) {\n                tmp = $.vakata.attributes(tmp, true);\n                $.each(tmp, function (i, v) {\n                    v = $.vakata.trim(v);\n                    if(v.length) {\n                        data.a_attr[i] = v;\n                    }\n                });\n            }\n            tmp = d.children(\"a\").first().length ? d.children(\"a\").first().clone() : d.clone();\n            tmp.children(\"ins, i, ul\").remove();\n            tmp = tmp.html();\n            tmp = $('<div></div>').html(tmp);\n            data.text = this.settings.core.force_text ? tmp.text() : tmp.html();\n            tmp = d.data();\n            data.data = tmp ? $.extend(true, {}, tmp) : null;\n            data.state.opened = d.hasClass('jstree-open');\n            data.state.selected = d.children('a').hasClass('jstree-clicked');\n            data.state.disabled = d.children('a').hasClass('jstree-disabled');\n            if(data.data && data.data.jstree) {\n                for(i in data.data.jstree) {\n                    if(data.data.jstree.hasOwnProperty(i)) {\n                        data.state[i] = data.data.jstree[i];\n                    }\n                }\n            }\n            tmp = d.children(\"a\").children(\".jstree-themeicon\");\n            if(tmp.length) {\n                data.icon = tmp.hasClass('jstree-themeicon-hidden') ? false : tmp.attr('rel');\n            }\n            if(data.state.icon !== undefined) {\n                data.icon = data.state.icon;\n            }\n            if(data.icon === undefined || data.icon === null || data.icon === \"\") {\n                data.icon = true;\n            }\n            tmp = d.children(\"ul\").children(\"li\");\n            do {\n                tid = 'j' + this._id + '_' + (++this._cnt);\n            } while(m[tid]);\n            data.id = data.li_attr.id ? data.li_attr.id.toString() : tid;\n            if(tmp.length) {\n                tmp.each(function (i, v) {\n                    c = this._parse_model_from_html($(v), data.id, ps);\n                    e = this._model.data[c];\n                    data.children.push(c);\n                    if(e.children_d.length) {\n                        data.children_d = data.children_d.concat(e.children_d);\n                    }\n                }.bind(this));\n                data.children_d = data.children_d.concat(data.children);\n            }\n            else {\n                if(d.hasClass('jstree-closed')) {\n                    data.state.loaded = false;\n                }\n            }\n            if(data.li_attr['class']) {\n                data.li_attr['class'] = data.li_attr['class'].replace('jstree-closed','').replace('jstree-open','');\n            }\n            if(data.a_attr['class']) {\n                data.a_attr['class'] = data.a_attr['class'].replace('jstree-clicked','').replace('jstree-disabled','');\n            }\n            m[data.id] = data;\n            if(data.state.selected) {\n                this._data.core.selected.push(data.id);\n            }\n            return data.id;\n        },\n        /**\n         * parses a node from a JSON object (used when dealing with flat data, which has no nesting of children, but has id and parent properties) and appends it to the in memory tree model. Used internally.\n         * @private\n         * @name _parse_model_from_flat_json(d [, p, ps])\n         * @param  {Object} d the JSON object to parse\n         * @param  {String} p the parent ID\n         * @param  {Array} ps list of all parents\n         * @return {String} the ID of the object added to the model\n         */\n        _parse_model_from_flat_json : function (d, p, ps) {\n            if(!ps) { ps = []; }\n            else { ps = ps.concat(); }\n            if(p) { ps.unshift(p); }\n            var tid = d.id.toString(),\n                m = this._model.data,\n                df = this._model.default_state,\n                i, j, c, e,\n                tmp = {\n                    id\t\t\t: tid,\n                    text\t\t: d.text || '',\n                    icon\t\t: d.icon !== undefined ? d.icon : true,\n                    parent\t\t: p,\n                    parents\t\t: ps,\n                    children\t: d.children || [],\n                    children_d\t: d.children_d || [],\n                    data\t\t: d.data,\n                    state\t\t: { },\n                    li_attr\t\t: { id : false },\n                    a_attr\t\t: { href : '#' },\n                    original\t: false\n                };\n            for(i in df) {\n                if(df.hasOwnProperty(i)) {\n                    tmp.state[i] = df[i];\n                }\n            }\n            if(d && d.data && d.data.jstree && d.data.jstree.icon) {\n                tmp.icon = d.data.jstree.icon;\n            }\n            if(tmp.icon === undefined || tmp.icon === null || tmp.icon === \"\") {\n                tmp.icon = true;\n            }\n            if(d && d.data) {\n                tmp.data = d.data;\n                if(d.data.jstree) {\n                    for(i in d.data.jstree) {\n                        if(d.data.jstree.hasOwnProperty(i)) {\n                            tmp.state[i] = d.data.jstree[i];\n                        }\n                    }\n                }\n            }\n            if(d && typeof d.state === 'object') {\n                for (i in d.state) {\n                    if(d.state.hasOwnProperty(i)) {\n                        tmp.state[i] = d.state[i];\n                    }\n                }\n            }\n            if(d && typeof d.li_attr === 'object') {\n                for (i in d.li_attr) {\n                    if(d.li_attr.hasOwnProperty(i)) {\n                        tmp.li_attr[i] = d.li_attr[i];\n                    }\n                }\n            }\n            if(!tmp.li_attr.id) {\n                tmp.li_attr.id = tid;\n            }\n            if(d && typeof d.a_attr === 'object') {\n                for (i in d.a_attr) {\n                    if(d.a_attr.hasOwnProperty(i)) {\n                        tmp.a_attr[i] = d.a_attr[i];\n                    }\n                }\n            }\n            if(d && d.children && d.children === true) {\n                tmp.state.loaded = false;\n                tmp.children = [];\n                tmp.children_d = [];\n            }\n            m[tmp.id] = tmp;\n            for(i = 0, j = tmp.children.length; i < j; i++) {\n                c = this._parse_model_from_flat_json(m[tmp.children[i]], tmp.id, ps);\n                e = m[c];\n                tmp.children_d.push(c);\n                if(e.children_d.length) {\n                    tmp.children_d = tmp.children_d.concat(e.children_d);\n                }\n            }\n            delete d.data;\n            delete d.children;\n            m[tmp.id].original = d;\n            if(tmp.state.selected) {\n                this._data.core.selected.push(tmp.id);\n            }\n            return tmp.id;\n        },\n        /**\n         * parses a node from a JSON object and appends it to the in memory tree model. Used internally.\n         * @private\n         * @name _parse_model_from_json(d [, p, ps])\n         * @param  {Object} d the JSON object to parse\n         * @param  {String} p the parent ID\n         * @param  {Array} ps list of all parents\n         * @return {String} the ID of the object added to the model\n         */\n        _parse_model_from_json : function (d, p, ps) {\n            if(!ps) { ps = []; }\n            else { ps = ps.concat(); }\n            if(p) { ps.unshift(p); }\n            var tid = false, i, j, c, e, m = this._model.data, df = this._model.default_state, tmp;\n            do {\n                tid = 'j' + this._id + '_' + (++this._cnt);\n            } while(m[tid]);\n\n            tmp = {\n                id\t\t\t: false,\n                text\t\t: typeof d === 'string' ? d : '',\n                icon\t\t: typeof d === 'object' && d.icon !== undefined ? d.icon : true,\n                parent\t\t: p,\n                parents\t\t: ps,\n                children\t: [],\n                children_d\t: [],\n                data\t\t: null,\n                state\t\t: { },\n                li_attr\t\t: { id : false },\n                a_attr\t\t: { href : '#' },\n                original\t: false\n            };\n            for(i in df) {\n                if(df.hasOwnProperty(i)) {\n                    tmp.state[i] = df[i];\n                }\n            }\n            if(d && (d.id || d.id === 0)) { tmp.id = d.id.toString(); }\n            if(d && d.text) { tmp.text = d.text; }\n            if(d && d.data && d.data.jstree && d.data.jstree.icon) {\n                tmp.icon = d.data.jstree.icon;\n            }\n            if(tmp.icon === undefined || tmp.icon === null || tmp.icon === \"\") {\n                tmp.icon = true;\n            }\n            if(d && d.data) {\n                tmp.data = d.data;\n                if(d.data.jstree) {\n                    for(i in d.data.jstree) {\n                        if(d.data.jstree.hasOwnProperty(i)) {\n                            tmp.state[i] = d.data.jstree[i];\n                        }\n                    }\n                }\n            }\n            if(d && typeof d.state === 'object') {\n                for (i in d.state) {\n                    if(d.state.hasOwnProperty(i)) {\n                        tmp.state[i] = d.state[i];\n                    }\n                }\n            }\n            if(d && typeof d.li_attr === 'object') {\n                for (i in d.li_attr) {\n                    if(d.li_attr.hasOwnProperty(i)) {\n                        tmp.li_attr[i] = d.li_attr[i];\n                    }\n                }\n            }\n            if(tmp.li_attr.id && !(tmp.id || tmp.id === 0)) {\n                tmp.id = tmp.li_attr.id.toString();\n            }\n            if(!(tmp.id || tmp.id === 0)) {\n                tmp.id = tid;\n            }\n            if(!tmp.li_attr.id) {\n                tmp.li_attr.id = tmp.id;\n            }\n            if(d && typeof d.a_attr === 'object') {\n                for (i in d.a_attr) {\n                    if(d.a_attr.hasOwnProperty(i)) {\n                        tmp.a_attr[i] = d.a_attr[i];\n                    }\n                }\n            }\n            if(d && d.children && d.children.length) {\n                for(i = 0, j = d.children.length; i < j; i++) {\n                    c = this._parse_model_from_json(d.children[i], tmp.id, ps);\n                    e = m[c];\n                    tmp.children.push(c);\n                    if(e.children_d.length) {\n                        tmp.children_d = tmp.children_d.concat(e.children_d);\n                    }\n                }\n                tmp.children_d = tmp.children.concat(tmp.children_d);\n            }\n            if(d && d.children && d.children === true) {\n                tmp.state.loaded = false;\n                tmp.children = [];\n                tmp.children_d = [];\n            }\n            delete d.data;\n            delete d.children;\n            tmp.original = d;\n            m[tmp.id] = tmp;\n            if(tmp.state.selected) {\n                this._data.core.selected.push(tmp.id);\n            }\n            return tmp.id;\n        },\n        /**\n         * redraws all nodes that need to be redrawn. Used internally.\n         * @private\n         * @name _redraw()\n         * @trigger redraw.jstree\n         */\n        _redraw : function () {\n            var nodes = this._model.force_full_redraw ? this._model.data[$.jstree.root].children.concat([]) : this._model.changed.concat([]),\n                f = document.createElement('UL'), tmp, i, j, fe = this._data.core.focused;\n            for(i = 0, j = nodes.length; i < j; i++) {\n                tmp = this.redraw_node(nodes[i], true, this._model.force_full_redraw);\n                if(tmp && this._model.force_full_redraw) {\n                    f.appendChild(tmp);\n                }\n            }\n            if(this._model.force_full_redraw) {\n                f.className = this.get_container_ul()[0].className;\n                f.setAttribute('role','presentation');\n                this.element.empty().append(f);\n                //this.get_container_ul()[0].appendChild(f);\n            }\n            if(fe !== null && this.settings.core.restore_focus) {\n                tmp = this.get_node(fe, true);\n                if(tmp && tmp.length && tmp.children('.jstree-anchor')[0] !== document.activeElement) {\n                    tmp.children('.jstree-anchor').trigger('focus');\n                }\n                else {\n                    this._data.core.focused = null;\n                }\n            }\n            this._model.force_full_redraw = false;\n            this._model.changed = [];\n            /**\n             * triggered after nodes are redrawn\n             * @event\n             * @name redraw.jstree\n             * @param {array} nodes the redrawn nodes\n             */\n            this.trigger('redraw', { \"nodes\" : nodes });\n        },\n        /**\n         * redraws all nodes that need to be redrawn or optionally - the whole tree\n         * @name redraw([full])\n         * @param {Boolean} full if set to `true` all nodes are redrawn.\n         */\n        redraw : function (full) {\n            if(full) {\n                this._model.force_full_redraw = true;\n            }\n            //if(this._model.redraw_timeout) {\n            //\tclearTimeout(this._model.redraw_timeout);\n            //}\n            //this._model.redraw_timeout = setTimeout($.proxy(this._redraw, this),0);\n            this._redraw();\n        },\n        /**\n         * redraws a single node's children. Used internally.\n         * @private\n         * @name draw_children(node)\n         * @param {mixed} node the node whose children will be redrawn\n         */\n        draw_children : function (node) {\n            var obj = this.get_node(node),\n                i = false,\n                j = false,\n                k = false,\n                d = document;\n            if(!obj) { return false; }\n            if(obj.id === $.jstree.root) { return this.redraw(true); }\n            node = this.get_node(node, true);\n            if(!node || !node.length) { return false; } // TODO: quick toggle\n\n            node.children('.jstree-children').remove();\n            node = node[0];\n            if(obj.children.length && obj.state.loaded) {\n                k = d.createElement('UL');\n                k.setAttribute('role', 'group');\n                k.className = 'jstree-children';\n                for(i = 0, j = obj.children.length; i < j; i++) {\n                    k.appendChild(this.redraw_node(obj.children[i], true, true));\n                }\n                node.appendChild(k);\n            }\n        },\n        /**\n         * redraws a single node. Used internally.\n         * @private\n         * @name redraw_node(node, deep, is_callback, force_render)\n         * @param {mixed} node the node to redraw\n         * @param {Boolean} deep should child nodes be redrawn too\n         * @param {Boolean} is_callback is this a recursion call\n         * @param {Boolean} force_render should children of closed parents be drawn anyway\n         */\n        redraw_node : function (node, deep, is_callback, force_render) {\n            var obj = this.get_node(node),\n                par = false,\n                ind = false,\n                old = false,\n                i = false,\n                j = false,\n                k = false,\n                c = '',\n                d = document,\n                m = this._model.data,\n                f = false,\n                s = false,\n                tmp = null,\n                t = 0,\n                l = 0,\n                has_children = false,\n                last_sibling = false;\n            if(!obj) { return false; }\n            if(obj.id === $.jstree.root) {  return this.redraw(true); }\n            deep = deep || obj.children.length === 0;\n            node = !document.querySelector ? document.getElementById(obj.id) : this.element[0].querySelector('#' + (\"0123456789\".indexOf(obj.id[0]) !== -1 ? '\\\\3' + obj.id[0] + ' ' + obj.id.substr(1).replace($.jstree.idregex,'\\\\$&') : obj.id.replace($.jstree.idregex,'\\\\$&')) ); //, this.element);\n            if(!node) {\n                deep = true;\n                //node = d.createElement('LI');\n                if(!is_callback) {\n                    par = obj.parent !== $.jstree.root ? $('#' + obj.parent.replace($.jstree.idregex,'\\\\$&'), this.element)[0] : null;\n                    if(par !== null && (!par || !m[obj.parent].state.opened)) {\n                        return false;\n                    }\n                    ind = $.inArray(obj.id, par === null ? m[$.jstree.root].children : m[obj.parent].children);\n                }\n            }\n            else {\n                node = $(node);\n                if(!is_callback) {\n                    par = node.parent().parent()[0];\n                    if(par === this.element[0]) {\n                        par = null;\n                    }\n                    ind = node.index();\n                }\n                // m[obj.id].data = node.data(); // use only node's data, no need to touch jquery storage\n                if(!deep && obj.children.length && !node.children('.jstree-children').length) {\n                    deep = true;\n                }\n                if(!deep) {\n                    old = node.children('.jstree-children')[0];\n                }\n                f = node.children('.jstree-anchor')[0] === document.activeElement;\n                node.remove();\n                //node = d.createElement('LI');\n                //node = node[0];\n            }\n            node = this._data.core.node.cloneNode(true);\n            // node is DOM, deep is boolean\n\n            c = 'jstree-node ';\n            for(i in obj.li_attr) {\n                if(obj.li_attr.hasOwnProperty(i)) {\n                    if(i === 'id') { continue; }\n                    if(i !== 'class') {\n                        node.setAttribute(i, obj.li_attr[i]);\n                    }\n                    else {\n                        c += obj.li_attr[i];\n                    }\n                }\n            }\n            if(!obj.a_attr.id) {\n                obj.a_attr.id = obj.id + '_anchor';\n            }\n            node.childNodes[1].setAttribute('aria-selected', !!obj.state.selected);\n            node.childNodes[1].setAttribute('aria-level', obj.parents.length);\n            if(this.settings.core.compute_elements_positions) {\n                node.childNodes[1].setAttribute('aria-setsize', m[obj.parent].children.length);\n                node.childNodes[1].setAttribute('aria-posinset', m[obj.parent].children.indexOf(obj.id) + 1);\n            }\n            if(obj.state.disabled) {\n                node.childNodes[1].setAttribute('aria-disabled', true);\n            }\n\n            for(i = 0, j = obj.children.length; i < j; i++) {\n                if(!m[obj.children[i]].state.hidden) {\n                    has_children = true;\n                    break;\n                }\n            }\n            if(obj.parent !== null && m[obj.parent] && !obj.state.hidden) {\n                i = $.inArray(obj.id, m[obj.parent].children);\n                last_sibling = obj.id;\n                if(i !== -1) {\n                    i++;\n                    for(j = m[obj.parent].children.length; i < j; i++) {\n                        if(!m[m[obj.parent].children[i]].state.hidden) {\n                            last_sibling = m[obj.parent].children[i];\n                        }\n                        if(last_sibling !== obj.id) {\n                            break;\n                        }\n                    }\n                }\n            }\n\n            if(obj.state.hidden) {\n                c += ' jstree-hidden';\n            }\n            if (obj.state.loading) {\n                c += ' jstree-loading';\n            }\n            if(obj.state.loaded && !has_children) {\n                c += ' jstree-leaf';\n            }\n            else {\n                c += obj.state.opened && obj.state.loaded ? ' jstree-open' : ' jstree-closed';\n                node.childNodes[1].setAttribute('aria-expanded', (obj.state.opened && obj.state.loaded) );\n            }\n            if(last_sibling === obj.id) {\n                c += ' jstree-last';\n            }\n            node.id = obj.id;\n            node.className = c;\n            c = ( obj.state.selected ? ' jstree-clicked' : '') + ( obj.state.disabled ? ' jstree-disabled' : '');\n            for(j in obj.a_attr) {\n                if(obj.a_attr.hasOwnProperty(j)) {\n                    if(j === 'href' && obj.a_attr[j] === '#') { continue; }\n                    if(j !== 'class') {\n                        node.childNodes[1].setAttribute(j, obj.a_attr[j]);\n                    }\n                    else {\n                        c += ' ' + obj.a_attr[j];\n                    }\n                }\n            }\n            if(c.length) {\n                node.childNodes[1].className = 'jstree-anchor ' + c;\n            }\n            if((obj.icon && obj.icon !== true) || obj.icon === false) {\n                if(obj.icon === false) {\n                    node.childNodes[1].childNodes[0].className += ' jstree-themeicon-hidden';\n                }\n                else if(obj.icon.indexOf('/') === -1 && obj.icon.indexOf('.') === -1) {\n                    node.childNodes[1].childNodes[0].className += ' ' + obj.icon + ' jstree-themeicon-custom';\n                }\n                else {\n                    node.childNodes[1].childNodes[0].style.backgroundImage = 'url(\"'+obj.icon+'\")';\n                    node.childNodes[1].childNodes[0].style.backgroundPosition = 'center center';\n                    node.childNodes[1].childNodes[0].style.backgroundSize = 'auto';\n                    node.childNodes[1].childNodes[0].className += ' jstree-themeicon-custom';\n                }\n            }\n\n            if(this.settings.core.force_text) {\n                node.childNodes[1].appendChild(d.createTextNode(obj.text));\n            }\n            else {\n                node.childNodes[1].innerHTML += obj.text;\n            }\n\n\n            if(deep && obj.children.length && (obj.state.opened || force_render) && obj.state.loaded) {\n                k = d.createElement('UL');\n                k.setAttribute('role', 'group');\n                k.className = 'jstree-children';\n                for(i = 0, j = obj.children.length; i < j; i++) {\n                    k.appendChild(this.redraw_node(obj.children[i], deep, true));\n                }\n                node.appendChild(k);\n            }\n            if(old) {\n                node.appendChild(old);\n            }\n            if(!is_callback) {\n                // append back using par / ind\n                if(!par) {\n                    par = this.element[0];\n                }\n                for(i = 0, j = par.childNodes.length; i < j; i++) {\n                    if(par.childNodes[i] && par.childNodes[i].className && par.childNodes[i].className.indexOf('jstree-children') !== -1) {\n                        tmp = par.childNodes[i];\n                        break;\n                    }\n                }\n                if(!tmp) {\n                    tmp = d.createElement('UL');\n                    tmp.setAttribute('role', 'group');\n                    tmp.className = 'jstree-children';\n                    par.appendChild(tmp);\n                }\n                par = tmp;\n\n                if(ind < par.childNodes.length) {\n                    par.insertBefore(node, par.childNodes[ind]);\n                }\n                else {\n                    par.appendChild(node);\n                }\n                if(f) {\n                    t = this.element[0].scrollTop;\n                    l = this.element[0].scrollLeft;\n                    node.childNodes[1].focus();\n                    this.element[0].scrollTop = t;\n                    this.element[0].scrollLeft = l;\n                }\n            }\n            if(obj.state.opened && !obj.state.loaded) {\n                obj.state.opened = false;\n                setTimeout(function () {\n                    this.open_node(obj.id, false, 0);\n                }.bind(this), 0);\n            }\n            return node;\n        },\n        /**\n         * opens a node, revealing its children. If the node is not loaded it will be loaded and opened once ready.\n         * @name open_node(obj [, callback, animation])\n         * @param {mixed} obj the node to open\n         * @param {Function} callback a function to execute once the node is opened\n         * @param {Number} animation the animation duration in milliseconds when opening the node (overrides the `core.animation` setting). Use `false` for no animation.\n         * @trigger open_node.jstree, after_open.jstree, before_open.jstree\n         */\n        open_node : function (obj, callback, animation) {\n            var t1, t2, d, t;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.open_node(obj[t1], callback, animation);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            animation = animation === undefined ? this.settings.core.animation : animation;\n            if(!this.is_closed(obj)) {\n                if(callback) {\n                    callback.call(this, obj, false);\n                }\n                return false;\n            }\n            if(!this.is_loaded(obj)) {\n                if(this.is_loading(obj)) {\n                    return setTimeout(function () {\n                        this.open_node(obj, callback, animation);\n                    }.bind(this), 500);\n                }\n                this.load_node(obj, function (o, ok) {\n                    return ok ? this.open_node(o, callback, animation) : (callback ? callback.call(this, o, false) : false);\n                });\n            }\n            else {\n                d = this.get_node(obj, true);\n                t = this;\n                if(d.length) {\n                    if(animation && d.children(\".jstree-children\").length) {\n                        d.children(\".jstree-children\").stop(true, true);\n                    }\n                    if(obj.children.length && !this._firstChild(d.children('.jstree-children')[0])) {\n                        this.draw_children(obj);\n                        //d = this.get_node(obj, true);\n                    }\n                    if(!animation) {\n                        this.trigger('before_open', { \"node\" : obj });\n                        d[0].className = d[0].className.replace('jstree-closed', 'jstree-open');\n                        d[0].childNodes[1].setAttribute(\"aria-expanded\", true);\n                    }\n                    else {\n                        this.trigger('before_open', { \"node\" : obj });\n                        d\n                            .children(\".jstree-children\").css(\"display\",\"none\").end()\n                            .removeClass(\"jstree-closed\").addClass(\"jstree-open\")\n                            .children('.jstree-anchor').attr(\"aria-expanded\", true).end()\n                            .children(\".jstree-children\").stop(true, true)\n                            .slideDown(animation, function () {\n                                this.style.display = \"\";\n                                if (t.element) {\n                                    t.trigger(\"after_open\", { \"node\" : obj });\n                                }\n                            });\n                    }\n                }\n                obj.state.opened = true;\n                if(callback) {\n                    callback.call(this, obj, true);\n                }\n                if(!d.length) {\n                    /**\n                     * triggered when a node is about to be opened (if the node is supposed to be in the DOM, it will be, but it won't be visible yet)\n                     * @event\n                     * @name before_open.jstree\n                     * @param {Object} node the opened node\n                     */\n                    this.trigger('before_open', { \"node\" : obj });\n                }\n                /**\n                 * triggered when a node is opened (if there is an animation it will not be completed yet)\n                 * @event\n                 * @name open_node.jstree\n                 * @param {Object} node the opened node\n                 */\n                this.trigger('open_node', { \"node\" : obj });\n                if(!animation || !d.length) {\n                    /**\n                     * triggered when a node is opened and the animation is complete\n                     * @event\n                     * @name after_open.jstree\n                     * @param {Object} node the opened node\n                     */\n                    this.trigger(\"after_open\", { \"node\" : obj });\n                }\n                return true;\n            }\n        },\n        /**\n         * opens every parent of a node (node should be loaded)\n         * @name _open_to(obj)\n         * @param {mixed} obj the node to reveal\n         * @private\n         */\n        _open_to : function (obj) {\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            var i, j, p = obj.parents;\n            for(i = 0, j = p.length; i < j; i+=1) {\n                if(i !== $.jstree.root) {\n                    this.open_node(p[i], false, 0);\n                }\n            }\n            return $('#' + obj.id.replace($.jstree.idregex,'\\\\$&'), this.element);\n        },\n        /**\n         * closes a node, hiding its children\n         * @name close_node(obj [, animation])\n         * @param {mixed} obj the node to close\n         * @param {Number} animation the animation duration in milliseconds when closing the node (overrides the `core.animation` setting). Use `false` for no animation.\n         * @trigger close_node.jstree, after_close.jstree\n         */\n        close_node : function (obj, animation) {\n            var t1, t2, t, d;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.close_node(obj[t1], animation);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            if(this.is_closed(obj)) {\n                return false;\n            }\n            animation = animation === undefined ? this.settings.core.animation : animation;\n            t = this;\n            d = this.get_node(obj, true);\n\n            obj.state.opened = false;\n            /**\n             * triggered when a node is closed (if there is an animation it will not be complete yet)\n             * @event\n             * @name close_node.jstree\n             * @param {Object} node the closed node\n             */\n            this.trigger('close_node',{ \"node\" : obj });\n            if(!d.length) {\n                /**\n                 * triggered when a node is closed and the animation is complete\n                 * @event\n                 * @name after_close.jstree\n                 * @param {Object} node the closed node\n                 */\n                this.trigger(\"after_close\", { \"node\" : obj });\n            }\n            else {\n                if(!animation) {\n                    d[0].className = d[0].className.replace('jstree-open', 'jstree-closed');\n                    d.children('.jstree-anchor').attr(\"aria-expanded\", false);\n                    d.children('.jstree-children').remove();\n                    this.trigger(\"after_close\", { \"node\" : obj });\n                }\n                else {\n                    d\n                        .children(\".jstree-children\").attr(\"style\",\"display:block !important\").end()\n                        .removeClass(\"jstree-open\").addClass(\"jstree-closed\")\n                        .children('.jstree-anchor').attr(\"aria-expanded\", false).end()\n                        .children(\".jstree-children\").stop(true, true).slideUp(animation, function () {\n                        this.style.display = \"\";\n                        d.children('.jstree-children').remove();\n                        if (t.element) {\n                            t.trigger(\"after_close\", { \"node\" : obj });\n                        }\n                    });\n                }\n            }\n        },\n        /**\n         * toggles a node - closing it if it is open, opening it if it is closed\n         * @name toggle_node(obj)\n         * @param {mixed} obj the node to toggle\n         */\n        toggle_node : function (obj) {\n            var t1, t2;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.toggle_node(obj[t1]);\n                }\n                return true;\n            }\n            if(this.is_closed(obj)) {\n                return this.open_node(obj);\n            }\n            if(this.is_open(obj)) {\n                return this.close_node(obj);\n            }\n        },\n        /**\n         * opens all nodes within a node (or the tree), revealing their children. If the node is not loaded it will be loaded and opened once ready.\n         * @name open_all([obj, animation, original_obj])\n         * @param {mixed} obj the node to open recursively, omit to open all nodes in the tree\n         * @param {Number} animation the animation duration in milliseconds when opening the nodes, the default is no animation\n         * @param {jQuery} reference to the node that started the process (internal use)\n         * @trigger open_all.jstree\n         */\n        open_all : function (obj, animation, original_obj) {\n            if(!obj) { obj = $.jstree.root; }\n            obj = this.get_node(obj);\n            if(!obj) { return false; }\n            var dom = obj.id === $.jstree.root ? this.get_container_ul() : this.get_node(obj, true), i, j, _this;\n            if(!dom.length) {\n                for(i = 0, j = obj.children_d.length; i < j; i++) {\n                    if(this.is_closed(this._model.data[obj.children_d[i]])) {\n                        this._model.data[obj.children_d[i]].state.opened = true;\n                    }\n                }\n                return this.trigger('open_all', { \"node\" : obj });\n            }\n            original_obj = original_obj || dom;\n            _this = this;\n            dom = this.is_closed(obj) ? dom.find('.jstree-closed').addBack() : dom.find('.jstree-closed');\n            dom.each(function () {\n                _this.open_node(\n                    this,\n                    function(node, status) { if(status && this.is_parent(node)) { this.open_all(node, animation, original_obj); } },\n                    animation || 0\n                );\n            });\n            if(original_obj.find('.jstree-closed').length === 0) {\n                /**\n                 * triggered when an `open_all` call completes\n                 * @event\n                 * @name open_all.jstree\n                 * @param {Object} node the opened node\n                 */\n                this.trigger('open_all', { \"node\" : this.get_node(original_obj) });\n            }\n        },\n        /**\n         * closes all nodes within a node (or the tree), revealing their children\n         * @name close_all([obj, animation])\n         * @param {mixed} obj the node to close recursively, omit to close all nodes in the tree\n         * @param {Number} animation the animation duration in milliseconds when closing the nodes, the default is no animation\n         * @trigger close_all.jstree\n         */\n        close_all : function (obj, animation) {\n            if(!obj) { obj = $.jstree.root; }\n            obj = this.get_node(obj);\n            if(!obj) { return false; }\n            var dom = obj.id === $.jstree.root ? this.get_container_ul() : this.get_node(obj, true),\n                _this = this, i, j;\n            if(dom.length) {\n                dom = this.is_open(obj) ? dom.find('.jstree-open').addBack() : dom.find('.jstree-open');\n                $(dom.get().reverse()).each(function () { _this.close_node(this, animation || 0); });\n            }\n            for(i = 0, j = obj.children_d.length; i < j; i++) {\n                this._model.data[obj.children_d[i]].state.opened = false;\n            }\n            /**\n             * triggered when an `close_all` call completes\n             * @event\n             * @name close_all.jstree\n             * @param {Object} node the closed node\n             */\n            this.trigger('close_all', { \"node\" : obj });\n        },\n        /**\n         * checks if a node is disabled (not selectable)\n         * @name is_disabled(obj)\n         * @param  {mixed} obj\n         * @return {Boolean}\n         */\n        is_disabled : function (obj) {\n            obj = this.get_node(obj);\n            return obj && obj.state && obj.state.disabled;\n        },\n        /**\n         * enables a node - so that it can be selected\n         * @name enable_node(obj)\n         * @param {mixed} obj the node to enable\n         * @trigger enable_node.jstree\n         */\n        enable_node : function (obj) {\n            var t1, t2;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.enable_node(obj[t1]);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            obj.state.disabled = false;\n            this.get_node(obj,true).children('.jstree-anchor').removeClass('jstree-disabled').attr('aria-disabled', false);\n            /**\n             * triggered when an node is enabled\n             * @event\n             * @name enable_node.jstree\n             * @param {Object} node the enabled node\n             */\n            this.trigger('enable_node', { 'node' : obj });\n        },\n        /**\n         * disables a node - so that it can not be selected\n         * @name disable_node(obj)\n         * @param {mixed} obj the node to disable\n         * @trigger disable_node.jstree\n         */\n        disable_node : function (obj) {\n            var t1, t2;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.disable_node(obj[t1]);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            obj.state.disabled = true;\n            this.get_node(obj,true).children('.jstree-anchor').addClass('jstree-disabled').attr('aria-disabled', true);\n            /**\n             * triggered when an node is disabled\n             * @event\n             * @name disable_node.jstree\n             * @param {Object} node the disabled node\n             */\n            this.trigger('disable_node', { 'node' : obj });\n        },\n        /**\n         * determines if a node is hidden\n         * @name is_hidden(obj)\n         * @param {mixed} obj the node\n         */\n        is_hidden : function (obj) {\n            obj = this.get_node(obj);\n            return obj.state.hidden === true;\n        },\n        /**\n         * hides a node - it is still in the structure but will not be visible\n         * @name hide_node(obj)\n         * @param {mixed} obj the node to hide\n         * @param {Boolean} skip_redraw internal parameter controlling if redraw is called\n         * @trigger hide_node.jstree\n         */\n        hide_node : function (obj, skip_redraw) {\n            var t1, t2;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.hide_node(obj[t1], true);\n                }\n                if (!skip_redraw) {\n                    this.redraw();\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            if(!obj.state.hidden) {\n                obj.state.hidden = true;\n                this._node_changed(obj.parent);\n                if(!skip_redraw) {\n                    this.redraw();\n                }\n                /**\n                 * triggered when an node is hidden\n                 * @event\n                 * @name hide_node.jstree\n                 * @param {Object} node the hidden node\n                 */\n                this.trigger('hide_node', { 'node' : obj });\n            }\n        },\n        /**\n         * shows a node\n         * @name show_node(obj)\n         * @param {mixed} obj the node to show\n         * @param {Boolean} skip_redraw internal parameter controlling if redraw is called\n         * @trigger show_node.jstree\n         */\n        show_node : function (obj, skip_redraw) {\n            var t1, t2;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.show_node(obj[t1], true);\n                }\n                if (!skip_redraw) {\n                    this.redraw();\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            if(obj.state.hidden) {\n                obj.state.hidden = false;\n                this._node_changed(obj.parent);\n                if(!skip_redraw) {\n                    this.redraw();\n                }\n                /**\n                 * triggered when an node is shown\n                 * @event\n                 * @name show_node.jstree\n                 * @param {Object} node the shown node\n                 */\n                this.trigger('show_node', { 'node' : obj });\n            }\n        },\n        /**\n         * hides all nodes\n         * @name hide_all()\n         * @trigger hide_all.jstree\n         */\n        hide_all : function (skip_redraw) {\n            var i, m = this._model.data, ids = [];\n            for(i in m) {\n                if(m.hasOwnProperty(i) && i !== $.jstree.root && !m[i].state.hidden) {\n                    m[i].state.hidden = true;\n                    ids.push(i);\n                }\n            }\n            this._model.force_full_redraw = true;\n            if(!skip_redraw) {\n                this.redraw();\n            }\n            /**\n             * triggered when all nodes are hidden\n             * @event\n             * @name hide_all.jstree\n             * @param {Array} nodes the IDs of all hidden nodes\n             */\n            this.trigger('hide_all', { 'nodes' : ids });\n            return ids;\n        },\n        /**\n         * shows all nodes\n         * @name show_all()\n         * @trigger show_all.jstree\n         */\n        show_all : function (skip_redraw) {\n            var i, m = this._model.data, ids = [];\n            for(i in m) {\n                if(m.hasOwnProperty(i) && i !== $.jstree.root && m[i].state.hidden) {\n                    m[i].state.hidden = false;\n                    ids.push(i);\n                }\n            }\n            this._model.force_full_redraw = true;\n            if(!skip_redraw) {\n                this.redraw();\n            }\n            /**\n             * triggered when all nodes are shown\n             * @event\n             * @name show_all.jstree\n             * @param {Array} nodes the IDs of all shown nodes\n             */\n            this.trigger('show_all', { 'nodes' : ids });\n            return ids;\n        },\n        /**\n         * called when a node is selected by the user. Used internally.\n         * @private\n         * @name activate_node(obj, e)\n         * @param {mixed} obj the node\n         * @param {Object} e the related event\n         * @trigger activate_node.jstree, changed.jstree\n         */\n        activate_node : function (obj, e) {\n            if(this.is_disabled(obj)) {\n                return false;\n            }\n            if(!e || typeof e !== 'object') {\n                e = {};\n            }\n\n            // ensure last_clicked is still in the DOM, make it fresh (maybe it was moved?) and make sure it is still selected, if not - make last_clicked the last selected node\n            this._data.core.last_clicked = this._data.core.last_clicked && this._data.core.last_clicked.id !== undefined ? this.get_node(this._data.core.last_clicked.id) : null;\n            if(this._data.core.last_clicked && !this._data.core.last_clicked.state.selected) { this._data.core.last_clicked = null; }\n            if(!this._data.core.last_clicked && this._data.core.selected.length) { this._data.core.last_clicked = this.get_node(this._data.core.selected[this._data.core.selected.length - 1]); }\n\n            if(!this.settings.core.multiple || (!e.metaKey && !e.ctrlKey && !e.shiftKey) || (e.shiftKey && (!this._data.core.last_clicked || !this.get_parent(obj) || this.get_parent(obj) !== this._data.core.last_clicked.parent ) )) {\n                if(!this.settings.core.multiple && (e.metaKey || e.ctrlKey || e.shiftKey) && this.is_selected(obj)) {\n                    this.deselect_node(obj, false, e);\n                }\n                else {\n                    if (this.settings.core.allow_reselect || !this.is_selected(obj) || this._data.core.selected.length !== 1) {\n                        this.deselect_all(true);\n                        this.select_node(obj, false, false, e);\n                    }\n                    this._data.core.last_clicked = this.get_node(obj);\n                }\n            }\n            else {\n                if(e.shiftKey) {\n                    var o = this.get_node(obj).id,\n                        l = this._data.core.last_clicked.id,\n                        p = this.get_node(this._data.core.last_clicked.parent).children,\n                        c = false,\n                        i, j;\n                    for(i = 0, j = p.length; i < j; i += 1) {\n                        // separate IFs work whem o and l are the same\n                        if(p[i] === o) {\n                            c = !c;\n                        }\n                        if(p[i] === l) {\n                            c = !c;\n                        }\n                        if(!this.is_disabled(p[i]) && (c || p[i] === o || p[i] === l)) {\n                            if (!this.is_hidden(p[i])) {\n                                this.select_node(p[i], true, false, e);\n                            }\n                        }\n                        else {\n                            if (!e.ctrlKey) {\n                                this.deselect_node(p[i], true, e);\n                            }\n                        }\n                    }\n                    this.trigger('changed', { 'action' : 'select_node', 'node' : this.get_node(obj), 'selected' : this._data.core.selected, 'event' : e });\n                }\n                else {\n                    if(!this.is_selected(obj)) {\n                        if (e.ctrlKey) {\n                            this._data.core.last_clicked = this.get_node(obj);\n                        }\n                        this.select_node(obj, false, false, e);\n                    }\n                    else {\n                        this.deselect_node(obj, false, e);\n                    }\n                }\n            }\n            /**\n             * triggered when an node is clicked or intercated with by the user\n             * @event\n             * @name activate_node.jstree\n             * @param {Object} node\n             * @param {Object} event the ooriginal event (if any) which triggered the call (may be an empty object)\n             */\n            this.trigger('activate_node', { 'node' : this.get_node(obj), 'event' : e });\n        },\n        /**\n         * applies the hover state on a node, called when a node is hovered by the user. Used internally.\n         * @private\n         * @name hover_node(obj)\n         * @param {mixed} obj\n         * @trigger hover_node.jstree\n         */\n        hover_node : function (obj) {\n            obj = this.get_node(obj, true);\n            if(!obj || !obj.length || obj.children('.jstree-hovered').length) {\n                return false;\n            }\n            var o = this.element.find('.jstree-hovered'), t = this.element;\n            if(o && o.length) { this.dehover_node(o); }\n\n            obj.children('.jstree-anchor').addClass('jstree-hovered');\n            /**\n             * triggered when an node is hovered\n             * @event\n             * @name hover_node.jstree\n             * @param {Object} node\n             */\n            this.trigger('hover_node', { 'node' : this.get_node(obj) });\n            setTimeout(function () { t.attr('aria-activedescendant', obj[0].id); }, 0);\n        },\n        /**\n         * removes the hover state from a nodecalled when a node is no longer hovered by the user. Used internally.\n         * @private\n         * @name dehover_node(obj)\n         * @param {mixed} obj\n         * @trigger dehover_node.jstree\n         */\n        dehover_node : function (obj) {\n            obj = this.get_node(obj, true);\n            if(!obj || !obj.length || !obj.children('.jstree-hovered').length) {\n                return false;\n            }\n            obj.children('.jstree-anchor').removeClass('jstree-hovered');\n            /**\n             * triggered when an node is no longer hovered\n             * @event\n             * @name dehover_node.jstree\n             * @param {Object} node\n             */\n            this.trigger('dehover_node', { 'node' : this.get_node(obj) });\n        },\n        /**\n         * select a node\n         * @name select_node(obj [, supress_event, prevent_open])\n         * @param {mixed} obj an array can be used to select multiple nodes\n         * @param {Boolean} supress_event if set to `true` the `changed.jstree` event won't be triggered\n         * @param {Boolean} prevent_open if set to `true` parents of the selected node won't be opened\n         * @trigger select_node.jstree, changed.jstree\n         */\n        select_node : function (obj, supress_event, prevent_open, e) {\n            var dom, t1, t2, th;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.select_node(obj[t1], supress_event, prevent_open, e);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            dom = this.get_node(obj, true);\n            if(!obj.state.selected) {\n                obj.state.selected = true;\n                this._data.core.selected.push(obj.id);\n                if(!prevent_open) {\n                    dom = this._open_to(obj);\n                }\n                if(dom && dom.length) {\n                    dom.children('.jstree-anchor').addClass('jstree-clicked').attr('aria-selected', true);\n                }\n                /**\n                 * triggered when an node is selected\n                 * @event\n                 * @name select_node.jstree\n                 * @param {Object} node\n                 * @param {Array} selected the current selection\n                 * @param {Object} event the event (if any) that triggered this select_node\n                 */\n                this.trigger('select_node', { 'node' : obj, 'selected' : this._data.core.selected, 'event' : e });\n                if(!supress_event) {\n                    /**\n                     * triggered when selection changes\n                     * @event\n                     * @name changed.jstree\n                     * @param {Object} node\n                     * @param {Object} action the action that caused the selection to change\n                     * @param {Array} selected the current selection\n                     * @param {Object} event the event (if any) that triggered this changed event\n                     */\n                    this.trigger('changed', { 'action' : 'select_node', 'node' : obj, 'selected' : this._data.core.selected, 'event' : e });\n                }\n            }\n        },\n        /**\n         * deselect a node\n         * @name deselect_node(obj [, supress_event])\n         * @param {mixed} obj an array can be used to deselect multiple nodes\n         * @param {Boolean} supress_event if set to `true` the `changed.jstree` event won't be triggered\n         * @trigger deselect_node.jstree, changed.jstree\n         */\n        deselect_node : function (obj, supress_event, e) {\n            var t1, t2, dom;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.deselect_node(obj[t1], supress_event, e);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            dom = this.get_node(obj, true);\n            if(obj.state.selected) {\n                obj.state.selected = false;\n                this._data.core.selected = $.vakata.array_remove_item(this._data.core.selected, obj.id);\n                if(dom.length) {\n                    dom.children('.jstree-anchor').removeClass('jstree-clicked').attr('aria-selected', false);\n                }\n                /**\n                 * triggered when an node is deselected\n                 * @event\n                 * @name deselect_node.jstree\n                 * @param {Object} node\n                 * @param {Array} selected the current selection\n                 * @param {Object} event the event (if any) that triggered this deselect_node\n                 */\n                this.trigger('deselect_node', { 'node' : obj, 'selected' : this._data.core.selected, 'event' : e });\n                if(!supress_event) {\n                    this.trigger('changed', { 'action' : 'deselect_node', 'node' : obj, 'selected' : this._data.core.selected, 'event' : e });\n                }\n            }\n        },\n        /**\n         * select all nodes in the tree\n         * @name select_all([supress_event])\n         * @param {Boolean} supress_event if set to `true` the `changed.jstree` event won't be triggered\n         * @trigger select_all.jstree, changed.jstree\n         */\n        select_all : function (supress_event) {\n            var tmp = this._data.core.selected.concat([]), i, j;\n            this._data.core.selected = this._model.data[$.jstree.root].children_d.concat();\n            for(i = 0, j = this._data.core.selected.length; i < j; i++) {\n                if(this._model.data[this._data.core.selected[i]]) {\n                    this._model.data[this._data.core.selected[i]].state.selected = true;\n                }\n            }\n            this.redraw(true);\n            /**\n             * triggered when all nodes are selected\n             * @event\n             * @name select_all.jstree\n             * @param {Array} selected the current selection\n             */\n            this.trigger('select_all', { 'selected' : this._data.core.selected });\n            if(!supress_event) {\n                this.trigger('changed', { 'action' : 'select_all', 'selected' : this._data.core.selected, 'old_selection' : tmp });\n            }\n        },\n        /**\n         * deselect all selected nodes\n         * @name deselect_all([supress_event])\n         * @param {Boolean} supress_event if set to `true` the `changed.jstree` event won't be triggered\n         * @trigger deselect_all.jstree, changed.jstree\n         */\n        deselect_all : function (supress_event) {\n            var tmp = this._data.core.selected.concat([]), i, j;\n            for(i = 0, j = this._data.core.selected.length; i < j; i++) {\n                if(this._model.data[this._data.core.selected[i]]) {\n                    this._model.data[this._data.core.selected[i]].state.selected = false;\n                }\n            }\n            this._data.core.selected = [];\n            this.element.find('.jstree-clicked').removeClass('jstree-clicked').attr('aria-selected', false);\n            /**\n             * triggered when all nodes are deselected\n             * @event\n             * @name deselect_all.jstree\n             * @param {Object} node the previous selection\n             * @param {Array} selected the current selection\n             */\n            this.trigger('deselect_all', { 'selected' : this._data.core.selected, 'node' : tmp });\n            if(!supress_event) {\n                this.trigger('changed', { 'action' : 'deselect_all', 'selected' : this._data.core.selected, 'old_selection' : tmp });\n            }\n        },\n        /**\n         * checks if a node is selected\n         * @name is_selected(obj)\n         * @param  {mixed}  obj\n         * @return {Boolean}\n         */\n        is_selected : function (obj) {\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            return obj.state.selected;\n        },\n        /**\n         * get an array of all selected nodes\n         * @name get_selected([full])\n         * @param  {mixed}  full if set to `true` the returned array will consist of the full node objects, otherwise - only IDs will be returned\n         * @return {Array}\n         */\n        get_selected : function (full) {\n            return full ? $.map(this._data.core.selected, function (i) { return this.get_node(i); }.bind(this)) : this._data.core.selected.slice();\n        },\n        /**\n         * get an array of all top level selected nodes (ignoring children of selected nodes)\n         * @name get_top_selected([full])\n         * @param  {mixed}  full if set to `true` the returned array will consist of the full node objects, otherwise - only IDs will be returned\n         * @return {Array}\n         */\n        get_top_selected : function (full) {\n            var tmp = this.get_selected(true),\n                obj = {}, i, j, k, l;\n            for(i = 0, j = tmp.length; i < j; i++) {\n                obj[tmp[i].id] = tmp[i];\n            }\n            for(i = 0, j = tmp.length; i < j; i++) {\n                for(k = 0, l = tmp[i].children_d.length; k < l; k++) {\n                    if(obj[tmp[i].children_d[k]]) {\n                        delete obj[tmp[i].children_d[k]];\n                    }\n                }\n            }\n            tmp = [];\n            for(i in obj) {\n                if(obj.hasOwnProperty(i)) {\n                    tmp.push(i);\n                }\n            }\n            return full ? $.map(tmp, function (i) { return this.get_node(i); }.bind(this)) : tmp;\n        },\n        /**\n         * get an array of all bottom level selected nodes (ignoring selected parents)\n         * @name get_bottom_selected([full])\n         * @param  {mixed}  full if set to `true` the returned array will consist of the full node objects, otherwise - only IDs will be returned\n         * @return {Array}\n         */\n        get_bottom_selected : function (full) {\n            var tmp = this.get_selected(true),\n                obj = [], i, j;\n            for(i = 0, j = tmp.length; i < j; i++) {\n                if(!tmp[i].children.length) {\n                    obj.push(tmp[i].id);\n                }\n            }\n            return full ? $.map(obj, function (i) { return this.get_node(i); }.bind(this)) : obj;\n        },\n        /**\n         * gets the current state of the tree so that it can be restored later with `set_state(state)`. Used internally.\n         * @name get_state()\n         * @private\n         * @return {Object}\n         */\n        get_state : function () {\n            var state\t= {\n                'core' : {\n                    'open' : [],\n                    'loaded' : [],\n                    'scroll' : {\n                        'left' : this.element.scrollLeft(),\n                        'top' : this.element.scrollTop()\n                    },\n                    /*!\n\t\t\t\t\t'themes' : {\n\t\t\t\t\t\t'name' : this.get_theme(),\n\t\t\t\t\t\t'icons' : this._data.core.themes.icons,\n\t\t\t\t\t\t'dots' : this._data.core.themes.dots\n\t\t\t\t\t},\n\t\t\t\t\t*/\n                    'selected' : []\n                }\n            }, i;\n            for(i in this._model.data) {\n                if(this._model.data.hasOwnProperty(i)) {\n                    if(i !== $.jstree.root) {\n                        if(this._model.data[i].state.loaded && this.settings.core.loaded_state) {\n                            state.core.loaded.push(i);\n                        }\n                        if(this._model.data[i].state.opened) {\n                            state.core.open.push(i);\n                        }\n                        if(this._model.data[i].state.selected) {\n                            state.core.selected.push(i);\n                        }\n                    }\n                }\n            }\n            return state;\n        },\n        /**\n         * sets the state of the tree. Used internally.\n         * @name set_state(state [, callback])\n         * @private\n         * @param {Object} state the state to restore. Keep in mind this object is passed by reference and jstree will modify it.\n         * @param {Function} callback an optional function to execute once the state is restored.\n         * @trigger set_state.jstree\n         */\n        set_state : function (state, callback) {\n            if(state) {\n                if(state.core && state.core.selected && state.core.initial_selection === undefined) {\n                    state.core.initial_selection = this._data.core.selected.concat([]).sort().join(',');\n                }\n                if(state.core) {\n                    var res, n, t, _this, i;\n                    if(state.core.loaded) {\n                        if(!this.settings.core.loaded_state || !$.vakata.is_array(state.core.loaded) || !state.core.loaded.length) {\n                            delete state.core.loaded;\n                            this.set_state(state, callback);\n                        }\n                        else {\n                            this._load_nodes(state.core.loaded, function (nodes) {\n                                delete state.core.loaded;\n                                this.set_state(state, callback);\n                            });\n                        }\n                        return false;\n                    }\n                    if(state.core.open) {\n                        if(!$.vakata.is_array(state.core.open) || !state.core.open.length) {\n                            delete state.core.open;\n                            this.set_state(state, callback);\n                        }\n                        else {\n                            this._load_nodes(state.core.open, function (nodes) {\n                                this.open_node(nodes, false, 0);\n                                delete state.core.open;\n                                this.set_state(state, callback);\n                            });\n                        }\n                        return false;\n                    }\n                    if(state.core.scroll) {\n                        if(state.core.scroll && state.core.scroll.left !== undefined) {\n                            this.element.scrollLeft(state.core.scroll.left);\n                        }\n                        if(state.core.scroll && state.core.scroll.top !== undefined) {\n                            this.element.scrollTop(state.core.scroll.top);\n                        }\n                        delete state.core.scroll;\n                        this.set_state(state, callback);\n                        return false;\n                    }\n                    if(state.core.selected) {\n                        _this = this;\n                        if (state.core.initial_selection === undefined ||\n                            state.core.initial_selection === this._data.core.selected.concat([]).sort().join(',')\n                        ) {\n                            this.deselect_all();\n                            $.each(state.core.selected, function (i, v) {\n                                _this.select_node(v, false, true);\n                            });\n                        }\n                        delete state.core.initial_selection;\n                        delete state.core.selected;\n                        this.set_state(state, callback);\n                        return false;\n                    }\n                    for(i in state) {\n                        if(state.hasOwnProperty(i) && i !== \"core\" && $.inArray(i, this.settings.plugins) === -1) {\n                            delete state[i];\n                        }\n                    }\n                    if($.isEmptyObject(state.core)) {\n                        delete state.core;\n                        this.set_state(state, callback);\n                        return false;\n                    }\n                }\n                if($.isEmptyObject(state)) {\n                    state = null;\n                    if(callback) { callback.call(this); }\n                    /**\n                     * triggered when a `set_state` call completes\n                     * @event\n                     * @name set_state.jstree\n                     */\n                    this.trigger('set_state');\n                    return false;\n                }\n                return true;\n            }\n            return false;\n        },\n        /**\n         * refreshes the tree - all nodes are reloaded with calls to `load_node`.\n         * @name refresh()\n         * @param {Boolean} skip_loading an option to skip showing the loading indicator\n         * @param {Mixed} forget_state if set to `true` state will not be reapplied, if set to a function (receiving the current state as argument) the result of that function will be used as state\n         * @trigger refresh.jstree\n         */\n        refresh : function (skip_loading, forget_state) {\n            this._data.core.state = forget_state === true ? {} : this.get_state();\n            if(forget_state && $.vakata.is_function(forget_state)) { this._data.core.state = forget_state.call(this, this._data.core.state); }\n            this._cnt = 0;\n            this._model.data = {};\n            this._model.data[$.jstree.root] = {\n                id : $.jstree.root,\n                parent : null,\n                parents : [],\n                children : [],\n                children_d : [],\n                state : { loaded : false }\n            };\n            this._data.core.selected = [];\n            this._data.core.last_clicked = null;\n            this._data.core.focused = null;\n\n            var c = this.get_container_ul()[0].className;\n            if(!skip_loading) {\n                this.element.html(\"<\"+\"ul class='\"+c+\"' role='group'><\"+\"li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none' id='j\"+this._id+\"_loading'><i class='jstree-icon jstree-ocl'></i><\"+\"a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>\" + this.get_string(\"Loading ...\") + \"</a></li></ul>\");\n                this.element.attr('aria-activedescendant','j'+this._id+'_loading');\n            }\n            this.load_node($.jstree.root, function (o, s) {\n                if(s) {\n                    this.get_container_ul()[0].className = c;\n                    if(this._firstChild(this.get_container_ul()[0])) {\n                        this.element.attr('aria-activedescendant',this._firstChild(this.get_container_ul()[0]).id);\n                    }\n                    this.set_state($.extend(true, {}, this._data.core.state), function () {\n                        /**\n                         * triggered when a `refresh` call completes\n                         * @event\n                         * @name refresh.jstree\n                         */\n                        this.trigger('refresh');\n                    });\n                }\n                this._data.core.state = null;\n            });\n        },\n        /**\n         * refreshes a node in the tree (reload its children) all opened nodes inside that node are reloaded with calls to `load_node`.\n         * @name refresh_node(obj)\n         * @param  {mixed} obj the node\n         * @trigger refresh_node.jstree\n         */\n        refresh_node : function (obj) {\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) { return false; }\n            var opened = [], to_load = [], s = this._data.core.selected.concat([]);\n            to_load.push(obj.id);\n            if(obj.state.opened === true) { opened.push(obj.id); }\n            this.get_node(obj, true).find('.jstree-open').each(function() { to_load.push(this.id); opened.push(this.id); });\n            this._load_nodes(to_load, function (nodes) {\n                this.open_node(opened, false, 0);\n                this.select_node(s);\n                /**\n                 * triggered when a node is refreshed\n                 * @event\n                 * @name refresh_node.jstree\n                 * @param {Object} node - the refreshed node\n                 * @param {Array} nodes - an array of the IDs of the nodes that were reloaded\n                 */\n                this.trigger('refresh_node', { 'node' : obj, 'nodes' : nodes });\n            }.bind(this), false, true);\n        },\n        /**\n         * set (change) the ID of a node\n         * @name set_id(obj, id)\n         * @param  {mixed} obj the node\n         * @param  {String} id the new ID\n         * @return {Boolean}\n         * @trigger set_id.jstree\n         */\n        set_id : function (obj, id) {\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) { return false; }\n            var i, j, m = this._model.data, old = obj.id;\n            id = id.toString();\n            // update parents (replace current ID with new one in children and children_d)\n            m[obj.parent].children[$.inArray(obj.id, m[obj.parent].children)] = id;\n            for(i = 0, j = obj.parents.length; i < j; i++) {\n                m[obj.parents[i]].children_d[$.inArray(obj.id, m[obj.parents[i]].children_d)] = id;\n            }\n            // update children (replace current ID with new one in parent and parents)\n            for(i = 0, j = obj.children.length; i < j; i++) {\n                m[obj.children[i]].parent = id;\n            }\n            for(i = 0, j = obj.children_d.length; i < j; i++) {\n                m[obj.children_d[i]].parents[$.inArray(obj.id, m[obj.children_d[i]].parents)] = id;\n            }\n            i = $.inArray(obj.id, this._data.core.selected);\n            if(i !== -1) { this._data.core.selected[i] = id; }\n            // update model and obj itself (obj.id, this._model.data[KEY])\n            i = this.get_node(obj.id, true);\n            if(i) {\n                i.attr('id', id); //.children('.jstree-anchor').attr('id', id + '_anchor').end().attr('aria-labelledby', id + '_anchor');\n                if(this.element.attr('aria-activedescendant') === obj.id) {\n                    this.element.attr('aria-activedescendant', id);\n                }\n            }\n            delete m[obj.id];\n            obj.id = id;\n            obj.li_attr.id = id;\n            m[id] = obj;\n            /**\n             * triggered when a node id value is changed\n             * @event\n             * @name set_id.jstree\n             * @param {Object} node\n             * @param {String} old the old id\n             */\n            this.trigger('set_id',{ \"node\" : obj, \"new\" : obj.id, \"old\" : old });\n            return true;\n        },\n        /**\n         * get the text value of a node\n         * @name get_text(obj)\n         * @param  {mixed} obj the node\n         * @return {String}\n         */\n        get_text : function (obj) {\n            obj = this.get_node(obj);\n            return (!obj || obj.id === $.jstree.root) ? false : obj.text;\n        },\n        /**\n         * set the text value of a node. Used internally, please use `rename_node(obj, val)`.\n         * @private\n         * @name set_text(obj, val)\n         * @param  {mixed} obj the node, you can pass an array to set the text on multiple nodes\n         * @param  {String} val the new text value\n         * @return {Boolean}\n         * @trigger set_text.jstree\n         */\n        set_text : function (obj, val) {\n            var t1, t2;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.set_text(obj[t1], val);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) { return false; }\n            obj.text = val;\n            if(this.get_node(obj, true).length) {\n                this.redraw_node(obj.id);\n            }\n            /**\n             * triggered when a node text value is changed\n             * @event\n             * @name set_text.jstree\n             * @param {Object} obj\n             * @param {String} text the new value\n             */\n            this.trigger('set_text',{ \"obj\" : obj, \"text\" : val });\n            return true;\n        },\n        /**\n         * gets a JSON representation of a node (or the whole tree)\n         * @name get_json([obj, options])\n         * @param  {mixed} obj\n         * @param  {Object} options\n         * @param  {Boolean} options.no_state do not return state information\n         * @param  {Boolean} options.no_id do not return ID\n         * @param  {Boolean} options.no_children do not include children\n         * @param  {Boolean} options.no_data do not include node data\n         * @param  {Boolean} options.no_li_attr do not include LI attributes\n         * @param  {Boolean} options.no_a_attr do not include A attributes\n         * @param  {Boolean} options.flat return flat JSON instead of nested\n         * @return {Object}\n         */\n        get_json : function (obj, options, flat) {\n            obj = this.get_node(obj || $.jstree.root);\n            if(!obj) { return false; }\n            if(options && options.flat && !flat) { flat = []; }\n            var tmp = {\n                'id' : obj.id,\n                'text' : obj.text,\n                'icon' : this.get_icon(obj),\n                'li_attr' : $.extend(true, {}, obj.li_attr),\n                'a_attr' : $.extend(true, {}, obj.a_attr),\n                'state' : {},\n                'data' : options && options.no_data ? false : $.extend(true, $.vakata.is_array(obj.data)?[]:{}, obj.data)\n                //( this.get_node(obj, true).length ? this.get_node(obj, true).data() : obj.data ),\n            }, i, j;\n            if(options && options.flat) {\n                tmp.parent = obj.parent;\n            }\n            else {\n                tmp.children = [];\n            }\n            if(!options || !options.no_state) {\n                for(i in obj.state) {\n                    if(obj.state.hasOwnProperty(i)) {\n                        tmp.state[i] = obj.state[i];\n                    }\n                }\n            } else {\n                delete tmp.state;\n            }\n            if(options && options.no_li_attr) {\n                delete tmp.li_attr;\n            }\n            if(options && options.no_a_attr) {\n                delete tmp.a_attr;\n            }\n            if(options && options.no_id) {\n                delete tmp.id;\n                if(tmp.li_attr && tmp.li_attr.id) {\n                    delete tmp.li_attr.id;\n                }\n                if(tmp.a_attr && tmp.a_attr.id) {\n                    delete tmp.a_attr.id;\n                }\n            }\n            if(options && options.flat && obj.id !== $.jstree.root) {\n                flat.push(tmp);\n            }\n            if(!options || !options.no_children) {\n                for(i = 0, j = obj.children.length; i < j; i++) {\n                    if(options && options.flat) {\n                        this.get_json(obj.children[i], options, flat);\n                    }\n                    else {\n                        tmp.children.push(this.get_json(obj.children[i], options));\n                    }\n                }\n            }\n            return options && options.flat ? flat : (obj.id === $.jstree.root ? tmp.children : tmp);\n        },\n        /**\n         * create a new node (do not confuse with load_node)\n         * @name create_node([par, node, pos, callback, is_loaded])\n         * @param  {mixed}   par       the parent node (to create a root node use either \"#\" (string) or `null`)\n         * @param  {mixed}   node      the data for the new node (a valid JSON object, or a simple string with the name)\n         * @param  {mixed}   pos       the index at which to insert the node, \"first\" and \"last\" are also supported, default is \"last\"\n         * @param  {Function} callback a function to be called once the node is created\n         * @param  {Boolean} is_loaded internal argument indicating if the parent node was succesfully loaded\n         * @return {String}            the ID of the newly create node\n         * @trigger model.jstree, create_node.jstree\n         */\n        create_node : function (par, node, pos, callback, is_loaded) {\n            if(par === null) { par = $.jstree.root; }\n            par = this.get_node(par);\n            if(!par) { return false; }\n            pos = pos === undefined ? \"last\" : pos;\n            if(!pos.toString().match(/^(before|after)$/) && !is_loaded && !this.is_loaded(par)) {\n                return this.load_node(par, function () { this.create_node(par, node, pos, callback, true); });\n            }\n            if(!node) { node = { \"text\" : this.get_string('New node') }; }\n            if(typeof node === \"string\") {\n                node = { \"text\" : node };\n            } else {\n                node = $.extend(true, {}, node);\n            }\n            if(node.text === undefined) { node.text = this.get_string('New node'); }\n            var tmp, dpc, i, j;\n\n            if(par.id === $.jstree.root) {\n                if(pos === \"before\") { pos = \"first\"; }\n                if(pos === \"after\") { pos = \"last\"; }\n            }\n            switch(pos) {\n                case \"before\":\n                    tmp = this.get_node(par.parent);\n                    pos = $.inArray(par.id, tmp.children);\n                    par = tmp;\n                    break;\n                case \"after\" :\n                    tmp = this.get_node(par.parent);\n                    pos = $.inArray(par.id, tmp.children) + 1;\n                    par = tmp;\n                    break;\n                case \"inside\":\n                case \"first\":\n                    pos = 0;\n                    break;\n                case \"last\":\n                    pos = par.children.length;\n                    break;\n                default:\n                    if(!pos) { pos = 0; }\n                    break;\n            }\n            if(pos > par.children.length) { pos = par.children.length; }\n            if(node.id === undefined) { node.id = true; }\n            if(!this.check(\"create_node\", node, par, pos)) {\n                this.settings.core.error.call(this, this._data.core.last_error);\n                return false;\n            }\n            if(node.id === true) { delete node.id; }\n            node = this._parse_model_from_json(node, par.id, par.parents.concat());\n            if(!node) { return false; }\n            tmp = this.get_node(node);\n            dpc = [];\n            dpc.push(node);\n            dpc = dpc.concat(tmp.children_d);\n            this.trigger('model', { \"nodes\" : dpc, \"parent\" : par.id });\n\n            par.children_d = par.children_d.concat(dpc);\n            for(i = 0, j = par.parents.length; i < j; i++) {\n                this._model.data[par.parents[i]].children_d = this._model.data[par.parents[i]].children_d.concat(dpc);\n            }\n            node = tmp;\n            tmp = [];\n            for(i = 0, j = par.children.length; i < j; i++) {\n                tmp[i >= pos ? i+1 : i] = par.children[i];\n            }\n            tmp[pos] = node.id;\n            par.children = tmp;\n\n            this.redraw_node(par, true);\n            /**\n             * triggered when a node is created\n             * @event\n             * @name create_node.jstree\n             * @param {Object} node\n             * @param {String} parent the parent's ID\n             * @param {Number} position the position of the new node among the parent's children\n             */\n            this.trigger('create_node', { \"node\" : this.get_node(node), \"parent\" : par.id, \"position\" : pos });\n            if(callback) { callback.call(this, this.get_node(node)); }\n            return node.id;\n        },\n        /**\n         * set the text value of a node\n         * @name rename_node(obj, val)\n         * @param  {mixed} obj the node, you can pass an array to rename multiple nodes to the same name\n         * @param  {String} val the new text value\n         * @return {Boolean}\n         * @trigger rename_node.jstree\n         */\n        rename_node : function (obj, val) {\n            var t1, t2, old;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.rename_node(obj[t1], val);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) { return false; }\n            old = obj.text;\n            if(!this.check(\"rename_node\", obj, this.get_parent(obj), val)) {\n                this.settings.core.error.call(this, this._data.core.last_error);\n                return false;\n            }\n            this.set_text(obj, val); // .apply(this, Array.prototype.slice.call(arguments))\n            /**\n             * triggered when a node is renamed\n             * @event\n             * @name rename_node.jstree\n             * @param {Object} node\n             * @param {String} text the new value\n             * @param {String} old the old value\n             */\n            this.trigger('rename_node', { \"node\" : obj, \"text\" : val, \"old\" : old });\n            return true;\n        },\n        /**\n         * remove a node\n         * @name delete_node(obj)\n         * @param  {mixed} obj the node, you can pass an array to delete multiple nodes\n         * @return {Boolean}\n         * @trigger delete_node.jstree, changed.jstree\n         */\n        delete_node : function (obj) {\n            var t1, t2, par, pos, tmp, i, j, k, l, c, top, lft;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.delete_node(obj[t1]);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) { return false; }\n            par = this.get_node(obj.parent);\n            pos = $.inArray(obj.id, par.children);\n            c = false;\n            if(!this.check(\"delete_node\", obj, par, pos)) {\n                this.settings.core.error.call(this, this._data.core.last_error);\n                return false;\n            }\n            if(pos !== -1) {\n                par.children = $.vakata.array_remove(par.children, pos);\n            }\n            tmp = obj.children_d.concat([]);\n            tmp.push(obj.id);\n            for(i = 0, j = obj.parents.length; i < j; i++) {\n                this._model.data[obj.parents[i]].children_d = $.vakata.array_filter(this._model.data[obj.parents[i]].children_d, function (v) {\n                    return $.inArray(v, tmp) === -1;\n                });\n            }\n            for(k = 0, l = tmp.length; k < l; k++) {\n                if(this._model.data[tmp[k]].state.selected) {\n                    c = true;\n                    break;\n                }\n            }\n            if (c) {\n                this._data.core.selected = $.vakata.array_filter(this._data.core.selected, function (v) {\n                    return $.inArray(v, tmp) === -1;\n                });\n            }\n            /**\n             * triggered when a node is deleted\n             * @event\n             * @name delete_node.jstree\n             * @param {Object} node\n             * @param {String} parent the parent's ID\n             */\n            this.trigger('delete_node', { \"node\" : obj, \"parent\" : par.id });\n            if(c) {\n                this.trigger('changed', { 'action' : 'delete_node', 'node' : obj, 'selected' : this._data.core.selected, 'parent' : par.id });\n            }\n            for(k = 0, l = tmp.length; k < l; k++) {\n                delete this._model.data[tmp[k]];\n            }\n            if($.inArray(this._data.core.focused, tmp) !== -1) {\n                this._data.core.focused = null;\n                top = this.element[0].scrollTop;\n                lft = this.element[0].scrollLeft;\n                if(par.id === $.jstree.root) {\n                    if (this._model.data[$.jstree.root].children[0]) {\n                        this.get_node(this._model.data[$.jstree.root].children[0], true).children('.jstree-anchor').trigger('focus');\n                    }\n                }\n                else {\n                    this.get_node(par, true).children('.jstree-anchor').trigger('focus');\n                }\n                this.element[0].scrollTop  = top;\n                this.element[0].scrollLeft = lft;\n            }\n            this.redraw_node(par, true);\n            return true;\n        },\n        /**\n         * check if an operation is premitted on the tree. Used internally.\n         * @private\n         * @name check(chk, obj, par, pos)\n         * @param  {String} chk the operation to check, can be \"create_node\", \"rename_node\", \"delete_node\", \"copy_node\" or \"move_node\"\n         * @param  {mixed} obj the node\n         * @param  {mixed} par the parent\n         * @param  {mixed} pos the position to insert at, or if \"rename_node\" - the new name\n         * @param  {mixed} more some various additional information, for example if a \"move_node\" operations is triggered by DND this will be the hovered node\n         * @return {Boolean}\n         */\n        check : function (chk, obj, par, pos, more) {\n            obj = obj && obj.id ? obj : this.get_node(obj);\n            par = par && par.id ? par : this.get_node(par);\n            var tmp = chk.match(/^(move_node|copy_node|create_node)$/i) ? par : obj,\n                chc = this.settings.core.check_callback;\n            if(chk === \"move_node\" || chk === \"copy_node\") {\n                if((!more || !more.is_multi) && (chk === \"move_node\" && $.inArray(obj.id, par.children) === pos)) {\n                    this._data.core.last_error = { 'error' : 'check', 'plugin' : 'core', 'id' : 'core_08', 'reason' : 'Moving node to its current position', 'data' : JSON.stringify({ 'chk' : chk, 'pos' : pos, 'obj' : obj && obj.id ? obj.id : false, 'par' : par && par.id ? par.id : false }) };\n                    return false;\n                }\n                if((!more || !more.is_multi) && (obj.id === par.id || (chk === \"move_node\" && $.inArray(obj.id, par.children) === pos) || $.inArray(par.id, obj.children_d) !== -1)) {\n                    this._data.core.last_error = { 'error' : 'check', 'plugin' : 'core', 'id' : 'core_01', 'reason' : 'Moving parent inside child', 'data' : JSON.stringify({ 'chk' : chk, 'pos' : pos, 'obj' : obj && obj.id ? obj.id : false, 'par' : par && par.id ? par.id : false }) };\n                    return false;\n                }\n            }\n            if(tmp && tmp.data) { tmp = tmp.data; }\n            if(tmp && tmp.functions && (tmp.functions[chk] === false || tmp.functions[chk] === true)) {\n                if(tmp.functions[chk] === false) {\n                    this._data.core.last_error = { 'error' : 'check', 'plugin' : 'core', 'id' : 'core_02', 'reason' : 'Node data prevents function: ' + chk, 'data' : JSON.stringify({ 'chk' : chk, 'pos' : pos, 'obj' : obj && obj.id ? obj.id : false, 'par' : par && par.id ? par.id : false }) };\n                }\n                return tmp.functions[chk];\n            }\n            if(chc === false || ($.vakata.is_function(chc) && chc.call(this, chk, obj, par, pos, more) === false) || (chc && chc[chk] === false)) {\n                this._data.core.last_error = { 'error' : 'check', 'plugin' : 'core', 'id' : 'core_03', 'reason' : 'User config for core.check_callback prevents function: ' + chk, 'data' : JSON.stringify({ 'chk' : chk, 'pos' : pos, 'obj' : obj && obj.id ? obj.id : false, 'par' : par && par.id ? par.id : false }) };\n                return false;\n            }\n            return true;\n        },\n        /**\n         * get the last error\n         * @name last_error()\n         * @return {Object}\n         */\n        last_error : function () {\n            return this._data.core.last_error;\n        },\n        /**\n         * move a node to a new parent\n         * @name move_node(obj, par [, pos, callback, is_loaded])\n         * @param  {mixed} obj the node to move, pass an array to move multiple nodes\n         * @param  {mixed} par the new parent\n         * @param  {mixed} pos the position to insert at (besides integer values, \"first\" and \"last\" are supported, as well as \"before\" and \"after\"), defaults to integer `0`\n         * @param  {function} callback a function to call once the move is completed, receives 3 arguments - the node, the new parent and the position\n         * @param  {Boolean} is_loaded internal parameter indicating if the parent node has been loaded\n         * @param  {Boolean} skip_redraw internal parameter indicating if the tree should be redrawn\n         * @param  {Boolean} instance internal parameter indicating if the node comes from another instance\n         * @trigger move_node.jstree\n         */\n        move_node : function (obj, par, pos, callback, is_loaded, skip_redraw, origin) {\n            var t1, t2, old_par, old_pos, new_par, old_ins, is_multi, dpc, tmp, i, j, k, l, p;\n\n            par = this.get_node(par);\n            pos = pos === undefined ? 0 : pos;\n            if(!par) { return false; }\n            if(!pos.toString().match(/^(before|after)$/) && !is_loaded && !this.is_loaded(par)) {\n                return this.load_node(par, function () { this.move_node(obj, par, pos, callback, true, false, origin); });\n            }\n\n            if($.vakata.is_array(obj)) {\n                if(obj.length === 1) {\n                    obj = obj[0];\n                }\n                else {\n                    //obj = obj.slice();\n                    for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                        if((tmp = this.move_node(obj[t1], par, pos, callback, is_loaded, false, origin))) {\n                            par = tmp;\n                            pos = \"after\";\n                        }\n                    }\n                    this.redraw();\n                    return true;\n                }\n            }\n            obj = obj && (obj.id !== undefined) ? obj : this.get_node(obj);\n\n            if(!obj || obj.id === $.jstree.root) { return false; }\n\n            old_par = (obj.parent || $.jstree.root).toString();\n            new_par = (!pos.toString().match(/^(before|after)$/) || par.id === $.jstree.root) ? par : this.get_node(par.parent);\n            old_ins = origin ? origin : (this._model.data[obj.id] ? this : $.jstree.reference(obj.id));\n            is_multi = !old_ins || !old_ins._id || (this._id !== old_ins._id);\n            old_pos = old_ins && old_ins._id && old_par && old_ins._model.data[old_par] && old_ins._model.data[old_par].children ? $.inArray(obj.id, old_ins._model.data[old_par].children) : -1;\n            if(old_ins && old_ins._id) {\n                obj = old_ins._model.data[obj.id];\n            }\n\n            if(is_multi) {\n                if((tmp = this.copy_node(obj, par, pos, callback, is_loaded, false, origin))) {\n                    if(old_ins) { old_ins.delete_node(obj); }\n                    return tmp;\n                }\n                return false;\n            }\n            //var m = this._model.data;\n            if(par.id === $.jstree.root) {\n                if(pos === \"before\") { pos = \"first\"; }\n                if(pos === \"after\") { pos = \"last\"; }\n            }\n            switch(pos) {\n                case \"before\":\n                    pos = $.inArray(par.id, new_par.children);\n                    break;\n                case \"after\" :\n                    pos = $.inArray(par.id, new_par.children) + 1;\n                    break;\n                case \"inside\":\n                case \"first\":\n                    pos = 0;\n                    break;\n                case \"last\":\n                    pos = new_par.children.length;\n                    break;\n                default:\n                    if(!pos) { pos = 0; }\n                    break;\n            }\n            if(pos > new_par.children.length) { pos = new_par.children.length; }\n            if(!this.check(\"move_node\", obj, new_par, pos, { 'core' : true, 'origin' : origin, 'is_multi' : (old_ins && old_ins._id && old_ins._id !== this._id), 'is_foreign' : (!old_ins || !old_ins._id) })) {\n                this.settings.core.error.call(this, this._data.core.last_error);\n                return false;\n            }\n            if(obj.parent === new_par.id) {\n                dpc = new_par.children.concat();\n                tmp = $.inArray(obj.id, dpc);\n                if(tmp !== -1) {\n                    dpc = $.vakata.array_remove(dpc, tmp);\n                    if(pos > tmp) { pos--; }\n                }\n                tmp = [];\n                for(i = 0, j = dpc.length; i < j; i++) {\n                    tmp[i >= pos ? i+1 : i] = dpc[i];\n                }\n                tmp[pos] = obj.id;\n                new_par.children = tmp;\n                this._node_changed(new_par.id);\n                this.redraw(new_par.id === $.jstree.root);\n            }\n            else {\n                // clean old parent and up\n                tmp = obj.children_d.concat();\n                tmp.push(obj.id);\n                for(i = 0, j = obj.parents.length; i < j; i++) {\n                    dpc = [];\n                    p = old_ins._model.data[obj.parents[i]].children_d;\n                    for(k = 0, l = p.length; k < l; k++) {\n                        if($.inArray(p[k], tmp) === -1) {\n                            dpc.push(p[k]);\n                        }\n                    }\n                    old_ins._model.data[obj.parents[i]].children_d = dpc;\n                }\n                old_ins._model.data[old_par].children = $.vakata.array_remove_item(old_ins._model.data[old_par].children, obj.id);\n\n                // insert into new parent and up\n                for(i = 0, j = new_par.parents.length; i < j; i++) {\n                    this._model.data[new_par.parents[i]].children_d = this._model.data[new_par.parents[i]].children_d.concat(tmp);\n                }\n                dpc = [];\n                for(i = 0, j = new_par.children.length; i < j; i++) {\n                    dpc[i >= pos ? i+1 : i] = new_par.children[i];\n                }\n                dpc[pos] = obj.id;\n                new_par.children = dpc;\n                new_par.children_d.push(obj.id);\n                new_par.children_d = new_par.children_d.concat(obj.children_d);\n\n                // update object\n                obj.parent = new_par.id;\n                tmp = new_par.parents.concat();\n                tmp.unshift(new_par.id);\n                p = obj.parents.length;\n                obj.parents = tmp;\n\n                // update object children\n                tmp = tmp.concat();\n                for(i = 0, j = obj.children_d.length; i < j; i++) {\n                    this._model.data[obj.children_d[i]].parents = this._model.data[obj.children_d[i]].parents.slice(0,p*-1);\n                    Array.prototype.push.apply(this._model.data[obj.children_d[i]].parents, tmp);\n                }\n\n                if(old_par === $.jstree.root || new_par.id === $.jstree.root) {\n                    this._model.force_full_redraw = true;\n                }\n                if(!this._model.force_full_redraw) {\n                    this._node_changed(old_par);\n                    this._node_changed(new_par.id);\n                }\n                if(!skip_redraw) {\n                    this.redraw();\n                }\n            }\n            if(callback) { callback.call(this, obj, new_par, pos); }\n            /**\n             * triggered when a node is moved\n             * @event\n             * @name move_node.jstree\n             * @param {Object} node\n             * @param {String} parent the parent's ID\n             * @param {Number} position the position of the node among the parent's children\n             * @param {String} old_parent the old parent of the node\n             * @param {Number} old_position the old position of the node\n             * @param {Boolean} is_multi do the node and new parent belong to different instances\n             * @param {jsTree} old_instance the instance the node came from\n             * @param {jsTree} new_instance the instance of the new parent\n             */\n            this.trigger('move_node', { \"node\" : obj, \"parent\" : new_par.id, \"position\" : pos, \"old_parent\" : old_par, \"old_position\" : old_pos, 'is_multi' : (old_ins && old_ins._id && old_ins._id !== this._id), 'is_foreign' : (!old_ins || !old_ins._id), 'old_instance' : old_ins, 'new_instance' : this });\n            return obj.id;\n        },\n        /**\n         * copy a node to a new parent\n         * @name copy_node(obj, par [, pos, callback, is_loaded])\n         * @param  {mixed} obj the node to copy, pass an array to copy multiple nodes\n         * @param  {mixed} par the new parent\n         * @param  {mixed} pos the position to insert at (besides integer values, \"first\" and \"last\" are supported, as well as \"before\" and \"after\"), defaults to integer `0`\n         * @param  {function} callback a function to call once the move is completed, receives 3 arguments - the node, the new parent and the position\n         * @param  {Boolean} is_loaded internal parameter indicating if the parent node has been loaded\n         * @param  {Boolean} skip_redraw internal parameter indicating if the tree should be redrawn\n         * @param  {Boolean} instance internal parameter indicating if the node comes from another instance\n         * @trigger model.jstree copy_node.jstree\n         */\n        copy_node : function (obj, par, pos, callback, is_loaded, skip_redraw, origin) {\n            var t1, t2, dpc, tmp, i, j, node, old_par, new_par, old_ins, is_multi;\n\n            par = this.get_node(par);\n            pos = pos === undefined ? 0 : pos;\n            if(!par) { return false; }\n            if(!pos.toString().match(/^(before|after)$/) && !is_loaded && !this.is_loaded(par)) {\n                return this.load_node(par, function () { this.copy_node(obj, par, pos, callback, true, false, origin); });\n            }\n\n            if($.vakata.is_array(obj)) {\n                if(obj.length === 1) {\n                    obj = obj[0];\n                }\n                else {\n                    //obj = obj.slice();\n                    for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                        if((tmp = this.copy_node(obj[t1], par, pos, callback, is_loaded, true, origin))) {\n                            par = tmp;\n                            pos = \"after\";\n                        }\n                    }\n                    this.redraw();\n                    return true;\n                }\n            }\n            obj = obj && (obj.id !== undefined) ? obj : this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) { return false; }\n\n            old_par = (obj.parent || $.jstree.root).toString();\n            new_par = (!pos.toString().match(/^(before|after)$/) || par.id === $.jstree.root) ? par : this.get_node(par.parent);\n            old_ins = origin ? origin : (this._model.data[obj.id] ? this : $.jstree.reference(obj.id));\n            is_multi = !old_ins || !old_ins._id || (this._id !== old_ins._id);\n\n            if(old_ins && old_ins._id) {\n                obj = old_ins._model.data[obj.id];\n            }\n\n            if(par.id === $.jstree.root) {\n                if(pos === \"before\") { pos = \"first\"; }\n                if(pos === \"after\") { pos = \"last\"; }\n            }\n            switch(pos) {\n                case \"before\":\n                    pos = $.inArray(par.id, new_par.children);\n                    break;\n                case \"after\" :\n                    pos = $.inArray(par.id, new_par.children) + 1;\n                    break;\n                case \"inside\":\n                case \"first\":\n                    pos = 0;\n                    break;\n                case \"last\":\n                    pos = new_par.children.length;\n                    break;\n                default:\n                    if(!pos) { pos = 0; }\n                    break;\n            }\n            if(pos > new_par.children.length) { pos = new_par.children.length; }\n            if(!this.check(\"copy_node\", obj, new_par, pos, { 'core' : true, 'origin' : origin, 'is_multi' : (old_ins && old_ins._id && old_ins._id !== this._id), 'is_foreign' : (!old_ins || !old_ins._id) })) {\n                this.settings.core.error.call(this, this._data.core.last_error);\n                return false;\n            }\n            node = old_ins ? old_ins.get_json(obj, { no_id : true, no_data : true, no_state : true }) : obj;\n            if(!node) { return false; }\n            if(node.id === true) { delete node.id; }\n            node = this._parse_model_from_json(node, new_par.id, new_par.parents.concat());\n            if(!node) { return false; }\n            tmp = this.get_node(node);\n            if(obj && obj.state && obj.state.loaded === false) { tmp.state.loaded = false; }\n            dpc = [];\n            dpc.push(node);\n            dpc = dpc.concat(tmp.children_d);\n            this.trigger('model', { \"nodes\" : dpc, \"parent\" : new_par.id });\n\n            // insert into new parent and up\n            for(i = 0, j = new_par.parents.length; i < j; i++) {\n                this._model.data[new_par.parents[i]].children_d = this._model.data[new_par.parents[i]].children_d.concat(dpc);\n            }\n            dpc = [];\n            for(i = 0, j = new_par.children.length; i < j; i++) {\n                dpc[i >= pos ? i+1 : i] = new_par.children[i];\n            }\n            dpc[pos] = tmp.id;\n            new_par.children = dpc;\n            new_par.children_d.push(tmp.id);\n            new_par.children_d = new_par.children_d.concat(tmp.children_d);\n\n            if(new_par.id === $.jstree.root) {\n                this._model.force_full_redraw = true;\n            }\n            if(!this._model.force_full_redraw) {\n                this._node_changed(new_par.id);\n            }\n            if(!skip_redraw) {\n                this.redraw(new_par.id === $.jstree.root);\n            }\n            if(callback) { callback.call(this, tmp, new_par, pos); }\n            /**\n             * triggered when a node is copied\n             * @event\n             * @name copy_node.jstree\n             * @param {Object} node the copied node\n             * @param {Object} original the original node\n             * @param {String} parent the parent's ID\n             * @param {Number} position the position of the node among the parent's children\n             * @param {String} old_parent the old parent of the node\n             * @param {Number} old_position the position of the original node\n             * @param {Boolean} is_multi do the node and new parent belong to different instances\n             * @param {jsTree} old_instance the instance the node came from\n             * @param {jsTree} new_instance the instance of the new parent\n             */\n            this.trigger('copy_node', { \"node\" : tmp, \"original\" : obj, \"parent\" : new_par.id, \"position\" : pos, \"old_parent\" : old_par, \"old_position\" : old_ins && old_ins._id && old_par && old_ins._model.data[old_par] && old_ins._model.data[old_par].children ? $.inArray(obj.id, old_ins._model.data[old_par].children) : -1,'is_multi' : (old_ins && old_ins._id && old_ins._id !== this._id), 'is_foreign' : (!old_ins || !old_ins._id), 'old_instance' : old_ins, 'new_instance' : this });\n            return tmp.id;\n        },\n        /**\n         * cut a node (a later call to `paste(obj)` would move the node)\n         * @name cut(obj)\n         * @param  {mixed} obj multiple objects can be passed using an array\n         * @trigger cut.jstree\n         */\n        cut : function (obj) {\n            if(!obj) { obj = this._data.core.selected.concat(); }\n            if(!$.vakata.is_array(obj)) { obj = [obj]; }\n            if(!obj.length) { return false; }\n            var tmp = [], o, t1, t2;\n            for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                o = this.get_node(obj[t1]);\n                if(o && (o.id || o.id === 0) && o.id !== $.jstree.root) { tmp.push(o); }\n            }\n            if(!tmp.length) { return false; }\n            ccp_node = tmp;\n            ccp_inst = this;\n            ccp_mode = 'move_node';\n            /**\n             * triggered when nodes are added to the buffer for moving\n             * @event\n             * @name cut.jstree\n             * @param {Array} node\n             */\n            this.trigger('cut', { \"node\" : obj });\n        },\n        /**\n         * copy a node (a later call to `paste(obj)` would copy the node)\n         * @name copy(obj)\n         * @param  {mixed} obj multiple objects can be passed using an array\n         * @trigger copy.jstree\n         */\n        copy : function (obj) {\n            if(!obj) { obj = this._data.core.selected.concat(); }\n            if(!$.vakata.is_array(obj)) { obj = [obj]; }\n            if(!obj.length) { return false; }\n            var tmp = [], o, t1, t2;\n            for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                o = this.get_node(obj[t1]);\n                if(o && (o.id !== undefined) && o.id !== $.jstree.root) { tmp.push(o); }\n            }\n            if(!tmp.length) { return false; }\n            ccp_node = tmp;\n            ccp_inst = this;\n            ccp_mode = 'copy_node';\n            /**\n             * triggered when nodes are added to the buffer for copying\n             * @event\n             * @name copy.jstree\n             * @param {Array} node\n             */\n            this.trigger('copy', { \"node\" : obj });\n        },\n        /**\n         * get the current buffer (any nodes that are waiting for a paste operation)\n         * @name get_buffer()\n         * @return {Object} an object consisting of `mode` (\"copy_node\" or \"move_node\"), `node` (an array of objects) and `inst` (the instance)\n         */\n        get_buffer : function () {\n            return { 'mode' : ccp_mode, 'node' : ccp_node, 'inst' : ccp_inst };\n        },\n        /**\n         * check if there is something in the buffer to paste\n         * @name can_paste()\n         * @return {Boolean}\n         */\n        can_paste : function () {\n            return ccp_mode !== false && ccp_node !== false; // && ccp_inst._model.data[ccp_node];\n        },\n        /**\n         * copy or move the previously cut or copied nodes to a new parent\n         * @name paste(obj [, pos])\n         * @param  {mixed} obj the new parent\n         * @param  {mixed} pos the position to insert at (besides integer, \"first\" and \"last\" are supported), defaults to integer `0`\n         * @trigger paste.jstree\n         */\n        paste : function (obj, pos) {\n            obj = this.get_node(obj);\n            if(!obj || !ccp_mode || !ccp_mode.match(/^(copy_node|move_node)$/) || !ccp_node) { return false; }\n            if(this[ccp_mode](ccp_node, obj, pos, false, false, false, ccp_inst)) {\n                /**\n                 * triggered when paste is invoked\n                 * @event\n                 * @name paste.jstree\n                 * @param {String} parent the ID of the receiving node\n                 * @param {Array} node the nodes in the buffer\n                 * @param {String} mode the performed operation - \"copy_node\" or \"move_node\"\n                 */\n                this.trigger('paste', { \"parent\" : obj.id, \"node\" : ccp_node, \"mode\" : ccp_mode });\n            }\n            ccp_node = false;\n            ccp_mode = false;\n            ccp_inst = false;\n        },\n        /**\n         * clear the buffer of previously copied or cut nodes\n         * @name clear_buffer()\n         * @trigger clear_buffer.jstree\n         */\n        clear_buffer : function () {\n            ccp_node = false;\n            ccp_mode = false;\n            ccp_inst = false;\n            /**\n             * triggered when the copy / cut buffer is cleared\n             * @event\n             * @name clear_buffer.jstree\n             */\n            this.trigger('clear_buffer');\n        },\n        /**\n         * put a node in edit mode (input field to rename the node)\n         * @name edit(obj [, default_text, callback])\n         * @param  {mixed} obj\n         * @param  {String} default_text the text to populate the input with (if omitted or set to a non-string value the node's text value is used)\n         * @param  {Function} callback a function to be called once the text box is blurred, it is called in the instance's scope and receives the node, a status parameter (true if the rename is successful, false otherwise), a boolean indicating if the user cancelled the edit and the original unescaped value provided by the user. You can also access the node's title using .text\n         */\n        edit : function (obj, default_text, callback) {\n            var rtl, w, a, s, t, h1, h2, fn, tmp, cancel = false;\n            obj = this.get_node(obj);\n            if(!obj) { return false; }\n            if(!this.check(\"edit\", obj, this.get_parent(obj))) {\n                this.settings.core.error.call(this, this._data.core.last_error);\n                return false;\n            }\n            tmp = obj;\n            default_text = typeof default_text === 'string' ? default_text : obj.text;\n            this.set_text(obj, \"\");\n            obj = this._open_to(obj);\n            tmp.text = default_text;\n\n            rtl = this._data.core.rtl;\n            w  = this.element.width();\n            this._data.core.focused = tmp.id;\n            a  = obj.children('.jstree-anchor').trigger('focus');\n            s  = $('<span></span>');\n            /*!\n\t\t\toi = obj.children(\"i:visible\"),\n\t\t\tai = a.children(\"i:visible\"),\n\t\t\tw1 = oi.width() * oi.length,\n\t\t\tw2 = ai.width() * ai.length,\n\t\t\t*/\n            t  = default_text;\n            h1 = $(\"<\"+\"div></div>\", { css : { \"position\" : \"absolute\", \"top\" : \"-200px\", \"left\" : (rtl ? \"0px\" : \"-1000px\"), \"visibility\" : \"hidden\" } }).appendTo(document.body);\n            h2 = $(\"<\"+\"input />\", {\n                \"value\" : t,\n                \"class\" : \"jstree-rename-input\",\n                // \"size\" : t.length,\n                \"css\" : {\n                    \"padding\" : \"0\",\n                    \"border\" : \"1px solid silver\",\n                    \"box-sizing\" : \"border-box\",\n                    \"display\" : \"inline-block\",\n                    \"height\" : (this._data.core.li_height) + \"px\",\n                    \"lineHeight\" : (this._data.core.li_height) + \"px\",\n                    \"width\" : \"150px\" // will be set a bit further down\n                },\n                \"blur\" : function (e) {\n                    e.stopImmediatePropagation();\n                    e.preventDefault();\n                    var i = s.children(\".jstree-rename-input\"),\n                        v = i.val(),\n                        f = this.settings.core.force_text,\n                        nv;\n                    if(v === \"\") { v = t; }\n                    h1.remove();\n                    s.replaceWith(a);\n                    s.remove();\n                    t = f ? t : $('<div></div>').append($.parseHTML(t)).html();\n                    obj = this.get_node(obj);\n                    this.set_text(obj, t);\n                    nv = !!this.rename_node(obj, f ? $('<div></div>').text(v).text() : $('<div></div>').append($.parseHTML(v)).html());\n                    if(!nv) {\n                        this.set_text(obj, t); // move this up? and fix #483\n                    }\n                    this._data.core.focused = tmp.id;\n                    setTimeout(function () {\n                        var node = this.get_node(tmp.id, true);\n                        if(node.length) {\n                            this._data.core.focused = tmp.id;\n                            node.children('.jstree-anchor').trigger('focus');\n                        }\n                    }.bind(this), 0);\n                    if(callback) {\n                        callback.call(this, tmp, nv, cancel, v);\n                    }\n                    h2 = null;\n                }.bind(this),\n                \"keydown\" : function (e) {\n                    var key = e.which;\n                    if(key === 27) {\n                        cancel = true;\n                        this.value = t;\n                    }\n                    if(key === 27 || key === 13 || key === 37 || key === 38 || key === 39 || key === 40 || key === 32) {\n                        e.stopImmediatePropagation();\n                    }\n                    if(key === 27 || key === 13) {\n                        e.preventDefault();\n                        this.blur();\n                    }\n                },\n                \"click\" : function (e) { e.stopImmediatePropagation(); },\n                \"mousedown\" : function (e) { e.stopImmediatePropagation(); },\n                \"keyup\" : function (e) {\n                    h2.width(Math.min(h1.text(\"pW\" + this.value).width(),w));\n                },\n                \"keypress\" : function(e) {\n                    if(e.which === 13) { return false; }\n                }\n            });\n            fn = {\n                fontFamily\t\t: a.css('fontFamily')\t\t|| '',\n                fontSize\t\t: a.css('fontSize')\t\t\t|| '',\n                fontWeight\t\t: a.css('fontWeight')\t\t|| '',\n                fontStyle\t\t: a.css('fontStyle')\t\t|| '',\n                fontStretch\t\t: a.css('fontStretch')\t\t|| '',\n                fontVariant\t\t: a.css('fontVariant')\t\t|| '',\n                letterSpacing\t: a.css('letterSpacing')\t|| '',\n                wordSpacing\t\t: a.css('wordSpacing')\t\t|| ''\n            };\n            s.attr('class', a.attr('class')).append(a.contents().clone()).append(h2);\n            a.replaceWith(s);\n            h1.css(fn);\n            h2.css(fn).width(Math.min(h1.text(\"pW\" + h2[0].value).width(),w))[0].select();\n            $(document).one('mousedown.jstree touchstart.jstree dnd_start.vakata', function (e) {\n                if (h2 && e.target !== h2) {\n                    $(h2).trigger('blur');\n                }\n            });\n        },\n\n\n        /**\n         * changes the theme\n         * @name set_theme(theme_name [, theme_url])\n         * @param {String} theme_name the name of the new theme to apply\n         * @param {mixed} theme_url  the location of the CSS file for this theme. Omit or set to `false` if you manually included the file. Set to `true` to autoload from the `core.themes.dir` directory.\n         * @trigger set_theme.jstree\n         */\n        set_theme : function (theme_name, theme_url) {\n            if(!theme_name) { return false; }\n            if(theme_url === true) {\n                var dir = this.settings.core.themes.dir;\n                if(!dir) { dir = $.jstree.path + '/themes'; }\n                theme_url = dir + '/' + theme_name + '/style.css';\n            }\n            if(theme_url && $.inArray(theme_url, themes_loaded) === -1) {\n                $('head').append('<'+'link rel=\"stylesheet\" href=\"' + theme_url + '\" type=\"text/css\" />');\n                themes_loaded.push(theme_url);\n            }\n            if(this._data.core.themes.name) {\n                this.element.removeClass('jstree-' + this._data.core.themes.name);\n            }\n            this._data.core.themes.name = theme_name;\n            this.element.addClass('jstree-' + theme_name);\n            this.element[this.settings.core.themes.responsive ? 'addClass' : 'removeClass' ]('jstree-' + theme_name + '-responsive');\n            /**\n             * triggered when a theme is set\n             * @event\n             * @name set_theme.jstree\n             * @param {String} theme the new theme\n             */\n            this.trigger('set_theme', { 'theme' : theme_name });\n        },\n        /**\n         * gets the name of the currently applied theme name\n         * @name get_theme()\n         * @return {String}\n         */\n        get_theme : function () { return this._data.core.themes.name; },\n        /**\n         * changes the theme variant (if the theme has variants)\n         * @name set_theme_variant(variant_name)\n         * @param {String|Boolean} variant_name the variant to apply (if `false` is used the current variant is removed)\n         */\n        set_theme_variant : function (variant_name) {\n            if(this._data.core.themes.variant) {\n                this.element.removeClass('jstree-' + this._data.core.themes.name + '-' + this._data.core.themes.variant);\n            }\n            this._data.core.themes.variant = variant_name;\n            if(variant_name) {\n                this.element.addClass('jstree-' + this._data.core.themes.name + '-' + this._data.core.themes.variant);\n            }\n        },\n        /**\n         * gets the name of the currently applied theme variant\n         * @name get_theme()\n         * @return {String}\n         */\n        get_theme_variant : function () { return this._data.core.themes.variant; },\n        /**\n         * shows a striped background on the container (if the theme supports it)\n         * @name show_stripes()\n         */\n        show_stripes : function () {\n            this._data.core.themes.stripes = true;\n            this.get_container_ul().addClass(\"jstree-striped\");\n            /**\n             * triggered when stripes are shown\n             * @event\n             * @name show_stripes.jstree\n             */\n            this.trigger('show_stripes');\n        },\n        /**\n         * hides the striped background on the container\n         * @name hide_stripes()\n         */\n        hide_stripes : function () {\n            this._data.core.themes.stripes = false;\n            this.get_container_ul().removeClass(\"jstree-striped\");\n            /**\n             * triggered when stripes are hidden\n             * @event\n             * @name hide_stripes.jstree\n             */\n            this.trigger('hide_stripes');\n        },\n        /**\n         * toggles the striped background on the container\n         * @name toggle_stripes()\n         */\n        toggle_stripes : function () { if(this._data.core.themes.stripes) { this.hide_stripes(); } else { this.show_stripes(); } },\n        /**\n         * shows the connecting dots (if the theme supports it)\n         * @name show_dots()\n         */\n        show_dots : function () {\n            this._data.core.themes.dots = true;\n            this.get_container_ul().removeClass(\"jstree-no-dots\");\n            /**\n             * triggered when dots are shown\n             * @event\n             * @name show_dots.jstree\n             */\n            this.trigger('show_dots');\n        },\n        /**\n         * hides the connecting dots\n         * @name hide_dots()\n         */\n        hide_dots : function () {\n            this._data.core.themes.dots = false;\n            this.get_container_ul().addClass(\"jstree-no-dots\");\n            /**\n             * triggered when dots are hidden\n             * @event\n             * @name hide_dots.jstree\n             */\n            this.trigger('hide_dots');\n        },\n        /**\n         * toggles the connecting dots\n         * @name toggle_dots()\n         */\n        toggle_dots : function () { if(this._data.core.themes.dots) { this.hide_dots(); } else { this.show_dots(); } },\n        /**\n         * show the node icons\n         * @name show_icons()\n         */\n        show_icons : function () {\n            this._data.core.themes.icons = true;\n            this.get_container_ul().removeClass(\"jstree-no-icons\");\n            /**\n             * triggered when icons are shown\n             * @event\n             * @name show_icons.jstree\n             */\n            this.trigger('show_icons');\n        },\n        /**\n         * hide the node icons\n         * @name hide_icons()\n         */\n        hide_icons : function () {\n            this._data.core.themes.icons = false;\n            this.get_container_ul().addClass(\"jstree-no-icons\");\n            /**\n             * triggered when icons are hidden\n             * @event\n             * @name hide_icons.jstree\n             */\n            this.trigger('hide_icons');\n        },\n        /**\n         * toggle the node icons\n         * @name toggle_icons()\n         */\n        toggle_icons : function () { if(this._data.core.themes.icons) { this.hide_icons(); } else { this.show_icons(); } },\n        /**\n         * show the node ellipsis\n         * @name show_icons()\n         */\n        show_ellipsis : function () {\n            this._data.core.themes.ellipsis = true;\n            this.get_container_ul().addClass(\"jstree-ellipsis\");\n            /**\n             * triggered when ellisis is shown\n             * @event\n             * @name show_ellipsis.jstree\n             */\n            this.trigger('show_ellipsis');\n        },\n        /**\n         * hide the node ellipsis\n         * @name hide_ellipsis()\n         */\n        hide_ellipsis : function () {\n            this._data.core.themes.ellipsis = false;\n            this.get_container_ul().removeClass(\"jstree-ellipsis\");\n            /**\n             * triggered when ellisis is hidden\n             * @event\n             * @name hide_ellipsis.jstree\n             */\n            this.trigger('hide_ellipsis');\n        },\n        /**\n         * toggle the node ellipsis\n         * @name toggle_icons()\n         */\n        toggle_ellipsis : function () { if(this._data.core.themes.ellipsis) { this.hide_ellipsis(); } else { this.show_ellipsis(); } },\n        /**\n         * set the node icon for a node\n         * @name set_icon(obj, icon)\n         * @param {mixed} obj\n         * @param {String} icon the new icon - can be a path to an icon or a className, if using an image that is in the current directory use a `./` prefix, otherwise it will be detected as a class\n         */\n        set_icon : function (obj, icon) {\n            var t1, t2, dom, old;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.set_icon(obj[t1], icon);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) { return false; }\n            old = obj.icon;\n            obj.icon = icon === true || icon === null || icon === undefined || icon === '' ? true : icon;\n            dom = this.get_node(obj, true).children(\".jstree-anchor\").children(\".jstree-themeicon\");\n            if(icon === false) {\n                dom.removeClass('jstree-themeicon-custom ' + old).css(\"background\",\"\").removeAttr(\"rel\");\n                this.hide_icon(obj);\n            }\n            else if(icon === true || icon === null || icon === undefined || icon === '') {\n                dom.removeClass('jstree-themeicon-custom ' + old).css(\"background\",\"\").removeAttr(\"rel\");\n                if(old === false) { this.show_icon(obj); }\n            }\n            else if(icon.indexOf(\"/\") === -1 && icon.indexOf(\".\") === -1) {\n                dom.removeClass(old).css(\"background\",\"\");\n                dom.addClass(icon + ' jstree-themeicon-custom').attr(\"rel\",icon);\n                if(old === false) { this.show_icon(obj); }\n            }\n            else {\n                dom.removeClass(old).css(\"background\",\"\");\n                dom.addClass('jstree-themeicon-custom').css(\"background\", \"url('\" + icon + \"') center center no-repeat\").attr(\"rel\",icon);\n                if(old === false) { this.show_icon(obj); }\n            }\n            return true;\n        },\n        /**\n         * get the node icon for a node\n         * @name get_icon(obj)\n         * @param {mixed} obj\n         * @return {String}\n         */\n        get_icon : function (obj) {\n            obj = this.get_node(obj);\n            return (!obj || obj.id === $.jstree.root) ? false : obj.icon;\n        },\n        /**\n         * hide the icon on an individual node\n         * @name hide_icon(obj)\n         * @param {mixed} obj\n         */\n        hide_icon : function (obj) {\n            var t1, t2;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.hide_icon(obj[t1]);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj === $.jstree.root) { return false; }\n            obj.icon = false;\n            this.get_node(obj, true).children(\".jstree-anchor\").children(\".jstree-themeicon\").addClass('jstree-themeicon-hidden');\n            return true;\n        },\n        /**\n         * show the icon on an individual node\n         * @name show_icon(obj)\n         * @param {mixed} obj\n         */\n        show_icon : function (obj) {\n            var t1, t2, dom;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.show_icon(obj[t1]);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj === $.jstree.root) { return false; }\n            dom = this.get_node(obj, true);\n            obj.icon = dom.length ? dom.children(\".jstree-anchor\").children(\".jstree-themeicon\").attr('rel') : true;\n            if(!obj.icon) { obj.icon = true; }\n            dom.children(\".jstree-anchor\").children(\".jstree-themeicon\").removeClass('jstree-themeicon-hidden');\n            return true;\n        }\n    };\n\n    // helpers\n    $.vakata = {};\n    // collect attributes\n    $.vakata.attributes = function(node, with_values) {\n        node = $(node)[0];\n        var attr = with_values ? {} : [];\n        if(node && node.attributes) {\n            $.each(node.attributes, function (i, v) {\n                if($.inArray(v.name.toLowerCase(),['style','contenteditable','hasfocus','tabindex']) !== -1) { return; }\n                if(v.value !== null && $.vakata.trim(v.value) !== '') {\n                    if(with_values) { attr[v.name] = v.value; }\n                    else { attr.push(v.name); }\n                }\n            });\n        }\n        return attr;\n    };\n    $.vakata.array_unique = function(array) {\n        var a = [], i, j, l, o = {};\n        for(i = 0, l = array.length; i < l; i++) {\n            if(o[array[i]] === undefined) {\n                a.push(array[i]);\n                o[array[i]] = true;\n            }\n        }\n        return a;\n    };\n    // remove item from array\n    $.vakata.array_remove = function(array, from) {\n        array.splice(from, 1);\n        return array;\n        //var rest = array.slice((to || from) + 1 || array.length);\n        //array.length = from < 0 ? array.length + from : from;\n        //array.push.apply(array, rest);\n        //return array;\n    };\n    // remove item from array\n    $.vakata.array_remove_item = function(array, item) {\n        var tmp = $.inArray(item, array);\n        return tmp !== -1 ? $.vakata.array_remove(array, tmp) : array;\n    };\n    $.vakata.array_filter = function(c,a,b,d,e) {\n        if (c.filter) {\n            return c.filter(a, b);\n        }\n        d=[];\n        for (e in c) {\n            if (~~e+''===e+'' && e>=0 && a.call(b,c[e],+e,c)) {\n                d.push(c[e]);\n            }\n        }\n        return d;\n    };\n    $.vakata.trim = function (text) {\n        return String.prototype.trim ?\n            String.prototype.trim.call(text.toString()) :\n            text.toString().replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n    };\n    $.vakata.is_function = function(obj) {\n        return typeof obj === \"function\" && typeof obj.nodeType !== \"number\";\n    };\n    $.vakata.is_array = Array.isArray || function (obj) {\n        return Object.prototype.toString.call(obj) === \"[object Array]\";\n    };\n\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/Function/bind#polyfill\n    if (!Function.prototype.bind) {\n        Function.prototype.bind = function () {\n            var thatFunc = this, thatArg = arguments[0];\n            var args = Array.prototype.slice.call(arguments, 1);\n            if (typeof thatFunc !== 'function') {\n                // closest thing possible to the ECMAScript 5\n                // internal IsCallable function\n                throw new TypeError('Function.prototype.bind - what is trying to be bound is not callable');\n            }\n            return function(){\n                var funcArgs = args.concat(Array.prototype.slice.call(arguments));\n                return thatFunc.apply(thatArg, funcArgs);\n            };\n        };\n    }\n\n\n    /**\n     * ### Changed plugin\n     *\n     * This plugin adds more information to the `changed.jstree` event. The new data is contained in the `changed` event data property, and contains a lists of `selected` and `deselected` nodes.\n     */\n\n    $.jstree.plugins.changed = function (options, parent) {\n        var last = [];\n        this.trigger = function (ev, data) {\n            var i, j;\n            if(!data) {\n                data = {};\n            }\n            if(ev.replace('.jstree','') === 'changed') {\n                data.changed = { selected : [], deselected : [] };\n                var tmp = {};\n                for(i = 0, j = last.length; i < j; i++) {\n                    tmp[last[i]] = 1;\n                }\n                for(i = 0, j = data.selected.length; i < j; i++) {\n                    if(!tmp[data.selected[i]]) {\n                        data.changed.selected.push(data.selected[i]);\n                    }\n                    else {\n                        tmp[data.selected[i]] = 2;\n                    }\n                }\n                for(i = 0, j = last.length; i < j; i++) {\n                    if(tmp[last[i]] === 1) {\n                        data.changed.deselected.push(last[i]);\n                    }\n                }\n                last = data.selected.slice();\n            }\n            /**\n             * triggered when selection changes (the \"changed\" plugin enhances the original event with more data)\n             * @event\n             * @name changed.jstree\n             * @param {Object} node\n             * @param {Object} action the action that caused the selection to change\n             * @param {Array} selected the current selection\n             * @param {Object} changed an object containing two properties `selected` and `deselected` - both arrays of node IDs, which were selected or deselected since the last changed event\n             * @param {Object} event the event (if any) that triggered this changed event\n             * @plugin changed\n             */\n            parent.trigger.call(this, ev, data);\n        };\n        this.refresh = function (skip_loading, forget_state) {\n            last = [];\n            return parent.refresh.apply(this, arguments);\n        };\n    };\n\n    /**\n     * ### Checkbox plugin\n     *\n     * This plugin renders checkbox icons in front of each node, making multiple selection much easier.\n     * It also supports tri-state behavior, meaning that if a node has a few of its children checked it will be rendered as undetermined, and state will be propagated up.\n     */\n\n    var _i = document.createElement('I');\n    _i.className = 'jstree-icon jstree-checkbox';\n    _i.setAttribute('role', 'presentation');\n    /**\n     * stores all defaults for the checkbox plugin\n     * @name $.jstree.defaults.checkbox\n     * @plugin checkbox\n     */\n    $.jstree.defaults.checkbox = {\n        /**\n         * a boolean indicating if checkboxes should be visible (can be changed at a later time using `show_checkboxes()` and `hide_checkboxes`). Defaults to `true`.\n         * @name $.jstree.defaults.checkbox.visible\n         * @plugin checkbox\n         */\n        visible\t\t\t\t: true,\n        /**\n         * a boolean indicating if checkboxes should cascade down and have an undetermined state. Defaults to `true`.\n         * @name $.jstree.defaults.checkbox.three_state\n         * @plugin checkbox\n         */\n        three_state\t\t\t: true,\n        /**\n         * a boolean indicating if clicking anywhere on the node should act as clicking on the checkbox. Defaults to `true`.\n         * @name $.jstree.defaults.checkbox.whole_node\n         * @plugin checkbox\n         */\n        whole_node\t\t\t: true,\n        /**\n         * a boolean indicating if the selected style of a node should be kept, or removed. Defaults to `true`.\n         * @name $.jstree.defaults.checkbox.keep_selected_style\n         * @plugin checkbox\n         */\n        keep_selected_style\t: true,\n        /**\n         * This setting controls how cascading and undetermined nodes are applied.\n         * If 'up' is in the string - cascading up is enabled, if 'down' is in the string - cascading down is enabled, if 'undetermined' is in the string - undetermined nodes will be used.\n         * If `three_state` is set to `true` this setting is automatically set to 'up+down+undetermined'. Defaults to ''.\n         * @name $.jstree.defaults.checkbox.cascade\n         * @plugin checkbox\n         */\n        cascade\t\t\t\t: '',\n        /**\n         * This setting controls if checkbox are bound to the general tree selection or to an internal array maintained by the checkbox plugin. Defaults to `true`, only set to `false` if you know exactly what you are doing.\n         * @name $.jstree.defaults.checkbox.tie_selection\n         * @plugin checkbox\n         */\n        tie_selection\t\t: true,\n\n        /**\n         * This setting controls if cascading down affects disabled checkboxes\n         * @name $.jstree.defaults.checkbox.cascade_to_disabled\n         * @plugin checkbox\n         */\n        cascade_to_disabled : true,\n\n        /**\n         * This setting controls if cascading down affects hidden checkboxes\n         * @name $.jstree.defaults.checkbox.cascade_to_hidden\n         * @plugin checkbox\n         */\n        cascade_to_hidden : true\n    };\n    $.jstree.plugins.checkbox = function (options, parent) {\n        this.bind = function () {\n            parent.bind.call(this);\n            this._data.checkbox.uto = false;\n            this._data.checkbox.selected = [];\n            if(this.settings.checkbox.three_state) {\n                this.settings.checkbox.cascade = 'up+down+undetermined';\n            }\n            this.element\n                .on(\"init.jstree\", function () {\n                    this._data.checkbox.visible = this.settings.checkbox.visible;\n                    if(!this.settings.checkbox.keep_selected_style) {\n                        this.element.addClass('jstree-checkbox-no-clicked');\n                    }\n                    if(this.settings.checkbox.tie_selection) {\n                        this.element.addClass('jstree-checkbox-selection');\n                    }\n                }.bind(this))\n                .on(\"loading.jstree\", function () {\n                    this[ this._data.checkbox.visible ? 'show_checkboxes' : 'hide_checkboxes' ]();\n                }.bind(this));\n            if(this.settings.checkbox.cascade.indexOf('undetermined') !== -1) {\n                this.element\n                    .on('changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree', function () {\n                        // only if undetermined is in setting\n                        if(this._data.checkbox.uto) { clearTimeout(this._data.checkbox.uto); }\n                        this._data.checkbox.uto = setTimeout(this._undetermined.bind(this), 50);\n                    }.bind(this));\n            }\n            if(!this.settings.checkbox.tie_selection) {\n                this.element\n                    .on('model.jstree', function (e, data) {\n                        var m = this._model.data,\n                            p = m[data.parent],\n                            dpc = data.nodes,\n                            i, j;\n                        for(i = 0, j = dpc.length; i < j; i++) {\n                            m[dpc[i]].state.checked = m[dpc[i]].state.checked || (m[dpc[i]].original && m[dpc[i]].original.state && m[dpc[i]].original.state.checked);\n                            if(m[dpc[i]].state.checked) {\n                                this._data.checkbox.selected.push(dpc[i]);\n                            }\n                        }\n                    }.bind(this));\n            }\n            if(this.settings.checkbox.cascade.indexOf('up') !== -1 || this.settings.checkbox.cascade.indexOf('down') !== -1) {\n                this.element\n                    .on('model.jstree', function (e, data) {\n                        var m = this._model.data,\n                            p = m[data.parent],\n                            dpc = data.nodes,\n                            chd = [],\n                            c, i, j, k, l, tmp, s = this.settings.checkbox.cascade, t = this.settings.checkbox.tie_selection;\n\n                        if(s.indexOf('down') !== -1) {\n                            // apply down\n                            if(p.state[ t ? 'selected' : 'checked' ]) {\n                                for(i = 0, j = dpc.length; i < j; i++) {\n                                    m[dpc[i]].state[ t ? 'selected' : 'checked' ] = true;\n                                }\n\n                                this._data[ t ? 'core' : 'checkbox' ].selected = this._data[ t ? 'core' : 'checkbox' ].selected.concat(dpc);\n                            }\n                            else {\n                                for(i = 0, j = dpc.length; i < j; i++) {\n                                    if(m[dpc[i]].state[ t ? 'selected' : 'checked' ]) {\n                                        for(k = 0, l = m[dpc[i]].children_d.length; k < l; k++) {\n                                            m[m[dpc[i]].children_d[k]].state[ t ? 'selected' : 'checked' ] = true;\n                                        }\n                                        this._data[ t ? 'core' : 'checkbox' ].selected = this._data[ t ? 'core' : 'checkbox' ].selected.concat(m[dpc[i]].children_d);\n                                    }\n                                }\n                            }\n                        }\n\n                        if(s.indexOf('up') !== -1) {\n                            // apply up\n                            for(i = 0, j = p.children_d.length; i < j; i++) {\n                                if(!m[p.children_d[i]].children.length) {\n                                    chd.push(m[p.children_d[i]].parent);\n                                }\n                            }\n                            chd = $.vakata.array_unique(chd);\n                            for(k = 0, l = chd.length; k < l; k++) {\n                                p = m[chd[k]];\n                                while(p && p.id !== $.jstree.root) {\n                                    c = 0;\n                                    for(i = 0, j = p.children.length; i < j; i++) {\n                                        c += m[p.children[i]].state[ t ? 'selected' : 'checked' ];\n                                    }\n                                    if(c === j) {\n                                        p.state[ t ? 'selected' : 'checked' ] = true;\n                                        this._data[ t ? 'core' : 'checkbox' ].selected.push(p.id);\n                                        tmp = this.get_node(p, true);\n                                        if(tmp && tmp.length) {\n                                            tmp.children('.jstree-anchor').attr('aria-selected', true).addClass( t ? 'jstree-clicked' : 'jstree-checked');\n                                        }\n                                    }\n                                    else {\n                                        break;\n                                    }\n                                    p = this.get_node(p.parent);\n                                }\n                            }\n                        }\n\n                        this._data[ t ? 'core' : 'checkbox' ].selected = $.vakata.array_unique(this._data[ t ? 'core' : 'checkbox' ].selected);\n                    }.bind(this))\n                    .on(this.settings.checkbox.tie_selection ? 'select_node.jstree' : 'check_node.jstree', function (e, data) {\n                        var self = this,\n                            obj = data.node,\n                            m = this._model.data,\n                            par = this.get_node(obj.parent),\n                            i, j, c, tmp, s = this.settings.checkbox.cascade, t = this.settings.checkbox.tie_selection,\n                            sel = {}, cur = this._data[ t ? 'core' : 'checkbox' ].selected;\n\n                        for (i = 0, j = cur.length; i < j; i++) {\n                            sel[cur[i]] = true;\n                        }\n\n                        // apply down\n                        if(s.indexOf('down') !== -1) {\n                            //this._data[ t ? 'core' : 'checkbox' ].selected = $.vakata.array_unique(this._data[ t ? 'core' : 'checkbox' ].selected.concat(obj.children_d));\n                            var selectedIds = this._cascade_new_checked_state(obj.id, true);\n                            var temp = obj.children_d.concat(obj.id);\n                            for (i = 0, j = temp.length; i < j; i++) {\n                                if (selectedIds.indexOf(temp[i]) > -1) {\n                                    sel[temp[i]] = true;\n                                }\n                                else {\n                                    delete sel[temp[i]];\n                                }\n                            }\n                        }\n\n                        // apply up\n                        if(s.indexOf('up') !== -1) {\n                            while(par && par.id !== $.jstree.root) {\n                                c = 0;\n                                for(i = 0, j = par.children.length; i < j; i++) {\n                                    c += m[par.children[i]].state[ t ? 'selected' : 'checked' ];\n                                }\n                                if(c === j) {\n                                    par.state[ t ? 'selected' : 'checked' ] = true;\n                                    sel[par.id] = true;\n                                    //this._data[ t ? 'core' : 'checkbox' ].selected.push(par.id);\n                                    tmp = this.get_node(par, true);\n                                    if(tmp && tmp.length) {\n                                        tmp.children('.jstree-anchor').attr('aria-selected', true).addClass(t ? 'jstree-clicked' : 'jstree-checked');\n                                    }\n                                }\n                                else {\n                                    break;\n                                }\n                                par = this.get_node(par.parent);\n                            }\n                        }\n\n                        cur = [];\n                        for (i in sel) {\n                            if (sel.hasOwnProperty(i)) {\n                                cur.push(i);\n                            }\n                        }\n                        this._data[ t ? 'core' : 'checkbox' ].selected = cur;\n                    }.bind(this))\n                    .on(this.settings.checkbox.tie_selection ? 'deselect_all.jstree' : 'uncheck_all.jstree', function (e, data) {\n                        var obj = this.get_node($.jstree.root),\n                            m = this._model.data,\n                            i, j, tmp;\n                        for(i = 0, j = obj.children_d.length; i < j; i++) {\n                            tmp = m[obj.children_d[i]];\n                            if(tmp && tmp.original && tmp.original.state && tmp.original.state.undetermined) {\n                                tmp.original.state.undetermined = false;\n                            }\n                        }\n                    }.bind(this))\n                    .on(this.settings.checkbox.tie_selection ? 'deselect_node.jstree' : 'uncheck_node.jstree', function (e, data) {\n                        var self = this,\n                            obj = data.node,\n                            dom = this.get_node(obj, true),\n                            i, j, tmp, s = this.settings.checkbox.cascade, t = this.settings.checkbox.tie_selection,\n                            cur = this._data[ t ? 'core' : 'checkbox' ].selected, sel = {},\n                            stillSelectedIds = [],\n                            allIds = obj.children_d.concat(obj.id);\n\n                        // apply down\n                        if(s.indexOf('down') !== -1) {\n                            var selectedIds = this._cascade_new_checked_state(obj.id, false);\n\n                            cur = $.vakata.array_filter(cur, function(id) {\n                                return allIds.indexOf(id) === -1 || selectedIds.indexOf(id) > -1;\n                            });\n                        }\n\n                        // only apply up if cascade up is enabled and if this node is not selected\n                        // (if all child nodes are disabled and cascade_to_disabled === false then this node will till be selected).\n                        if(s.indexOf('up') !== -1 && cur.indexOf(obj.id) === -1) {\n                            for(i = 0, j = obj.parents.length; i < j; i++) {\n                                tmp = this._model.data[obj.parents[i]];\n                                tmp.state[ t ? 'selected' : 'checked' ] = false;\n                                if(tmp && tmp.original && tmp.original.state && tmp.original.state.undetermined) {\n                                    tmp.original.state.undetermined = false;\n                                }\n                                tmp = this.get_node(obj.parents[i], true);\n                                if(tmp && tmp.length) {\n                                    tmp.children('.jstree-anchor').attr('aria-selected', false).removeClass(t ? 'jstree-clicked' : 'jstree-checked');\n                                }\n                            }\n\n                            cur = $.vakata.array_filter(cur, function(id) {\n                                return obj.parents.indexOf(id) === -1;\n                            });\n                        }\n\n                        this._data[ t ? 'core' : 'checkbox' ].selected = cur;\n                    }.bind(this));\n            }\n            if(this.settings.checkbox.cascade.indexOf('up') !== -1) {\n                this.element\n                    .on('delete_node.jstree', function (e, data) {\n                        // apply up (whole handler)\n                        var p = this.get_node(data.parent),\n                            m = this._model.data,\n                            i, j, c, tmp, t = this.settings.checkbox.tie_selection;\n                        while(p && p.id !== $.jstree.root && !p.state[ t ? 'selected' : 'checked' ]) {\n                            c = 0;\n                            for(i = 0, j = p.children.length; i < j; i++) {\n                                c += m[p.children[i]].state[ t ? 'selected' : 'checked' ];\n                            }\n                            if(j > 0 && c === j) {\n                                p.state[ t ? 'selected' : 'checked' ] = true;\n                                this._data[ t ? 'core' : 'checkbox' ].selected.push(p.id);\n                                tmp = this.get_node(p, true);\n                                if(tmp && tmp.length) {\n                                    tmp.children('.jstree-anchor').attr('aria-selected', true).addClass(t ? 'jstree-clicked' : 'jstree-checked');\n                                }\n                            }\n                            else {\n                                break;\n                            }\n                            p = this.get_node(p.parent);\n                        }\n                    }.bind(this))\n                    .on('move_node.jstree', function (e, data) {\n                        // apply up (whole handler)\n                        var is_multi = data.is_multi,\n                            old_par = data.old_parent,\n                            new_par = this.get_node(data.parent),\n                            m = this._model.data,\n                            p, c, i, j, tmp, t = this.settings.checkbox.tie_selection;\n                        if(!is_multi) {\n                            p = this.get_node(old_par);\n                            while(p && p.id !== $.jstree.root && !p.state[ t ? 'selected' : 'checked' ]) {\n                                c = 0;\n                                for(i = 0, j = p.children.length; i < j; i++) {\n                                    c += m[p.children[i]].state[ t ? 'selected' : 'checked' ];\n                                }\n                                if(j > 0 && c === j) {\n                                    p.state[ t ? 'selected' : 'checked' ] = true;\n                                    this._data[ t ? 'core' : 'checkbox' ].selected.push(p.id);\n                                    tmp = this.get_node(p, true);\n                                    if(tmp && tmp.length) {\n                                        tmp.children('.jstree-anchor').attr('aria-selected', true).addClass(t ? 'jstree-clicked' : 'jstree-checked');\n                                    }\n                                }\n                                else {\n                                    break;\n                                }\n                                p = this.get_node(p.parent);\n                            }\n                        }\n                        p = new_par;\n                        while(p && p.id !== $.jstree.root) {\n                            c = 0;\n                            for(i = 0, j = p.children.length; i < j; i++) {\n                                c += m[p.children[i]].state[ t ? 'selected' : 'checked' ];\n                            }\n                            if(c === j) {\n                                if(!p.state[ t ? 'selected' : 'checked' ]) {\n                                    p.state[ t ? 'selected' : 'checked' ] = true;\n                                    this._data[ t ? 'core' : 'checkbox' ].selected.push(p.id);\n                                    tmp = this.get_node(p, true);\n                                    if(tmp && tmp.length) {\n                                        tmp.children('.jstree-anchor').attr('aria-selected', true).addClass(t ? 'jstree-clicked' : 'jstree-checked');\n                                    }\n                                }\n                            }\n                            else {\n                                if(p.state[ t ? 'selected' : 'checked' ]) {\n                                    p.state[ t ? 'selected' : 'checked' ] = false;\n                                    this._data[ t ? 'core' : 'checkbox' ].selected = $.vakata.array_remove_item(this._data[ t ? 'core' : 'checkbox' ].selected, p.id);\n                                    tmp = this.get_node(p, true);\n                                    if(tmp && tmp.length) {\n                                        tmp.children('.jstree-anchor').attr('aria-selected', false).removeClass(t ? 'jstree-clicked' : 'jstree-checked');\n                                    }\n                                }\n                                else {\n                                    break;\n                                }\n                            }\n                            p = this.get_node(p.parent);\n                        }\n                    }.bind(this));\n            }\n        };\n        /**\n         * get an array of all nodes whose state is \"undetermined\"\n         * @name get_undetermined([full])\n         * @param  {boolean} full: if set to `true` the returned array will consist of the full node objects, otherwise - only IDs will be returned\n         * @return {Array}\n         * @plugin checkbox\n         */\n        this.get_undetermined = function (full) {\n            if (this.settings.checkbox.cascade.indexOf('undetermined') === -1) {\n                return [];\n            }\n            var i, j, k, l, o = {}, m = this._model.data, t = this.settings.checkbox.tie_selection, s = this._data[ t ? 'core' : 'checkbox' ].selected, p = [], tt = this, r = [];\n            for(i = 0, j = s.length; i < j; i++) {\n                if(m[s[i]] && m[s[i]].parents) {\n                    for(k = 0, l = m[s[i]].parents.length; k < l; k++) {\n                        if(o[m[s[i]].parents[k]] !== undefined) {\n                            break;\n                        }\n                        if(m[s[i]].parents[k] !== $.jstree.root) {\n                            o[m[s[i]].parents[k]] = true;\n                            p.push(m[s[i]].parents[k]);\n                        }\n                    }\n                }\n            }\n            // attempt for server side undetermined state\n            this.element.find('.jstree-closed').not(':has(.jstree-children)')\n                .each(function () {\n                    var tmp = tt.get_node(this), tmp2;\n\n                    if(!tmp) { return; }\n\n                    if(!tmp.state.loaded) {\n                        if(tmp.original && tmp.original.state && tmp.original.state.undetermined && tmp.original.state.undetermined === true) {\n                            if(o[tmp.id] === undefined && tmp.id !== $.jstree.root) {\n                                o[tmp.id] = true;\n                                p.push(tmp.id);\n                            }\n                            for(k = 0, l = tmp.parents.length; k < l; k++) {\n                                if(o[tmp.parents[k]] === undefined && tmp.parents[k] !== $.jstree.root) {\n                                    o[tmp.parents[k]] = true;\n                                    p.push(tmp.parents[k]);\n                                }\n                            }\n                        }\n                    }\n                    else {\n                        for(i = 0, j = tmp.children_d.length; i < j; i++) {\n                            tmp2 = m[tmp.children_d[i]];\n                            if(!tmp2.state.loaded && tmp2.original && tmp2.original.state && tmp2.original.state.undetermined && tmp2.original.state.undetermined === true) {\n                                if(o[tmp2.id] === undefined && tmp2.id !== $.jstree.root) {\n                                    o[tmp2.id] = true;\n                                    p.push(tmp2.id);\n                                }\n                                for(k = 0, l = tmp2.parents.length; k < l; k++) {\n                                    if(o[tmp2.parents[k]] === undefined && tmp2.parents[k] !== $.jstree.root) {\n                                        o[tmp2.parents[k]] = true;\n                                        p.push(tmp2.parents[k]);\n                                    }\n                                }\n                            }\n                        }\n                    }\n                });\n            for (i = 0, j = p.length; i < j; i++) {\n                if(!m[p[i]].state[ t ? 'selected' : 'checked' ]) {\n                    r.push(full ? m[p[i]] : p[i]);\n                }\n            }\n            return r;\n        };\n        /**\n         * set the undetermined state where and if necessary. Used internally.\n         * @private\n         * @name _undetermined()\n         * @plugin checkbox\n         */\n        this._undetermined = function () {\n            if(this.element === null) { return; }\n            var p = this.get_undetermined(false), i, j, s;\n\n            this.element.find('.jstree-undetermined').removeClass('jstree-undetermined');\n            for (i = 0, j = p.length; i < j; i++) {\n                s = this.get_node(p[i], true);\n                if(s && s.length) {\n                    s.children('.jstree-anchor').children('.jstree-checkbox').addClass('jstree-undetermined');\n                }\n            }\n        };\n        this.redraw_node = function(obj, deep, is_callback, force_render) {\n            obj = parent.redraw_node.apply(this, arguments);\n            if(obj) {\n                var i, j, tmp = null, icon = null;\n                for(i = 0, j = obj.childNodes.length; i < j; i++) {\n                    if(obj.childNodes[i] && obj.childNodes[i].className && obj.childNodes[i].className.indexOf(\"jstree-anchor\") !== -1) {\n                        tmp = obj.childNodes[i];\n                        break;\n                    }\n                }\n                if(tmp) {\n                    if(!this.settings.checkbox.tie_selection && this._model.data[obj.id].state.checked) { tmp.className += ' jstree-checked'; }\n                    icon = _i.cloneNode(false);\n                    if(this._model.data[obj.id].state.checkbox_disabled) { icon.className += ' jstree-checkbox-disabled'; }\n                    tmp.insertBefore(icon, tmp.childNodes[0]);\n                }\n            }\n            if(!is_callback && this.settings.checkbox.cascade.indexOf('undetermined') !== -1) {\n                if(this._data.checkbox.uto) { clearTimeout(this._data.checkbox.uto); }\n                this._data.checkbox.uto = setTimeout(this._undetermined.bind(this), 50);\n            }\n            return obj;\n        };\n        /**\n         * show the node checkbox icons\n         * @name show_checkboxes()\n         * @plugin checkbox\n         */\n        this.show_checkboxes = function () { this._data.core.themes.checkboxes = true; this.get_container_ul().removeClass(\"jstree-no-checkboxes\"); };\n        /**\n         * hide the node checkbox icons\n         * @name hide_checkboxes()\n         * @plugin checkbox\n         */\n        this.hide_checkboxes = function () { this._data.core.themes.checkboxes = false; this.get_container_ul().addClass(\"jstree-no-checkboxes\"); };\n        /**\n         * toggle the node icons\n         * @name toggle_checkboxes()\n         * @plugin checkbox\n         */\n        this.toggle_checkboxes = function () { if(this._data.core.themes.checkboxes) { this.hide_checkboxes(); } else { this.show_checkboxes(); } };\n        /**\n         * checks if a node is in an undetermined state\n         * @name is_undetermined(obj)\n         * @param  {mixed} obj\n         * @return {Boolean}\n         */\n        this.is_undetermined = function (obj) {\n            obj = this.get_node(obj);\n            var s = this.settings.checkbox.cascade, i, j, t = this.settings.checkbox.tie_selection, d = this._data[ t ? 'core' : 'checkbox' ].selected, m = this._model.data;\n            if(!obj || obj.state[ t ? 'selected' : 'checked' ] === true || s.indexOf('undetermined') === -1 || (s.indexOf('down') === -1 && s.indexOf('up') === -1)) {\n                return false;\n            }\n            if(!obj.state.loaded && obj.original.state.undetermined === true) {\n                return true;\n            }\n            for(i = 0, j = obj.children_d.length; i < j; i++) {\n                if($.inArray(obj.children_d[i], d) !== -1 || (!m[obj.children_d[i]].state.loaded && m[obj.children_d[i]].original.state.undetermined)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        /**\n         * disable a node's checkbox\n         * @name disable_checkbox(obj)\n         * @param {mixed} obj an array can be used too\n         * @trigger disable_checkbox.jstree\n         * @plugin checkbox\n         */\n        this.disable_checkbox = function (obj) {\n            var t1, t2, dom;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.disable_checkbox(obj[t1]);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            dom = this.get_node(obj, true);\n            if(!obj.state.checkbox_disabled) {\n                obj.state.checkbox_disabled = true;\n                if(dom && dom.length) {\n                    dom.children('.jstree-anchor').children('.jstree-checkbox').addClass('jstree-checkbox-disabled');\n                }\n                /**\n                 * triggered when an node's checkbox is disabled\n                 * @event\n                 * @name disable_checkbox.jstree\n                 * @param {Object} node\n                 * @plugin checkbox\n                 */\n                this.trigger('disable_checkbox', { 'node' : obj });\n            }\n        };\n        /**\n         * enable a node's checkbox\n         * @name enable_checkbox(obj)\n         * @param {mixed} obj an array can be used too\n         * @trigger enable_checkbox.jstree\n         * @plugin checkbox\n         */\n        this.enable_checkbox = function (obj) {\n            var t1, t2, dom;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.enable_checkbox(obj[t1]);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            dom = this.get_node(obj, true);\n            if(obj.state.checkbox_disabled) {\n                obj.state.checkbox_disabled = false;\n                if(dom && dom.length) {\n                    dom.children('.jstree-anchor').children('.jstree-checkbox').removeClass('jstree-checkbox-disabled');\n                }\n                /**\n                 * triggered when an node's checkbox is enabled\n                 * @event\n                 * @name enable_checkbox.jstree\n                 * @param {Object} node\n                 * @plugin checkbox\n                 */\n                this.trigger('enable_checkbox', { 'node' : obj });\n            }\n        };\n\n        this.activate_node = function (obj, e) {\n            if($(e.target).hasClass('jstree-checkbox-disabled')) {\n                return false;\n            }\n            if(this.settings.checkbox.tie_selection && (this.settings.checkbox.whole_node || $(e.target).hasClass('jstree-checkbox'))) {\n                e.ctrlKey = true;\n            }\n            if(this.settings.checkbox.tie_selection || (!this.settings.checkbox.whole_node && !$(e.target).hasClass('jstree-checkbox'))) {\n                return parent.activate_node.call(this, obj, e);\n            }\n            if(this.is_disabled(obj)) {\n                return false;\n            }\n            if(this.is_checked(obj)) {\n                this.uncheck_node(obj, e);\n            }\n            else {\n                this.check_node(obj, e);\n            }\n            this.trigger('activate_node', { 'node' : this.get_node(obj) });\n        };\n        this.delete_node = function (obj) {\n            if(this.settings.checkbox.tie_selection || $.vakata.is_array(obj)) {\n                return parent.delete_node.call(this, obj);\n            }\n            var tmp, k, l, c = false;\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) { return false; }\n            tmp = obj.children_d.concat([]);\n            tmp.push(obj.id);\n            for(k = 0, l = tmp.length; k < l; k++) {\n                if(this._model.data[tmp[k]].state.checked) {\n                    c = true;\n                    break;\n                }\n            }\n            if (c) {\n                this._data.checkbox.selected = $.vakata.array_filter(this._data.checkbox.selected, function (v) {\n                    return $.inArray(v, tmp) === -1;\n                });\n            }\n            return parent.delete_node.call(this, obj);\n        };\n\n        /**\n         * Cascades checked state to a node and all its descendants. This function does NOT affect hidden and disabled nodes (or their descendants).\n         * However if these unaffected nodes are already selected their ids will be included in the returned array.\n         * @private\n         * @name _cascade_new_checked_state(id, checkedState)\n         * @param {string} id the node ID\n         * @param {bool} checkedState should the nodes be checked or not\n         * @returns {Array} Array of all node id's (in this tree branch) that are checked.\n         */\n        this._cascade_new_checked_state = function (id, checkedState) {\n            var self = this;\n            var t = this.settings.checkbox.tie_selection;\n            var node = this._model.data[id];\n            var selectedNodeIds = [];\n            var selectedChildrenIds = [], i, j, selectedChildIds;\n\n            if (\n                (this.settings.checkbox.cascade_to_disabled || !node.state.disabled) &&\n                (this.settings.checkbox.cascade_to_hidden || !node.state.hidden)\n            ) {\n                //First try and check/uncheck the children\n                if (node.children) {\n                    for (i = 0, j = node.children.length; i < j; i++) {\n                        var childId = node.children[i];\n                        selectedChildIds = self._cascade_new_checked_state(childId, checkedState);\n                        selectedNodeIds = selectedNodeIds.concat(selectedChildIds);\n                        if (selectedChildIds.indexOf(childId) > -1) {\n                            selectedChildrenIds.push(childId);\n                        }\n                    }\n                }\n\n                var dom = self.get_node(node, true);\n\n                //A node's state is undetermined if some but not all of it's children are checked/selected .\n                var undetermined = selectedChildrenIds.length > 0 && selectedChildrenIds.length < node.children.length;\n\n                if(node.original && node.original.state && node.original.state.undetermined) {\n                    node.original.state.undetermined = undetermined;\n                }\n\n                //If a node is undetermined then remove selected class\n                if (undetermined) {\n                    node.state[ t ? 'selected' : 'checked' ] = false;\n                    dom.children('.jstree-anchor').attr('aria-selected', false).removeClass(t ? 'jstree-clicked' : 'jstree-checked');\n                }\n                    //Otherwise, if the checkedState === true (i.e. the node is being checked now) and all of the node's children are checked (if it has any children),\n                //check the node and style it correctly.\n                else if (checkedState && selectedChildrenIds.length === node.children.length) {\n                    node.state[ t ? 'selected' : 'checked' ] = checkedState;\n                    selectedNodeIds.push(node.id);\n\n                    dom.children('.jstree-anchor').attr('aria-selected', true).addClass(t ? 'jstree-clicked' : 'jstree-checked');\n                }\n                else {\n                    node.state[ t ? 'selected' : 'checked' ] = false;\n                    dom.children('.jstree-anchor').attr('aria-selected', false).removeClass(t ? 'jstree-clicked' : 'jstree-checked');\n                }\n            }\n            else {\n                selectedChildIds = this.get_checked_descendants(id);\n\n                if (node.state[ t ? 'selected' : 'checked' ]) {\n                    selectedChildIds.push(node.id);\n                }\n\n                selectedNodeIds = selectedNodeIds.concat(selectedChildIds);\n            }\n\n            return selectedNodeIds;\n        };\n\n        /**\n         * Gets ids of nodes selected in branch (of tree) specified by id (does not include the node specified by id)\n         * @name get_checked_descendants(obj)\n         * @param {string} id the node ID\n         * @return {Array} array of IDs\n         * @plugin checkbox\n         */\n        this.get_checked_descendants = function (id) {\n            var self = this;\n            var t = self.settings.checkbox.tie_selection;\n            var node = self._model.data[id];\n\n            return $.vakata.array_filter(node.children_d, function(_id) {\n                return self._model.data[_id].state[ t ? 'selected' : 'checked' ];\n            });\n        };\n\n        /**\n         * check a node (only if tie_selection in checkbox settings is false, otherwise select_node will be called internally)\n         * @name check_node(obj)\n         * @param {mixed} obj an array can be used to check multiple nodes\n         * @trigger check_node.jstree\n         * @plugin checkbox\n         */\n        this.check_node = function (obj, e) {\n            if(this.settings.checkbox.tie_selection) { return this.select_node(obj, false, true, e); }\n            var dom, t1, t2, th;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.check_node(obj[t1], e);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            dom = this.get_node(obj, true);\n            if(!obj.state.checked) {\n                obj.state.checked = true;\n                this._data.checkbox.selected.push(obj.id);\n                if(dom && dom.length) {\n                    dom.children('.jstree-anchor').addClass('jstree-checked');\n                }\n                /**\n                 * triggered when an node is checked (only if tie_selection in checkbox settings is false)\n                 * @event\n                 * @name check_node.jstree\n                 * @param {Object} node\n                 * @param {Array} selected the current selection\n                 * @param {Object} event the event (if any) that triggered this check_node\n                 * @plugin checkbox\n                 */\n                this.trigger('check_node', { 'node' : obj, 'selected' : this._data.checkbox.selected, 'event' : e });\n            }\n        };\n        /**\n         * uncheck a node (only if tie_selection in checkbox settings is false, otherwise deselect_node will be called internally)\n         * @name uncheck_node(obj)\n         * @param {mixed} obj an array can be used to uncheck multiple nodes\n         * @trigger uncheck_node.jstree\n         * @plugin checkbox\n         */\n        this.uncheck_node = function (obj, e) {\n            if(this.settings.checkbox.tie_selection) { return this.deselect_node(obj, false, e); }\n            var t1, t2, dom;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.uncheck_node(obj[t1], e);\n                }\n                return true;\n            }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) {\n                return false;\n            }\n            dom = this.get_node(obj, true);\n            if(obj.state.checked) {\n                obj.state.checked = false;\n                this._data.checkbox.selected = $.vakata.array_remove_item(this._data.checkbox.selected, obj.id);\n                if(dom.length) {\n                    dom.children('.jstree-anchor').removeClass('jstree-checked');\n                }\n                /**\n                 * triggered when an node is unchecked (only if tie_selection in checkbox settings is false)\n                 * @event\n                 * @name uncheck_node.jstree\n                 * @param {Object} node\n                 * @param {Array} selected the current selection\n                 * @param {Object} event the event (if any) that triggered this uncheck_node\n                 * @plugin checkbox\n                 */\n                this.trigger('uncheck_node', { 'node' : obj, 'selected' : this._data.checkbox.selected, 'event' : e });\n            }\n        };\n\n        /**\n         * checks all nodes in the tree (only if tie_selection in checkbox settings is false, otherwise select_all will be called internally)\n         * @name check_all()\n         * @trigger check_all.jstree, changed.jstree\n         * @plugin checkbox\n         */\n        this.check_all = function () {\n            if(this.settings.checkbox.tie_selection) { return this.select_all(); }\n            var tmp = this._data.checkbox.selected.concat([]), i, j;\n            this._data.checkbox.selected = this._model.data[$.jstree.root].children_d.concat();\n            for(i = 0, j = this._data.checkbox.selected.length; i < j; i++) {\n                if(this._model.data[this._data.checkbox.selected[i]]) {\n                    this._model.data[this._data.checkbox.selected[i]].state.checked = true;\n                }\n            }\n            this.redraw(true);\n            /**\n             * triggered when all nodes are checked (only if tie_selection in checkbox settings is false)\n             * @event\n             * @name check_all.jstree\n             * @param {Array} selected the current selection\n             * @plugin checkbox\n             */\n            this.trigger('check_all', { 'selected' : this._data.checkbox.selected });\n        };\n        /**\n         * uncheck all checked nodes (only if tie_selection in checkbox settings is false, otherwise deselect_all will be called internally)\n         * @name uncheck_all()\n         * @trigger uncheck_all.jstree\n         * @plugin checkbox\n         */\n        this.uncheck_all = function () {\n            if(this.settings.checkbox.tie_selection) { return this.deselect_all(); }\n            var tmp = this._data.checkbox.selected.concat([]), i, j;\n            for(i = 0, j = this._data.checkbox.selected.length; i < j; i++) {\n                if(this._model.data[this._data.checkbox.selected[i]]) {\n                    this._model.data[this._data.checkbox.selected[i]].state.checked = false;\n                }\n            }\n            this._data.checkbox.selected = [];\n            this.element.find('.jstree-checked').removeClass('jstree-checked');\n            /**\n             * triggered when all nodes are unchecked (only if tie_selection in checkbox settings is false)\n             * @event\n             * @name uncheck_all.jstree\n             * @param {Object} node the previous selection\n             * @param {Array} selected the current selection\n             * @plugin checkbox\n             */\n            this.trigger('uncheck_all', { 'selected' : this._data.checkbox.selected, 'node' : tmp });\n        };\n        /**\n         * checks if a node is checked (if tie_selection is on in the settings this function will return the same as is_selected)\n         * @name is_checked(obj)\n         * @param  {mixed}  obj\n         * @return {Boolean}\n         * @plugin checkbox\n         */\n        this.is_checked = function (obj) {\n            if(this.settings.checkbox.tie_selection) { return this.is_selected(obj); }\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) { return false; }\n            return obj.state.checked;\n        };\n        /**\n         * get an array of all checked nodes (if tie_selection is on in the settings this function will return the same as get_selected)\n         * @name get_checked([full])\n         * @param  {mixed}  full if set to `true` the returned array will consist of the full node objects, otherwise - only IDs will be returned\n         * @return {Array}\n         * @plugin checkbox\n         */\n        this.get_checked = function (full) {\n            if(this.settings.checkbox.tie_selection) { return this.get_selected(full); }\n            return full ? $.map(this._data.checkbox.selected, function (i) { return this.get_node(i); }.bind(this)) : this._data.checkbox.selected.slice();\n        };\n        /**\n         * get an array of all top level checked nodes (ignoring children of checked nodes) (if tie_selection is on in the settings this function will return the same as get_top_selected)\n         * @name get_top_checked([full])\n         * @param  {mixed}  full if set to `true` the returned array will consist of the full node objects, otherwise - only IDs will be returned\n         * @return {Array}\n         * @plugin checkbox\n         */\n        this.get_top_checked = function (full) {\n            if(this.settings.checkbox.tie_selection) { return this.get_top_selected(full); }\n            var tmp = this.get_checked(true),\n                obj = {}, i, j, k, l;\n            for(i = 0, j = tmp.length; i < j; i++) {\n                obj[tmp[i].id] = tmp[i];\n            }\n            for(i = 0, j = tmp.length; i < j; i++) {\n                for(k = 0, l = tmp[i].children_d.length; k < l; k++) {\n                    if(obj[tmp[i].children_d[k]]) {\n                        delete obj[tmp[i].children_d[k]];\n                    }\n                }\n            }\n            tmp = [];\n            for(i in obj) {\n                if(obj.hasOwnProperty(i)) {\n                    tmp.push(i);\n                }\n            }\n            return full ? $.map(tmp, function (i) { return this.get_node(i); }.bind(this)) : tmp;\n        };\n        /**\n         * get an array of all bottom level checked nodes (ignoring selected parents) (if tie_selection is on in the settings this function will return the same as get_bottom_selected)\n         * @name get_bottom_checked([full])\n         * @param  {mixed}  full if set to `true` the returned array will consist of the full node objects, otherwise - only IDs will be returned\n         * @return {Array}\n         * @plugin checkbox\n         */\n        this.get_bottom_checked = function (full) {\n            if(this.settings.checkbox.tie_selection) { return this.get_bottom_selected(full); }\n            var tmp = this.get_checked(true),\n                obj = [], i, j;\n            for(i = 0, j = tmp.length; i < j; i++) {\n                if(!tmp[i].children.length) {\n                    obj.push(tmp[i].id);\n                }\n            }\n            return full ? $.map(obj, function (i) { return this.get_node(i); }.bind(this)) : obj;\n        };\n        this.load_node = function (obj, callback) {\n            var k, l, i, j, c, tmp;\n            if(!$.vakata.is_array(obj) && !this.settings.checkbox.tie_selection) {\n                tmp = this.get_node(obj);\n                if(tmp && tmp.state.loaded) {\n                    for(k = 0, l = tmp.children_d.length; k < l; k++) {\n                        if(this._model.data[tmp.children_d[k]].state.checked) {\n                            c = true;\n                            this._data.checkbox.selected = $.vakata.array_remove_item(this._data.checkbox.selected, tmp.children_d[k]);\n                        }\n                    }\n                }\n            }\n            return parent.load_node.apply(this, arguments);\n        };\n        this.get_state = function () {\n            var state = parent.get_state.apply(this, arguments);\n            if(this.settings.checkbox.tie_selection) { return state; }\n            state.checkbox = this._data.checkbox.selected.slice();\n            return state;\n        };\n        this.set_state = function (state, callback) {\n            var res = parent.set_state.apply(this, arguments);\n            if(res && state.checkbox) {\n                if(!this.settings.checkbox.tie_selection) {\n                    this.uncheck_all();\n                    var _this = this;\n                    $.each(state.checkbox, function (i, v) {\n                        _this.check_node(v);\n                    });\n                }\n                delete state.checkbox;\n                this.set_state(state, callback);\n                return false;\n            }\n            return res;\n        };\n        this.refresh = function (skip_loading, forget_state) {\n            if(this.settings.checkbox.tie_selection) {\n                this._data.checkbox.selected = [];\n            }\n            return parent.refresh.apply(this, arguments);\n        };\n    };\n\n    // include the checkbox plugin by default\n    // $.jstree.defaults.plugins.push(\"checkbox\");\n\n\n    /**\n     * ### Conditionalselect plugin\n     *\n     * This plugin allows defining a callback to allow or deny node selection by user input (activate node method).\n     */\n\n    /**\n     * a callback (function) which is invoked in the instance's scope and receives two arguments - the node and the event that triggered the `activate_node` call. Returning false prevents working with the node, returning true allows invoking activate_node. Defaults to returning `true`.\n     * @name $.jstree.defaults.checkbox.visible\n     * @plugin checkbox\n     */\n    $.jstree.defaults.conditionalselect = function () { return true; };\n    $.jstree.plugins.conditionalselect = function (options, parent) {\n        // own function\n        this.activate_node = function (obj, e) {\n            if(this.settings.conditionalselect.call(this, this.get_node(obj), e)) {\n                return parent.activate_node.call(this, obj, e);\n            }\n        };\n    };\n\n\n    /**\n     * ### Contextmenu plugin\n     *\n     * Shows a context menu when a node is right-clicked.\n     */\n\n    /**\n     * stores all defaults for the contextmenu plugin\n     * @name $.jstree.defaults.contextmenu\n     * @plugin contextmenu\n     */\n    $.jstree.defaults.contextmenu = {\n        /**\n         * a boolean indicating if the node should be selected when the context menu is invoked on it. Defaults to `true`.\n         * @name $.jstree.defaults.contextmenu.select_node\n         * @plugin contextmenu\n         */\n        select_node : true,\n        /**\n         * a boolean indicating if the menu should be shown aligned with the node. Defaults to `true`, otherwise the mouse coordinates are used.\n         * @name $.jstree.defaults.contextmenu.show_at_node\n         * @plugin contextmenu\n         */\n        show_at_node : true,\n        /**\n         * an object of actions, or a function that accepts a node and a callback function and calls the callback function with an object of actions available for that node (you can also return the items too).\n         *\n         * Each action consists of a key (a unique name) and a value which is an object with the following properties (only label and action are required). Once a menu item is activated the `action` function will be invoked with an object containing the following keys: item - the contextmenu item definition as seen below, reference - the DOM node that was used (the tree node), element - the contextmenu DOM element, position - an object with x/y properties indicating the position of the menu.\n         *\n         * * `separator_before` - a boolean indicating if there should be a separator before this item\n         * * `separator_after` - a boolean indicating if there should be a separator after this item\n         * * `_disabled` - a boolean indicating if this action should be disabled\n         * * `label` - a string - the name of the action (could be a function returning a string)\n         * * `title` - a string - an optional tooltip for the item\n         * * `action` - a function to be executed if this item is chosen, the function will receive\n         * * `icon` - a string, can be a path to an icon or a className, if using an image that is in the current directory use a `./` prefix, otherwise it will be detected as a class\n         * * `shortcut` - keyCode which will trigger the action if the menu is open (for example `113` for rename, which equals F2)\n         * * `shortcut_label` - shortcut label (like for example `F2` for rename)\n         * * `submenu` - an object with the same structure as $.jstree.defaults.contextmenu.items which can be used to create a submenu - each key will be rendered as a separate option in a submenu that will appear once the current item is hovered\n         *\n         * @name $.jstree.defaults.contextmenu.items\n         * @plugin contextmenu\n         */\n        items : function (o, cb) { // Could be an object directly\n            return {\n                \"create\" : {\n                    \"separator_before\"\t: false,\n                    \"separator_after\"\t: true,\n                    \"_disabled\"\t\t\t: false, //(this.check(\"create_node\", data.reference, {}, \"last\")),\n                    \"label\"\t\t\t\t: \"Create\",\n                    \"action\"\t\t\t: function (data) {\n                        var inst = $.jstree.reference(data.reference),\n                            obj = inst.get_node(data.reference);\n                        inst.create_node(obj, {}, \"last\", function (new_node) {\n                            try {\n                                inst.edit(new_node);\n                            } catch (ex) {\n                                setTimeout(function () { inst.edit(new_node); },0);\n                            }\n                        });\n                    }\n                },\n                \"rename\" : {\n                    \"separator_before\"\t: false,\n                    \"separator_after\"\t: false,\n                    \"_disabled\"\t\t\t: false, //(this.check(\"rename_node\", data.reference, this.get_parent(data.reference), \"\")),\n                    \"label\"\t\t\t\t: \"Rename\",\n                    /*!\n\t\t\t\t\t\"shortcut\"\t\t\t: 113,\n\t\t\t\t\t\"shortcut_label\"\t: 'F2',\n\t\t\t\t\t\"icon\"\t\t\t\t: \"glyphicon glyphicon-leaf\",\n\t\t\t\t\t*/\n                    \"action\"\t\t\t: function (data) {\n                        var inst = $.jstree.reference(data.reference),\n                            obj = inst.get_node(data.reference);\n                        inst.edit(obj);\n                    }\n                },\n                \"remove\" : {\n                    \"separator_before\"\t: false,\n                    \"icon\"\t\t\t\t: false,\n                    \"separator_after\"\t: false,\n                    \"_disabled\"\t\t\t: false, //(this.check(\"delete_node\", data.reference, this.get_parent(data.reference), \"\")),\n                    \"label\"\t\t\t\t: \"Delete\",\n                    \"action\"\t\t\t: function (data) {\n                        var inst = $.jstree.reference(data.reference),\n                            obj = inst.get_node(data.reference);\n                        if(inst.is_selected(obj)) {\n                            inst.delete_node(inst.get_selected());\n                        }\n                        else {\n                            inst.delete_node(obj);\n                        }\n                    }\n                },\n                \"ccp\" : {\n                    \"separator_before\"\t: true,\n                    \"icon\"\t\t\t\t: false,\n                    \"separator_after\"\t: false,\n                    \"label\"\t\t\t\t: \"Edit\",\n                    \"action\"\t\t\t: false,\n                    \"submenu\" : {\n                        \"cut\" : {\n                            \"separator_before\"\t: false,\n                            \"separator_after\"\t: false,\n                            \"label\"\t\t\t\t: \"Cut\",\n                            \"action\"\t\t\t: function (data) {\n                                var inst = $.jstree.reference(data.reference),\n                                    obj = inst.get_node(data.reference);\n                                if(inst.is_selected(obj)) {\n                                    inst.cut(inst.get_top_selected());\n                                }\n                                else {\n                                    inst.cut(obj);\n                                }\n                            }\n                        },\n                        \"copy\" : {\n                            \"separator_before\"\t: false,\n                            \"icon\"\t\t\t\t: false,\n                            \"separator_after\"\t: false,\n                            \"label\"\t\t\t\t: \"Copy\",\n                            \"action\"\t\t\t: function (data) {\n                                var inst = $.jstree.reference(data.reference),\n                                    obj = inst.get_node(data.reference);\n                                if(inst.is_selected(obj)) {\n                                    inst.copy(inst.get_top_selected());\n                                }\n                                else {\n                                    inst.copy(obj);\n                                }\n                            }\n                        },\n                        \"paste\" : {\n                            \"separator_before\"\t: false,\n                            \"icon\"\t\t\t\t: false,\n                            \"_disabled\"\t\t\t: function (data) {\n                                return !$.jstree.reference(data.reference).can_paste();\n                            },\n                            \"separator_after\"\t: false,\n                            \"label\"\t\t\t\t: \"Paste\",\n                            \"action\"\t\t\t: function (data) {\n                                var inst = $.jstree.reference(data.reference),\n                                    obj = inst.get_node(data.reference);\n                                inst.paste(obj);\n                            }\n                        }\n                    }\n                }\n            };\n        }\n    };\n\n    $.jstree.plugins.contextmenu = function (options, parent) {\n        this.bind = function () {\n            parent.bind.call(this);\n\n            var last_ts = 0, cto = null, ex, ey;\n            this.element\n                .on(\"init.jstree loading.jstree ready.jstree\", function () {\n                    this.get_container_ul().addClass('jstree-contextmenu');\n                }.bind(this))\n                .on(\"contextmenu.jstree\", \".jstree-anchor\", function (e, data) {\n                    if (e.target.tagName.toLowerCase() === 'input') {\n                        return;\n                    }\n                    e.preventDefault();\n                    last_ts = e.ctrlKey ? +new Date() : 0;\n                    if(data || cto) {\n                        last_ts = (+new Date()) + 10000;\n                    }\n                    if(cto) {\n                        clearTimeout(cto);\n                    }\n                    if(!this.is_loading(e.currentTarget)) {\n                        this.show_contextmenu(e.currentTarget, e.pageX, e.pageY, e);\n                    }\n                }.bind(this))\n                .on(\"click.jstree\", \".jstree-anchor\", function (e) {\n                    if(this._data.contextmenu.visible && (!last_ts || (+new Date()) - last_ts > 250)) { // work around safari & macOS ctrl+click\n                        $.vakata.context.hide();\n                    }\n                    last_ts = 0;\n                }.bind(this))\n                .on(\"touchstart.jstree\", \".jstree-anchor\", function (e) {\n                    if(!e.originalEvent || !e.originalEvent.changedTouches || !e.originalEvent.changedTouches[0]) {\n                        return;\n                    }\n                    ex = e.originalEvent.changedTouches[0].clientX;\n                    ey = e.originalEvent.changedTouches[0].clientY;\n                    cto = setTimeout(function () {\n                        $(e.currentTarget).trigger('contextmenu', true);\n                    }, 750);\n                })\n                .on('touchmove.vakata.jstree', function (e) {\n                    if(cto && e.originalEvent && e.originalEvent.changedTouches && e.originalEvent.changedTouches[0] && (Math.abs(ex - e.originalEvent.changedTouches[0].clientX) > 10 || Math.abs(ey - e.originalEvent.changedTouches[0].clientY) > 10)) {\n                        clearTimeout(cto);\n                        $.vakata.context.hide();\n                    }\n                })\n                .on('touchend.vakata.jstree', function (e) {\n                    if(cto) {\n                        clearTimeout(cto);\n                    }\n                });\n\n            /*!\n\t\t\tif(!('oncontextmenu' in document.body) && ('ontouchstart' in document.body)) {\n\t\t\t\tvar el = null, tm = null;\n\t\t\t\tthis.element\n\t\t\t\t\t.on(\"touchstart\", \".jstree-anchor\", function (e) {\n\t\t\t\t\t\tel = e.currentTarget;\n\t\t\t\t\t\ttm = +new Date();\n\t\t\t\t\t\t$(document).one(\"touchend\", function (e) {\n\t\t\t\t\t\t\te.target = document.elementFromPoint(e.originalEvent.targetTouches[0].pageX - window.pageXOffset, e.originalEvent.targetTouches[0].pageY - window.pageYOffset);\n\t\t\t\t\t\t\te.currentTarget = e.target;\n\t\t\t\t\t\t\ttm = ((+(new Date())) - tm);\n\t\t\t\t\t\t\tif(e.target === el && tm > 600 && tm < 1000) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t$(el).trigger('contextmenu', e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tel = null;\n\t\t\t\t\t\t\ttm = null;\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t}\n\t\t\t*/\n            $(document).on(\"context_hide.vakata.jstree\", function (e, data) {\n                this._data.contextmenu.visible = false;\n                $(data.reference).removeClass('jstree-context');\n            }.bind(this));\n        };\n        this.teardown = function () {\n            if(this._data.contextmenu.visible) {\n                $.vakata.context.hide();\n            }\n            $(document).off(\"context_hide.vakata.jstree\");\n            parent.teardown.call(this);\n        };\n\n        /**\n         * prepare and show the context menu for a node\n         * @name show_contextmenu(obj [, x, y])\n         * @param {mixed} obj the node\n         * @param {Number} x the x-coordinate relative to the document to show the menu at\n         * @param {Number} y the y-coordinate relative to the document to show the menu at\n         * @param {Object} e the event if available that triggered the contextmenu\n         * @plugin contextmenu\n         * @trigger show_contextmenu.jstree\n         */\n        this.show_contextmenu = function (obj, x, y, e) {\n            obj = this.get_node(obj);\n            if(!obj || obj.id === $.jstree.root) { return false; }\n            var s = this.settings.contextmenu,\n                d = this.get_node(obj, true),\n                a = d.children(\".jstree-anchor\"),\n                o = false,\n                i = false;\n            if(s.show_at_node || x === undefined || y === undefined) {\n                o = a.offset();\n                x = o.left;\n                y = o.top + this._data.core.li_height;\n            }\n            if(this.settings.contextmenu.select_node && !this.is_selected(obj)) {\n                this.activate_node(obj, e);\n            }\n\n            i = s.items;\n            if($.vakata.is_function(i)) {\n                i = i.call(this, obj, function (i) {\n                    this._show_contextmenu(obj, x, y, i);\n                }.bind(this));\n            }\n            if($.isPlainObject(i)) {\n                this._show_contextmenu(obj, x, y, i);\n            }\n        };\n        /**\n         * show the prepared context menu for a node\n         * @name _show_contextmenu(obj, x, y, i)\n         * @param {mixed} obj the node\n         * @param {Number} x the x-coordinate relative to the document to show the menu at\n         * @param {Number} y the y-coordinate relative to the document to show the menu at\n         * @param {Number} i the object of items to show\n         * @plugin contextmenu\n         * @trigger show_contextmenu.jstree\n         * @private\n         */\n        this._show_contextmenu = function (obj, x, y, i) {\n            var d = this.get_node(obj, true),\n                a = d.children(\".jstree-anchor\");\n            $(document).one(\"context_show.vakata.jstree\", function (e, data) {\n                var cls = 'jstree-contextmenu jstree-' + this.get_theme() + '-contextmenu';\n                $(data.element).addClass(cls);\n                a.addClass('jstree-context');\n            }.bind(this));\n            this._data.contextmenu.visible = true;\n            $.vakata.context.show(a, { 'x' : x, 'y' : y }, i);\n            /**\n             * triggered when the contextmenu is shown for a node\n             * @event\n             * @name show_contextmenu.jstree\n             * @param {Object} node the node\n             * @param {Number} x the x-coordinate of the menu relative to the document\n             * @param {Number} y the y-coordinate of the menu relative to the document\n             * @plugin contextmenu\n             */\n            this.trigger('show_contextmenu', { \"node\" : obj, \"x\" : x, \"y\" : y });\n        };\n    };\n\n    // contextmenu helper\n    (function ($) {\n        var right_to_left = false,\n            vakata_context = {\n                element\t\t: false,\n                reference\t: false,\n                position_x\t: 0,\n                position_y\t: 0,\n                items\t\t: [],\n                html\t\t: \"\",\n                is_visible\t: false\n            };\n\n        $.vakata.context = {\n            settings : {\n                hide_onmouseleave\t: 0,\n                icons\t\t\t\t: true\n            },\n            _trigger : function (event_name) {\n                $(document).triggerHandler(\"context_\" + event_name + \".vakata\", {\n                    \"reference\"\t: vakata_context.reference,\n                    \"element\"\t: vakata_context.element,\n                    \"position\"\t: {\n                        \"x\" : vakata_context.position_x,\n                        \"y\" : vakata_context.position_y\n                    }\n                });\n            },\n            _execute : function (i) {\n                i = vakata_context.items[i];\n                return i && (!i._disabled || ($.vakata.is_function(i._disabled) && !i._disabled({ \"item\" : i, \"reference\" : vakata_context.reference, \"element\" : vakata_context.element }))) && i.action ? i.action.call(null, {\n                    \"item\"\t\t: i,\n                    \"reference\"\t: vakata_context.reference,\n                    \"element\"\t: vakata_context.element,\n                    \"position\"\t: {\n                        \"x\" : vakata_context.position_x,\n                        \"y\" : vakata_context.position_y\n                    }\n                }) : false;\n            },\n            _parse : function (o, is_callback) {\n                if(!o) { return false; }\n                if(!is_callback) {\n                    vakata_context.html\t\t= \"\";\n                    vakata_context.items\t= [];\n                }\n                var str = \"\",\n                    sep = false,\n                    tmp;\n\n                if(is_callback) { str += \"<\"+\"ul>\"; }\n                $.each(o, function (i, val) {\n                    if(!val) { return true; }\n                    vakata_context.items.push(val);\n                    if(!sep && val.separator_before) {\n                        str += \"<\"+\"li class='vakata-context-separator'><\"+\"a href='#' \" + ($.vakata.context.settings.icons ? '' : 'class=\"vakata-context-no-icons\"') + \">&#160;<\"+\"/a><\"+\"/li>\";\n                    }\n                    sep = false;\n                    str += \"<\"+\"li class='\" + (val._class || \"\") + (val._disabled === true || ($.vakata.is_function(val._disabled) && val._disabled({ \"item\" : val, \"reference\" : vakata_context.reference, \"element\" : vakata_context.element })) ? \" vakata-contextmenu-disabled \" : \"\") + \"' \"+(val.shortcut?\" data-shortcut='\"+val.shortcut+\"' \":'')+\">\";\n                    str += \"<\"+\"a href='#' rel='\" + (vakata_context.items.length - 1) + \"' \" + (val.title ? \"title='\" + val.title + \"'\" : \"\") + \">\";\n                    if($.vakata.context.settings.icons) {\n                        str += \"<\"+\"i \";\n                        if(val.icon) {\n                            if(val.icon.indexOf(\"/\") !== -1 || val.icon.indexOf(\".\") !== -1) { str += \" style='background:url(\\\"\" + val.icon + \"\\\") center center no-repeat' \"; }\n                            else { str += \" class='\" + val.icon + \"' \"; }\n                        }\n                        str += \"><\"+\"/i><\"+\"span class='vakata-contextmenu-sep'>&#160;<\"+\"/span>\";\n                    }\n                    str += ($.vakata.is_function(val.label) ? val.label({ \"item\" : i, \"reference\" : vakata_context.reference, \"element\" : vakata_context.element }) : val.label) + (val.shortcut?' <span class=\"vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+val.shortcut+'\">'+ (val.shortcut_label || '') +'</span>':'') + \"<\"+\"/a>\";\n                    if(val.submenu) {\n                        tmp = $.vakata.context._parse(val.submenu, true);\n                        if(tmp) { str += tmp; }\n                    }\n                    str += \"<\"+\"/li>\";\n                    if(val.separator_after) {\n                        str += \"<\"+\"li class='vakata-context-separator'><\"+\"a href='#' \" + ($.vakata.context.settings.icons ? '' : 'class=\"vakata-context-no-icons\"') + \">&#160;<\"+\"/a><\"+\"/li>\";\n                        sep = true;\n                    }\n                });\n                str  = str.replace(/<li class\\='vakata-context-separator'\\><\\/li\\>$/,\"\");\n                if(is_callback) { str += \"</ul>\"; }\n                /**\n                 * triggered on the document when the contextmenu is parsed (HTML is built)\n                 * @event\n                 * @plugin contextmenu\n                 * @name context_parse.vakata\n                 * @param {jQuery} reference the element that was right clicked\n                 * @param {jQuery} element the DOM element of the menu itself\n                 * @param {Object} position the x & y coordinates of the menu\n                 */\n                if(!is_callback) { vakata_context.html = str; $.vakata.context._trigger(\"parse\"); }\n                return str.length > 10 ? str : false;\n            },\n            _show_submenu : function (o) {\n                o = $(o);\n                if(!o.length || !o.children(\"ul\").length) { return; }\n                var e = o.children(\"ul\"),\n                    xl = o.offset().left,\n                    x = xl + o.outerWidth(),\n                    y = o.offset().top,\n                    w = e.width(),\n                    h = e.height(),\n                    dw = $(window).width() + $(window).scrollLeft(),\n                    dh = $(window).height() + $(window).scrollTop();\n                // \u043c\u043e\u0436\u0435 \u0434\u0430 \u0441\u0435 \u0441\u043f\u0435\u0441\u0442\u0438 \u0435 \u0435\u0434\u043d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 - \u0434\u0430\u043b\u0438 \u043d\u044f\u043c\u0430 \u043d\u044f\u043a\u043e\u0439 \u043e\u0442 \u043a\u043b\u0430\u0441\u043e\u0432\u0435\u0442\u0435 \u0432\u0435\u0447\u0435 \u043d\u0430\u0433\u043e\u0440\u0435\n                if(right_to_left) {\n                    o[x - (w + 10 + o.outerWidth()) < 0 ? \"addClass\" : \"removeClass\"](\"vakata-context-left\");\n                }\n                else {\n                    o[x + w > dw  && xl > dw - x ? \"addClass\" : \"removeClass\"](\"vakata-context-right\");\n                }\n                if(y + h + 10 > dh) {\n                    e.css(\"bottom\",\"-1px\");\n                }\n\n                //if does not fit - stick it to the side\n                if (o.hasClass('vakata-context-right')) {\n                    if (xl < w) {\n                        e.css(\"margin-right\", xl - w);\n                    }\n                } else {\n                    if (dw - x < w) {\n                        e.css(\"margin-left\", dw - x - w);\n                    }\n                }\n\n                e.show();\n            },\n            show : function (reference, position, data) {\n                var o, e, x, y, w, h, dw, dh, cond = true;\n                if(vakata_context.element && vakata_context.element.length) {\n                    vakata_context.element.width('');\n                }\n                switch(cond) {\n                    case (!position && !reference):\n                        return false;\n                    case (!!position && !!reference):\n                        vakata_context.reference\t= reference;\n                        vakata_context.position_x\t= position.x;\n                        vakata_context.position_y\t= position.y;\n                        break;\n                    case (!position && !!reference):\n                        vakata_context.reference\t= reference;\n                        o = reference.offset();\n                        vakata_context.position_x\t= o.left + reference.outerHeight();\n                        vakata_context.position_y\t= o.top;\n                        break;\n                    case (!!position && !reference):\n                        vakata_context.position_x\t= position.x;\n                        vakata_context.position_y\t= position.y;\n                        break;\n                }\n                if(!!reference && !data && $(reference).data('vakata_contextmenu')) {\n                    data = $(reference).data('vakata_contextmenu');\n                }\n                if($.vakata.context._parse(data)) {\n                    vakata_context.element.html(vakata_context.html);\n                }\n                if(vakata_context.items.length) {\n                    vakata_context.element.appendTo(document.body);\n                    e = vakata_context.element;\n                    x = vakata_context.position_x;\n                    y = vakata_context.position_y;\n                    w = e.width();\n                    h = e.height();\n                    dw = $(window).width() + $(window).scrollLeft();\n                    dh = $(window).height() + $(window).scrollTop();\n                    if(right_to_left) {\n                        x -= (e.outerWidth() - $(reference).outerWidth());\n                        if(x < $(window).scrollLeft() + 20) {\n                            x = $(window).scrollLeft() + 20;\n                        }\n                    }\n                    if(x + w + 20 > dw) {\n                        x = dw - (w + 20);\n                    }\n                    if(y + h + 20 > dh) {\n                        y = dh - (h + 20);\n                    }\n\n                    vakata_context.element\n                        .css({ \"left\" : x, \"top\" : y })\n                        .show()\n                        .find('a').first().trigger('focus').parent().addClass(\"vakata-context-hover\");\n                    vakata_context.is_visible = true;\n                    /**\n                     * triggered on the document when the contextmenu is shown\n                     * @event\n                     * @plugin contextmenu\n                     * @name context_show.vakata\n                     * @param {jQuery} reference the element that was right clicked\n                     * @param {jQuery} element the DOM element of the menu itself\n                     * @param {Object} position the x & y coordinates of the menu\n                     */\n                    $.vakata.context._trigger(\"show\");\n                }\n            },\n            hide : function () {\n                if(vakata_context.is_visible) {\n                    vakata_context.element.hide().find(\"ul\").hide().end().find(':focus').trigger('blur').end().detach();\n                    vakata_context.is_visible = false;\n                    /**\n                     * triggered on the document when the contextmenu is hidden\n                     * @event\n                     * @plugin contextmenu\n                     * @name context_hide.vakata\n                     * @param {jQuery} reference the element that was right clicked\n                     * @param {jQuery} element the DOM element of the menu itself\n                     * @param {Object} position the x & y coordinates of the menu\n                     */\n                    $.vakata.context._trigger(\"hide\");\n                }\n            }\n        };\n        $(function () {\n            right_to_left = $(document.body).css(\"direction\") === \"rtl\";\n            var to = false;\n\n            vakata_context.element = $(\"<ul class='vakata-context'></ul>\");\n            vakata_context.element\n                .on(\"mouseenter\", \"li\", function (e) {\n                    e.stopImmediatePropagation();\n\n                    if($.contains(this, e.relatedTarget)) {\n                        // \u043f\u0440\u0435\u043c\u0430\u0445\u043d\u0430\u0442\u043e \u0437\u0430\u0440\u0430\u0434\u0438 delegate mouseleave \u043f\u043e-\u0434\u043e\u043b\u0443\n                        // $(this).find(\".vakata-context-hover\").removeClass(\"vakata-context-hover\");\n                        return;\n                    }\n\n                    if(to) { clearTimeout(to); }\n                    vakata_context.element.find(\".vakata-context-hover\").removeClass(\"vakata-context-hover\").end();\n\n                    $(this)\n                        .siblings().find(\"ul\").hide().end().end()\n                        .parentsUntil(\".vakata-context\", \"li\").addBack().addClass(\"vakata-context-hover\");\n                    $.vakata.context._show_submenu(this);\n                })\n                // \u0442\u0435\u0441\u0442\u043e\u0432\u043e - \u0434\u0430\u043b\u0438 \u043d\u0435 \u043d\u0430\u0442\u043e\u0432\u0430\u0440\u0432\u0430?\n                .on(\"mouseleave\", \"li\", function (e) {\n                    if($.contains(this, e.relatedTarget)) { return; }\n                    $(this).find(\".vakata-context-hover\").addBack().removeClass(\"vakata-context-hover\");\n                })\n                .on(\"mouseleave\", function (e) {\n                    $(this).find(\".vakata-context-hover\").removeClass(\"vakata-context-hover\");\n                    if($.vakata.context.settings.hide_onmouseleave) {\n                        to = setTimeout(\n                            (function (t) {\n                                return function () { $.vakata.context.hide(); };\n                            }(this)), $.vakata.context.settings.hide_onmouseleave);\n                    }\n                })\n                .on(\"click\", \"a\", function (e) {\n                    e.preventDefault();\n                    //})\n                    //.on(\"mouseup\", \"a\", function (e) {\n                    if(!$(this).trigger('blur').parent().hasClass(\"vakata-context-disabled\") && $.vakata.context._execute($(this).attr(\"rel\")) !== false) {\n                        $.vakata.context.hide();\n                    }\n                })\n                .on('keydown', 'a', function (e) {\n                    var o = null;\n                    switch(e.which) {\n                        case 13:\n                        case 32:\n                            e.type = \"click\";\n                            e.preventDefault();\n                            $(e.currentTarget).trigger(e);\n                            break;\n                        case 37:\n                            if(vakata_context.is_visible) {\n                                vakata_context.element.find(\".vakata-context-hover\").last().closest(\"li\").first().find(\"ul\").hide().find(\".vakata-context-hover\").removeClass(\"vakata-context-hover\").end().end().children('a').trigger('focus');\n                                e.stopImmediatePropagation();\n                                e.preventDefault();\n                            }\n                            break;\n                        case 38:\n                            if(vakata_context.is_visible) {\n                                o = vakata_context.element.find(\"ul:visible\").addBack().last().children(\".vakata-context-hover\").removeClass(\"vakata-context-hover\").prevAll(\"li:not(.vakata-context-separator)\").first();\n                                if(!o.length) { o = vakata_context.element.find(\"ul:visible\").addBack().last().children(\"li:not(.vakata-context-separator)\").last(); }\n                                o.addClass(\"vakata-context-hover\").children('a').trigger('focus');\n                                e.stopImmediatePropagation();\n                                e.preventDefault();\n                            }\n                            break;\n                        case 39:\n                            if(vakata_context.is_visible) {\n                                vakata_context.element.find(\".vakata-context-hover\").last().children(\"ul\").show().children(\"li:not(.vakata-context-separator)\").removeClass(\"vakata-context-hover\").first().addClass(\"vakata-context-hover\").children('a').trigger('focus');\n                                e.stopImmediatePropagation();\n                                e.preventDefault();\n                            }\n                            break;\n                        case 40:\n                            if(vakata_context.is_visible) {\n                                o = vakata_context.element.find(\"ul:visible\").addBack().last().children(\".vakata-context-hover\").removeClass(\"vakata-context-hover\").nextAll(\"li:not(.vakata-context-separator)\").first();\n                                if(!o.length) { o = vakata_context.element.find(\"ul:visible\").addBack().last().children(\"li:not(.vakata-context-separator)\").first(); }\n                                o.addClass(\"vakata-context-hover\").children('a').trigger('focus');\n                                e.stopImmediatePropagation();\n                                e.preventDefault();\n                            }\n                            break;\n                        case 27:\n                            $.vakata.context.hide();\n                            e.preventDefault();\n                            break;\n                        default:\n                            //console.log(e.which);\n                            break;\n                    }\n                })\n                .on('keydown', function (e) {\n                    e.preventDefault();\n                    var a = vakata_context.element.find('.vakata-contextmenu-shortcut-' + e.which).parent();\n                    if(a.parent().not('.vakata-context-disabled')) {\n                        a.trigger('click');\n                    }\n                });\n\n            $(document)\n                .on(\"mousedown.vakata.jstree\", function (e) {\n                    if(vakata_context.is_visible && vakata_context.element[0] !== e.target  && !$.contains(vakata_context.element[0], e.target)) {\n                        $.vakata.context.hide();\n                    }\n                })\n                .on(\"context_show.vakata.jstree\", function (e, data) {\n                    vakata_context.element.find(\"li:has(ul)\").children(\"a\").addClass(\"vakata-context-parent\");\n                    if(right_to_left) {\n                        vakata_context.element.addClass(\"vakata-context-rtl\").css(\"direction\", \"rtl\");\n                    }\n                    // also apply a RTL class?\n                    vakata_context.element.find(\"ul\").hide().end();\n                });\n        });\n    }($));\n    // $.jstree.defaults.plugins.push(\"contextmenu\");\n\n\n    /**\n     * ### Drag'n'drop plugin\n     *\n     * Enables dragging and dropping of nodes in the tree, resulting in a move or copy operations.\n     */\n\n    /**\n     * stores all defaults for the drag'n'drop plugin\n     * @name $.jstree.defaults.dnd\n     * @plugin dnd\n     */\n    $.jstree.defaults.dnd = {\n        /**\n         * a boolean indicating if a copy should be possible while dragging (by pressint the meta key or Ctrl). Defaults to `true`.\n         * @name $.jstree.defaults.dnd.copy\n         * @plugin dnd\n         */\n        copy : true,\n        /**\n         * a number indicating how long a node should remain hovered while dragging to be opened. Defaults to `500`.\n         * @name $.jstree.defaults.dnd.open_timeout\n         * @plugin dnd\n         */\n        open_timeout : 500,\n        /**\n         * a function invoked each time a node is about to be dragged, invoked in the tree's scope and receives the nodes about to be dragged as an argument (array) and the event that started the drag - return `false` to prevent dragging\n         * @name $.jstree.defaults.dnd.is_draggable\n         * @plugin dnd\n         */\n        is_draggable : true,\n        /**\n         * a boolean indicating if checks should constantly be made while the user is dragging the node (as opposed to checking only on drop), default is `true`\n         * @name $.jstree.defaults.dnd.check_while_dragging\n         * @plugin dnd\n         */\n        check_while_dragging : true,\n        /**\n         * a boolean indicating if nodes from this tree should only be copied with dnd (as opposed to moved), default is `false`\n         * @name $.jstree.defaults.dnd.always_copy\n         * @plugin dnd\n         */\n        always_copy : false,\n        /**\n         * when dropping a node \"inside\", this setting indicates the position the node should go to - it can be an integer or a string: \"first\" (same as 0) or \"last\", default is `0`\n         * @name $.jstree.defaults.dnd.inside_pos\n         * @plugin dnd\n         */\n        inside_pos : 0,\n        /**\n         * when starting the drag on a node that is selected this setting controls if all selected nodes are dragged or only the single node, default is `true`, which means all selected nodes are dragged when the drag is started on a selected node\n         * @name $.jstree.defaults.dnd.drag_selection\n         * @plugin dnd\n         */\n        drag_selection : true,\n        /**\n         * controls whether dnd works on touch devices. If left as boolean true dnd will work the same as in desktop browsers, which in some cases may impair scrolling. If set to boolean false dnd will not work on touch devices. There is a special third option - string \"selected\" which means only selected nodes can be dragged on touch devices.\n         * @name $.jstree.defaults.dnd.touch\n         * @plugin dnd\n         */\n        touch : true,\n        /**\n         * controls whether items can be dropped anywhere on the node, not just on the anchor, by default only the node anchor is a valid drop target. Works best with the wholerow plugin. If enabled on mobile depending on the interface it might be hard for the user to cancel the drop, since the whole tree container will be a valid drop target.\n         * @name $.jstree.defaults.dnd.large_drop_target\n         * @plugin dnd\n         */\n        large_drop_target : false,\n        /**\n         * controls whether a drag can be initiated from any part of the node and not just the text/icon part, works best with the wholerow plugin. Keep in mind it can cause problems with tree scrolling on mobile depending on the interface - in that case set the touch option to \"selected\".\n         * @name $.jstree.defaults.dnd.large_drag_target\n         * @plugin dnd\n         */\n        large_drag_target : false,\n        /**\n         * controls whether use HTML5 dnd api instead of classical. That will allow better integration of dnd events with other HTML5 controls.\n         * @reference http://caniuse.com/#feat=dragndrop\n         * @name $.jstree.defaults.dnd.use_html5\n         * @plugin dnd\n         */\n        use_html5: false,\n        /**\n         * controls whether items can be dropped anywhere on the tree.\n         * @name $.jstree.defaults.dnd.blank_space_drop\n         * @plugin dnd\n         */\n        blank_space_drop: false\n    };\n    var drg, elm;\n    // TODO: now check works by checking for each node individually, how about max_children, unique, etc?\n    $.jstree.plugins.dnd = function (options, parent) {\n        this.init = function (el, options) {\n            parent.init.call(this, el, options);\n            this.settings.dnd.use_html5 = this.settings.dnd.use_html5 && ('draggable' in document.createElement('span'));\n        };\n        this.bind = function () {\n            parent.bind.call(this);\n\n            this.element\n                .on(this.settings.dnd.use_html5 ? 'dragstart.jstree' : 'mousedown.jstree touchstart.jstree', this.settings.dnd.large_drag_target ? '.jstree-node' : '.jstree-anchor', function (e) {\n                    if(this.settings.dnd.large_drag_target && $(e.target).closest('.jstree-node')[0] !== e.currentTarget) {\n                        return true;\n                    }\n                    if(e.type === \"touchstart\" && (!this.settings.dnd.touch || (this.settings.dnd.touch === 'selected' && !$(e.currentTarget).closest('.jstree-node').children('.jstree-anchor').hasClass('jstree-clicked')))) {\n                        return true;\n                    }\n                    var obj = this.get_node(e.target),\n                        mlt = this.is_selected(obj) && this.settings.dnd.drag_selection ? this.get_top_selected().length : 1,\n                        txt = (mlt > 1 ? mlt + ' ' + this.get_string('nodes') : this.get_text(e.currentTarget));\n                    if(this.settings.core.force_text) {\n                        txt = $.vakata.html.escape(txt);\n                    }\n                    if(obj && (obj.id || obj.id === 0) && obj.id !== $.jstree.root && (e.which === 1 || e.type === \"touchstart\" || e.type === \"dragstart\") &&\n                        (this.settings.dnd.is_draggable === true || ($.vakata.is_function(this.settings.dnd.is_draggable) && this.settings.dnd.is_draggable.call(this, (mlt > 1 ? this.get_top_selected(true) : [obj]), e)))\n                    ) {\n                        drg = { 'jstree' : true, 'origin' : this, 'obj' : this.get_node(obj,true), 'nodes' : mlt > 1 ? this.get_top_selected() : [obj.id] };\n                        elm = e.currentTarget;\n                        if (this.settings.dnd.use_html5) {\n                            $.vakata.dnd._trigger('start', e, { 'helper': $(), 'element': elm, 'data': drg });\n                        } else {\n                            this.element.trigger('mousedown.jstree');\n                            return $.vakata.dnd.start(e, drg, '<div id=\"jstree-dnd\" class=\"jstree-' + this.get_theme() + ' jstree-' + this.get_theme() + '-' + this.get_theme_variant() + ' ' + ( this.settings.core.themes.responsive ? ' jstree-dnd-responsive' : '' ) + '\"><i class=\"jstree-icon jstree-er\"></i>' + txt + '<ins class=\"jstree-copy\">+</ins></div>');\n                        }\n                    }\n                }.bind(this));\n            if (this.settings.dnd.use_html5) {\n                this.element\n                    .on('dragover.jstree', function (e) {\n                        e.preventDefault();\n                        $.vakata.dnd._trigger('move', e, { 'helper': $(), 'element': elm, 'data': drg });\n                        return false;\n                    })\n                    //.on('dragenter.jstree', this.settings.dnd.large_drop_target ? '.jstree-node' : '.jstree-anchor', $.proxy(function (e) {\n                    //\t\te.preventDefault();\n                    //\t\t$.vakata.dnd._trigger('move', e, { 'helper': $(), 'element': elm, 'data': drg });\n                    //\t\treturn false;\n                    //\t}, this))\n                    .on('drop.jstree', function (e) {\n                        e.preventDefault();\n                        $.vakata.dnd._trigger('stop', e, { 'helper': $(), 'element': elm, 'data': drg });\n                        return false;\n                    }.bind(this));\n            }\n        };\n        this.redraw_node = function(obj, deep, callback, force_render) {\n            obj = parent.redraw_node.apply(this, arguments);\n            if (obj && this.settings.dnd.use_html5) {\n                if (this.settings.dnd.large_drag_target) {\n                    obj.setAttribute('draggable', true);\n                } else {\n                    var i, j, tmp = null;\n                    for(i = 0, j = obj.childNodes.length; i < j; i++) {\n                        if(obj.childNodes[i] && obj.childNodes[i].className && obj.childNodes[i].className.indexOf(\"jstree-anchor\") !== -1) {\n                            tmp = obj.childNodes[i];\n                            break;\n                        }\n                    }\n                    if(tmp) {\n                        tmp.setAttribute('draggable', true);\n                    }\n                }\n            }\n            return obj;\n        };\n    };\n\n    $(function() {\n        // bind only once for all instances\n        var lastmv = false,\n            laster = false,\n            lastev = false,\n            opento = false,\n            marker = $('<div id=\"jstree-marker\">&#160;</div>').hide(); //.appendTo('body');\n\n        $(document)\n            .on('dragover.vakata.jstree', function (e) {\n                if (elm) {\n                    $.vakata.dnd._trigger('move', e, { 'helper': $(), 'element': elm, 'data': drg });\n                }\n            })\n            .on('drop.vakata.jstree', function (e) {\n                if (elm) {\n                    $.vakata.dnd._trigger('stop', e, { 'helper': $(), 'element': elm, 'data': drg });\n                    elm = null;\n                    drg = null;\n                }\n            })\n            .on('dnd_start.vakata.jstree', function (e, data) {\n                lastmv = false;\n                lastev = false;\n                if(!data || !data.data || !data.data.jstree) { return; }\n                marker.appendTo(document.body); //.show();\n            })\n            .on('dnd_move.vakata.jstree', function (e, data) {\n                var isDifferentNode = data.event.target !== lastev.target;\n                if(opento) {\n                    if (!data.event || data.event.type !== 'dragover' || isDifferentNode) {\n                        clearTimeout(opento);\n                    }\n                }\n                if(!data || !data.data || !data.data.jstree) { return; }\n\n                // if we are hovering the marker image do nothing (can happen on \"inside\" drags)\n                if(data.event.target.id && data.event.target.id === 'jstree-marker') {\n                    return;\n                }\n                lastev = data.event;\n\n                var ins = $.jstree.reference(data.event.target),\n                    ref = false,\n                    off = false,\n                    rel = false,\n                    tmp, l, t, h, p, i, o, ok, t1, t2, op, ps, pr, ip, tm, is_copy, pn, c;\n                // if we are over an instance\n                if(ins && ins._data && ins._data.dnd) {\n                    marker.attr('class', 'jstree-' + ins.get_theme() + ( ins.settings.core.themes.responsive ? ' jstree-dnd-responsive' : '' ));\n                    is_copy = data.data.origin && (data.data.origin.settings.dnd.always_copy || (data.data.origin.settings.dnd.copy && (data.event.metaKey || data.event.ctrlKey)));\n                    data.helper\n                        .children().attr('class', 'jstree-' + ins.get_theme() + ' jstree-' + ins.get_theme() + '-' + ins.get_theme_variant() + ' ' + ( ins.settings.core.themes.responsive ? ' jstree-dnd-responsive' : '' ))\n                        .find('.jstree-copy').first()[ is_copy ? 'show' : 'hide' ]();\n\n                    // if are hovering the container itself add a new root node\n                    //console.log(data.event);\n                    if( (data.event.target === ins.element[0] || data.event.target === ins.get_container_ul()[0]) && (ins.get_container_ul().children().length === 0 || ins.settings.dnd.blank_space_drop)) {\n                        ok = true;\n                        for(t1 = 0, t2 = data.data.nodes.length; t1 < t2; t1++) {\n                            ok = ok && ins.check( (data.data.origin && (data.data.origin.settings.dnd.always_copy || (data.data.origin.settings.dnd.copy && (data.event.metaKey || data.event.ctrlKey)) ) ? \"copy_node\" : \"move_node\"), (data.data.origin && data.data.origin !== ins ? data.data.origin.get_node(data.data.nodes[t1]) : data.data.nodes[t1]), $.jstree.root, 'last', { 'dnd' : true, 'ref' : ins.get_node($.jstree.root), 'pos' : 'i', 'origin' : data.data.origin, 'is_multi' : (data.data.origin && data.data.origin !== ins), 'is_foreign' : (!data.data.origin) });\n                            if(!ok) { break; }\n                        }\n                        if(ok) {\n                            lastmv = { 'ins' : ins, 'par' : $.jstree.root, 'pos' : 'last' };\n                            marker.hide();\n                            data.helper.find('.jstree-icon').first().removeClass('jstree-er').addClass('jstree-ok');\n                            if (data.event.originalEvent && data.event.originalEvent.dataTransfer) {\n                                data.event.originalEvent.dataTransfer.dropEffect = is_copy ? 'copy' : 'move';\n                            }\n                            return;\n                        }\n                    }\n                    else {\n                        // if we are hovering a tree node\n                        ref = ins.settings.dnd.large_drop_target ? $(data.event.target).closest('.jstree-node').children('.jstree-anchor') : $(data.event.target).closest('.jstree-anchor');\n\n                        if(ref && ref.length && ref.parent().is('.jstree-closed, .jstree-open, .jstree-leaf')) {\n                            off = ref.offset();\n                            rel = (data.event.pageY !== undefined ? data.event.pageY : data.event.originalEvent.pageY) - off.top;\n                            h = ref.outerHeight();\n                            if(rel < h / 3) {\n                                o = ['b', 'i', 'a'];\n                            }\n                            else if(rel > h - h / 3) {\n                                o = ['a', 'i', 'b'];\n                            }\n                            else {\n                                o = rel > h / 2 ? ['i', 'a', 'b'] : ['i', 'b', 'a'];\n                            }\n                            $.each(o, function (j, v) {\n                                switch(v) {\n                                    case 'b':\n                                        l = off.left - 6;\n                                        t = off.top;\n                                        p = ins.get_parent(ref);\n                                        i = ref.parent().index();\n                                        c = 'jstree-below';\n                                        break;\n                                    case 'i':\n                                        ip = ins.settings.dnd.inside_pos;\n                                        tm = ins.get_node(ref.parent());\n                                        l = off.left - 2;\n                                        t = off.top + h / 2 + 1;\n                                        p = tm.id;\n                                        i = ip === 'first' ? 0 : (ip === 'last' ? tm.children.length : Math.min(ip, tm.children.length));\n                                        c = 'jstree-inside';\n                                        break;\n                                    case 'a':\n                                        l = off.left - 6;\n                                        t = off.top + h;\n                                        p = ins.get_parent(ref);\n                                        i = ref.parent().index() + 1;\n                                        c = 'jstree-above';\n                                        break;\n                                }\n                                ok = true;\n                                for(t1 = 0, t2 = data.data.nodes.length; t1 < t2; t1++) {\n                                    op = data.data.origin && (data.data.origin.settings.dnd.always_copy || (data.data.origin.settings.dnd.copy && (data.event.metaKey || data.event.ctrlKey))) ? \"copy_node\" : \"move_node\";\n                                    ps = i;\n                                    if(op === \"move_node\" && v === 'a' && (data.data.origin && data.data.origin === ins) && p === ins.get_parent(data.data.nodes[t1])) {\n                                        pr = ins.get_node(p);\n                                        if(ps > $.inArray(data.data.nodes[t1], pr.children)) {\n                                            ps -= 1;\n                                        }\n                                    }\n                                    ok = ok && ( (ins && ins.settings && ins.settings.dnd && ins.settings.dnd.check_while_dragging === false) || ins.check(op, (data.data.origin && data.data.origin !== ins ? data.data.origin.get_node(data.data.nodes[t1]) : data.data.nodes[t1]), p, ps, { 'dnd' : true, 'ref' : ins.get_node(ref.parent()), 'pos' : v, 'origin' : data.data.origin, 'is_multi' : (data.data.origin && data.data.origin !== ins), 'is_foreign' : (!data.data.origin) }) );\n                                    if(!ok) {\n                                        if(ins && ins.last_error) { laster = ins.last_error(); }\n                                        break;\n                                    }\n                                }\n                                if(v === 'i' && ref.parent().is('.jstree-closed') && ins.settings.dnd.open_timeout) {\n                                    if (!data.event || data.event.type !== 'dragover' || isDifferentNode) {\n                                        if (opento) { clearTimeout(opento); }\n                                        opento = setTimeout((function (x, z) { return function () { x.open_node(z); }; }(ins, ref)), ins.settings.dnd.open_timeout);\n                                    }\n                                }\n                                if(ok) {\n                                    pn = ins.get_node(p, true);\n                                    if (!pn.hasClass('.jstree-dnd-parent')) {\n                                        $('.jstree-dnd-parent').removeClass('jstree-dnd-parent');\n                                        pn.addClass('jstree-dnd-parent');\n                                    }\n                                    lastmv = { 'ins' : ins, 'par' : p, 'pos' : v === 'i' && ip === 'last' && i === 0 && !ins.is_loaded(tm) ? 'last' : i };\n                                    marker.css({ 'left' : l + 'px', 'top' : t + 'px' }).show();\n                                    marker.removeClass('jstree-above jstree-inside jstree-below').addClass(c);\n                                    data.helper.find('.jstree-icon').first().removeClass('jstree-er').addClass('jstree-ok');\n                                    if (data.event.originalEvent && data.event.originalEvent.dataTransfer) {\n                                        data.event.originalEvent.dataTransfer.dropEffect = is_copy ? 'copy' : 'move';\n                                    }\n                                    laster = {};\n                                    o = true;\n                                    return false;\n                                }\n                            });\n                            if(o === true) { return; }\n                        }\n                    }\n                }\n                $('.jstree-dnd-parent').removeClass('jstree-dnd-parent');\n                lastmv = false;\n                data.helper.find('.jstree-icon').removeClass('jstree-ok').addClass('jstree-er');\n                if (data.event.originalEvent && data.event.originalEvent.dataTransfer) {\n                    //data.event.originalEvent.dataTransfer.dropEffect = 'none';\n                }\n                marker.hide();\n            })\n            .on('dnd_scroll.vakata.jstree', function (e, data) {\n                if(!data || !data.data || !data.data.jstree) { return; }\n                marker.hide();\n                lastmv = false;\n                lastev = false;\n                data.helper.find('.jstree-icon').first().removeClass('jstree-ok').addClass('jstree-er');\n            })\n            .on('dnd_stop.vakata.jstree', function (e, data) {\n                $('.jstree-dnd-parent').removeClass('jstree-dnd-parent');\n                if(opento) { clearTimeout(opento); }\n                if(!data || !data.data || !data.data.jstree) { return; }\n                marker.hide().detach();\n                var i, j, nodes = [];\n                if(lastmv) {\n                    for(i = 0, j = data.data.nodes.length; i < j; i++) {\n                        nodes[i] = data.data.origin ? data.data.origin.get_node(data.data.nodes[i]) : data.data.nodes[i];\n                    }\n                    lastmv.ins[ data.data.origin && (data.data.origin.settings.dnd.always_copy || (data.data.origin.settings.dnd.copy && (data.event.metaKey || data.event.ctrlKey))) ? 'copy_node' : 'move_node' ](nodes, lastmv.par, lastmv.pos, false, false, false, data.data.origin);\n                }\n                else {\n                    i = $(data.event.target).closest('.jstree');\n                    if(i.length && laster && laster.error && laster.error === 'check') {\n                        i = i.jstree(true);\n                        if(i) {\n                            i.settings.core.error.call(this, laster);\n                        }\n                    }\n                }\n                lastev = false;\n                lastmv = false;\n            })\n            .on('keyup.jstree keydown.jstree', function (e, data) {\n                data = $.vakata.dnd._get();\n                if(data && data.data && data.data.jstree) {\n                    if (e.type === \"keyup\" && e.which === 27) {\n                        if (opento) { clearTimeout(opento); }\n                        lastmv = false;\n                        laster = false;\n                        lastev = false;\n                        opento = false;\n                        marker.hide().detach();\n                        $.vakata.dnd._clean();\n                    } else {\n                        data.helper.find('.jstree-copy').first()[ data.data.origin && (data.data.origin.settings.dnd.always_copy || (data.data.origin.settings.dnd.copy && (e.metaKey || e.ctrlKey))) ? 'show' : 'hide' ]();\n                        if(lastev) {\n                            lastev.metaKey = e.metaKey;\n                            lastev.ctrlKey = e.ctrlKey;\n                            $.vakata.dnd._trigger('move', lastev);\n                        }\n                    }\n                }\n            });\n    });\n\n    // helpers\n    (function ($) {\n        $.vakata.html = {\n            div : $('<div></div>'),\n            escape : function (str) {\n                return $.vakata.html.div.text(str).html();\n            },\n            strip : function (str) {\n                return $.vakata.html.div.empty().append($.parseHTML(str)).text();\n            }\n        };\n        // private variable\n        var vakata_dnd = {\n            element\t: false,\n            target\t: false,\n            is_down\t: false,\n            is_drag\t: false,\n            helper\t: false,\n            helper_w: 0,\n            data\t: false,\n            init_x\t: 0,\n            init_y\t: 0,\n            scroll_l: 0,\n            scroll_t: 0,\n            scroll_e: false,\n            scroll_i: false,\n            is_touch: false\n        };\n        $.vakata.dnd = {\n            settings : {\n                scroll_speed\t\t: 10,\n                scroll_proximity\t: 20,\n                helper_left\t\t\t: 5,\n                helper_top\t\t\t: 10,\n                threshold\t\t\t: 5,\n                threshold_touch\t\t: 10\n            },\n            _trigger : function (event_name, e, data) {\n                if (data === undefined) {\n                    data = $.vakata.dnd._get();\n                }\n                data.event = e;\n                $(document).triggerHandler(\"dnd_\" + event_name + \".vakata\", data);\n            },\n            _get : function () {\n                return {\n                    \"data\"\t\t: vakata_dnd.data,\n                    \"element\"\t: vakata_dnd.element,\n                    \"helper\"\t: vakata_dnd.helper\n                };\n            },\n            _clean : function () {\n                if(vakata_dnd.helper) { vakata_dnd.helper.remove(); }\n                if(vakata_dnd.scroll_i) { clearInterval(vakata_dnd.scroll_i); vakata_dnd.scroll_i = false; }\n                vakata_dnd = {\n                    element\t: false,\n                    target\t: false,\n                    is_down\t: false,\n                    is_drag\t: false,\n                    helper\t: false,\n                    helper_w: 0,\n                    data\t: false,\n                    init_x\t: 0,\n                    init_y\t: 0,\n                    scroll_l: 0,\n                    scroll_t: 0,\n                    scroll_e: false,\n                    scroll_i: false,\n                    is_touch: false\n                };\n                elm = null;\n                $(document).off(\"mousemove.vakata.jstree touchmove.vakata.jstree\", $.vakata.dnd.drag);\n                $(document).off(\"mouseup.vakata.jstree touchend.vakata.jstree\", $.vakata.dnd.stop);\n            },\n            _scroll : function (init_only) {\n                if(!vakata_dnd.scroll_e || (!vakata_dnd.scroll_l && !vakata_dnd.scroll_t)) {\n                    if(vakata_dnd.scroll_i) { clearInterval(vakata_dnd.scroll_i); vakata_dnd.scroll_i = false; }\n                    return false;\n                }\n                if(!vakata_dnd.scroll_i) {\n                    vakata_dnd.scroll_i = setInterval($.vakata.dnd._scroll, 100);\n                    return false;\n                }\n                if(init_only === true) { return false; }\n\n                var i = vakata_dnd.scroll_e.scrollTop(),\n                    j = vakata_dnd.scroll_e.scrollLeft();\n                vakata_dnd.scroll_e.scrollTop(i + vakata_dnd.scroll_t * $.vakata.dnd.settings.scroll_speed);\n                vakata_dnd.scroll_e.scrollLeft(j + vakata_dnd.scroll_l * $.vakata.dnd.settings.scroll_speed);\n                if(i !== vakata_dnd.scroll_e.scrollTop() || j !== vakata_dnd.scroll_e.scrollLeft()) {\n                    /**\n                     * triggered on the document when a drag causes an element to scroll\n                     * @event\n                     * @plugin dnd\n                     * @name dnd_scroll.vakata\n                     * @param {Mixed} data any data supplied with the call to $.vakata.dnd.start\n                     * @param {DOM} element the DOM element being dragged\n                     * @param {jQuery} helper the helper shown next to the mouse\n                     * @param {jQuery} event the element that is scrolling\n                     */\n                    $.vakata.dnd._trigger(\"scroll\", vakata_dnd.scroll_e);\n                }\n            },\n            start : function (e, data, html) {\n                if(e.type === \"touchstart\" && e.originalEvent && e.originalEvent.changedTouches && e.originalEvent.changedTouches[0]) {\n                    e.pageX = e.originalEvent.changedTouches[0].pageX;\n                    e.pageY = e.originalEvent.changedTouches[0].pageY;\n                    e.target = document.elementFromPoint(e.originalEvent.changedTouches[0].pageX - window.pageXOffset, e.originalEvent.changedTouches[0].pageY - window.pageYOffset);\n                }\n                if(vakata_dnd.is_drag) { $.vakata.dnd.stop({}); }\n                try {\n                    e.currentTarget.unselectable = \"on\";\n                    e.currentTarget.onselectstart = function() { return false; };\n                    if(e.currentTarget.style) {\n                        e.currentTarget.style.touchAction = \"none\";\n                        e.currentTarget.style.msTouchAction = \"none\";\n                        e.currentTarget.style.MozUserSelect = \"none\";\n                    }\n                } catch(ignore) { }\n                vakata_dnd.init_x\t= e.pageX;\n                vakata_dnd.init_y\t= e.pageY;\n                vakata_dnd.data\t\t= data;\n                vakata_dnd.is_down\t= true;\n                vakata_dnd.element\t= e.currentTarget;\n                vakata_dnd.target\t= e.target;\n                vakata_dnd.is_touch\t= e.type === \"touchstart\";\n                if(html !== false) {\n                    vakata_dnd.helper = $(\"<div id='vakata-dnd'></div>\").html(html).css({\n                        \"display\"\t\t: \"block\",\n                        \"margin\"\t\t: \"0\",\n                        \"padding\"\t\t: \"0\",\n                        \"position\"\t\t: \"absolute\",\n                        \"top\"\t\t\t: \"-2000px\",\n                        \"lineHeight\"\t: \"16px\",\n                        \"zIndex\"\t\t: \"10000\"\n                    });\n                }\n                $(document).on(\"mousemove.vakata.jstree touchmove.vakata.jstree\", $.vakata.dnd.drag);\n                $(document).on(\"mouseup.vakata.jstree touchend.vakata.jstree\", $.vakata.dnd.stop);\n                return false;\n            },\n            drag : function (e) {\n                if(e.type === \"touchmove\" && e.originalEvent && e.originalEvent.changedTouches && e.originalEvent.changedTouches[0]) {\n                    e.pageX = e.originalEvent.changedTouches[0].pageX;\n                    e.pageY = e.originalEvent.changedTouches[0].pageY;\n                    e.target = document.elementFromPoint(e.originalEvent.changedTouches[0].pageX - window.pageXOffset, e.originalEvent.changedTouches[0].pageY - window.pageYOffset);\n                }\n                if(!vakata_dnd.is_down) { return; }\n                if(!vakata_dnd.is_drag) {\n                    if(\n                        Math.abs(e.pageX - vakata_dnd.init_x) > (vakata_dnd.is_touch ? $.vakata.dnd.settings.threshold_touch : $.vakata.dnd.settings.threshold) ||\n                        Math.abs(e.pageY - vakata_dnd.init_y) > (vakata_dnd.is_touch ? $.vakata.dnd.settings.threshold_touch : $.vakata.dnd.settings.threshold)\n                    ) {\n                        if(vakata_dnd.helper) {\n                            vakata_dnd.helper.appendTo(document.body);\n                            vakata_dnd.helper_w = vakata_dnd.helper.outerWidth();\n                        }\n                        vakata_dnd.is_drag = true;\n                        $(vakata_dnd.target).one('click.vakata', false);\n                        /**\n                         * triggered on the document when a drag starts\n                         * @event\n                         * @plugin dnd\n                         * @name dnd_start.vakata\n                         * @param {Mixed} data any data supplied with the call to $.vakata.dnd.start\n                         * @param {DOM} element the DOM element being dragged\n                         * @param {jQuery} helper the helper shown next to the mouse\n                         * @param {Object} event the event that caused the start (probably mousemove)\n                         */\n                        $.vakata.dnd._trigger(\"start\", e);\n                    }\n                    else { return; }\n                }\n\n                var d  = false, w  = false,\n                    dh = false, wh = false,\n                    dw = false, ww = false,\n                    dt = false, dl = false,\n                    ht = false, hl = false;\n\n                vakata_dnd.scroll_t = 0;\n                vakata_dnd.scroll_l = 0;\n                vakata_dnd.scroll_e = false;\n                $($(e.target).parentsUntil(\"body\").addBack().get().reverse())\n                    .filter(function () {\n                        return\tthis.ownerDocument && (/^auto|scroll$/).test($(this).css(\"overflow\")) &&\n                            (this.scrollHeight > this.offsetHeight || this.scrollWidth > this.offsetWidth);\n                    })\n                    .each(function () {\n                        var t = $(this), o = t.offset();\n                        if(this.scrollHeight > this.offsetHeight) {\n                            if(o.top + t.height() - e.pageY < $.vakata.dnd.settings.scroll_proximity)\t{ vakata_dnd.scroll_t = 1; }\n                            if(e.pageY - o.top < $.vakata.dnd.settings.scroll_proximity)\t\t\t\t{ vakata_dnd.scroll_t = -1; }\n                        }\n                        if(this.scrollWidth > this.offsetWidth) {\n                            if(o.left + t.width() - e.pageX < $.vakata.dnd.settings.scroll_proximity)\t{ vakata_dnd.scroll_l = 1; }\n                            if(e.pageX - o.left < $.vakata.dnd.settings.scroll_proximity)\t\t\t\t{ vakata_dnd.scroll_l = -1; }\n                        }\n                        if(vakata_dnd.scroll_t || vakata_dnd.scroll_l) {\n                            vakata_dnd.scroll_e = $(this);\n                            return false;\n                        }\n                    });\n\n                if(!vakata_dnd.scroll_e) {\n                    d  = $(document); w = $(window);\n                    dh = d.height(); wh = w.height();\n                    dw = d.width(); ww = w.width();\n                    dt = d.scrollTop(); dl = d.scrollLeft();\n                    if(dh > wh && e.pageY - dt < $.vakata.dnd.settings.scroll_proximity)\t\t{ vakata_dnd.scroll_t = -1;  }\n                    if(dh > wh && wh - (e.pageY - dt) < $.vakata.dnd.settings.scroll_proximity)\t{ vakata_dnd.scroll_t = 1; }\n                    if(dw > ww && e.pageX - dl < $.vakata.dnd.settings.scroll_proximity)\t\t{ vakata_dnd.scroll_l = -1; }\n                    if(dw > ww && ww - (e.pageX - dl) < $.vakata.dnd.settings.scroll_proximity)\t{ vakata_dnd.scroll_l = 1; }\n                    if(vakata_dnd.scroll_t || vakata_dnd.scroll_l) {\n                        vakata_dnd.scroll_e = d;\n                    }\n                }\n                if(vakata_dnd.scroll_e) { $.vakata.dnd._scroll(true); }\n\n                if(vakata_dnd.helper) {\n                    ht = parseInt(e.pageY + $.vakata.dnd.settings.helper_top, 10);\n                    hl = parseInt(e.pageX + $.vakata.dnd.settings.helper_left, 10);\n                    if(dh && ht + 25 > dh) { ht = dh - 50; }\n                    if(dw && hl + vakata_dnd.helper_w > dw) { hl = dw - (vakata_dnd.helper_w + 2); }\n                    vakata_dnd.helper.css({\n                        left\t: hl + \"px\",\n                        top\t\t: ht + \"px\"\n                    });\n                }\n                /**\n                 * triggered on the document when a drag is in progress\n                 * @event\n                 * @plugin dnd\n                 * @name dnd_move.vakata\n                 * @param {Mixed} data any data supplied with the call to $.vakata.dnd.start\n                 * @param {DOM} element the DOM element being dragged\n                 * @param {jQuery} helper the helper shown next to the mouse\n                 * @param {Object} event the event that caused this to trigger (most likely mousemove)\n                 */\n                $.vakata.dnd._trigger(\"move\", e);\n                return false;\n            },\n            stop : function (e) {\n                if(e.type === \"touchend\" && e.originalEvent && e.originalEvent.changedTouches && e.originalEvent.changedTouches[0]) {\n                    e.pageX = e.originalEvent.changedTouches[0].pageX;\n                    e.pageY = e.originalEvent.changedTouches[0].pageY;\n                    e.target = document.elementFromPoint(e.originalEvent.changedTouches[0].pageX - window.pageXOffset, e.originalEvent.changedTouches[0].pageY - window.pageYOffset);\n                }\n                if(vakata_dnd.is_drag) {\n                    /**\n                     * triggered on the document when a drag stops (the dragged element is dropped)\n                     * @event\n                     * @plugin dnd\n                     * @name dnd_stop.vakata\n                     * @param {Mixed} data any data supplied with the call to $.vakata.dnd.start\n                     * @param {DOM} element the DOM element being dragged\n                     * @param {jQuery} helper the helper shown next to the mouse\n                     * @param {Object} event the event that caused the stop\n                     */\n                    if (e.target !== vakata_dnd.target) {\n                        $(vakata_dnd.target).off('click.vakata');\n                    }\n                    $.vakata.dnd._trigger(\"stop\", e);\n                }\n                else {\n                    if(e.type === \"touchend\" && e.target === vakata_dnd.target) {\n                        var to = setTimeout(function () { $(e.target).trigger('click'); }, 100);\n                        $(e.target).one('click', function() { if(to) { clearTimeout(to); } });\n                    }\n                }\n                $.vakata.dnd._clean();\n                return false;\n            }\n        };\n    }($));\n\n    // include the dnd plugin by default\n    // $.jstree.defaults.plugins.push(\"dnd\");\n\n\n    /**\n     * ### Massload plugin\n     *\n     * Adds massload functionality to jsTree, so that multiple nodes can be loaded in a single request (only useful with lazy loading).\n     */\n\n    /**\n     * massload configuration\n     *\n     * It is possible to set this to a standard jQuery-like AJAX config.\n     * In addition to the standard jQuery ajax options here you can supply functions for `data` and `url`, the functions will be run in the current instance's scope and a param will be passed indicating which node IDs need to be loaded, the return value of those functions will be used.\n     *\n     * You can also set this to a function, that function will receive the node IDs being loaded as argument and a second param which is a function (callback) which should be called with the result.\n     *\n     * Both the AJAX and the function approach rely on the same return value - an object where the keys are the node IDs, and the value is the children of that node as an array.\n     *\n     *\t{\n     *\t\t\"id1\" : [{ \"text\" : \"Child of ID1\", \"id\" : \"c1\" }, { \"text\" : \"Another child of ID1\", \"id\" : \"c2\" }],\n     *\t\t\"id2\" : [{ \"text\" : \"Child of ID2\", \"id\" : \"c3\" }]\n     *\t}\n     *\n     * @name $.jstree.defaults.massload\n     * @plugin massload\n     */\n    $.jstree.defaults.massload = null;\n    $.jstree.plugins.massload = function (options, parent) {\n        this.init = function (el, options) {\n            this._data.massload = {};\n            parent.init.call(this, el, options);\n        };\n        this._load_nodes = function (nodes, callback, is_callback, force_reload) {\n            var s = this.settings.massload,\n                toLoad = [],\n                m = this._model.data,\n                i, j, dom;\n            if (!is_callback) {\n                for(i = 0, j = nodes.length; i < j; i++) {\n                    if(!m[nodes[i]] || ( (!m[nodes[i]].state.loaded && !m[nodes[i]].state.failed) || force_reload) ) {\n                        toLoad.push(nodes[i]);\n                        dom = this.get_node(nodes[i], true);\n                        if (dom && dom.length) {\n                            dom.addClass(\"jstree-loading\").attr('aria-busy',true);\n                        }\n                    }\n                }\n                this._data.massload = {};\n                if (toLoad.length) {\n                    if($.vakata.is_function(s)) {\n                        return s.call(this, toLoad, function (data) {\n                            var i, j;\n                            if(data) {\n                                for(i in data) {\n                                    if(data.hasOwnProperty(i)) {\n                                        this._data.massload[i] = data[i];\n                                    }\n                                }\n                            }\n                            for(i = 0, j = nodes.length; i < j; i++) {\n                                dom = this.get_node(nodes[i], true);\n                                if (dom && dom.length) {\n                                    dom.removeClass(\"jstree-loading\").attr('aria-busy',false);\n                                }\n                            }\n                            parent._load_nodes.call(this, nodes, callback, is_callback, force_reload);\n                        }.bind(this));\n                    }\n                    if(typeof s === 'object' && s && s.url) {\n                        s = $.extend(true, {}, s);\n                        if($.vakata.is_function(s.url)) {\n                            s.url = s.url.call(this, toLoad);\n                        }\n                        if($.vakata.is_function(s.data)) {\n                            s.data = s.data.call(this, toLoad);\n                        }\n                        return $.ajax(s)\n                            .done(function (data,t,x) {\n                                var i, j;\n                                if(data) {\n                                    for(i in data) {\n                                        if(data.hasOwnProperty(i)) {\n                                            this._data.massload[i] = data[i];\n                                        }\n                                    }\n                                }\n                                for(i = 0, j = nodes.length; i < j; i++) {\n                                    dom = this.get_node(nodes[i], true);\n                                    if (dom && dom.length) {\n                                        dom.removeClass(\"jstree-loading\").attr('aria-busy',false);\n                                    }\n                                }\n                                parent._load_nodes.call(this, nodes, callback, is_callback, force_reload);\n                            }.bind(this))\n                            .fail(function (f) {\n                                parent._load_nodes.call(this, nodes, callback, is_callback, force_reload);\n                            }.bind(this));\n                    }\n                }\n            }\n            return parent._load_nodes.call(this, nodes, callback, is_callback, force_reload);\n        };\n        this._load_node = function (obj, callback) {\n            var data = this._data.massload[obj.id],\n                rslt = null, dom;\n            if(data) {\n                rslt = this[typeof data === 'string' ? '_append_html_data' : '_append_json_data'](\n                    obj,\n                    typeof data === 'string' ? $($.parseHTML(data)).filter(function () { return this.nodeType !== 3; }) : data,\n                    function (status) { callback.call(this, status); }\n                );\n                dom = this.get_node(obj.id, true);\n                if (dom && dom.length) {\n                    dom.removeClass(\"jstree-loading\").attr('aria-busy',false);\n                }\n                delete this._data.massload[obj.id];\n                return rslt;\n            }\n            return parent._load_node.call(this, obj, callback);\n        };\n    };\n\n\n    /**\n     * ### Search plugin\n     *\n     * Adds search functionality to jsTree.\n     */\n\n    /**\n     * stores all defaults for the search plugin\n     * @name $.jstree.defaults.search\n     * @plugin search\n     */\n    $.jstree.defaults.search = {\n        /**\n         * a jQuery-like AJAX config, which jstree uses if a server should be queried for results.\n         *\n         * A `str` (which is the search string) parameter will be added with the request, an optional `inside` parameter will be added if the search is limited to a node id. The expected result is a JSON array with nodes that need to be opened so that matching nodes will be revealed.\n         * Leave this setting as `false` to not query the server. You can also set this to a function, which will be invoked in the instance's scope and receive 3 parameters - the search string, the callback to call with the array of nodes to load, and the optional node ID to limit the search to\n         * @name $.jstree.defaults.search.ajax\n         * @plugin search\n         */\n        ajax : false,\n        /**\n         * Indicates if the search should be fuzzy or not (should `chnd3` match `child node 3`). Default is `false`.\n         * @name $.jstree.defaults.search.fuzzy\n         * @plugin search\n         */\n        fuzzy : false,\n        /**\n         * Indicates if the search should be case sensitive. Default is `false`.\n         * @name $.jstree.defaults.search.case_sensitive\n         * @plugin search\n         */\n        case_sensitive : false,\n        /**\n         * Indicates if the tree should be filtered (by default) to show only matching nodes (keep in mind this can be a heavy on large trees in old browsers).\n         * This setting can be changed at runtime when calling the search method. Default is `false`.\n         * @name $.jstree.defaults.search.show_only_matches\n         * @plugin search\n         */\n        show_only_matches : false,\n        /**\n         * Indicates if the children of matched element are shown (when show_only_matches is true)\n         * This setting can be changed at runtime when calling the search method. Default is `false`.\n         * @name $.jstree.defaults.search.show_only_matches_children\n         * @plugin search\n         */\n        show_only_matches_children : false,\n        /**\n         * Indicates if all nodes opened to reveal the search result, should be closed when the search is cleared or a new search is performed. Default is `true`.\n         * @name $.jstree.defaults.search.close_opened_onclear\n         * @plugin search\n         */\n        close_opened_onclear : true,\n        /**\n         * Indicates if only leaf nodes should be included in search results. Default is `false`.\n         * @name $.jstree.defaults.search.search_leaves_only\n         * @plugin search\n         */\n        search_leaves_only : false,\n        /**\n         * If set to a function it wil be called in the instance's scope with two arguments - search string and node (where node will be every node in the structure, so use with caution).\n         * If the function returns a truthy value the node will be considered a match (it might not be displayed if search_only_leaves is set to true and the node is not a leaf). Default is `false`.\n         * @name $.jstree.defaults.search.search_callback\n         * @plugin search\n         */\n        search_callback : false\n    };\n\n    $.jstree.plugins.search = function (options, parent) {\n        this.bind = function () {\n            parent.bind.call(this);\n\n            this._data.search.str = \"\";\n            this._data.search.dom = $();\n            this._data.search.res = [];\n            this._data.search.opn = [];\n            this._data.search.som = false;\n            this._data.search.smc = false;\n            this._data.search.hdn = [];\n\n            this.element\n                .on(\"search.jstree\", function (e, data) {\n                    if(this._data.search.som && data.res.length) {\n                        var m = this._model.data, i, j, p = [], k, l;\n                        for(i = 0, j = data.res.length; i < j; i++) {\n                            if(m[data.res[i]] && !m[data.res[i]].state.hidden) {\n                                p.push(data.res[i]);\n                                p = p.concat(m[data.res[i]].parents);\n                                if(this._data.search.smc) {\n                                    for (k = 0, l = m[data.res[i]].children_d.length; k < l; k++) {\n                                        if (m[m[data.res[i]].children_d[k]] && !m[m[data.res[i]].children_d[k]].state.hidden) {\n                                            p.push(m[data.res[i]].children_d[k]);\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                        p = $.vakata.array_remove_item($.vakata.array_unique(p), $.jstree.root);\n                        this._data.search.hdn = this.hide_all(true);\n                        this.show_node(p, true);\n                        this.redraw(true);\n                    }\n                }.bind(this))\n                .on(\"clear_search.jstree\", function (e, data) {\n                    if(this._data.search.som && data.res.length) {\n                        this.show_node(this._data.search.hdn, true);\n                        this.redraw(true);\n                    }\n                }.bind(this));\n        };\n        /**\n         * used to search the tree nodes for a given string\n         * @name search(str [, skip_async])\n         * @param {String} str the search string\n         * @param {Boolean} skip_async if set to true server will not be queried even if configured\n         * @param {Boolean} show_only_matches if set to true only matching nodes will be shown (keep in mind this can be very slow on large trees or old browsers)\n         * @param {mixed} inside an optional node to whose children to limit the search\n         * @param {Boolean} append if set to true the results of this search are appended to the previous search\n         * @plugin search\n         * @trigger search.jstree\n         */\n        this.search = function (str, skip_async, show_only_matches, inside, append, show_only_matches_children) {\n            if(str === false || $.vakata.trim(str.toString()) === \"\") {\n                return this.clear_search();\n            }\n            inside = this.get_node(inside);\n            inside = inside && (inside.id || inside.id === 0) ? inside.id : null;\n            str = str.toString();\n            var s = this.settings.search,\n                a = s.ajax ? s.ajax : false,\n                m = this._model.data,\n                f = null,\n                r = [],\n                p = [], i, j;\n            if(this._data.search.res.length && !append) {\n                this.clear_search();\n            }\n            if(show_only_matches === undefined) {\n                show_only_matches = s.show_only_matches;\n            }\n            if(show_only_matches_children === undefined) {\n                show_only_matches_children = s.show_only_matches_children;\n            }\n            if(!skip_async && a !== false) {\n                if($.vakata.is_function(a)) {\n                    return a.call(this, str, function (d) {\n                        if(d && d.d) { d = d.d; }\n                        this._load_nodes(!$.vakata.is_array(d) ? [] : $.vakata.array_unique(d), function () {\n                            this.search(str, true, show_only_matches, inside, append, show_only_matches_children);\n                        });\n                    }.bind(this), inside);\n                }\n                else {\n                    a = $.extend({}, a);\n                    if(!a.data) { a.data = {}; }\n                    a.data.str = str;\n                    if(inside) {\n                        a.data.inside = inside;\n                    }\n                    if (this._data.search.lastRequest) {\n                        this._data.search.lastRequest.abort();\n                    }\n                    this._data.search.lastRequest = $.ajax(a)\n                        .fail(function () {\n                            this._data.core.last_error = { 'error' : 'ajax', 'plugin' : 'search', 'id' : 'search_01', 'reason' : 'Could not load search parents', 'data' : JSON.stringify(a) };\n                            this.settings.core.error.call(this, this._data.core.last_error);\n                        }.bind(this))\n                        .done(function (d) {\n                            if(d && d.d) { d = d.d; }\n                            this._load_nodes(!$.vakata.is_array(d) ? [] : $.vakata.array_unique(d), function () {\n                                this.search(str, true, show_only_matches, inside, append, show_only_matches_children);\n                            });\n                        }.bind(this));\n                    return this._data.search.lastRequest;\n                }\n            }\n            if(!append) {\n                this._data.search.str = str;\n                this._data.search.dom = $();\n                this._data.search.res = [];\n                this._data.search.opn = [];\n                this._data.search.som = show_only_matches;\n                this._data.search.smc = show_only_matches_children;\n            }\n\n            f = new $.vakata.search(str, true, { caseSensitive : s.case_sensitive, fuzzy : s.fuzzy });\n            $.each(m[inside ? inside : $.jstree.root].children_d, function (ii, i) {\n                var v = m[i];\n                if(v.text && !v.state.hidden && (!s.search_leaves_only || (v.state.loaded && v.children.length === 0)) && ( (s.search_callback && s.search_callback.call(this, str, v)) || (!s.search_callback && f.search(v.text).isMatch) ) ) {\n                    r.push(i);\n                    p = p.concat(v.parents);\n                }\n            });\n            if(r.length) {\n                p = $.vakata.array_unique(p);\n                for(i = 0, j = p.length; i < j; i++) {\n                    if(p[i] !== $.jstree.root && m[p[i]] && this.open_node(p[i], null, 0) === true) {\n                        this._data.search.opn.push(p[i]);\n                    }\n                }\n                if(!append) {\n                    this._data.search.dom = $(this.element[0].querySelectorAll('#' + $.map(r, function (v) { return \"0123456789\".indexOf(v[0]) !== -1 ? '\\\\3' + v[0] + ' ' + v.substr(1).replace($.jstree.idregex,'\\\\$&') : v.replace($.jstree.idregex,'\\\\$&'); }).join(', #')));\n                    this._data.search.res = r;\n                }\n                else {\n                    this._data.search.dom = this._data.search.dom.add($(this.element[0].querySelectorAll('#' + $.map(r, function (v) { return \"0123456789\".indexOf(v[0]) !== -1 ? '\\\\3' + v[0] + ' ' + v.substr(1).replace($.jstree.idregex,'\\\\$&') : v.replace($.jstree.idregex,'\\\\$&'); }).join(', #'))));\n                    this._data.search.res = $.vakata.array_unique(this._data.search.res.concat(r));\n                }\n                this._data.search.dom.children(\".jstree-anchor\").addClass('jstree-search');\n            }\n            /**\n             * triggered after search is complete\n             * @event\n             * @name search.jstree\n             * @param {jQuery} nodes a jQuery collection of matching nodes\n             * @param {String} str the search string\n             * @param {Array} res a collection of objects represeing the matching nodes\n             * @plugin search\n             */\n            this.trigger('search', { nodes : this._data.search.dom, str : str, res : this._data.search.res, show_only_matches : show_only_matches });\n        };\n        /**\n         * used to clear the last search (removes classes and shows all nodes if filtering is on)\n         * @name clear_search()\n         * @plugin search\n         * @trigger clear_search.jstree\n         */\n        this.clear_search = function () {\n            if(this.settings.search.close_opened_onclear) {\n                this.close_node(this._data.search.opn, 0);\n            }\n            /**\n             * triggered after search is complete\n             * @event\n             * @name clear_search.jstree\n             * @param {jQuery} nodes a jQuery collection of matching nodes (the result from the last search)\n             * @param {String} str the search string (the last search string)\n             * @param {Array} res a collection of objects represeing the matching nodes (the result from the last search)\n             * @plugin search\n             */\n            this.trigger('clear_search', { 'nodes' : this._data.search.dom, str : this._data.search.str, res : this._data.search.res });\n            if(this._data.search.res.length) {\n                this._data.search.dom = $(this.element[0].querySelectorAll('#' + $.map(this._data.search.res, function (v) {\n                    return \"0123456789\".indexOf(v[0]) !== -1 ? '\\\\3' + v[0] + ' ' + v.substr(1).replace($.jstree.idregex,'\\\\$&') : v.replace($.jstree.idregex,'\\\\$&');\n                }).join(', #')));\n                this._data.search.dom.children(\".jstree-anchor\").removeClass(\"jstree-search\");\n            }\n            this._data.search.str = \"\";\n            this._data.search.res = [];\n            this._data.search.opn = [];\n            this._data.search.dom = $();\n        };\n\n        this.redraw_node = function(obj, deep, callback, force_render) {\n            obj = parent.redraw_node.apply(this, arguments);\n            if(obj) {\n                if($.inArray(obj.id, this._data.search.res) !== -1) {\n                    var i, j, tmp = null;\n                    for(i = 0, j = obj.childNodes.length; i < j; i++) {\n                        if(obj.childNodes[i] && obj.childNodes[i].className && obj.childNodes[i].className.indexOf(\"jstree-anchor\") !== -1) {\n                            tmp = obj.childNodes[i];\n                            break;\n                        }\n                    }\n                    if(tmp) {\n                        tmp.className += ' jstree-search';\n                    }\n                }\n            }\n            return obj;\n        };\n    };\n\n    // helpers\n    (function ($) {\n        // from http://kiro.me/projects/fuse.html\n        $.vakata.search = function(pattern, txt, options) {\n            options = options || {};\n            options = $.extend({}, $.vakata.search.defaults, options);\n            if(options.fuzzy !== false) {\n                options.fuzzy = true;\n            }\n            pattern = options.caseSensitive ? pattern : pattern.toLowerCase();\n            var MATCH_LOCATION\t= options.location,\n                MATCH_DISTANCE\t= options.distance,\n                MATCH_THRESHOLD\t= options.threshold,\n                patternLen = pattern.length,\n                matchmask, pattern_alphabet, match_bitapScore, search;\n            if(patternLen > 32) {\n                options.fuzzy = false;\n            }\n            if(options.fuzzy) {\n                matchmask = 1 << (patternLen - 1);\n                pattern_alphabet = (function () {\n                    var mask = {},\n                        i = 0;\n                    for (i = 0; i < patternLen; i++) {\n                        mask[pattern.charAt(i)] = 0;\n                    }\n                    for (i = 0; i < patternLen; i++) {\n                        mask[pattern.charAt(i)] |= 1 << (patternLen - i - 1);\n                    }\n                    return mask;\n                }());\n                match_bitapScore = function (e, x) {\n                    var accuracy = e / patternLen,\n                        proximity = Math.abs(MATCH_LOCATION - x);\n                    if(!MATCH_DISTANCE) {\n                        return proximity ? 1.0 : accuracy;\n                    }\n                    return accuracy + (proximity / MATCH_DISTANCE);\n                };\n            }\n            search = function (text) {\n                text = options.caseSensitive ? text.toString() : text.toString().toLowerCase();\n                if(pattern === text || text.indexOf(pattern) !== -1) {\n                    return {\n                        isMatch: true,\n                        score: 0\n                    };\n                }\n                if(!options.fuzzy) {\n                    return {\n                        isMatch: false,\n                        score: 1\n                    };\n                }\n                var i, j,\n                    textLen = text.length,\n                    scoreThreshold = MATCH_THRESHOLD,\n                    bestLoc = text.indexOf(pattern, MATCH_LOCATION),\n                    binMin, binMid,\n                    binMax = patternLen + textLen,\n                    lastRd, start, finish, rd, charMatch,\n                    score = 1,\n                    locations = [];\n                if (bestLoc !== -1) {\n                    scoreThreshold = Math.min(match_bitapScore(0, bestLoc), scoreThreshold);\n                    bestLoc = text.lastIndexOf(pattern, MATCH_LOCATION + patternLen);\n                    if (bestLoc !== -1) {\n                        scoreThreshold = Math.min(match_bitapScore(0, bestLoc), scoreThreshold);\n                    }\n                }\n                bestLoc = -1;\n                for (i = 0; i < patternLen; i++) {\n                    binMin = 0;\n                    binMid = binMax;\n                    while (binMin < binMid) {\n                        if (match_bitapScore(i, MATCH_LOCATION + binMid) <= scoreThreshold) {\n                            binMin = binMid;\n                        } else {\n                            binMax = binMid;\n                        }\n                        binMid = Math.floor((binMax - binMin) / 2 + binMin);\n                    }\n                    binMax = binMid;\n                    start = Math.max(1, MATCH_LOCATION - binMid + 1);\n                    finish = Math.min(MATCH_LOCATION + binMid, textLen) + patternLen;\n                    rd = new Array(finish + 2);\n                    rd[finish + 1] = (1 << i) - 1;\n                    for (j = finish; j >= start; j--) {\n                        charMatch = pattern_alphabet[text.charAt(j - 1)];\n                        if (i === 0) {\n                            rd[j] = ((rd[j + 1] << 1) | 1) & charMatch;\n                        } else {\n                            rd[j] = ((rd[j + 1] << 1) | 1) & charMatch | (((lastRd[j + 1] | lastRd[j]) << 1) | 1) | lastRd[j + 1];\n                        }\n                        if (rd[j] & matchmask) {\n                            score = match_bitapScore(i, j - 1);\n                            if (score <= scoreThreshold) {\n                                scoreThreshold = score;\n                                bestLoc = j - 1;\n                                locations.push(bestLoc);\n                                if (bestLoc > MATCH_LOCATION) {\n                                    start = Math.max(1, 2 * MATCH_LOCATION - bestLoc);\n                                } else {\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (match_bitapScore(i + 1, MATCH_LOCATION) > scoreThreshold) {\n                        break;\n                    }\n                    lastRd = rd;\n                }\n                return {\n                    isMatch: bestLoc >= 0,\n                    score: score\n                };\n            };\n            return txt === true ? { 'search' : search } : search(txt);\n        };\n        $.vakata.search.defaults = {\n            location : 0,\n            distance : 100,\n            threshold : 0.6,\n            fuzzy : false,\n            caseSensitive : false\n        };\n    }($));\n\n    // include the search plugin by default\n    // $.jstree.defaults.plugins.push(\"search\");\n\n\n    /**\n     * ### Sort plugin\n     *\n     * Automatically sorts all siblings in the tree according to a sorting function.\n     */\n\n    /**\n     * the settings function used to sort the nodes.\n     * It is executed in the tree's context, accepts two nodes as arguments and should return `1` or `-1`.\n     * @name $.jstree.defaults.sort\n     * @plugin sort\n     */\n    $.jstree.defaults.sort = function (a, b) {\n        //return this.get_type(a) === this.get_type(b) ? (this.get_text(a) > this.get_text(b) ? 1 : -1) : this.get_type(a) >= this.get_type(b);\n        return this.get_text(a) > this.get_text(b) ? 1 : -1;\n    };\n    $.jstree.plugins.sort = function (options, parent) {\n        this.bind = function () {\n            parent.bind.call(this);\n            this.element\n                .on(\"model.jstree\", function (e, data) {\n                    this.sort(data.parent, true);\n                }.bind(this))\n                .on(\"rename_node.jstree create_node.jstree\", function (e, data) {\n                    this.sort(data.parent || data.node.parent, false);\n                    this.redraw_node(data.parent || data.node.parent, true);\n                }.bind(this))\n                .on(\"move_node.jstree copy_node.jstree\", function (e, data) {\n                    this.sort(data.parent, false);\n                    this.redraw_node(data.parent, true);\n                }.bind(this));\n        };\n        /**\n         * used to sort a node's children\n         * @private\n         * @name sort(obj [, deep])\n         * @param  {mixed} obj the node\n         * @param {Boolean} deep if set to `true` nodes are sorted recursively.\n         * @plugin sort\n         * @trigger search.jstree\n         */\n        this.sort = function (obj, deep) {\n            var i, j;\n            obj = this.get_node(obj);\n            if(obj && obj.children && obj.children.length) {\n                obj.children.sort(this.settings.sort.bind(this));\n                if(deep) {\n                    for(i = 0, j = obj.children_d.length; i < j; i++) {\n                        this.sort(obj.children_d[i], false);\n                    }\n                }\n            }\n        };\n    };\n\n    // include the sort plugin by default\n    // $.jstree.defaults.plugins.push(\"sort\");\n\n    /**\n     * ### State plugin\n     *\n     * Saves the state of the tree (selected nodes, opened nodes) on the user's computer using available options (localStorage, cookies, etc)\n     */\n\n    var to = false;\n    /**\n     * stores all defaults for the state plugin\n     * @name $.jstree.defaults.state\n     * @plugin state\n     */\n    $.jstree.defaults.state = {\n        /**\n         * A string for the key to use when saving the current tree (change if using multiple trees in your project). Defaults to `jstree`.\n         * @name $.jstree.defaults.state.key\n         * @plugin state\n         */\n        key\t\t: 'jstree',\n        /**\n         * A space separated list of events that trigger a state save. Defaults to `changed.jstree open_node.jstree close_node.jstree`.\n         * @name $.jstree.defaults.state.events\n         * @plugin state\n         */\n        events\t: 'changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree',\n        /**\n         * Time in milliseconds after which the state will expire. Defaults to 'false' meaning - no expire.\n         * @name $.jstree.defaults.state.ttl\n         * @plugin state\n         */\n        ttl\t\t: false,\n        /**\n         * A function that will be executed prior to restoring state with one argument - the state object. Can be used to clear unwanted parts of the state.\n         * @name $.jstree.defaults.state.filter\n         * @plugin state\n         */\n        filter\t: false,\n        /**\n         * Should loaded nodes be restored (setting this to true means that it is possible that the whole tree will be loaded for some users - use with caution). Defaults to `false`\n         * @name $.jstree.defaults.state.preserve_loaded\n         * @plugin state\n         */\n        preserve_loaded : false\n    };\n    $.jstree.plugins.state = function (options, parent) {\n        this.bind = function () {\n            parent.bind.call(this);\n            var bind = function () {\n                this.element.on(this.settings.state.events, function () {\n                    if(to) { clearTimeout(to); }\n                    to = setTimeout(function () { this.save_state(); }.bind(this), 100);\n                }.bind(this));\n                /**\n                 * triggered when the state plugin is finished restoring the state (and immediately after ready if there is no state to restore).\n                 * @event\n                 * @name state_ready.jstree\n                 * @plugin state\n                 */\n                this.trigger('state_ready');\n            }.bind(this);\n            this.element\n                .on(\"ready.jstree\", function (e, data) {\n                    this.element.one(\"restore_state.jstree\", bind);\n                    if(!this.restore_state()) { bind(); }\n                }.bind(this));\n        };\n        /**\n         * save the state\n         * @name save_state()\n         * @plugin state\n         */\n        this.save_state = function () {\n            var tm = this.get_state();\n            if (!this.settings.state.preserve_loaded) {\n                delete tm.core.loaded;\n            }\n            var st = { 'state' : tm, 'ttl' : this.settings.state.ttl, 'sec' : +(new Date()) };\n            $.vakata.storage.set(this.settings.state.key, JSON.stringify(st));\n        };\n        /**\n         * restore the state from the user's computer\n         * @name restore_state()\n         * @plugin state\n         */\n        this.restore_state = function () {\n            var k = $.vakata.storage.get(this.settings.state.key);\n            if(!!k) { try { k = JSON.parse(k); } catch(ex) { return false; } }\n            if(!!k && k.ttl && k.sec && +(new Date()) - k.sec > k.ttl) { return false; }\n            if(!!k && k.state) { k = k.state; }\n            if(!!k && $.vakata.is_function(this.settings.state.filter)) { k = this.settings.state.filter.call(this, k); }\n            if(!!k) {\n                if (!this.settings.state.preserve_loaded) {\n                    delete k.core.loaded;\n                }\n                this.element.one(\"set_state.jstree\", function (e, data) { data.instance.trigger('restore_state', { 'state' : $.extend(true, {}, k) }); });\n                this.set_state(k);\n                return true;\n            }\n            return false;\n        };\n        /**\n         * clear the state on the user's computer\n         * @name clear_state()\n         * @plugin state\n         */\n        this.clear_state = function () {\n            return $.vakata.storage.del(this.settings.state.key);\n        };\n    };\n\n    (function ($, undefined) {\n        $.vakata.storage = {\n            // simply specifying the functions in FF throws an error\n            set : function (key, val) { return window.localStorage.setItem(key, val); },\n            get : function (key) { return window.localStorage.getItem(key); },\n            del : function (key) { return window.localStorage.removeItem(key); }\n        };\n    }($));\n\n    // include the state plugin by default\n    // $.jstree.defaults.plugins.push(\"state\");\n\n    /**\n     * ### Types plugin\n     *\n     * Makes it possible to add predefined types for groups of nodes, which make it possible to easily control nesting rules and icon for each group.\n     */\n\n    /**\n     * An object storing all types as key value pairs, where the key is the type name and the value is an object that could contain following keys (all optional).\n     *\n     * * `max_children` the maximum number of immediate children this node type can have. Do not specify or set to `-1` for unlimited.\n     * * `max_depth` the maximum number of nesting this node type can have. A value of `1` would mean that the node can have children, but no grandchildren. Do not specify or set to `-1` for unlimited.\n     * * `valid_children` an array of node type strings, that nodes of this type can have as children. Do not specify or set to `-1` for no limits.\n     * * `icon` a string - can be a path to an icon or a className, if using an image that is in the current directory use a `./` prefix, otherwise it will be detected as a class. Omit to use the default icon from your theme.\n     * * `li_attr` an object of values which will be used to add HTML attributes on the resulting LI DOM node (merged with the node's own data)\n     * * `a_attr` an object of values which will be used to add HTML attributes on the resulting A DOM node (merged with the node's own data)\n     *\n     * There are two predefined types:\n     *\n     * * `#` represents the root of the tree, for example `max_children` would control the maximum number of root nodes.\n     * * `default` represents the default node - any settings here will be applied to all nodes that do not have a type specified.\n     *\n     * @name $.jstree.defaults.types\n     * @plugin types\n     */\n    $.jstree.defaults.types = {\n        'default' : {}\n    };\n    $.jstree.defaults.types[$.jstree.root] = {};\n\n    $.jstree.plugins.types = function (options, parent) {\n        this.init = function (el, options) {\n            var i, j;\n            if(options && options.types && options.types['default']) {\n                for(i in options.types) {\n                    if(i !== \"default\" && i !== $.jstree.root && options.types.hasOwnProperty(i)) {\n                        for(j in options.types['default']) {\n                            if(options.types['default'].hasOwnProperty(j) && options.types[i][j] === undefined) {\n                                options.types[i][j] = options.types['default'][j];\n                            }\n                        }\n                    }\n                }\n            }\n            parent.init.call(this, el, options);\n            this._model.data[$.jstree.root].type = $.jstree.root;\n        };\n        this.refresh = function (skip_loading, forget_state) {\n            parent.refresh.call(this, skip_loading, forget_state);\n            this._model.data[$.jstree.root].type = $.jstree.root;\n        };\n        this.bind = function () {\n            this.element\n                .on('model.jstree', function (e, data) {\n                    var m = this._model.data,\n                        dpc = data.nodes,\n                        t = this.settings.types,\n                        i, j, c = 'default', k;\n                    for(i = 0, j = dpc.length; i < j; i++) {\n                        c = 'default';\n                        if(m[dpc[i]].original && m[dpc[i]].original.type && t[m[dpc[i]].original.type]) {\n                            c = m[dpc[i]].original.type;\n                        }\n                        if(m[dpc[i]].data && m[dpc[i]].data.jstree && m[dpc[i]].data.jstree.type && t[m[dpc[i]].data.jstree.type]) {\n                            c = m[dpc[i]].data.jstree.type;\n                        }\n                        m[dpc[i]].type = c;\n                        if(m[dpc[i]].icon === true && t[c].icon !== undefined) {\n                            m[dpc[i]].icon = t[c].icon;\n                        }\n                        if(t[c].li_attr !== undefined && typeof t[c].li_attr === 'object') {\n                            for (k in t[c].li_attr) {\n                                if (t[c].li_attr.hasOwnProperty(k)) {\n                                    if (k === 'id') {\n                                        continue;\n                                    }\n                                    else if (m[dpc[i]].li_attr[k] === undefined) {\n                                        m[dpc[i]].li_attr[k] = t[c].li_attr[k];\n                                    }\n                                    else if (k === 'class') {\n                                        m[dpc[i]].li_attr['class'] = t[c].li_attr['class'] + ' ' + m[dpc[i]].li_attr['class'];\n                                    }\n                                }\n                            }\n                        }\n                        if(t[c].a_attr !== undefined && typeof t[c].a_attr === 'object') {\n                            for (k in t[c].a_attr) {\n                                if (t[c].a_attr.hasOwnProperty(k)) {\n                                    if (k === 'id') {\n                                        continue;\n                                    }\n                                    else if (m[dpc[i]].a_attr[k] === undefined) {\n                                        m[dpc[i]].a_attr[k] = t[c].a_attr[k];\n                                    }\n                                    else if (k === 'href' && m[dpc[i]].a_attr[k] === '#') {\n                                        m[dpc[i]].a_attr['href'] = t[c].a_attr['href'];\n                                    }\n                                    else if (k === 'class') {\n                                        m[dpc[i]].a_attr['class'] = t[c].a_attr['class'] + ' ' + m[dpc[i]].a_attr['class'];\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    m[$.jstree.root].type = $.jstree.root;\n                }.bind(this));\n            parent.bind.call(this);\n        };\n        this.get_json = function (obj, options, flat) {\n            var i, j,\n                m = this._model.data,\n                opt = options ? $.extend(true, {}, options, {no_id:false}) : {},\n                tmp = parent.get_json.call(this, obj, opt, flat);\n            if(tmp === false) { return false; }\n            if($.vakata.is_array(tmp)) {\n                for(i = 0, j = tmp.length; i < j; i++) {\n                    tmp[i].type = (tmp[i].id || tmp[i].id === 0) && m[tmp[i].id] && m[tmp[i].id].type ? m[tmp[i].id].type : \"default\";\n                    if(options && options.no_id) {\n                        delete tmp[i].id;\n                        if(tmp[i].li_attr && tmp[i].li_attr.id) {\n                            delete tmp[i].li_attr.id;\n                        }\n                        if(tmp[i].a_attr && tmp[i].a_attr.id) {\n                            delete tmp[i].a_attr.id;\n                        }\n                    }\n                }\n            }\n            else {\n                tmp.type = (tmp.id || tmp.id === 0) && m[tmp.id] && m[tmp.id].type ? m[tmp.id].type : \"default\";\n                if(options && options.no_id) {\n                    tmp = this._delete_ids(tmp);\n                }\n            }\n            return tmp;\n        };\n        this._delete_ids = function (tmp) {\n            if($.vakata.is_array(tmp)) {\n                for(var i = 0, j = tmp.length; i < j; i++) {\n                    tmp[i] = this._delete_ids(tmp[i]);\n                }\n                return tmp;\n            }\n            delete tmp.id;\n            if(tmp.li_attr && tmp.li_attr.id) {\n                delete tmp.li_attr.id;\n            }\n            if(tmp.a_attr && tmp.a_attr.id) {\n                delete tmp.a_attr.id;\n            }\n            if(tmp.children && $.vakata.is_array(tmp.children)) {\n                tmp.children = this._delete_ids(tmp.children);\n            }\n            return tmp;\n        };\n        this.check = function (chk, obj, par, pos, more) {\n            if(parent.check.call(this, chk, obj, par, pos, more) === false) { return false; }\n            obj = obj && (obj.id || obj.id === 0) ? obj : this.get_node(obj);\n            par = par && (par.id || par.id === 0) ? par : this.get_node(par);\n            var m = obj && (obj.id || obj.id === 0) ? (more && more.origin ? more.origin : $.jstree.reference(obj.id)) : null, tmp, d, i, j;\n            m = m && m._model && m._model.data ? m._model.data : null;\n            switch(chk) {\n                case \"create_node\":\n                case \"move_node\":\n                case \"copy_node\":\n                    if(chk !== 'move_node' || $.inArray(obj.id, par.children) === -1) {\n                        tmp = this.get_rules(par);\n                        if(tmp.max_children !== undefined && tmp.max_children !== -1 && tmp.max_children === par.children.length) {\n                            this._data.core.last_error = { 'error' : 'check', 'plugin' : 'types', 'id' : 'types_01', 'reason' : 'max_children prevents function: ' + chk, 'data' : JSON.stringify({ 'chk' : chk, 'pos' : pos, 'obj' : obj && (obj.id || obj.id === 0) ? obj.id : false, 'par' : par && (par.id || par.id === 0) ? par.id : false }) };\n                            return false;\n                        }\n                        if(tmp.valid_children !== undefined && tmp.valid_children !== -1 && $.inArray((obj.type || 'default'), tmp.valid_children) === -1) {\n                            this._data.core.last_error = { 'error' : 'check', 'plugin' : 'types', 'id' : 'types_02', 'reason' : 'valid_children prevents function: ' + chk, 'data' : JSON.stringify({ 'chk' : chk, 'pos' : pos, 'obj' : obj && (obj.id || obj.id === 0) ? obj.id : false, 'par' : par && (par.id || par.id === 0) ? par.id : false }) };\n                            return false;\n                        }\n                        if(m && obj.children_d && obj.parents) {\n                            d = 0;\n                            for(i = 0, j = obj.children_d.length; i < j; i++) {\n                                d = Math.max(d, m[obj.children_d[i]].parents.length);\n                            }\n                            d = d - obj.parents.length + 1;\n                        }\n                        if(d <= 0 || d === undefined) { d = 1; }\n                        do {\n                            if(tmp.max_depth !== undefined && tmp.max_depth !== -1 && tmp.max_depth < d) {\n                                this._data.core.last_error = { 'error' : 'check', 'plugin' : 'types', 'id' : 'types_03', 'reason' : 'max_depth prevents function: ' + chk, 'data' : JSON.stringify({ 'chk' : chk, 'pos' : pos, 'obj' : obj && (obj.id || obj.id === 0) ? obj.id : false, 'par' : par && (par.id || par.id === 0) ? par.id : false }) };\n                                return false;\n                            }\n                            par = this.get_node(par.parent);\n                            tmp = this.get_rules(par);\n                            d++;\n                        } while(par);\n                    }\n                    break;\n            }\n            return true;\n        };\n        /**\n         * used to retrieve the type settings object for a node\n         * @name get_rules(obj)\n         * @param {mixed} obj the node to find the rules for\n         * @return {Object}\n         * @plugin types\n         */\n        this.get_rules = function (obj) {\n            obj = this.get_node(obj);\n            if(!obj) { return false; }\n            var tmp = this.get_type(obj, true);\n            if(tmp.max_depth === undefined) { tmp.max_depth = -1; }\n            if(tmp.max_children === undefined) { tmp.max_children = -1; }\n            if(tmp.valid_children === undefined) { tmp.valid_children = -1; }\n            return tmp;\n        };\n        /**\n         * used to retrieve the type string or settings object for a node\n         * @name get_type(obj [, rules])\n         * @param {mixed} obj the node to find the rules for\n         * @param {Boolean} rules if set to `true` instead of a string the settings object will be returned\n         * @return {String|Object}\n         * @plugin types\n         */\n        this.get_type = function (obj, rules) {\n            obj = this.get_node(obj);\n            return (!obj) ? false : ( rules ? $.extend({ 'type' : obj.type }, this.settings.types[obj.type]) : obj.type);\n        };\n        /**\n         * used to change a node's type\n         * @name set_type(obj, type)\n         * @param {mixed} obj the node to change\n         * @param {String} type the new type\n         * @plugin types\n         */\n        this.set_type = function (obj, type) {\n            var m = this._model.data, t, t1, t2, old_type, old_icon, k, d, a;\n            if($.vakata.is_array(obj)) {\n                obj = obj.slice();\n                for(t1 = 0, t2 = obj.length; t1 < t2; t1++) {\n                    this.set_type(obj[t1], type);\n                }\n                return true;\n            }\n            t = this.settings.types;\n            obj = this.get_node(obj);\n            if(!t[type] || !obj) { return false; }\n            d = this.get_node(obj, true);\n            if (d && d.length) {\n                a = d.children('.jstree-anchor');\n            }\n            old_type = obj.type;\n            old_icon = this.get_icon(obj);\n            obj.type = type;\n            if(old_icon === true || !t[old_type] || (t[old_type].icon !== undefined && old_icon === t[old_type].icon)) {\n                this.set_icon(obj, t[type].icon !== undefined ? t[type].icon : true);\n            }\n\n            // remove old type props\n            if(t[old_type] && t[old_type].li_attr !== undefined && typeof t[old_type].li_attr === 'object') {\n                for (k in t[old_type].li_attr) {\n                    if (t[old_type].li_attr.hasOwnProperty(k)) {\n                        if (k === 'id') {\n                            continue;\n                        }\n                        else if (k === 'class') {\n                            m[obj.id].li_attr['class'] = (m[obj.id].li_attr['class'] || '').replace(t[old_type].li_attr[k], '');\n                            if (d) { d.removeClass(t[old_type].li_attr[k]); }\n                        }\n                        else if (m[obj.id].li_attr[k] === t[old_type].li_attr[k]) {\n                            m[obj.id].li_attr[k] = null;\n                            if (d) { d.removeAttr(k); }\n                        }\n                    }\n                }\n            }\n            if(t[old_type] && t[old_type].a_attr !== undefined && typeof t[old_type].a_attr === 'object') {\n                for (k in t[old_type].a_attr) {\n                    if (t[old_type].a_attr.hasOwnProperty(k)) {\n                        if (k === 'id') {\n                            continue;\n                        }\n                        else if (k === 'class') {\n                            m[obj.id].a_attr['class'] = (m[obj.id].a_attr['class'] || '').replace(t[old_type].a_attr[k], '');\n                            if (a) { a.removeClass(t[old_type].a_attr[k]); }\n                        }\n                        else if (m[obj.id].a_attr[k] === t[old_type].a_attr[k]) {\n                            if (k === 'href') {\n                                m[obj.id].a_attr[k] = '#';\n                                if (a) { a.attr('href', '#'); }\n                            }\n                            else {\n                                delete m[obj.id].a_attr[k];\n                                if (a) { a.removeAttr(k); }\n                            }\n                        }\n                    }\n                }\n            }\n\n            // add new props\n            if(t[type].li_attr !== undefined && typeof t[type].li_attr === 'object') {\n                for (k in t[type].li_attr) {\n                    if (t[type].li_attr.hasOwnProperty(k)) {\n                        if (k === 'id') {\n                            continue;\n                        }\n                        else if (m[obj.id].li_attr[k] === undefined) {\n                            m[obj.id].li_attr[k] = t[type].li_attr[k];\n                            if (d) {\n                                if (k === 'class') {\n                                    d.addClass(t[type].li_attr[k]);\n                                }\n                                else {\n                                    d.attr(k, t[type].li_attr[k]);\n                                }\n                            }\n                        }\n                        else if (k === 'class') {\n                            m[obj.id].li_attr['class'] = t[type].li_attr[k] + ' ' + m[obj.id].li_attr['class'];\n                            if (d) { d.addClass(t[type].li_attr[k]); }\n                        }\n                    }\n                }\n            }\n            if(t[type].a_attr !== undefined && typeof t[type].a_attr === 'object') {\n                for (k in t[type].a_attr) {\n                    if (t[type].a_attr.hasOwnProperty(k)) {\n                        if (k === 'id') {\n                            continue;\n                        }\n                        else if (m[obj.id].a_attr[k] === undefined) {\n                            m[obj.id].a_attr[k] = t[type].a_attr[k];\n                            if (a) {\n                                if (k === 'class') {\n                                    a.addClass(t[type].a_attr[k]);\n                                }\n                                else {\n                                    a.attr(k, t[type].a_attr[k]);\n                                }\n                            }\n                        }\n                        else if (k === 'href' && m[obj.id].a_attr[k] === '#') {\n                            m[obj.id].a_attr['href'] = t[type].a_attr['href'];\n                            if (a) { a.attr('href', t[type].a_attr['href']); }\n                        }\n                        else if (k === 'class') {\n                            m[obj.id].a_attr['class'] = t[type].a_attr['class'] + ' ' + m[obj.id].a_attr['class'];\n                            if (a) { a.addClass(t[type].a_attr[k]); }\n                        }\n                    }\n                }\n            }\n\n            return true;\n        };\n    };\n    // include the types plugin by default\n    // $.jstree.defaults.plugins.push(\"types\");\n\n\n    /**\n     * ### Unique plugin\n     *\n     * Enforces that no nodes with the same name can coexist as siblings.\n     */\n\n    /**\n     * stores all defaults for the unique plugin\n     * @name $.jstree.defaults.unique\n     * @plugin unique\n     */\n    $.jstree.defaults.unique = {\n        /**\n         * Indicates if the comparison should be case sensitive. Default is `false`.\n         * @name $.jstree.defaults.unique.case_sensitive\n         * @plugin unique\n         */\n        case_sensitive : false,\n        /**\n         * Indicates if white space should be trimmed before the comparison. Default is `false`.\n         * @name $.jstree.defaults.unique.trim_whitespace\n         * @plugin unique\n         */\n        trim_whitespace : false,\n        /**\n         * A callback executed in the instance's scope when a new node is created with no name and a node with the default name already exists, the two arguments are the conflicting name and the counter. The default will produce results like `New node (2)`.\n         * @name $.jstree.defaults.unique.duplicate\n         * @plugin unique\n         */\n        duplicate : function (name, counter) {\n            return name + ' (' + counter + ')';\n        }\n    };\n\n    $.jstree.plugins.unique = function (options, parent) {\n        this.check = function (chk, obj, par, pos, more) {\n            if(parent.check.call(this, chk, obj, par, pos, more) === false) { return false; }\n            obj = obj && (obj.id || obj.id === 0) ? obj : this.get_node(obj);\n            par = par && (par.id || par.id === 0) ? par : this.get_node(par);\n            if(!par || !par.children) { return true; }\n            var n = chk === \"rename_node\" ? pos : obj.text,\n                c = [],\n                s = this.settings.unique.case_sensitive,\n                w = this.settings.unique.trim_whitespace,\n                m = this._model.data, i, j, t;\n            for(i = 0, j = par.children.length; i < j; i++) {\n                t = m[par.children[i]].text;\n                if (!s) {\n                    t = t.toLowerCase();\n                }\n                if (w) {\n                    t = t.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n                }\n                c.push(t);\n            }\n            if(!s) { n = n.toLowerCase(); }\n            if (w) { n = n.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, ''); }\n            switch(chk) {\n                case \"delete_node\":\n                    return true;\n                case \"rename_node\":\n                    t = obj.text || '';\n                    if (!s) {\n                        t = t.toLowerCase();\n                    }\n                    if (w) {\n                        t = t.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n                    }\n                    i = ($.inArray(n, c) === -1 || (obj.text && t === n));\n                    if(!i) {\n                        this._data.core.last_error = { 'error' : 'check', 'plugin' : 'unique', 'id' : 'unique_01', 'reason' : 'Child with name ' + n + ' already exists. Preventing: ' + chk, 'data' : JSON.stringify({ 'chk' : chk, 'pos' : pos, 'obj' : obj && (obj.id || obj.id === 0) ? obj.id : false, 'par' : par && (par.id || par.id === 0) ? par.id : false }) };\n                    }\n                    return i;\n                case \"create_node\":\n                    i = ($.inArray(n, c) === -1);\n                    if(!i) {\n                        this._data.core.last_error = { 'error' : 'check', 'plugin' : 'unique', 'id' : 'unique_04', 'reason' : 'Child with name ' + n + ' already exists. Preventing: ' + chk, 'data' : JSON.stringify({ 'chk' : chk, 'pos' : pos, 'obj' : obj && (obj.id || obj.id === 0) ? obj.id : false, 'par' : par && (par.id || par.id === 0) ? par.id : false }) };\n                    }\n                    return i;\n                case \"copy_node\":\n                    i = ($.inArray(n, c) === -1);\n                    if(!i) {\n                        this._data.core.last_error = { 'error' : 'check', 'plugin' : 'unique', 'id' : 'unique_02', 'reason' : 'Child with name ' + n + ' already exists. Preventing: ' + chk, 'data' : JSON.stringify({ 'chk' : chk, 'pos' : pos, 'obj' : obj && (obj.id || obj.id === 0) ? obj.id : false, 'par' : par && (par.id || par.id === 0) ? par.id : false }) };\n                    }\n                    return i;\n                case \"move_node\":\n                    i = ( (obj.parent === par.id && (!more || !more.is_multi)) || $.inArray(n, c) === -1);\n                    if(!i) {\n                        this._data.core.last_error = { 'error' : 'check', 'plugin' : 'unique', 'id' : 'unique_03', 'reason' : 'Child with name ' + n + ' already exists. Preventing: ' + chk, 'data' : JSON.stringify({ 'chk' : chk, 'pos' : pos, 'obj' : obj && (obj.id || obj.id === 0) ? obj.id : false, 'par' : par && (par.id || par.id === 0) ? par.id : false }) };\n                    }\n                    return i;\n            }\n            return true;\n        };\n        this.create_node = function (par, node, pos, callback, is_loaded) {\n            if(!node || (typeof node === 'object' && node.text === undefined)) {\n                if(par === null) {\n                    par = $.jstree.root;\n                }\n                par = this.get_node(par);\n                if(!par) {\n                    return parent.create_node.call(this, par, node, pos, callback, is_loaded);\n                }\n                pos = pos === undefined ? \"last\" : pos;\n                if(!pos.toString().match(/^(before|after)$/) && !is_loaded && !this.is_loaded(par)) {\n                    return parent.create_node.call(this, par, node, pos, callback, is_loaded);\n                }\n                if(!node) { node = {}; }\n                var tmp, n, dpc, i, j, m = this._model.data, s = this.settings.unique.case_sensitive, w = this.settings.unique.trim_whitespace, cb = this.settings.unique.duplicate, t;\n                n = tmp = this.get_string('New node');\n                dpc = [];\n                for(i = 0, j = par.children.length; i < j; i++) {\n                    t = m[par.children[i]].text;\n                    if (!s) {\n                        t = t.toLowerCase();\n                    }\n                    if (w) {\n                        t = t.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n                    }\n                    dpc.push(t);\n                }\n                i = 1;\n                t = n;\n                if (!s) {\n                    t = t.toLowerCase();\n                }\n                if (w) {\n                    t = t.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n                }\n                while($.inArray(t, dpc) !== -1) {\n                    n = cb.call(this, tmp, (++i)).toString();\n                    t = n;\n                    if (!s) {\n                        t = t.toLowerCase();\n                    }\n                    if (w) {\n                        t = t.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n                    }\n                }\n                node.text = n;\n            }\n            return parent.create_node.call(this, par, node, pos, callback, is_loaded);\n        };\n    };\n\n    // include the unique plugin by default\n    // $.jstree.defaults.plugins.push(\"unique\");\n\n\n    /**\n     * ### Wholerow plugin\n     *\n     * Makes each node appear block level. Making selection easier. May cause slow down for large trees in old browsers.\n     */\n\n    var div = document.createElement('DIV');\n    div.setAttribute('unselectable','on');\n    div.setAttribute('role','presentation');\n    div.className = 'jstree-wholerow';\n    div.innerHTML = '&#160;';\n    $.jstree.plugins.wholerow = function (options, parent) {\n        this.bind = function () {\n            parent.bind.call(this);\n\n            this.element\n                .on('ready.jstree set_state.jstree', function () {\n                    this.hide_dots();\n                }.bind(this))\n                .on(\"init.jstree loading.jstree ready.jstree\", function () {\n                    //div.style.height = this._data.core.li_height + 'px';\n                    this.get_container_ul().addClass('jstree-wholerow-ul');\n                }.bind(this))\n                .on(\"deselect_all.jstree\", function (e, data) {\n                    this.element.find('.jstree-wholerow-clicked').removeClass('jstree-wholerow-clicked');\n                }.bind(this))\n                .on(\"changed.jstree\", function (e, data) {\n                    this.element.find('.jstree-wholerow-clicked').removeClass('jstree-wholerow-clicked');\n                    var tmp = false, i, j;\n                    for(i = 0, j = data.selected.length; i < j; i++) {\n                        tmp = this.get_node(data.selected[i], true);\n                        if(tmp && tmp.length) {\n                            tmp.children('.jstree-wholerow').addClass('jstree-wholerow-clicked');\n                        }\n                    }\n                }.bind(this))\n                .on(\"open_node.jstree\", function (e, data) {\n                    this.get_node(data.node, true).find('.jstree-clicked').parent().children('.jstree-wholerow').addClass('jstree-wholerow-clicked');\n                }.bind(this))\n                .on(\"hover_node.jstree dehover_node.jstree\", function (e, data) {\n                    if(e.type === \"hover_node\" && this.is_disabled(data.node)) { return; }\n                    this.get_node(data.node, true).children('.jstree-wholerow')[e.type === \"hover_node\"?\"addClass\":\"removeClass\"]('jstree-wholerow-hovered');\n                }.bind(this))\n                .on(\"contextmenu.jstree\", \".jstree-wholerow\", function (e) {\n                    if (this._data.contextmenu) {\n                        e.preventDefault();\n                        var tmp = $.Event('contextmenu', { metaKey : e.metaKey, ctrlKey : e.ctrlKey, altKey : e.altKey, shiftKey : e.shiftKey, pageX : e.pageX, pageY : e.pageY });\n                        $(e.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\").first().trigger(tmp);\n                    }\n                }.bind(this))\n                /*!\n\t\t\t\t.on(\"mousedown.jstree touchstart.jstree\", \".jstree-wholerow\", function (e) {\n\t\t\t\t\t\tif(e.target === e.currentTarget) {\n\t\t\t\t\t\t\tvar a = $(e.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\");\n\t\t\t\t\t\t\te.target = a[0];\n\t\t\t\t\t\t\ta.trigger(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t*/\n                .on(\"click.jstree\", \".jstree-wholerow\", function (e) {\n                    e.stopImmediatePropagation();\n                    var tmp = $.Event('click', { metaKey : e.metaKey, ctrlKey : e.ctrlKey, altKey : e.altKey, shiftKey : e.shiftKey });\n                    $(e.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\").first().trigger(tmp).trigger('focus');\n                })\n                .on(\"dblclick.jstree\", \".jstree-wholerow\", function (e) {\n                    e.stopImmediatePropagation();\n                    var tmp = $.Event('dblclick', { metaKey : e.metaKey, ctrlKey : e.ctrlKey, altKey : e.altKey, shiftKey : e.shiftKey });\n                    $(e.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\").first().trigger(tmp).trigger('focus');\n                })\n                .on(\"click.jstree\", \".jstree-leaf > .jstree-ocl\", function (e) {\n                    e.stopImmediatePropagation();\n                    var tmp = $.Event('click', { metaKey : e.metaKey, ctrlKey : e.ctrlKey, altKey : e.altKey, shiftKey : e.shiftKey });\n                    $(e.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\").first().trigger(tmp).trigger('focus');\n                }.bind(this))\n                .on(\"mouseover.jstree\", \".jstree-wholerow, .jstree-icon\", function (e) {\n                    e.stopImmediatePropagation();\n                    if(!this.is_disabled(e.currentTarget)) {\n                        this.hover_node(e.currentTarget);\n                    }\n                    return false;\n                }.bind(this))\n                .on(\"mouseleave.jstree\", \".jstree-node\", function (e) {\n                    this.dehover_node(e.currentTarget);\n                }.bind(this));\n        };\n        this.teardown = function () {\n            if(this.settings.wholerow) {\n                this.element.find(\".jstree-wholerow\").remove();\n            }\n            parent.teardown.call(this);\n        };\n        this.redraw_node = function(obj, deep, callback, force_render) {\n            obj = parent.redraw_node.apply(this, arguments);\n            if(obj) {\n                var tmp = div.cloneNode(true);\n                //tmp.style.height = this._data.core.li_height + 'px';\n                if($.inArray(obj.id, this._data.core.selected) !== -1) { tmp.className += ' jstree-wholerow-clicked'; }\n                if(this._data.core.focused && this._data.core.focused === obj.id) { tmp.className += ' jstree-wholerow-hovered'; }\n                obj.insertBefore(tmp, obj.childNodes[0]);\n            }\n            return obj;\n        };\n    };\n    // include the wholerow plugin by default\n    // $.jstree.defaults.plugins.push(\"wholerow\");\n    if(window.customElements && Object && Object.create) {\n        var proto = Object.create(HTMLElement.prototype);\n        proto.createdCallback = function () {\n            var c = { core : {}, plugins : [] }, i;\n            for(i in $.jstree.plugins) {\n                if($.jstree.plugins.hasOwnProperty(i) && this.attributes[i]) {\n                    c.plugins.push(i);\n                    if(this.getAttribute(i) && JSON.parse(this.getAttribute(i))) {\n                        c[i] = JSON.parse(this.getAttribute(i));\n                    }\n                }\n            }\n            for(i in $.jstree.defaults.core) {\n                if($.jstree.defaults.core.hasOwnProperty(i) && this.attributes[i]) {\n                    c.core[i] = JSON.parse(this.getAttribute(i)) || this.getAttribute(i);\n                }\n            }\n            $(this).jstree(c);\n        };\n        // proto.attributeChangedCallback = function (name, previous, value) { };\n        try {\n            window.customElements.define(\"vakata-jstree\", function() {}, { prototype: proto });\n        } catch (ignore) { }\n    }\n\n}));\n","jquery/colorpicker/js/colorpicker.js":"/**\n *\n * Color picker\n * Author: Stefan Petre www.eyecon.ro\n * \n * Dual licensed under the MIT and GPL licenses\n * \n */\n\ndefine([\n\t\"jquery\",\n], function ($) {\n\tvar ColorPicker = function () {\n\t\tvar\n\t\t\tids = {},\n\t\t\tinAction,\n\t\t\tcharMin = 65,\n\t\t\tvisible,\n\t\t\ttpl = '<div class=\"colorpicker\"><div class=\"colorpicker_color\"><div><div></div></div></div><div class=\"colorpicker_hue\"><div></div></div><div class=\"colorpicker_new_color\"></div><div class=\"colorpicker_current_color\"></div><div class=\"colorpicker_hex\"><input type=\"text\" maxlength=\"6\" size=\"6\" /></div><div class=\"colorpicker_rgb_r colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_rgb_g colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_rgb_b colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_h colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_s colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_b colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_submit\"></div></div>',\n\t\t\tdefaults = {\n\t\t\t\teventName: 'click',\n\t\t\t\tonShow: function () {},\n\t\t\t\tonBeforeShow: function(){},\n\t\t\t\tonHide: function () {},\n\t\t\t\tonChange: function () {},\n\t\t\t\tonSubmit: function () {},\n\t\t\t\tcolor: 'ff0000',\n\t\t\t\tlivePreview: true,\n\t\t\t\tflat: false\n\t\t\t},\n\t\t\tfillRGBFields = function  (hsb, cal) {\n\t\t\t\tvar rgb = HSBToRGB(hsb);\n\t\t\t\t$(cal).data('colorpicker').fields\n\t\t\t\t\t.eq(1).val(rgb.r).end()\n\t\t\t\t\t.eq(2).val(rgb.g).end()\n\t\t\t\t\t.eq(3).val(rgb.b).end();\n\t\t\t},\n\t\t\tfillHSBFields = function  (hsb, cal) {\n\t\t\t\t$(cal).data('colorpicker').fields\n\t\t\t\t\t.eq(4).val(hsb.h).end()\n\t\t\t\t\t.eq(5).val(hsb.s).end()\n\t\t\t\t\t.eq(6).val(hsb.b).end();\n\t\t\t},\n\t\t\tfillHexFields = function (hsb, cal) {\n\t\t\t\t$(cal).data('colorpicker').fields\n\t\t\t\t\t.eq(0).val(HSBToHex(hsb)).end();\n\t\t\t},\n\t\t\tsetSelector = function (hsb, cal) {\n\t\t\t\t$(cal).data('colorpicker').selector.css('backgroundColor', '#' + HSBToHex({h: hsb.h, s: 100, b: 100}));\n\t\t\t\t$(cal).data('colorpicker').selectorIndic.css({\n\t\t\t\t\tleft: parseInt(150 * hsb.s/100, 10),\n\t\t\t\t\ttop: parseInt(150 * (100-hsb.b)/100, 10)\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetHue = function (hsb, cal) {\n\t\t\t\t$(cal).data('colorpicker').hue.css('top', parseInt(150 - 150 * hsb.h/360, 10));\n\t\t\t},\n\t\t\tsetCurrentColor = function (hsb, cal) {\n\t\t\t\t$(cal).data('colorpicker').currentColor.css('backgroundColor', '#' + HSBToHex(hsb));\n\t\t\t},\n\t\t\tsetNewColor = function (hsb, cal) {\n\t\t\t\t$(cal).data('colorpicker').newColor.css('backgroundColor', '#' + HSBToHex(hsb));\n\t\t\t},\n\t\t\tkeyDown = function (ev) {\n\t\t\t\tvar pressedKey = ev.charCode || ev.keyCode || -1;\n\t\t\t\tif ((pressedKey > charMin && pressedKey <= 90) || pressedKey == 32) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar cal = $(this).parent().parent();\n\t\t\t\tif (cal.data('colorpicker').livePreview === true) {\n\t\t\t\t\tchange.apply(this);\n\t\t\t\t}\n\t\t\t},\n\t\t\tchange = function (ev) {\n\t\t\t\tvar cal = $(this).parent().parent(), col;\n\t\t\t\tif (this.parentNode.className.indexOf('_hex') > 0) {\n\t\t\t\t\tcal.data('colorpicker').color = col = HexToHSB(fixHex(this.value));\n\t\t\t\t} else if (this.parentNode.className.indexOf('_hsb') > 0) {\n\t\t\t\t\tcal.data('colorpicker').color = col = fixHSB({\n\t\t\t\t\t\th: parseInt(cal.data('colorpicker').fields.eq(4).val(), 10),\n\t\t\t\t\t\ts: parseInt(cal.data('colorpicker').fields.eq(5).val(), 10),\n\t\t\t\t\t\tb: parseInt(cal.data('colorpicker').fields.eq(6).val(), 10)\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tcal.data('colorpicker').color = col = RGBToHSB(fixRGB({\n\t\t\t\t\t\tr: parseInt(cal.data('colorpicker').fields.eq(1).val(), 10),\n\t\t\t\t\t\tg: parseInt(cal.data('colorpicker').fields.eq(2).val(), 10),\n\t\t\t\t\t\tb: parseInt(cal.data('colorpicker').fields.eq(3).val(), 10)\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t\tif (ev) {\n\t\t\t\t\tfillRGBFields(col, cal.get(0));\n\t\t\t\t\tfillHexFields(col, cal.get(0));\n\t\t\t\t\tfillHSBFields(col, cal.get(0));\n\t\t\t\t}\n\t\t\t\tsetSelector(col, cal.get(0));\n\t\t\t\tsetHue(col, cal.get(0));\n\t\t\t\tsetNewColor(col, cal.get(0));\n\t\t\t\tcal.data('colorpicker').onChange.apply(cal, [col, HSBToHex(col), HSBToRGB(col)]);\n\t\t\t},\n\t\t\tblur = function (ev) {\n\t\t\t\tvar cal = $(this).parent().parent();\n\t\t\t\tcal.data('colorpicker').fields.parent().removeClass('colorpicker_focus');\n\t\t\t},\n\t\t\tfocus = function () {\n\t\t\t\tcharMin = this.parentNode.className.indexOf('_hex') > 0 ? 70 : 65;\n\t\t\t\t$(this).parent().parent().data('colorpicker').fields.parent().removeClass('colorpicker_focus');\n\t\t\t\t$(this).parent().addClass('colorpicker_focus');\n\t\t\t},\n\t\t\tdownIncrement = function (ev) {\n\t\t\t\tvar field = $(this).parent().find('input').focus();\n\t\t\t\tvar current = {\n\t\t\t\t\tel: $(this).parent().addClass('colorpicker_slider'),\n\t\t\t\t\tmax: this.parentNode.className.indexOf('_hsb_h') > 0 ? 360 : (this.parentNode.className.indexOf('_hsb') > 0 ? 100 : 255),\n\t\t\t\t\ty: ev.pageY,\n\t\t\t\t\tfield: field,\n\t\t\t\t\tval: parseInt(field.val(), 10),\n\t\t\t\t\tpreview: $(this).parent().parent().data('colorpicker').livePreview\t\t\t\t\t\n\t\t\t\t};\n\t\t\t\t$(document).bind('mouseup', current, upIncrement);\n\t\t\t\t$(document).bind('mousemove', current, moveIncrement);\n\t\t\t},\n\t\t\tmoveIncrement = function (ev) {\n\t\t\t\tev.data.field.val(Math.max(0, Math.min(ev.data.max, parseInt(ev.data.val + ev.pageY - ev.data.y, 10))));\n\t\t\t\tif (ev.data.preview) {\n\t\t\t\t\tchange.apply(ev.data.field.get(0), [true]);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tupIncrement = function (ev) {\n\t\t\t\tchange.apply(ev.data.field.get(0), [true]);\n\t\t\t\tev.data.el.removeClass('colorpicker_slider').find('input').focus();\n\t\t\t\t$(document).unbind('mouseup', upIncrement);\n\t\t\t\t$(document).unbind('mousemove', moveIncrement);\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tdownHue = function (ev) {\n\t\t\t\tvar current = {\n\t\t\t\t\tcal: $(this).parent(),\n\t\t\t\t\ty: $(this).offset().top\n\t\t\t\t};\n\t\t\t\tcurrent.preview = current.cal.data('colorpicker').livePreview;\n\t\t\t\t$(document).bind('mouseup', current, upHue);\n\t\t\t\t$(document).bind('mousemove', current, moveHue);\n\t\t\t},\n\t\t\tmoveHue = function (ev) {\n\t\t\t\tchange.apply(\n\t\t\t\t\tev.data.cal.data('colorpicker')\n\t\t\t\t\t\t.fields\n\t\t\t\t\t\t.eq(4)\n\t\t\t\t\t\t.val(parseInt(360*(150 - Math.max(0,Math.min(150,(ev.pageY - ev.data.y))))/150, 10))\n\t\t\t\t\t\t.get(0),\n\t\t\t\t\t[ev.data.preview]\n\t\t\t\t);\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tupHue = function (ev) {\n\t\t\t\tfillRGBFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\n\t\t\t\tfillHexFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\n\t\t\t\t$(document).unbind('mouseup', upHue);\n\t\t\t\t$(document).unbind('mousemove', moveHue);\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tdownSelector = function (ev) {\n\t\t\t\tvar current = {\n\t\t\t\t\tcal: $(this).parent(),\n\t\t\t\t\tpos: $(this).offset()\n\t\t\t\t};\n\t\t\t\tcurrent.preview = current.cal.data('colorpicker').livePreview;\n\t\t\t\t$(document).bind('mouseup', current, upSelector);\n\t\t\t\t$(document).bind('mousemove', current, moveSelector);\n\t\t\t},\n\t\t\tmoveSelector = function (ev) {\n\t\t\t\tchange.apply(\n\t\t\t\t\tev.data.cal.data('colorpicker')\n\t\t\t\t\t\t.fields\n\t\t\t\t\t\t.eq(6)\n\t\t\t\t\t\t.val(parseInt(100*(150 - Math.max(0,Math.min(150,(ev.pageY - ev.data.pos.top))))/150, 10))\n\t\t\t\t\t\t.end()\n\t\t\t\t\t\t.eq(5)\n\t\t\t\t\t\t.val(parseInt(100*(Math.max(0,Math.min(150,(ev.pageX - ev.data.pos.left))))/150, 10))\n\t\t\t\t\t\t.get(0),\n\t\t\t\t\t[ev.data.preview]\n\t\t\t\t);\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tupSelector = function (ev) {\n\t\t\t\tfillRGBFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\n\t\t\t\tfillHexFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\n\t\t\t\t$(document).unbind('mouseup', upSelector);\n\t\t\t\t$(document).unbind('mousemove', moveSelector);\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tenterSubmit = function (ev) {\n\t\t\t\t$(this).addClass('colorpicker_focus');\n\t\t\t},\n\t\t\tleaveSubmit = function (ev) {\n\t\t\t\t$(this).removeClass('colorpicker_focus');\n\t\t\t},\n\t\t\tclickSubmit = function (ev) {\n\t\t\t\tvar cal = $(this).parent();\n\t\t\t\tvar col = cal.data('colorpicker').color;\n\t\t\t\tcal.data('colorpicker').origColor = col;\n\t\t\t\tsetCurrentColor(col, cal.get(0));\n\t\t\t\tcal.data('colorpicker').onSubmit(col, HSBToHex(col), HSBToRGB(col), cal.data('colorpicker').el);\n\t\t\t},\n\t\t\tshow = function (ev) {\n\t\t\t\tvar cal = $('#' + $(this).data('colorpickerId'));\n\t\t\t\tcal.data('colorpicker').onBeforeShow.apply(this, [cal.get(0)]);\n\t\t\t\tvar pos = $(this).offset();\n\t\t\t\tvar viewPort = getViewport();\n\t\t\t\tvar top = pos.top + this.offsetHeight;\n\t\t\t\tvar left = pos.left;\n\t\t\t\tif (top + 176 > viewPort.t + viewPort.h) {\n\t\t\t\t\ttop -= this.offsetHeight + 176;\n\t\t\t\t}\n\t\t\t\tif (left + 356 > viewPort.l + viewPort.w) {\n\t\t\t\t\tleft -= 356;\n\t\t\t\t}\n\t\t\t\tcal.css({left: left + 'px', top: top + 'px'});\n\t\t\t\tif (cal.data('colorpicker').onShow.apply(this, [cal.get(0)]) != false) {\n\t\t\t\t\tcal.show();\n\t\t\t\t}\n\t\t\t\t$(document).bind('mousedown', {cal: cal}, hide);\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\thide = function (ev) {\n\t\t\t\tif (!isChildOf(ev.data.cal.get(0), ev.target, ev.data.cal.get(0))) {\n\t\t\t\t\tif (ev.data.cal.data('colorpicker').onHide.apply(this, [ev.data.cal.get(0)]) != false) {\n\t\t\t\t\t\tev.data.cal.hide();\n\t\t\t\t\t}\n\t\t\t\t\t$(document).unbind('mousedown', hide);\n\t\t\t\t}\n\t\t\t},\n\t\t\tisChildOf = function(parentEl, el, container) {\n\t\t\t\tif (parentEl == el) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tif (parentEl.contains) {\n\t\t\t\t\treturn parentEl.contains(el);\n\t\t\t\t}\n\t\t\t\tif ( parentEl.compareDocumentPosition ) {\n\t\t\t\t\treturn !!(parentEl.compareDocumentPosition(el) & 16);\n\t\t\t\t}\n\t\t\t\tvar prEl = el.parentNode;\n\t\t\t\twhile(prEl && prEl != container) {\n\t\t\t\t\tif (prEl == parentEl)\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tprEl = prEl.parentNode;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tgetViewport = function () {\n\t\t\t\tvar m = document.compatMode == 'CSS1Compat';\n\t\t\t\treturn {\n\t\t\t\t\tl : window.pageXOffset || (m ? document.documentElement.scrollLeft : document.body.scrollLeft),\n\t\t\t\t\tt : window.pageYOffset || (m ? document.documentElement.scrollTop : document.body.scrollTop),\n\t\t\t\t\tw : window.innerWidth || (m ? document.documentElement.clientWidth : document.body.clientWidth),\n\t\t\t\t\th : window.innerHeight || (m ? document.documentElement.clientHeight : document.body.clientHeight)\n\t\t\t\t};\n\t\t\t},\n\t\t\tfixHSB = function (hsb) {\n\t\t\t\treturn {\n\t\t\t\t\th: Math.min(360, Math.max(0, hsb.h)),\n\t\t\t\t\ts: Math.min(100, Math.max(0, hsb.s)),\n\t\t\t\t\tb: Math.min(100, Math.max(0, hsb.b))\n\t\t\t\t};\n\t\t\t}, \n\t\t\tfixRGB = function (rgb) {\n\t\t\t\treturn {\n\t\t\t\t\tr: Math.min(255, Math.max(0, rgb.r)),\n\t\t\t\t\tg: Math.min(255, Math.max(0, rgb.g)),\n\t\t\t\t\tb: Math.min(255, Math.max(0, rgb.b))\n\t\t\t\t};\n\t\t\t},\n\t\t\tfixHex = function (hex) {\n\t\t\t\tvar len = 6 - hex.length;\n\t\t\t\tif (len > 0) {\n\t\t\t\t\tvar o = [];\n\t\t\t\t\tfor (var i=0; i<len; i++) {\n\t\t\t\t\t\to.push('0');\n\t\t\t\t\t}\n\t\t\t\t\to.push(hex);\n\t\t\t\t\thex = o.join('');\n\t\t\t\t}\n\t\t\t\treturn hex;\n\t\t\t}, \n\t\t\tHexToRGB = function (hex) {\n\t\t\t\tvar hex = parseInt(((hex.indexOf('#') > -1) ? hex.substring(1) : hex), 16);\n\t\t\t\treturn {r: hex >> 16, g: (hex & 0x00FF00) >> 8, b: (hex & 0x0000FF)};\n\t\t\t},\n\t\t\tHexToHSB = function (hex) {\n\t\t\t\treturn RGBToHSB(HexToRGB(hex));\n\t\t\t},\n\t\t\tRGBToHSB = function (rgb) {\n\t\t\t\tvar hsb = {\n\t\t\t\t\th: 0,\n\t\t\t\t\ts: 0,\n\t\t\t\t\tb: 0\n\t\t\t\t};\n\t\t\t\tvar min = Math.min(rgb.r, rgb.g, rgb.b);\n\t\t\t\tvar max = Math.max(rgb.r, rgb.g, rgb.b);\n\t\t\t\tvar delta = max - min;\n\t\t\t\thsb.b = max;\n\t\t\t\tif (max != 0) {\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\thsb.s = max != 0 ? 255 * delta / max : 0;\n\t\t\t\tif (hsb.s != 0) {\n\t\t\t\t\tif (rgb.r == max) {\n\t\t\t\t\t\thsb.h = (rgb.g - rgb.b) / delta;\n\t\t\t\t\t} else if (rgb.g == max) {\n\t\t\t\t\t\thsb.h = 2 + (rgb.b - rgb.r) / delta;\n\t\t\t\t\t} else {\n\t\t\t\t\t\thsb.h = 4 + (rgb.r - rgb.g) / delta;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\thsb.h = -1;\n\t\t\t\t}\n\t\t\t\thsb.h *= 60;\n\t\t\t\tif (hsb.h < 0) {\n\t\t\t\t\thsb.h += 360;\n\t\t\t\t}\n\t\t\t\thsb.s *= 100/255;\n\t\t\t\thsb.b *= 100/255;\n\t\t\t\treturn hsb;\n\t\t\t},\n\t\t\tHSBToRGB = function (hsb) {\n\t\t\t\tvar rgb = {};\n\t\t\t\tvar h = Math.round(hsb.h);\n\t\t\t\tvar s = Math.round(hsb.s*255/100);\n\t\t\t\tvar v = Math.round(hsb.b*255/100);\n\t\t\t\tif(s == 0) {\n\t\t\t\t\trgb.r = rgb.g = rgb.b = v;\n\t\t\t\t} else {\n\t\t\t\t\tvar t1 = v;\n\t\t\t\t\tvar t2 = (255-s)*v/255;\n\t\t\t\t\tvar t3 = (t1-t2)*(h%60)/60;\n\t\t\t\t\tif(h==360) h = 0;\n\t\t\t\t\tif(h<60) {rgb.r=t1;\trgb.b=t2; rgb.g=t2+t3}\n\t\t\t\t\telse if(h<120) {rgb.g=t1; rgb.b=t2;\trgb.r=t1-t3}\n\t\t\t\t\telse if(h<180) {rgb.g=t1; rgb.r=t2;\trgb.b=t2+t3}\n\t\t\t\t\telse if(h<240) {rgb.b=t1; rgb.r=t2;\trgb.g=t1-t3}\n\t\t\t\t\telse if(h<300) {rgb.b=t1; rgb.g=t2;\trgb.r=t2+t3}\n\t\t\t\t\telse if(h<360) {rgb.r=t1; rgb.g=t2;\trgb.b=t1-t3}\n\t\t\t\t\telse {rgb.r=0; rgb.g=0;\trgb.b=0}\n\t\t\t\t}\n\t\t\t\treturn {r:Math.round(rgb.r), g:Math.round(rgb.g), b:Math.round(rgb.b)};\n\t\t\t},\n\t\t\tRGBToHex = function (rgb) {\n\t\t\t\tvar hex = [\n\t\t\t\t\trgb.r.toString(16),\n\t\t\t\t\trgb.g.toString(16),\n\t\t\t\t\trgb.b.toString(16)\n\t\t\t\t];\n\t\t\t\t$.each(hex, function (nr, val) {\n\t\t\t\t\tif (val.length == 1) {\n\t\t\t\t\t\thex[nr] = '0' + val;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn hex.join('');\n\t\t\t},\n\t\t\tHSBToHex = function (hsb) {\n\t\t\t\treturn RGBToHex(HSBToRGB(hsb));\n\t\t\t},\n\t\t\trestoreOriginal = function () {\n\t\t\t\tvar cal = $(this).parent();\n\t\t\t\tvar col = cal.data('colorpicker').origColor;\n\t\t\t\tcal.data('colorpicker').color = col;\n\t\t\t\tfillRGBFields(col, cal.get(0));\n\t\t\t\tfillHexFields(col, cal.get(0));\n\t\t\t\tfillHSBFields(col, cal.get(0));\n\t\t\t\tsetSelector(col, cal.get(0));\n\t\t\t\tsetHue(col, cal.get(0));\n\t\t\t\tsetNewColor(col, cal.get(0));\n\t\t\t};\n\t\treturn {\n\t\t\tinit: function (opt) {\n\t\t\t\topt = $.extend({}, defaults, opt||{});\n\t\t\t\tif (typeof opt.color == 'string') {\n\t\t\t\t\topt.color = HexToHSB(opt.color);\n\t\t\t\t} else if (opt.color.r != undefined && opt.color.g != undefined && opt.color.b != undefined) {\n\t\t\t\t\topt.color = RGBToHSB(opt.color);\n\t\t\t\t} else if (opt.color.h != undefined && opt.color.s != undefined && opt.color.b != undefined) {\n\t\t\t\t\topt.color = fixHSB(opt.color);\n\t\t\t\t} else {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t\treturn this.each(function () {\n\t\t\t\t\tif (!$(this).data('colorpickerId')) {\n\t\t\t\t\t\tvar options = $.extend({}, opt);\n\t\t\t\t\t\toptions.origColor = opt.color;\n\t\t\t\t\t\tvar id = 'collorpicker_' + parseInt(Math.random() * 1000);\n\t\t\t\t\t\t$(this).data('colorpickerId', id);\n\t\t\t\t\t\tvar cal = $(tpl).attr('id', id);\n\t\t\t\t\t\tif (options.flat) {\n\t\t\t\t\t\t\tcal.appendTo(this).show();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcal.appendTo(document.body);\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptions.fields = cal\n\t\t\t\t\t\t\t\t\t\t\t.find('input')\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('keyup', keyDown)\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('change', change)\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('blur', blur)\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('focus', focus);\n\t\t\t\t\t\tcal\n\t\t\t\t\t\t\t.find('span').bind('mousedown', downIncrement).end()\n\t\t\t\t\t\t\t.find('>div.colorpicker_current_color').bind('click', restoreOriginal);\n\t\t\t\t\t\toptions.selector = cal.find('div.colorpicker_color').bind('mousedown', downSelector);\n\t\t\t\t\t\toptions.selectorIndic = options.selector.find('div div');\n\t\t\t\t\t\toptions.el = this;\n\t\t\t\t\t\toptions.hue = cal.find('div.colorpicker_hue div');\n\t\t\t\t\t\tcal.find('div.colorpicker_hue').bind('mousedown', downHue);\n\t\t\t\t\t\toptions.newColor = cal.find('div.colorpicker_new_color');\n\t\t\t\t\t\toptions.currentColor = cal.find('div.colorpicker_current_color');\n\t\t\t\t\t\tcal.data('colorpicker', options);\n\t\t\t\t\t\tcal.find('div.colorpicker_submit')\n\t\t\t\t\t\t\t.bind('mouseenter', enterSubmit)\n\t\t\t\t\t\t\t.bind('mouseleave', leaveSubmit)\n\t\t\t\t\t\t\t.bind('click', clickSubmit);\n\t\t\t\t\t\tfillRGBFields(options.color, cal.get(0));\n\t\t\t\t\t\tfillHSBFields(options.color, cal.get(0));\n\t\t\t\t\t\tfillHexFields(options.color, cal.get(0));\n\t\t\t\t\t\tsetHue(options.color, cal.get(0));\n\t\t\t\t\t\tsetSelector(options.color, cal.get(0));\n\t\t\t\t\t\tsetCurrentColor(options.color, cal.get(0));\n\t\t\t\t\t\tsetNewColor(options.color, cal.get(0));\n\t\t\t\t\t\tif (options.flat) {\n\t\t\t\t\t\t\tcal.css({\n\t\t\t\t\t\t\t\tposition: 'relative',\n\t\t\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$(this).bind(options.eventName, show);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tshowPicker: function() {\n\t\t\t\treturn this.each( function () {\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\n\t\t\t\t\t\tshow.apply(this);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\thidePicker: function() {\n\t\t\t\treturn this.each( function () {\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\n\t\t\t\t\t\t$('#' + $(this).data('colorpickerId')).hide();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetColor: function(col) {\n\t\t\t\tif (typeof col == 'string') {\n\t\t\t\t\tcol = HexToHSB(col);\n\t\t\t\t} else if (col.r != undefined && col.g != undefined && col.b != undefined) {\n\t\t\t\t\tcol = RGBToHSB(col);\n\t\t\t\t} else if (col.h != undefined && col.s != undefined && col.b != undefined) {\n\t\t\t\t\tcol = fixHSB(col);\n\t\t\t\t} else {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t\treturn this.each(function(){\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\n\t\t\t\t\t\tvar cal = $('#' + $(this).data('colorpickerId'));\n\t\t\t\t\t\tcal.data('colorpicker').color = col;\n\t\t\t\t\t\tcal.data('colorpicker').origColor = col;\n\t\t\t\t\t\tfillRGBFields(col, cal.get(0));\n\t\t\t\t\t\tfillHSBFields(col, cal.get(0));\n\t\t\t\t\t\tfillHexFields(col, cal.get(0));\n\t\t\t\t\t\tsetHue(col, cal.get(0));\n\t\t\t\t\t\tsetSelector(col, cal.get(0));\n\t\t\t\t\t\tsetCurrentColor(col, cal.get(0));\n\t\t\t\t\t\tsetNewColor(col, cal.get(0));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}();\n\t$.fn.extend({\n\t\tColorPicker: ColorPicker.init,\n\t\tColorPickerHide: ColorPicker.hidePicker,\n\t\tColorPickerShow: ColorPicker.showPicker,\n\t\tColorPickerSetColor: ColorPicker.setColor\n\t});\n});","jquery/bootstrap/tab.js":"/**\n * --------------------------------------------------------------------------\n * Bootstrap (v5.1.3): tab.js and base-component.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\ndefine([\n    \"./util/index\",\n    \"./dom/event-handler\",\n    \"./dom/selector-engine\"\n], function(Util, EventHandler, SelectorEngine) {\n    'use strict';\n\n    const defineJQueryPlugin = Util.defineJQueryPlugin;\n    const executeAfterTransition = Util.executeAfterTransition;\n    const getElement = Util.getElement;\n    const getElementFromSelector = Util.getElementFromSelector;\n    const isDisabled = Util.isDisabled;\n    const reflow = Util.reflow;\n\n    /**\n     * ------------------------------------------------------------------------\n     * Constants\n     * ------------------------------------------------------------------------\n     */\n\n    const VERSION = '5.1.3';\n    const NAME = 'tab';\n    const DATA_KEY = 'bs.tab';\n    const EVENT_KEY = `.${DATA_KEY}`;\n    const DATA_API_KEY = '.data-api';\n\n    const EVENT_HIDE = `hide${EVENT_KEY}`;\n    const EVENT_HIDDEN = `hidden${EVENT_KEY}`;\n    const EVENT_SHOW = `show${EVENT_KEY}`;\n    const EVENT_SHOWN = `shown${EVENT_KEY}`;\n    const EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`;\n\n    const CLASS_NAME_DROPDOWN_MENU = 'dropdown-menu';\n    const CLASS_NAME_ACTIVE = 'active';\n    const CLASS_NAME_FADE = 'fade';\n    const CLASS_NAME_SHOW = 'show';\n\n    const SELECTOR_DROPDOWN = '.dropdown';\n    const SELECTOR_NAV_LIST_GROUP = '.nav, .list-group';\n    const SELECTOR_ACTIVE = '.active';\n    const SELECTOR_ACTIVE_UL = ':scope > li > .active';\n    const SELECTOR_DATA_TOGGLE = '[data-bs-toggle=\"tab\"], [data-bs-toggle=\"pill\"], [data-bs-toggle=\"list\"]';\n    const SELECTOR_DROPDOWN_TOGGLE = '.dropdown-toggle';\n    const SELECTOR_DROPDOWN_ACTIVE_CHILD = ':scope > .dropdown-menu .active';\n\n    /**\n     * ------------------------------------------------------------------------\n     * Class Definition\n     * ------------------------------------------------------------------------\n     */\n\n    function Tab(element) {\n        element = getElement(element);\n\n        if (!element) {\n            return;\n        }\n\n        this._element = element;\n        Data.set(this._element, DATA_KEY, this);\n    }\n\n    // Getters\n\n    Tab.VERSION = VERSION;\n\n    Tab.NAME = NAME;\n\n    Tab.DATA_KEY = 'bs.' + Tab.NAME;\n\n    Tab.EVENT_KEY = '.' + Tab.DATA_KEY;\n\n    // Public\n\n    Tab.prototype.dispose = function() {\n        Data.remove(this._element, this.constructor.DATA_KEY);\n        EventHandler.off(this._element, this.constructor.EVENT_KEY);\n\n        Object.getOwnPropertyNames(this).forEach(propertyName => {\n            this[propertyName] = null;\n        })\n    }\n\n    Tab.prototype._queueCallback = function(callback, element, isAnimated = true) {\n        executeAfterTransition(callback, element, isAnimated);\n    }\n\n    Tab.prototype.show = function() {\n        if ((this._element.parentNode &&\n            this._element.parentNode.nodeType === Node.ELEMENT_NODE &&\n            this._element.classList.contains(CLASS_NAME_ACTIVE))) {\n            return;\n        }\n\n        let previous;\n        const target = getElementFromSelector(this._element);\n        const listElement = this._element.closest(SELECTOR_NAV_LIST_GROUP);\n\n        if (listElement) {\n            const itemSelector = listElement.nodeName === 'UL' || listElement.nodeName === 'OL' ? SELECTOR_ACTIVE_UL : SELECTOR_ACTIVE;\n            previous = SelectorEngine.find(itemSelector, listElement);\n            previous = previous[previous.length - 1];\n        }\n\n        const hideEvent = previous ?\n            EventHandler.trigger(previous, EVENT_HIDE, {\n                relatedTarget: this._element\n            }) :\n            null;\n\n        const showEvent = EventHandler.trigger(this._element, EVENT_SHOW, {\n            relatedTarget: previous\n        });\n\n        if (showEvent.defaultPrevented || (hideEvent !== null && hideEvent.defaultPrevented)) {\n            return;\n        }\n\n        this._activate(this._element, listElement);\n\n        const complete = () => {\n            EventHandler.trigger(previous, EVENT_HIDDEN, {\n                relatedTarget: this._element\n            });\n            EventHandler.trigger(this._element, EVENT_SHOWN, {\n                relatedTarget: previous\n            });\n        };\n\n        if (target) {\n            this._activate(target, target.parentNode, complete);\n        } else {\n            complete();\n        }\n    }\n\n    // Private\n\n    Tab.prototype._activate = function(element, container, callback) {\n        const activeElements = container && (container.nodeName === 'UL' || container.nodeName === 'OL') ?\n            SelectorEngine.find(SELECTOR_ACTIVE_UL, container) :\n            SelectorEngine.children(container, SELECTOR_ACTIVE);\n\n        const active = activeElements[0];\n        const isTransitioning = callback && (active && active.classList.contains(CLASS_NAME_FADE));\n\n        const complete = () => this._transitionComplete(element, active, callback);\n\n        if (active && isTransitioning) {\n            active.classList.remove(CLASS_NAME_SHOW);\n            this._queueCallback(complete, element, true);\n        } else {\n            complete();\n        }\n    }\n\n    Tab.prototype._transitionComplete = function(element, active, callback) {\n        if (active) {\n            active.classList.remove(CLASS_NAME_ACTIVE);\n\n            const dropdownChild = SelectorEngine.findOne(SELECTOR_DROPDOWN_ACTIVE_CHILD, active.parentNode);\n\n            if (dropdownChild) {\n                dropdownChild.classList.remove(CLASS_NAME_ACTIVE);\n            }\n\n            if (active.getAttribute('role') === 'tab') {\n                active.setAttribute('aria-selected', false);\n            }\n        }\n\n        element.classList.add(CLASS_NAME_ACTIVE);\n        if (element.getAttribute('role') === 'tab') {\n            element.setAttribute('aria-selected', true);\n        }\n\n        reflow(element);\n\n        if (element.classList.contains(CLASS_NAME_FADE)) {\n            element.classList.add(CLASS_NAME_SHOW);\n        }\n\n        let parent = element.parentNode;\n        if (parent && parent.nodeName === 'LI') {\n            parent = parent.parentNode;\n        }\n\n        if (parent && parent.classList.contains(CLASS_NAME_DROPDOWN_MENU)) {\n            const dropdownElement = element.closest(SELECTOR_DROPDOWN);\n\n            if (dropdownElement) {\n                SelectorEngine.find(SELECTOR_DROPDOWN_TOGGLE, dropdownElement)\n                    .forEach(dropdown => dropdown.classList.add(CLASS_NAME_ACTIVE));\n            }\n\n            element.setAttribute('aria-expanded', true);\n        }\n\n        if (callback) {\n            callback();\n        }\n    }\n\n    // Static\n\n    Tab.getInstance = function(element) {\n        return Data.get(getElement(element), this.DATA_KEY);\n    }\n\n    Tab.getOrCreateInstance = function(element, config = {}) {\n        return this.getInstance(element) || new this(element, typeof config === 'object' ? config : null);\n    }\n\n    Tab.jQueryInterface = function(config) {\n        return this.each(function () {\n            const data = Tab.getOrCreateInstance(this);\n\n            if (typeof config === 'string') {\n                if (typeof data[config] === 'undefined') {\n                    throw new TypeError(`No method named \"${config}\"`);\n                }\n\n                data[config]();\n            }\n        })\n    }\n\n    /**\n     * ------------------------------------------------------------------------\n     * Data Api implementation\n     * ------------------------------------------------------------------------\n     */\n\n    EventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_DATA_TOGGLE, function (event) {\n        if (['A', 'AREA'].includes(this.tagName)) {\n            event.preventDefault();\n        }\n\n        if (isDisabled(this)) {\n            return;\n        }\n\n        const data = Tab.getOrCreateInstance(this);\n        data.show();\n    })\n\n    /**\n     * ------------------------------------------------------------------------\n     * jQuery\n     * ------------------------------------------------------------------------\n     * add .Tab to jQuery only if jQuery is present\n     */\n\n    defineJQueryPlugin(Tab);\n\n    return Tab;\n});\n","jquery/bootstrap/collapse.js":"/**\n * --------------------------------------------------------------------------\n * Bootstrap (v5.1.3): collapse.js and base-component.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\ndefine([\n    \"jquery\",\n    \"./util/index\",\n    \"./dom/data\",\n    \"./dom/event-handler\",\n    \"./dom/manipulator\",\n    \"./dom/selector-engine\"\n], function($, Util, Data, EventHandler, Manipulator, SelectorEngine) {\n    'use strict';\n\n    const defineJQueryPlugin = Util.defineJQueryPlugin;\n    const executeAfterTransition = Util.executeAfterTransition;\n    const getElement = Util.getElement;\n    const getSelectorFromElement = Util.getSelectorFromElement;\n    const getElementFromSelector = Util.getElementFromSelector;\n    const reflow = Util.reflow;\n    const typeCheckConfig = Util.typeCheckConfig;\n\n    /**\n     * ------------------------------------------------------------------------\n     * Constants\n     * ------------------------------------------------------------------------\n     */\n\n    const VERSION = '5.1.3';\n    const NAME = 'collapse';\n    const DATA_KEY = 'bs.collapse';\n    const EVENT_KEY = `.${DATA_KEY}`;\n    const DATA_API_KEY = '.data-api';\n\n    const Default = {\n        toggle: true,\n        parent: null\n    };\n\n    const DefaultType = {\n        toggle: 'boolean',\n        parent: '(null|element)'\n    };\n\n    const EVENT_SHOW = `show${EVENT_KEY}`;\n    const EVENT_SHOWN = `shown${EVENT_KEY}`;\n    const EVENT_HIDE = `hide${EVENT_KEY}`;\n    const EVENT_HIDDEN = `hidden${EVENT_KEY}`;\n    const EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`;\n\n    const CLASS_NAME_SHOW = 'show';\n    const CLASS_NAME_COLLAPSE = 'collapse';\n    const CLASS_NAME_COLLAPSING = 'collapsing';\n    const CLASS_NAME_COLLAPSED = 'collapsed';\n    const CLASS_NAME_DEEPER_CHILDREN = `:scope .${CLASS_NAME_COLLAPSE} .${CLASS_NAME_COLLAPSE}`;\n    const CLASS_NAME_HORIZONTAL = 'collapse-horizontal';\n\n    const WIDTH = 'width';\n    const HEIGHT = 'height';\n\n    const SELECTOR_ACTIVES = '.collapse.show, .collapse.collapsing';\n    const SELECTOR_DATA_TOGGLE = '[data-bs-toggle=\"collapse\"]';\n\n    /**\n     * ------------------------------------------------------------------------\n     * Class Definition\n     * ------------------------------------------------------------------------\n     */\n\n    var Collapse = function(element, config) {\n        element = getElement(element);\n\n        if (!element) {\n            return;\n        }\n\n        this._element = element;\n        Data.set(this._element, DATA_KEY, this);\n\n        this._isTransitioning = false;\n        this._config = this._getConfig(config);\n        this._triggerArray = [];\n\n        const toggleList = SelectorEngine.find(SELECTOR_DATA_TOGGLE);\n\n        for (let i = 0, len = toggleList.length; i < len; i++) {\n            const elem = toggleList[i];\n            const selector = getSelectorFromElement(elem);\n            const filterElement = SelectorEngine.find(selector)\n                .filter(foundElem => foundElem === this._element);\n\n            if (selector !== null && filterElement.length) {\n                this._selector = selector;\n                this._triggerArray.push(elem);\n            }\n        }\n\n        this._initializeChildren();\n\n        if (!this._config.parent) {\n            this._addAriaAndCollapsedClass(this._triggerArray, this._isShown());\n        }\n\n        if (this._config.toggle) {\n            this.toggle();\n        }\n    }\n\n    // Getters\n\n    Collapse.VERSION = VERSION;\n\n    Collapse.Default = Default;\n\n    Collapse.NAME = NAME;\n\n    Collapse.DATA_KEY = 'bs.' + Collapse.NAME;\n\n    Collapse.EVENT_KEY = '.' + Collapse.DATA_KEY;\n\n    // Public\n\n    Collapse.prototype.dispose = function() {\n        Data.remove(this._element, this.constructor.DATA_KEY);\n        EventHandler.off(this._element, this.constructor.EVENT_KEY);\n\n        Object.getOwnPropertyNames(this).forEach(propertyName => {\n            this[propertyName] = null;\n        })\n    }\n\n    Collapse.prototype._queueCallback = function(callback, element, isAnimated = true) {\n        executeAfterTransition(callback, element, isAnimated);\n    }\n\n    Collapse.prototype.toggle = function() {\n        if (this._isShown()) {\n            this.hide();\n        } else {\n            this.show();\n        }\n    }\n\n    Collapse.prototype.show = function() {\n        if (this._isTransitioning || this._isShown()) {\n            return;\n        }\n\n        let actives = [];\n        let activesData;\n\n        if (this._config.parent) {\n            const children = SelectorEngine.find(CLASS_NAME_DEEPER_CHILDREN, this._config.parent);\n            actives = SelectorEngine.find(SELECTOR_ACTIVES, this._config.parent).filter(elem => !children.includes(elem)); // remove children if greater depth\n        }\n\n        const container = SelectorEngine.findOne(this._selector);\n        if (actives.length) {\n            const tempActiveData = actives.find(elem => container !== elem);\n            activesData = tempActiveData ? Collapse.getInstance(tempActiveData) : null;\n\n            if (activesData && activesData._isTransitioning) {\n                return;\n            }\n        }\n\n        const startEvent = EventHandler.trigger(this._element, EVENT_SHOW);\n        if (startEvent.defaultPrevented) {\n            return;\n        }\n\n        actives.forEach(elemActive => {\n            if (container !== elemActive) {\n                Collapse.getOrCreateInstance(elemActive, {toggle: false}).hide();\n            }\n\n            if (!activesData) {\n                Data.set(elemActive, DATA_KEY, null);\n            }\n        })\n\n        const dimension = this._getDimension();\n\n        this._element.classList.remove(CLASS_NAME_COLLAPSE);\n        this._element.classList.add(CLASS_NAME_COLLAPSING);\n\n        this._element.style[dimension] = 0;\n\n        this._addAriaAndCollapsedClass(this._triggerArray, true);\n        this._isTransitioning = true;\n\n        const complete = () => {\n            this._isTransitioning = false;\n\n            this._element.classList.remove(CLASS_NAME_COLLAPSING);\n            this._element.classList.add(CLASS_NAME_COLLAPSE, CLASS_NAME_SHOW);\n\n            this._element.style[dimension] = '';\n\n            EventHandler.trigger(this._element, EVENT_SHOWN);\n        };\n\n        const capitalizedDimension = dimension[0].toUpperCase() + dimension.slice(1);\n        const scrollSize = `scroll${capitalizedDimension}`;\n\n        this._queueCallback(complete, this._element, true);\n        this._element.style[dimension] = `${this._element[scrollSize]}px`;\n    }\n\n    Collapse.prototype.hide = function() {\n        if (this._isTransitioning || !this._isShown()) {\n            return;\n        }\n\n        const startEvent = EventHandler.trigger(this._element, EVENT_HIDE);\n        if (startEvent.defaultPrevented) {\n            return;\n        }\n\n        const dimension = this._getDimension();\n\n        this._element.style[dimension] = `${this._element.getBoundingClientRect()[dimension]}px`;\n\n        reflow(this._element);\n\n        this._element.classList.add(CLASS_NAME_COLLAPSING);\n        this._element.classList.remove(CLASS_NAME_COLLAPSE, CLASS_NAME_SHOW);\n\n        const triggerArrayLength = this._triggerArray.length;\n        for (let i = 0; i < triggerArrayLength; i++) {\n            const trigger = this._triggerArray[i];\n            const elem = getElementFromSelector(trigger);\n\n            if (elem && !this._isShown(elem)) {\n                this._addAriaAndCollapsedClass([trigger], false);\n            }\n        }\n\n        this._isTransitioning = true;\n\n        const complete = () => {\n            this._isTransitioning = false;\n            this._element.classList.remove(CLASS_NAME_COLLAPSING);\n            this._element.classList.add(CLASS_NAME_COLLAPSE);\n            EventHandler.trigger(this._element, EVENT_HIDDEN);\n        };\n\n        this._element.style[dimension] = '';\n\n        this._queueCallback(complete, this._element, true);\n    }\n\n    Collapse.prototype._isShown = function(element = this._element) {\n        return element.classList.contains(CLASS_NAME_SHOW);\n    }\n\n    // Private\n\n    Collapse.prototype._getConfig = function(config) {\n        config = {\n            ...Default,\n            ...Manipulator.getDataAttributes(this._element),\n            ...config\n        };\n        config.toggle = Boolean(config.toggle); // Coerce string values\n        config.parent = getElement(config.parent);\n        typeCheckConfig(NAME, config, DefaultType);\n        return config;\n    }\n\n    Collapse.prototype._getDimension = function() {\n        return this._element.classList.contains(CLASS_NAME_HORIZONTAL) ? WIDTH : HEIGHT;\n    }\n\n    Collapse.prototype._initializeChildren = function() {\n        if (!this._config.parent) {\n            return;\n        }\n\n        const children = SelectorEngine.find(CLASS_NAME_DEEPER_CHILDREN, this._config.parent);\n        SelectorEngine.find(SELECTOR_DATA_TOGGLE, this._config.parent).filter(elem => !children.includes(elem))\n            .forEach(element => {\n                const selected = getElementFromSelector(element);\n\n                if (selected) {\n                    this._addAriaAndCollapsedClass([element], this._isShown(selected));\n                }\n            })\n    }\n\n    Collapse.prototype._addAriaAndCollapsedClass = function(triggerArray, isOpen) {\n        if (!triggerArray.length) {\n            return;\n        }\n\n        triggerArray.forEach(elem => {\n            if (isOpen) {\n                elem.classList.remove(CLASS_NAME_COLLAPSED);\n            } else {\n                elem.classList.add(CLASS_NAME_COLLAPSED);\n            }\n\n            elem.setAttribute('aria-expanded', isOpen);\n        })\n    }\n\n    // Static\n\n    Collapse.getInstance = function(element) {\n        return Data.get(getElement(element), this.DATA_KEY);\n    }\n\n    Collapse.getOrCreateInstance = function(element, config = {}) {\n        return this.getInstance(element) || new this(element, typeof config === 'object' ? config : null);\n    }\n\n    Collapse.jQueryInterface = function(config) {\n        return this.each(function () {\n            const _config = {};\n            if (typeof config === 'string' && /show|hide/.test(config)) {\n                _config.toggle = false;\n            }\n\n            const data = Collapse.getOrCreateInstance(this, _config);\n\n            if (typeof config === 'string') {\n                if (typeof data[config] === 'undefined') {\n                    throw new TypeError(`No method named \"${config}\"`);\n                }\n\n                data[config]();\n            }\n        })\n    }\n\n    /**\n     * ------------------------------------------------------------------------\n     * Data Api implementation\n     * ------------------------------------------------------------------------\n     */\n\n    EventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_DATA_TOGGLE, function (event) {\n        // preventDefault only for <a> elements (which change the URL) not inside the collapsible element\n        if (event.target.tagName === 'A' || (event.delegateTarget && event.delegateTarget.tagName === 'A')) {\n            event.preventDefault();\n        }\n\n        const selector = getSelectorFromElement(this);\n        const selectorElements = SelectorEngine.find(selector);\n\n        selectorElements.forEach(element => {\n            Collapse.getOrCreateInstance(element, {toggle: false}).toggle();\n        })\n    })\n\n    /**\n     * ------------------------------------------------------------------------\n     * jQuery\n     * ------------------------------------------------------------------------\n     * add .Collapse to jQuery only if jQuery is present\n     */\n\n    defineJQueryPlugin(Collapse);\n\n    return Collapse;\n});\n","jquery/bootstrap/dom/selector-engine.js":"/**\n * --------------------------------------------------------------------------\n * Bootstrap (v5.1.3): dom/selector-engine.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\ndefine([\n    \"../util/index\"\n], function(Util) {\n    'use strict';\n\n    const isDisabled = Util.isDisabled;\n    const isVisible = Util.isVisible;\n\n    /**\n     * ------------------------------------------------------------------------\n     * Constants\n     * ------------------------------------------------------------------------\n     */\n\n    const NODE_TEXT = 3;\n\n    return {\n        find: function(selector, element = document.documentElement) {\n            return [].concat(...Element.prototype.querySelectorAll.call(element, selector))\n        },\n\n        findOne: function(selector, element = document.documentElement) {\n            return Element.prototype.querySelector.call(element, selector)\n        },\n\n        children: function(element, selector) {\n            return [].concat(...element.children)\n                .filter(child => child.matches(selector))\n        },\n\n        parents: function(element, selector) {\n            const parents = [];\n\n            let ancestor = element.parentNode;\n\n            while (ancestor && ancestor.nodeType === Node.ELEMENT_NODE && ancestor.nodeType !== NODE_TEXT) {\n                if (ancestor.matches(selector)) {\n                    parents.push(ancestor)\n                }\n\n                ancestor = ancestor.parentNode\n            }\n\n            return parents\n        },\n\n        prev: function(element, selector) {\n            let previous = element.previousElementSibling;\n\n            while (previous) {\n                if (previous.matches(selector)) {\n                    return [previous]\n                }\n\n                previous = previous.previousElementSibling\n            }\n\n            return []\n        },\n\n        next: function(element, selector) {\n            let next = element.nextElementSibling;\n\n            while (next) {\n                if (next.matches(selector)) {\n                    return [next]\n                }\n\n                next = next.nextElementSibling\n            }\n\n            return []\n        },\n\n        focusableChildren: function(element) {\n            const focusables = [\n                'a',\n                'button',\n                'input',\n                'textarea',\n                'select',\n                'details',\n                '[tabindex]',\n                '[contenteditable=\"true\"]'\n            ].map(selector => `${selector}:not([tabindex^=\"-\"])`).join(', ');\n\n            return this.find(focusables, element).filter(el => !isDisabled(el) && isVisible(el))\n        }\n    }\n});\n","jquery/bootstrap/dom/data.js":"/**\n * --------------------------------------------------------------------------\n * Bootstrap (v5.1.3): dom/data.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\ndefine([], function() {\n    'use strict';\n\n    /**\n     * ------------------------------------------------------------------------\n     * Constants\n     * ------------------------------------------------------------------------\n     */\n\n    const elementMap = new Map();\n\n    return {\n        set: function (element, key, instance) {\n            if (!elementMap.has(element)) {\n                elementMap.set(element, new Map())\n            }\n\n            const instanceMap = elementMap.get(element);\n\n            // make it clear we only want one instance per element\n            // can be removed later when multiple key/instances are fine to be used\n            if (!instanceMap.has(key) && instanceMap.size !== 0) {\n                // eslint-disable-next-line no-console\n                console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(instanceMap.keys())[0]}.`)\n                return\n            }\n\n            instanceMap.set(key, instance)\n        },\n\n        get: function (element, key) {\n            if (elementMap.has(element)) {\n                return elementMap.get(element).get(key) || null\n            }\n\n            return null\n        },\n\n        remove: function (element, key) {\n            if (!elementMap.has(element)) {\n                return\n            }\n\n            const instanceMap = elementMap.get(element);\n\n            instanceMap.delete(key)\n\n            // free up element references if there are no instances left for an element\n            if (instanceMap.size === 0) {\n                elementMap.delete(element)\n            }\n        }\n    }\n});\n","jquery/bootstrap/dom/manipulator.js":"/**\n * --------------------------------------------------------------------------\n * Bootstrap (v5.1.3): dom/manipulator.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\ndefine([], function() {\n    'use strict';\n\n    function normalizeData(val) {\n        if (val === 'true') {\n            return true\n        }\n\n        if (val === 'false') {\n            return false\n        }\n\n        if (val === Number(val).toString()) {\n            return Number(val)\n        }\n\n        if (val === '' || val === 'null') {\n            return null\n        }\n\n        return val\n    }\n\n    function normalizeDataKey(key) {\n        return key.replace(/[A-Z]/g, chr => `-${chr.toLowerCase()}`)\n    }\n\n    return {\n        setDataAttribute: function(element, key, value) {\n            element.setAttribute(`data-bs-${normalizeDataKey(key)}`, value)\n        },\n\n        removeDataAttribute: function(element, key) {\n            element.removeAttribute(`data-bs-${normalizeDataKey(key)}`)\n        },\n\n        getDataAttributes: function(element) {\n            if (!element) {\n                return {}\n            }\n\n            const attributes = {};\n\n            Object.keys(element.dataset)\n                .filter(key => key.startsWith('bs'))\n                .forEach(key => {\n                    let pureKey = key.replace(/^bs/, '');\n                    pureKey = pureKey.charAt(0).toLowerCase() + pureKey.slice(1, pureKey.length)\n                    attributes[pureKey] = normalizeData(element.dataset[key])\n                })\n\n            return attributes\n        },\n\n        getDataAttribute: function(element, key) {\n            return normalizeData(element.getAttribute(`data-bs-${normalizeDataKey(key)}`))\n        },\n\n        offset: function(element) {\n            const rect = element.getBoundingClientRect();\n\n            return {\n                top: rect.top + window.pageYOffset,\n                left: rect.left + window.pageXOffset\n            }\n        },\n\n        position: function(element) {\n            return {\n                top: element.offsetTop,\n                left: element.offsetLeft\n            }\n        }\n    }\n});\n","jquery/bootstrap/dom/event-handler.js":"/**\n * --------------------------------------------------------------------------\n * Bootstrap (v5.1.3): dom/event-handler.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\ndefine([\n    \"../util/index\"\n], function(Util) {\n    'use strict';\n\n    const getjQuery = Util.getjQuery;\n\n    /**\n     * ------------------------------------------------------------------------\n     * Constants\n     * ------------------------------------------------------------------------\n     */\n\n    const namespaceRegex = /[^.]*(?=\\..*)\\.|.*/;\n    const stripNameRegex = /\\..*/;\n    const stripUidRegex = /::\\d+$/;\n    const eventRegistry = {}; // Events storage\n    let uidEvent = 1;\n    const customEvents = {\n        mouseenter: 'mouseover',\n        mouseleave: 'mouseout'\n    };\n    const customEventsRegex = /^(mouseenter|mouseleave)/i;\n    const nativeEvents = new Set([\n        'click',\n        'dblclick',\n        'mouseup',\n        'mousedown',\n        'contextmenu',\n        'mousewheel',\n        'DOMMouseScroll',\n        'mouseover',\n        'mouseout',\n        'mousemove',\n        'selectstart',\n        'selectend',\n        'keydown',\n        'keypress',\n        'keyup',\n        'orientationchange',\n        'touchstart',\n        'touchmove',\n        'touchend',\n        'touchcancel',\n        'pointerdown',\n        'pointermove',\n        'pointerup',\n        'pointerleave',\n        'pointercancel',\n        'gesturestart',\n        'gesturechange',\n        'gestureend',\n        'focus',\n        'blur',\n        'change',\n        'reset',\n        'select',\n        'submit',\n        'focusin',\n        'focusout',\n        'load',\n        'unload',\n        'beforeunload',\n        'resize',\n        'move',\n        'DOMContentLoaded',\n        'readystatechange',\n        'error',\n        'abort',\n        'scroll'\n    ]);\n\n    /**\n     * ------------------------------------------------------------------------\n     * Private methods\n     * ------------------------------------------------------------------------\n     */\n\n    function getUidEvent(element, uid) {\n        return (uid && `${uid}::${uidEvent++}`) || element.uidEvent || uidEvent++\n    }\n\n    function getEvent(element) {\n        const uid = getUidEvent(element);\n\n        element.uidEvent = uid\n        eventRegistry[uid] = eventRegistry[uid] || {}\n\n        return eventRegistry[uid]\n    }\n\n    function bootstrapHandler(element, fn) {\n        return function handler(event) {\n            event.delegateTarget = element\n\n            if (handler.oneOff) {\n                EventHandler.off(element, event.type, fn)\n            }\n\n            return fn.apply(element, [event])\n        }\n    }\n\n    function bootstrapDelegationHandler(element, selector, fn) {\n        return function handler(event) {\n            const domElements = element.querySelectorAll(selector);\n\n            for (let {target} = event; target && target !== this; target = target.parentNode) {\n                for (let i = domElements.length; i--;) {\n                    if (domElements[i] === target) {\n                        event.delegateTarget = target\n\n                        if (handler.oneOff) {\n                            EventHandler.off(element, event.type, selector, fn)\n                        }\n\n                        return fn.apply(target, [event])\n                    }\n                }\n            }\n\n            // To please ESLint\n            return null\n        }\n    }\n\n    function findHandler(events, handler, delegationSelector = null) {\n        const uidEventList = Object.keys(events);\n\n        for (let i = 0, len = uidEventList.length; i < len; i++) {\n            const event = events[uidEventList[i]];\n\n            if (event.originalHandler === handler && event.delegationSelector === delegationSelector) {\n                return event\n            }\n        }\n\n        return null\n    }\n\n    function normalizeParams(originalTypeEvent, handler, delegationFn) {\n        const delegation = typeof handler === 'string';\n        const originalHandler = delegation ? delegationFn : handler;\n\n        let typeEvent = getTypeEvent(originalTypeEvent);\n        const isNative = nativeEvents.has(typeEvent);\n\n        if (!isNative) {\n            typeEvent = originalTypeEvent\n        }\n\n        return [delegation, originalHandler, typeEvent]\n    }\n\n    function addHandler(element, originalTypeEvent, handler, delegationFn, oneOff) {\n        if (typeof originalTypeEvent !== 'string' || !element) {\n            return\n        }\n\n        if (!handler) {\n            handler = delegationFn\n            delegationFn = null\n        }\n\n        // in case of mouseenter or mouseleave wrap the handler within a function that checks for its DOM position\n        // this prevents the handler from being dispatched the same way as mouseover or mouseout does\n        if (customEventsRegex.test(originalTypeEvent)) {\n            const wrapFn = fn => {\n                return function (event) {\n                    if (!event.relatedTarget || (event.relatedTarget !== event.delegateTarget && !event.delegateTarget.contains(event.relatedTarget))) {\n                        return fn.call(this, event)\n                    }\n                }\n            };\n\n            if (delegationFn) {\n                delegationFn = wrapFn(delegationFn)\n            } else {\n                handler = wrapFn(handler)\n            }\n        }\n\n        const [delegation, originalHandler, typeEvent] = normalizeParams(originalTypeEvent, handler, delegationFn);\n        const events = getEvent(element);\n        const handlers = events[typeEvent] || (events[typeEvent] = {});\n        const previousFn = findHandler(handlers, originalHandler, delegation ? handler : null);\n\n        if (previousFn) {\n            previousFn.oneOff = previousFn.oneOff && oneOff\n\n            return\n        }\n\n        const uid = getUidEvent(originalHandler, originalTypeEvent.replace(namespaceRegex, ''));\n        const fn = delegation ?\n            bootstrapDelegationHandler(element, handler, delegationFn) :\n            bootstrapHandler(element, handler);\n\n        fn.delegationSelector = delegation ? handler : null\n        fn.originalHandler = originalHandler\n        fn.oneOff = oneOff\n        fn.uidEvent = uid\n        handlers[uid] = fn\n\n        element.addEventListener(typeEvent, fn, delegation)\n    }\n\n    function removeHandler(element, events, typeEvent, handler, delegationSelector) {\n        const fn = findHandler(events[typeEvent], handler, delegationSelector);\n\n        if (!fn) {\n            return\n        }\n\n        element.removeEventListener(typeEvent, fn, Boolean(delegationSelector))\n        delete events[typeEvent][fn.uidEvent]\n    }\n\n    function removeNamespacedHandlers(element, events, typeEvent, namespace) {\n        const storeElementEvent = events[typeEvent] || {};\n\n        Object.keys(storeElementEvent).forEach(handlerKey => {\n            if (handlerKey.includes(namespace)) {\n                const event = storeElementEvent[handlerKey];\n\n                removeHandler(element, events, typeEvent, event.originalHandler, event.delegationSelector)\n            }\n        })\n    }\n\n    function getTypeEvent(event) {\n        // allow to get the native events from namespaced events ('click.bs.button' --> 'click')\n        event = event.replace(stripNameRegex, '')\n        return customEvents[event] || event\n    }\n\n    return {\n        on: function(element, event, handler, delegationFn) {\n            addHandler(element, event, handler, delegationFn, false)\n        },\n\n        one: function(element, event, handler, delegationFn) {\n            addHandler(element, event, handler, delegationFn, true)\n        },\n\n        off: function(element, originalTypeEvent, handler, delegationFn) {\n            if (typeof originalTypeEvent !== 'string' || !element) {\n                return\n            }\n\n            const [delegation, originalHandler, typeEvent] = normalizeParams(originalTypeEvent, handler, delegationFn);\n            const inNamespace = typeEvent !== originalTypeEvent;\n            const events = getEvent(element);\n            const isNamespace = originalTypeEvent.startsWith('.');\n\n            if (typeof originalHandler !== 'undefined') {\n                // Simplest case: handler is passed, remove that listener ONLY.\n                if (!events || !events[typeEvent]) {\n                    return\n                }\n\n                removeHandler(element, events, typeEvent, originalHandler, delegation ? handler : null)\n                return\n            }\n\n            if (isNamespace) {\n                Object.keys(events).forEach(elementEvent => {\n                    removeNamespacedHandlers(element, events, elementEvent, originalTypeEvent.slice(1))\n                })\n            }\n\n            const storeElementEvent = events[typeEvent] || {};\n            Object.keys(storeElementEvent).forEach(keyHandlers => {\n                const handlerKey = keyHandlers.replace(stripUidRegex, '');\n\n                if (!inNamespace || originalTypeEvent.includes(handlerKey)) {\n                    const event = storeElementEvent[keyHandlers];\n\n                    removeHandler(element, events, typeEvent, event.originalHandler, event.delegationSelector)\n                }\n            })\n        },\n\n        trigger: function(element, event, args) {\n            if (typeof event !== 'string' || !element) {\n                return null\n            }\n\n            const $ = getjQuery();\n            const typeEvent = getTypeEvent(event);\n            const inNamespace = event !== typeEvent;\n            const isNative = nativeEvents.has(typeEvent);\n\n            let jQueryEvent;\n            let bubbles = true;\n            let nativeDispatch = true;\n            let defaultPrevented = false;\n            let evt = null;\n\n            if (inNamespace && $) {\n                jQueryEvent = $.Event(event, args)\n\n                $(element).trigger(jQueryEvent)\n                bubbles = !jQueryEvent.isPropagationStopped()\n                nativeDispatch = !jQueryEvent.isImmediatePropagationStopped()\n                defaultPrevented = jQueryEvent.isDefaultPrevented()\n            }\n\n            if (isNative) {\n                evt = document.createEvent('HTMLEvents')\n                evt.initEvent(typeEvent, bubbles, true)\n            } else {\n                evt = new CustomEvent(event, {\n                    bubbles,\n                    cancelable: true\n                })\n            }\n\n            // merge custom information in our event\n            if (typeof args !== 'undefined') {\n                Object.keys(args).forEach(key => {\n                    Object.defineProperty(evt, key, {\n                        get() {\n                            return args[key]\n                        }\n                    })\n                })\n            }\n\n            if (defaultPrevented) {\n                evt.preventDefault()\n            }\n\n            if (nativeDispatch) {\n                element.dispatchEvent(evt)\n            }\n\n            if (evt.defaultPrevented && typeof jQueryEvent !== 'undefined') {\n                jQueryEvent.preventDefault()\n            }\n\n            return evt\n        }\n    }\n});\n","jquery/bootstrap/util/index.js":"/**\n * --------------------------------------------------------------------------\n * Bootstrap (v5.1.3): util/index.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\n\ndefine([\n    \"jquery\",\n    'domReady!'\n], function() {\n    'use strict';\n\n    const MAX_UID = 1000000;\n    const MILLISECONDS_MULTIPLIER = 1000;\n    const TRANSITION_END = 'transitionend';\n\n    // Shoutout AngusCroll (https://goo.gl/pxwQGp)\n    const toType = obj => {\n        if (obj === null || obj === undefined) {\n            return `${obj}`\n        }\n\n        return {}.toString.call(obj).match(/\\s([a-z]+)/i)[1].toLowerCase()\n    };\n\n    /**\n     * --------------------------------------------------------------------------\n     * Public Util Api\n     * --------------------------------------------------------------------------\n     */\n\n    const getUID = prefix => {\n        do {\n            prefix += Math.floor(Math.random() * MAX_UID)\n        } while (document.getElementById(prefix))\n\n        return prefix\n    };\n\n    const getSelector = element => {\n        let selector = element.getAttribute('data-bs-target');\n\n        if (!selector || selector === '#') {\n            let hrefAttr = element.getAttribute('href');\n\n            // The only valid content that could double as a selector are IDs or classes,\n            // so everything starting with `#` or `.`. If a \"real\" URL is used as the selector,\n            // `document.querySelector` will rightfully complain it is invalid.\n            // See https://github.com/twbs/bootstrap/issues/32273\n            if (!hrefAttr || (!hrefAttr.includes('#') && !hrefAttr.startsWith('.'))) {\n                return null\n            }\n\n            // Just in case some CMS puts out a full URL with the anchor appended\n            if (hrefAttr.includes('#') && !hrefAttr.startsWith('#')) {\n                hrefAttr = `#${hrefAttr.split('#')[1]}`\n            }\n\n            selector = hrefAttr && hrefAttr !== '#' ? hrefAttr.trim() : null\n        }\n\n        return selector\n    };\n\n    const getSelectorFromElement = element => {\n        const selector = getSelector(element);\n\n        if (selector) {\n            return document.querySelector(selector) ? selector : null\n        }\n\n        return null\n    };\n\n    const getElementFromSelector = element => {\n        const selector = getSelector(element);\n\n        return selector ? document.querySelector(selector) : null\n    };\n\n    const getTransitionDurationFromElement = element => {\n        if (!element) {\n            return 0\n        }\n\n        // Get transition-duration of the element\n        let {transitionDuration, transitionDelay} = window.getComputedStyle(element);\n\n        const floatTransitionDuration = Number.parseFloat(transitionDuration);\n        const floatTransitionDelay = Number.parseFloat(transitionDelay);\n\n        // Return 0 if element or transition duration is not found\n        if (!floatTransitionDuration && !floatTransitionDelay) {\n            return 0\n        }\n\n        // If multiple durations are defined, take the first\n        transitionDuration = transitionDuration.split(',')[0]\n        transitionDelay = transitionDelay.split(',')[0]\n\n        return (Number.parseFloat(transitionDuration) + Number.parseFloat(transitionDelay)) * MILLISECONDS_MULTIPLIER\n    };\n\n    const triggerTransitionEnd = element => {\n        element.dispatchEvent(new Event(TRANSITION_END))\n    };\n\n    const isElement = obj => {\n        if (!obj || typeof obj !== 'object') {\n            return false\n        }\n\n        if (typeof obj.jquery !== 'undefined') {\n            obj = obj[0]\n        }\n\n        return typeof obj.nodeType !== 'undefined'\n    };\n\n    const getElement = obj => {\n        if (isElement(obj)) { // it's a jQuery object or a node element\n            return obj.jquery ? obj[0] : obj\n        }\n\n        if (typeof obj === 'string' && obj.length > 0) {\n            return document.querySelector(obj)\n        }\n\n        return null\n    };\n\n    const typeCheckConfig = (componentName, config, configTypes) => {\n        Object.keys(configTypes).forEach(property => {\n            const expectedTypes = configTypes[property];\n            const value = config[property];\n            const valueType = value && isElement(value) ? 'element' : toType(value);\n\n            if (!new RegExp(expectedTypes).test(valueType)) {\n                throw new TypeError(\n                    `${componentName.toUpperCase()}: Option \"${property}\" provided type \"${valueType}\" but expected type \"${expectedTypes}\".`\n                )\n            }\n        })\n    };\n\n    const isVisible = element => {\n        if (!isElement(element) || element.getClientRects().length === 0) {\n            return false\n        }\n\n        return getComputedStyle(element).getPropertyValue('visibility') === 'visible'\n    };\n\n    const isDisabled = element => {\n        if (!element || element.nodeType !== Node.ELEMENT_NODE) {\n            return true\n        }\n\n        if (element.classList.contains('disabled')) {\n            return true\n        }\n\n        if (typeof element.disabled !== 'undefined') {\n            return element.disabled\n        }\n\n        return element.hasAttribute('disabled') && element.getAttribute('disabled') !== 'false'\n    };\n\n    const findShadowRoot = element => {\n        if (!document.documentElement.attachShadow) {\n            return null\n        }\n\n        // Can find the shadow root otherwise it'll return the document\n        if (typeof element.getRootNode === 'function') {\n            const root = element.getRootNode();\n            return root instanceof ShadowRoot ? root : null\n        }\n\n        if (element instanceof ShadowRoot) {\n            return element\n        }\n\n        // when we don't find a shadow root\n        if (!element.parentNode) {\n            return null\n        }\n\n        return findShadowRoot(element.parentNode)\n    };\n\n    const noop = () => {};\n\n    /**\n     * Trick to restart an element's animation\n     *\n     * @param {HTMLElement} element\n     * @return void\n     *\n     * @see https://www.charistheo.io/blog/2021/02/restart-a-css-animation-with-javascript/#restarting-a-css-animation\n     */\n    const reflow = element => {\n        // eslint-disable-next-line no-unused-expressions\n        element.offsetHeight\n    };\n\n    const getjQuery = () => {\n        const {jQuery} = window;\n\n        if (jQuery && !document.body.hasAttribute('data-bs-no-jquery')) {\n            return jQuery\n        }\n\n        return null\n    };\n\n    const DOMContentLoadedCallbacks = [];\n\n    const onDOMContentLoaded = callback => {\n        if (document.readyState === 'loading') {\n            // add listener on the first call when the document is in loading state\n            if (!DOMContentLoadedCallbacks.length) {\n                document.addEventListener('DOMContentLoaded', () => {\n                    DOMContentLoadedCallbacks.forEach(callback => callback())\n                })\n            }\n\n            DOMContentLoadedCallbacks.push(callback)\n        } else {\n            callback()\n        }\n    };\n\n    const isRTL = () => document.documentElement.dir === 'rtl';\n\n    const defineJQueryPlugin = plugin => {\n        onDOMContentLoaded(() => {\n            const $ = getjQuery();\n            /* istanbul ignore if */\n            if ($) {\n                const name = plugin.NAME;\n                const JQUERY_NO_CONFLICT = $.fn[name];\n                $.fn[name] = plugin.jQueryInterface\n                $.fn[name].Constructor = plugin\n                $.fn[name].noConflict = () => {\n                    $.fn[name] = JQUERY_NO_CONFLICT\n                    return plugin.jQueryInterface\n                }\n            }\n        })\n    };\n\n    const execute = callback => {\n        if (typeof callback === 'function') {\n            callback()\n        }\n    };\n\n    const executeAfterTransition = (callback, transitionElement, waitForTransition = true) => {\n        if (!waitForTransition) {\n            execute(callback)\n            return\n        }\n\n        const durationPadding = 5;\n        const emulatedDuration = getTransitionDurationFromElement(transitionElement) + durationPadding;\n\n        let called = false;\n\n        const handler = ({ target }) => {\n            if (target !== transitionElement) {\n                return\n            }\n\n            called = true\n            transitionElement.removeEventListener(TRANSITION_END, handler)\n            execute(callback)\n        };\n\n        transitionElement.addEventListener(TRANSITION_END, handler)\n        setTimeout(() => {\n            if (!called) {\n                triggerTransitionEnd(transitionElement)\n            }\n        }, emulatedDuration)\n    };\n\n    /**\n     * Return the previous/next element of a list.\n     *\n     * @param {array} list    The list of elements\n     * @param activeElement   The active element\n     * @param shouldGetNext   Choose to get next or previous element\n     * @param isCycleAllowed\n     * @return {Element|elem} The proper element\n     */\n    const getNextActiveElement = (list, activeElement, shouldGetNext, isCycleAllowed) => {\n        let index = list.indexOf(activeElement);\n\n        // if the element does not exist in the list return an element depending on the direction and if cycle is allowed\n        if (index === -1) {\n            return list[!shouldGetNext && isCycleAllowed ? list.length - 1 : 0]\n        }\n\n        const listLength = list.length;\n\n        index += shouldGetNext ? 1 : -1\n\n        if (isCycleAllowed) {\n            index = (index + listLength) % listLength\n        }\n\n        return list[Math.max(0, Math.min(index, listLength - 1))]\n    };\n\n    return {\n        getElement,\n        getUID,\n        getSelectorFromElement,\n        getElementFromSelector,\n        getTransitionDurationFromElement,\n        triggerTransitionEnd,\n        isElement,\n        typeCheckConfig,\n        isVisible,\n        isDisabled,\n        findShadowRoot,\n        noop,\n        getNextActiveElement,\n        reflow,\n        getjQuery,\n        onDOMContentLoaded,\n        isRTL,\n        defineJQueryPlugin,\n        execute,\n        executeAfterTransition\n    };\n});\n","jquery/uppy/dist/uppy.min.js":"\"use strict\";(()=>{var Bb=Object.create;var Cl=Object.defineProperty;var zb=Object.getOwnPropertyDescriptor;var jb=Object.getOwnPropertyNames;var Hb=Object.getPrototypeOf,$b=Object.prototype.hasOwnProperty;var n=(i,e)=>Cl(i,\"name\",{value:e,configurable:!0});var he=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),Tl=(i,e)=>{for(var t in e)Cl(i,t,{get:e[t],enumerable:!0})},qb=(i,e,t,r)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let s of jb(e))!$b.call(i,s)&&s!==t&&Cl(i,s,{get:()=>e[s],enumerable:!(r=zb(e,s))||r.enumerable});return i};var de=(i,e,t)=>(t=i!=null?Bb(Hb(i)):{},qb(e||!i||!i.__esModule?Cl(t,\"default\",{value:i,enumerable:!0}):t,i));var yh=he((Zx,of)=>{of.exports=n(function(){var e={},t=e._fns={};e.emit=n(function(a,l,h,p,d,f,y){var b=r(a);b.length&&s(a,b,[l,h,p,d,f,y])},\"emit\"),e.on=n(function(a,l){t[a]||(t[a]=[]),t[a].push(l)},\"on\"),e.once=n(function(a,l){function h(){l.apply(this,arguments),e.off(a,h)}n(h,\"one\"),this.on(a,h)},\"once\"),e.off=n(function(a,l){var h=[];if(a&&l){var p=this._fns[a],d=0,f=p?p.length:0;for(d;d<f;d++)p[d]!==l&&h.push(p[d])}h.length?this._fns[a]=h:delete this._fns[a]},\"off\");function r(o){var a=t[o]?t[o]:[],l=o.indexOf(\":\"),h=l===-1?[o]:[o.substring(0,l),o.substring(l+1)],p=Object.keys(t),d=0,f=p.length;for(d;d<f;d++){var y=p[d];if(y===\"*\"&&(a=a.concat(t[y])),h.length===2&&h[0]===y){a=a.concat(t[y]);break}}return a}n(r,\"getListeners\");function s(o,a,l){var h=0,p=a.length;for(h;h<p&&a[h];h++)a[h].event=o,a[h].apply(a[h],l)}return n(s,\"emitAll\"),e},\"createNamespaceEmitter\")});var Al=he((rF,nf)=>{function Yb(i){var e=typeof i;return i!=null&&(e==\"object\"||e==\"function\")}n(Yb,\"isObject\");nf.exports=Yb});var lf=he((oF,af)=>{var Qb=typeof global==\"object\"&&global&&global.Object===Object&&global;af.exports=Qb});var vh=he((nF,uf)=>{var Jb=lf(),Zb=typeof self==\"object\"&&self&&self.Object===Object&&self,e1=Jb||Zb||Function(\"return this\")();uf.exports=e1});var df=he((aF,hf)=>{var t1=vh(),i1=n(function(){return t1.Date.now()},\"now\");hf.exports=i1});var pf=he((uF,cf)=>{var r1=/\\s/;function s1(i){for(var e=i.length;e--&&r1.test(i.charAt(e)););return e}n(s1,\"trimmedEndIndex\");cf.exports=s1});var mf=he((dF,ff)=>{var o1=pf(),n1=/^\\s+/;function a1(i){return i&&i.slice(0,o1(i)+1).replace(n1,\"\")}n(a1,\"baseTrim\");ff.exports=a1});var bh=he((pF,gf)=>{var l1=vh(),u1=l1.Symbol;gf.exports=u1});var wf=he((fF,bf)=>{var yf=bh(),vf=Object.prototype,h1=vf.hasOwnProperty,d1=vf.toString,cn=yf?yf.toStringTag:void 0;function c1(i){var e=h1.call(i,cn),t=i[cn];try{i[cn]=void 0;var r=!0}catch{}var s=d1.call(i);return r&&(e?i[cn]=t:delete i[cn]),s}n(c1,\"getRawTag\");bf.exports=c1});var Pf=he((gF,Sf)=>{var p1=Object.prototype,f1=p1.toString;function m1(i){return f1.call(i)}n(m1,\"objectToString\");Sf.exports=m1});var Ef=he((vF,Ff)=>{var _f=bh(),g1=wf(),y1=Pf(),v1=\"[object Null]\",b1=\"[object Undefined]\",xf=_f?_f.toStringTag:void 0;function w1(i){return i==null?i===void 0?b1:v1:xf&&xf in Object(i)?g1(i):y1(i)}n(w1,\"baseGetTag\");Ff.exports=w1});var Cf=he((wF,Of)=>{function S1(i){return i!=null&&typeof i==\"object\"}n(S1,\"isObjectLike\");Of.exports=S1});var Af=he((PF,Tf)=>{var P1=Ef(),_1=Cf(),x1=\"[object Symbol]\";function F1(i){return typeof i==\"symbol\"||_1(i)&&P1(i)==x1}n(F1,\"isSymbol\");Tf.exports=F1});var Df=he((xF,kf)=>{var E1=mf(),Rf=Al(),O1=Af(),Uf=0/0,C1=/^[-+]0x[0-9a-f]+$/i,T1=/^0b[01]+$/i,A1=/^0o[0-7]+$/i,R1=parseInt;function U1(i){if(typeof i==\"number\")return i;if(O1(i))return Uf;if(Rf(i)){var e=typeof i.valueOf==\"function\"?i.valueOf():i;i=Rf(e)?e+\"\":e}if(typeof i!=\"string\")return i===0?i:+i;i=E1(i);var t=T1.test(i);return t||A1.test(i)?R1(i.slice(2),t?2:8):C1.test(i)?Uf:+i}n(U1,\"toNumber\");kf.exports=U1});var Sh=he((EF,Nf)=>{var k1=Al(),wh=df(),If=Df(),D1=\"Expected a function\",I1=Math.max,N1=Math.min;function M1(i,e,t){var r,s,o,a,l,h,p=0,d=!1,f=!1,y=!0;if(typeof i!=\"function\")throw new TypeError(D1);e=If(e)||0,k1(t)&&(d=!!t.leading,f=\"maxWait\"in t,o=f?I1(If(t.maxWait)||0,e):o,y=\"trailing\"in t?!!t.trailing:y);function b(B){var z=r,K=s;return r=s=void 0,p=B,a=i.apply(K,z),a}n(b,\"invokeFunc\");function S(B){return p=B,l=setTimeout(F,e),d?b(B):a}n(S,\"leadingEdge\");function E(B){var z=B-h,K=B-p,oe=e-z;return f?N1(oe,o-K):oe}n(E,\"remainingWait\");function x(B){var z=B-h,K=B-p;return h===void 0||z>=e||z<0||f&&K>=o}n(x,\"shouldInvoke\");function F(){var B=wh();if(x(B))return U(B);l=setTimeout(F,E(B))}n(F,\"timerExpired\");function U(B){return l=void 0,y&&r?b(B):(r=s=void 0,a)}n(U,\"trailingEdge\");function j(){l!==void 0&&clearTimeout(l),p=0,r=h=s=l=void 0}n(j,\"cancel\");function G(){return l===void 0?a:U(wh())}n(G,\"flush\");function J(){var B=wh(),z=x(B);if(r=arguments,s=this,h=B,z){if(l===void 0)return S(h);if(f)return clearTimeout(l),l=setTimeout(F,e),b(h)}return l===void 0&&(l=setTimeout(F,e)),a}return n(J,\"debounced\"),J.cancel=j,J.flush=G,J}n(M1,\"debounce\");Nf.exports=M1});var Rl=he((CF,Mf)=>{var L1=Sh(),B1=Al(),z1=\"Expected a function\";function j1(i,e,t){var r=!0,s=!0;if(typeof i!=\"function\")throw new TypeError(z1);return B1(t)&&(r=\"leading\"in t?!!t.leading:r,s=\"trailing\"in t?!!t.trailing:s),L1(i,e,{leading:r,maxWait:e,trailing:s})}n(j1,\"throttle\");Mf.exports=j1});var Il=he((YF,Hf)=>{Hf.exports=n(function(e){if(typeof e!=\"number\"||isNaN(e))throw new TypeError(`Expected a number, got ${typeof e}`);let t=e<0,r=[\"B\",\"KB\",\"MB\",\"GB\",\"TB\",\"PB\",\"EB\",\"ZB\",\"YB\"];if(t&&(e=-e),e<1)return`${(t?\"-\":\"\")+e} B`;let s=Math.min(Math.floor(Math.log(e)/Math.log(1024)),r.length-1);e=Number(e/Math.pow(1024,s));let o=r[s];return e>=10||e%1===0?`${(t?\"-\":\"\")+e.toFixed(0)} ${o}`:`${(t?\"-\":\"\")+e.toFixed(1)} ${o}`},\"prettierBytes\")});var Vf=he((JF,qf)=>{\"use strict\";function $f(i,e){this.text=i=i||\"\",this.hasWild=~i.indexOf(\"*\"),this.separator=e,this.parts=i.split(e)}n($f,\"WildcardMatcher\");$f.prototype.match=function(i){var e=!0,t=this.parts,r,s=t.length,o;if(typeof i==\"string\"||i instanceof String)if(!this.hasWild&&this.text!=i)e=!1;else{for(o=(i||\"\").split(this.separator),r=0;e&&r<s;r++)t[r]!==\"*\"&&(r<o.length?e=t[r]===o[r]:e=!1);e=e&&o}else if(typeof i.splice==\"function\")for(e=[],r=i.length;r--;)this.match(i[r])&&(e[e.length]=i[r]);else if(typeof i==\"object\"){e={};for(var a in i)this.match(a)&&(e[a]=i[a])}return e};qf.exports=function(i,e,t){var r=new $f(i,t||/[\\/\\.]/);return typeof e<\"u\"?r.match(e):r}});var Gf=he((e3,Wf)=>{var G1=Vf(),K1=/[\\/\\+\\.]/;Wf.exports=function(i,e){function t(r){var s=G1(r,i,K1);return s&&s.length>=2}return n(t,\"test\"),e?t(e.split(\";\")[0]):t}});var bm=he((j3,vm)=>{function pi(i,e){typeof e==\"boolean\"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(i)),this._timeouts=i,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}n(pi,\"RetryOperation\");vm.exports=pi;pi.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};pi.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};pi.prototype.retry=function(i){if(this._timeout&&clearTimeout(this._timeout),!i)return!1;var e=new Date().getTime();if(i&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(i),this._errors.unshift(new Error(\"RetryOperation timeout occurred\")),!1;this._errors.push(i);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var r=this;return this._timer=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)},t),this._options.unref&&this._timer.unref(),!0};pi.prototype.attempt=function(i,e){this._fn=i,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};pi.prototype.try=function(i){console.log(\"Using RetryOperation.try() is deprecated\"),this.attempt(i)};pi.prototype.start=function(i){console.log(\"Using RetryOperation.start() is deprecated\"),this.attempt(i)};pi.prototype.start=pi.prototype.try;pi.prototype.errors=function(){return this._errors};pi.prototype.attempts=function(){return this._attempts};pi.prototype.mainError=function(){if(this._errors.length===0)return null;for(var i={},e=null,t=0,r=0;r<this._errors.length;r++){var s=this._errors[r],o=s.message,a=(i[o]||0)+1;i[o]=a,a>=t&&(e=s,t=a)}return e}});var wm=he(Ss=>{var bw=bm();Ss.operation=function(i){var e=Ss.timeouts(i);return new bw(e,{forever:i&&(i.forever||i.retries===1/0),unref:i&&i.unref,maxRetryTime:i&&i.maxRetryTime})};Ss.timeouts=function(i){if(i instanceof Array)return[].concat(i);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var t in i)e[t]=i[t];if(e.minTimeout>e.maxTimeout)throw new Error(\"minTimeout is greater than maxTimeout\");for(var r=[],s=0;s<e.retries;s++)r.push(this.createTimeout(s,e));return i&&i.forever&&!r.length&&r.push(this.createTimeout(s,e)),r.sort(function(o,a){return o-a}),r};Ss.createTimeout=function(i,e){var t=e.randomize?Math.random()+1:1,r=Math.round(t*Math.max(e.minTimeout,1)*Math.pow(e.factor,i));return r=Math.min(r,e.maxTimeout),r};Ss.wrap=function(i,e,t){if(e instanceof Array&&(t=e,e=null),!t){t=[];for(var r in i)typeof i[r]==\"function\"&&t.push(r)}for(var s=0;s<t.length;s++){var o=t[s],a=i[o];i[o]=n(function(h){var p=Ss.operation(e),d=Array.prototype.slice.call(arguments,1),f=d.pop();d.push(function(y){p.retry(y)||(y&&(arguments[0]=p.mainError()),f.apply(this,arguments))}),p.attempt(function(){h.apply(i,d)})},\"retryWrapper\").bind(i,a),i[o].options=e}}});var Pm=he((V3,Sm)=>{Sm.exports=wm()});var Dm=he((UE,zh)=>{\"use strict\";var $w=Object.prototype.hasOwnProperty,At=\"~\";function In(){}n(In,\"Events\");Object.create&&(In.prototype=Object.create(null),new In().__proto__||(At=!1));function qw(i,e,t){this.fn=i,this.context=e,this.once=t||!1}n(qw,\"EE\");function km(i,e,t,r,s){if(typeof t!=\"function\")throw new TypeError(\"The listener must be a function\");var o=new qw(t,r||i,s),a=At?At+e:e;return i._events[a]?i._events[a].fn?i._events[a]=[i._events[a],o]:i._events[a].push(o):(i._events[a]=o,i._eventsCount++),i}n(km,\"addListener\");function Xl(i,e){--i._eventsCount===0?i._events=new In:delete i._events[e]}n(Xl,\"clearEvent\");function _t(){this._events=new In,this._eventsCount=0}n(_t,\"EventEmitter\");_t.prototype.eventNames=n(function(){var e=[],t,r;if(this._eventsCount===0)return e;for(r in t=this._events)$w.call(t,r)&&e.push(At?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e},\"eventNames\");_t.prototype.listeners=n(function(e){var t=At?At+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var s=0,o=r.length,a=new Array(o);s<o;s++)a[s]=r[s].fn;return a},\"listeners\");_t.prototype.listenerCount=n(function(e){var t=At?At+e:e,r=this._events[t];return r?r.fn?1:r.length:0},\"listenerCount\");_t.prototype.emit=n(function(e,t,r,s,o,a){var l=At?At+e:e;if(!this._events[l])return!1;var h=this._events[l],p=arguments.length,d,f;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),p){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,r),!0;case 4:return h.fn.call(h.context,t,r,s),!0;case 5:return h.fn.call(h.context,t,r,s,o),!0;case 6:return h.fn.call(h.context,t,r,s,o,a),!0}for(f=1,d=new Array(p-1);f<p;f++)d[f-1]=arguments[f];h.fn.apply(h.context,d)}else{var y=h.length,b;for(f=0;f<y;f++)switch(h[f].once&&this.removeListener(e,h[f].fn,void 0,!0),p){case 1:h[f].fn.call(h[f].context);break;case 2:h[f].fn.call(h[f].context,t);break;case 3:h[f].fn.call(h[f].context,t,r);break;case 4:h[f].fn.call(h[f].context,t,r,s);break;default:if(!d)for(b=1,d=new Array(p-1);b<p;b++)d[b-1]=arguments[b];h[f].fn.apply(h[f].context,d)}}return!0},\"emit\");_t.prototype.on=n(function(e,t,r){return km(this,e,t,r,!1)},\"on\");_t.prototype.once=n(function(e,t,r){return km(this,e,t,r,!0)},\"once\");_t.prototype.removeListener=n(function(e,t,r,s){var o=At?At+e:e;if(!this._events[o])return this;if(!t)return Xl(this,o),this;var a=this._events[o];if(a.fn)a.fn===t&&(!s||a.once)&&(!r||a.context===r)&&Xl(this,o);else{for(var l=0,h=[],p=a.length;l<p;l++)(a[l].fn!==t||s&&!a[l].once||r&&a[l].context!==r)&&h.push(a[l]);h.length?this._events[o]=h.length===1?h[0]:h:Xl(this,o)}return this},\"removeListener\");_t.prototype.removeAllListeners=n(function(e){var t;return e?(t=At?At+e:e,this._events[t]&&Xl(this,t)):(this._events=new In,this._eventsCount=0),this},\"removeAllListeners\");_t.prototype.off=_t.prototype.removeListener;_t.prototype.addListener=_t.prototype.on;_t.prefixed=At;_t.EventEmitter=_t;typeof zh<\"u\"&&(zh.exports=_t)});var Qt=he((nO,nu)=>{(function(){\"use strict\";var i={}.hasOwnProperty;function e(){for(var t=[],r=0;r<arguments.length;r++){var s=arguments[r];if(s){var o=typeof s;if(o===\"string\"||o===\"number\")t.push(s);else if(Array.isArray(s)){if(s.length){var a=e.apply(null,s);a&&t.push(a)}}else if(o===\"object\")if(s.toString===Object.prototype.toString)for(var l in s)i.call(s,l)&&s[l]&&t.push(l);else t.push(s.toString())}}return t.join(\" \")}n(e,\"classNames\"),typeof nu<\"u\"&&nu.exports?(e.default=e,nu.exports=e):typeof define==\"function\"&&typeof define.amd==\"object\"&&define.amd?define(\"classnames\",[],function(){return e}):window.classNames=e})()});var iy=he((xT,ty)=>{ty.exports=n(function(e,t){if(e===t)return!0;for(var r in e)if(!(r in t))return!1;for(var r in t)if(e[r]!==t[r])return!1;return!0},\"isShallowEqual\")});var oy=he((VT,sy)=>{sy.exports=n(function(e){if(typeof e!=\"number\"||isNaN(e))throw new TypeError(\"Expected a number, got \"+typeof e);var t=e<0,r=[\"B\",\"KB\",\"MB\",\"GB\",\"TB\",\"PB\",\"EB\",\"ZB\",\"YB\"];if(t&&(e=-e),e<1)return(t?\"-\":\"\")+e+\" B\";var s=Math.min(Math.floor(Math.log(e)/Math.log(1024)),r.length-1);e=Number(e/Math.pow(1024,s));var o=r[s];return e>=10||e%1===0?(t?\"-\":\"\")+e.toFixed(0)+\" \"+o:(t?\"-\":\"\")+e.toFixed(1)+\" \"+o},\"prettierBytes\")});var Ay=he((Vd,Wd)=>{(function(i,e){typeof Vd==\"object\"&&typeof Wd<\"u\"?Wd.exports=e():typeof define==\"function\"&&define.amd?define(e):(i=i||self,i.Cropper=e())})(Vd,function(){\"use strict\";function i(v){\"@babel/helpers - typeof\";return typeof Symbol==\"function\"&&typeof Symbol.iterator==\"symbol\"?i=n(function(c){return typeof c},\"_typeof\"):i=n(function(c){return c&&typeof Symbol==\"function\"&&c.constructor===Symbol&&c!==Symbol.prototype?\"symbol\":typeof c},\"_typeof\"),i(v)}n(i,\"_typeof\");function e(v,c){if(!(v instanceof c))throw new TypeError(\"Cannot call a class as a function\")}n(e,\"_classCallCheck\");function t(v,c){for(var g=0;g<c.length;g++){var m=c[g];m.enumerable=m.enumerable||!1,m.configurable=!0,\"value\"in m&&(m.writable=!0),Object.defineProperty(v,m.key,m)}}n(t,\"_defineProperties\");function r(v,c,g){return c&&t(v.prototype,c),g&&t(v,g),v}n(r,\"_createClass\");function s(v,c,g){return c in v?Object.defineProperty(v,c,{value:g,enumerable:!0,configurable:!0,writable:!0}):v[c]=g,v}n(s,\"_defineProperty\");function o(v,c){var g=Object.keys(v);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(v);c&&(m=m.filter(function(P){return Object.getOwnPropertyDescriptor(v,P).enumerable})),g.push.apply(g,m)}return g}n(o,\"ownKeys\");function a(v){for(var c=1;c<arguments.length;c++){var g=arguments[c]!=null?arguments[c]:{};c%2?o(Object(g),!0).forEach(function(m){s(v,m,g[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(g)):o(Object(g)).forEach(function(m){Object.defineProperty(v,m,Object.getOwnPropertyDescriptor(g,m))})}return v}n(a,\"_objectSpread2\");function l(v){return h(v)||p(v)||d(v)||y()}n(l,\"_toConsumableArray\");function h(v){if(Array.isArray(v))return f(v)}n(h,\"_arrayWithoutHoles\");function p(v){if(typeof Symbol<\"u\"&&Symbol.iterator in Object(v))return Array.from(v)}n(p,\"_iterableToArray\");function d(v,c){if(v){if(typeof v==\"string\")return f(v,c);var g=Object.prototype.toString.call(v).slice(8,-1);if(g===\"Object\"&&v.constructor&&(g=v.constructor.name),g===\"Map\"||g===\"Set\")return Array.from(v);if(g===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return f(v,c)}}n(d,\"_unsupportedIterableToArray\");function f(v,c){(c==null||c>v.length)&&(c=v.length);for(var g=0,m=new Array(c);g<c;g++)m[g]=v[g];return m}n(f,\"_arrayLikeToArray\");function y(){throw new TypeError(`Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}n(y,\"_nonIterableSpread\");var b=typeof window<\"u\"&&typeof window.document<\"u\",S=b?window:{},E=b&&S.document.documentElement?\"ontouchstart\"in S.document.documentElement:!1,x=b?\"PointerEvent\"in S:!1,F=\"cropper\",U=\"all\",j=\"crop\",G=\"move\",J=\"zoom\",B=\"e\",z=\"w\",K=\"s\",oe=\"n\",Be=\"ne\",Je=\"nw\",wt=\"se\",We=\"sw\",_e=\"\".concat(F,\"-crop\"),ze=\"\".concat(F,\"-disabled\"),xe=\"\".concat(F,\"-hidden\"),ui=\"\".concat(F,\"-hide\"),V=\"\".concat(F,\"-invisible\"),R=\"\".concat(F,\"-modal\"),I=\"\".concat(F,\"-move\"),L=\"\".concat(F,\"Action\"),Q=\"\".concat(F,\"Preview\"),X=\"crop\",ye=\"move\",pe=\"none\",ne=\"crop\",re=\"cropend\",Fe=\"cropmove\",Ee=\"cropstart\",Ft=\"dblclick\",Et=E?\"touchstart\":\"mousedown\",te=E?\"touchmove\":\"mousemove\",Ot=E?\"touchend touchcancel\":\"mouseup\",Ge=x?\"pointerdown\":Et,lr=x?\"pointermove\":te,So=x?\"pointerup pointercancel\":Ot,Hr=\"ready\",$r=\"resize\",qr=\"wheel\",ur=\"zoom\",hr=\"image/jpeg\",nt=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,at=/^data:/,wl=/^data:image\\/jpeg;base64,/,Sl=/^img|canvas$/i,nn={viewMode:0,dragMode:X,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:\"\",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Pl='<div class=\"cropper-container\" touch-action=\"none\"><div class=\"cropper-wrap-box\"><div class=\"cropper-canvas\"></div></div><div class=\"cropper-drag-box\"></div><div class=\"cropper-crop-box\"><span class=\"cropper-view-box\"></span><span class=\"cropper-dashed dashed-h\"></span><span class=\"cropper-dashed dashed-v\"></span><span class=\"cropper-center\"></span><span class=\"cropper-face\"></span><span class=\"cropper-line line-e\" data-cropper-action=\"e\"></span><span class=\"cropper-line line-n\" data-cropper-action=\"n\"></span><span class=\"cropper-line line-w\" data-cropper-action=\"w\"></span><span class=\"cropper-line line-s\" data-cropper-action=\"s\"></span><span class=\"cropper-point point-e\" data-cropper-action=\"e\"></span><span class=\"cropper-point point-n\" data-cropper-action=\"n\"></span><span class=\"cropper-point point-w\" data-cropper-action=\"w\"></span><span class=\"cropper-point point-s\" data-cropper-action=\"s\"></span><span class=\"cropper-point point-ne\" data-cropper-action=\"ne\"></span><span class=\"cropper-point point-nw\" data-cropper-action=\"nw\"></span><span class=\"cropper-point point-sw\" data-cropper-action=\"sw\"></span><span class=\"cropper-point point-se\" data-cropper-action=\"se\"></span></div></div>',_l=Number.isNaN||S.isNaN;function ie(v){return typeof v==\"number\"&&!_l(v)}n(ie,\"isNumber\");var an=n(function(c){return c>0&&c<1/0},\"isPositiveNumber\");function Po(v){return typeof v>\"u\"}n(Po,\"isUndefined\");function Ni(v){return i(v)===\"object\"&&v!==null}n(Ni,\"isObject\");var hh=Object.prototype.hasOwnProperty;function Vr(v){if(!Ni(v))return!1;try{var c=v.constructor,g=c.prototype;return c&&g&&hh.call(g,\"isPrototypeOf\")}catch{return!1}}n(Vr,\"isPlainObject\");function St(v){return typeof v==\"function\"}n(St,\"isFunction\");var dh=Array.prototype.slice;function _o(v){return Array.from?Array.from(v):dh.call(v)}n(_o,\"toArray\");function Re(v,c){return v&&St(c)&&(Array.isArray(v)||ie(v.length)?_o(v).forEach(function(g,m){c.call(v,g,m,v)}):Ni(v)&&Object.keys(v).forEach(function(g){c.call(v,v[g],g,v)})),v}n(Re,\"forEach\");var Se=Object.assign||n(function(c){for(var g=arguments.length,m=new Array(g>1?g-1:0),P=1;P<g;P++)m[P-1]=arguments[P];return Ni(c)&&m.length>0&&m.forEach(function(w){Ni(w)&&Object.keys(w).forEach(function(_){c[_]=w[_]})}),c},\"assign\"),ln=/\\.\\d*(?:0|9){12}\\d*$/;function Mi(v){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return ln.test(v)?Math.round(v*c)/c:v}n(Mi,\"normalizeDecimalNumber\");var xl=/^width|height|left|top|marginLeft|marginTop$/;function vi(v,c){var g=v.style;Re(c,function(m,P){xl.test(P)&&ie(m)&&(m=\"\".concat(m,\"px\")),g[P]=m})}n(vi,\"setStyle\");function Fl(v,c){return v.classList?v.classList.contains(c):v.className.indexOf(c)>-1}n(Fl,\"hasClass\");function je(v,c){if(c){if(ie(v.length)){Re(v,function(m){je(m,c)});return}if(v.classList){v.classList.add(c);return}var g=v.className.trim();g?g.indexOf(c)<0&&(v.className=\"\".concat(g,\" \").concat(c)):v.className=c}}n(je,\"addClass\");function bi(v,c){if(c){if(ie(v.length)){Re(v,function(g){bi(g,c)});return}if(v.classList){v.classList.remove(c);return}v.className.indexOf(c)>=0&&(v.className=v.className.replace(c,\"\"))}}n(bi,\"removeClass\");function Wr(v,c,g){if(c){if(ie(v.length)){Re(v,function(m){Wr(m,c,g)});return}g?je(v,c):bi(v,c)}}n(Wr,\"toggleClass\");var yb=/([a-z\\d])([A-Z])/g;function ch(v){return v.replace(yb,\"$1-$2\").toLowerCase()}n(ch,\"toParamCase\");function ph(v,c){return Ni(v[c])?v[c]:v.dataset?v.dataset[c]:v.getAttribute(\"data-\".concat(ch(c)))}n(ph,\"getData\");function un(v,c,g){Ni(g)?v[c]=g:v.dataset?v.dataset[c]=g:v.setAttribute(\"data-\".concat(ch(c)),g)}n(un,\"setData\");function vb(v,c){if(Ni(v[c]))try{delete v[c]}catch{v[c]=void 0}else if(v.dataset)try{delete v.dataset[c]}catch{v.dataset[c]=void 0}else v.removeAttribute(\"data-\".concat(ch(c)))}n(vb,\"removeData\");var Vp=/\\s\\s*/,Wp=function(){var v=!1;if(b){var c=!1,g=n(function(){},\"listener\"),m=Object.defineProperty({},\"once\",{get:n(function(){return v=!0,c},\"get\"),set:n(function(w){c=w},\"set\")});S.addEventListener(\"test\",g,m),S.removeEventListener(\"test\",g,m)}return v}();function wi(v,c,g){var m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},P=g;c.trim().split(Vp).forEach(function(w){if(!Wp){var _=v.listeners;_&&_[w]&&_[w][g]&&(P=_[w][g],delete _[w][g],Object.keys(_[w]).length===0&&delete _[w],Object.keys(_).length===0&&delete v.listeners)}v.removeEventListener(w,P,m)})}n(wi,\"removeListener\");function hi(v,c,g){var m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},P=g;c.trim().split(Vp).forEach(function(w){if(m.once&&!Wp){var _=v.listeners,O=_===void 0?{}:_;P=n(function(){delete O[w][g],v.removeEventListener(w,P,m);for(var A=arguments.length,T=new Array(A),C=0;C<A;C++)T[C]=arguments[C];g.apply(v,T)},\"handler\"),O[w]||(O[w]={}),O[w][g]&&v.removeEventListener(w,O[w][g],m),O[w][g]=P,v.listeners=O}v.addEventListener(w,P,m)})}n(hi,\"addListener\");function xo(v,c,g){var m;return St(Event)&&St(CustomEvent)?m=new CustomEvent(c,{detail:g,bubbles:!0,cancelable:!0}):(m=document.createEvent(\"CustomEvent\"),m.initCustomEvent(c,!0,!0,g)),v.dispatchEvent(m)}n(xo,\"dispatchEvent\");function Gp(v){var c=v.getBoundingClientRect();return{left:c.left+(window.pageXOffset-document.documentElement.clientLeft),top:c.top+(window.pageYOffset-document.documentElement.clientTop)}}n(Gp,\"getOffset\");var fh=S.location,bb=/^(\\w+:)\\/\\/([^:/?#]*):?(\\d*)/i;function Kp(v){var c=v.match(bb);return c!==null&&(c[1]!==fh.protocol||c[2]!==fh.hostname||c[3]!==fh.port)}n(Kp,\"isCrossOriginURL\");function Xp(v){var c=\"timestamp=\".concat(new Date().getTime());return v+(v.indexOf(\"?\")===-1?\"?\":\"&\")+c}n(Xp,\"addTimestamp\");function hn(v){var c=v.rotate,g=v.scaleX,m=v.scaleY,P=v.translateX,w=v.translateY,_=[];ie(P)&&P!==0&&_.push(\"translateX(\".concat(P,\"px)\")),ie(w)&&w!==0&&_.push(\"translateY(\".concat(w,\"px)\")),ie(c)&&c!==0&&_.push(\"rotate(\".concat(c,\"deg)\")),ie(g)&&g!==1&&_.push(\"scaleX(\".concat(g,\")\")),ie(m)&&m!==1&&_.push(\"scaleY(\".concat(m,\")\"));var O=_.length?_.join(\" \"):\"none\";return{WebkitTransform:O,msTransform:O,transform:O}}n(hn,\"getTransforms\");function wb(v){var c=a({},v),g=[];return Re(v,function(m,P){delete c[P],Re(c,function(w){var _=Math.abs(m.startX-w.startX),O=Math.abs(m.startY-w.startY),D=Math.abs(m.endX-w.endX),A=Math.abs(m.endY-w.endY),T=Math.sqrt(_*_+O*O),C=Math.sqrt(D*D+A*A),k=(C-T)/T;g.push(k)})}),g.sort(function(m,P){return Math.abs(m)<Math.abs(P)}),g[0]}n(wb,\"getMaxZoomRatio\");function El(v,c){var g=v.pageX,m=v.pageY,P={endX:g,endY:m};return c?P:a({startX:g,startY:m},P)}n(El,\"getPointer\");function Sb(v){var c=0,g=0,m=0;return Re(v,function(P){var w=P.startX,_=P.startY;c+=w,g+=_,m+=1}),c/=m,g/=m,{pageX:c,pageY:g}}n(Sb,\"getPointersCenter\");function Gr(v){var c=v.aspectRatio,g=v.height,m=v.width,P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:\"contain\",w=an(m),_=an(g);if(w&&_){var O=g*c;P===\"contain\"&&O>m||P===\"cover\"&&O<m?g=m/c:m=g*c}else w?g=m/c:_&&(m=g*c);return{width:m,height:g}}n(Gr,\"getAdjustedSizes\");function Pb(v){var c=v.width,g=v.height,m=v.degree;if(m=Math.abs(m)%180,m===90)return{width:g,height:c};var P=m%90*Math.PI/180,w=Math.sin(P),_=Math.cos(P),O=c*_+g*w,D=c*w+g*_;return m>90?{width:D,height:O}:{width:O,height:D}}n(Pb,\"getRotatedSizes\");function _b(v,c,g,m){var P=c.aspectRatio,w=c.naturalWidth,_=c.naturalHeight,O=c.rotate,D=O===void 0?0:O,A=c.scaleX,T=A===void 0?1:A,C=c.scaleY,k=C===void 0?1:C,ue=g.aspectRatio,le=g.naturalWidth,Ce=g.naturalHeight,fe=m.fillColor,Ze=fe===void 0?\"transparent\":fe,lt=m.imageSmoothingEnabled,Ke=lt===void 0?!0:lt,dr=m.imageSmoothingQuality,Wt=dr===void 0?\"low\":dr,M=m.maxWidth,me=M===void 0?1/0:M,et=m.maxHeight,di=et===void 0?1/0:et,cr=m.minWidth,ps=cr===void 0?0:cr,fs=m.minHeight,Kr=fs===void 0?0:fs,Li=document.createElement(\"canvas\"),jt=Li.getContext(\"2d\"),ms=Gr({aspectRatio:ue,width:me,height:di}),Ol=Gr({aspectRatio:ue,width:ps,height:Kr},\"cover\"),mh=Math.min(ms.width,Math.max(Ol.width,le)),gh=Math.min(ms.height,Math.max(Ol.height,Ce)),Jp=Gr({aspectRatio:P,width:me,height:di}),Zp=Gr({aspectRatio:P,width:ps,height:Kr},\"cover\"),ef=Math.min(Jp.width,Math.max(Zp.width,w)),tf=Math.min(Jp.height,Math.max(Zp.height,_)),Mb=[-ef/2,-tf/2,ef,tf];return Li.width=Mi(mh),Li.height=Mi(gh),jt.fillStyle=Ze,jt.fillRect(0,0,mh,gh),jt.save(),jt.translate(mh/2,gh/2),jt.rotate(D*Math.PI/180),jt.scale(T,k),jt.imageSmoothingEnabled=Ke,jt.imageSmoothingQuality=Wt,jt.drawImage.apply(jt,[v].concat(l(Mb.map(function(Lb){return Math.floor(Mi(Lb))})))),jt.restore(),Li}n(_b,\"getSourceCanvas\");var Yp=String.fromCharCode;function xb(v,c,g){var m=\"\";g+=c;for(var P=c;P<g;P+=1)m+=Yp(v.getUint8(P));return m}n(xb,\"getStringFromCharCode\");var Fb=/^data:.*,/;function Eb(v){var c=v.replace(Fb,\"\"),g=atob(c),m=new ArrayBuffer(g.length),P=new Uint8Array(m);return Re(P,function(w,_){P[_]=g.charCodeAt(_)}),m}n(Eb,\"dataURLToArrayBuffer\");function Ob(v,c){for(var g=[],m=8192,P=new Uint8Array(v);P.length>0;)g.push(Yp.apply(null,_o(P.subarray(0,m)))),P=P.subarray(m);return\"data:\".concat(c,\";base64,\").concat(btoa(g.join(\"\")))}n(Ob,\"arrayBufferToDataURL\");function Cb(v){var c=new DataView(v),g;try{var m,P,w;if(c.getUint8(0)===255&&c.getUint8(1)===216)for(var _=c.byteLength,O=2;O+1<_;){if(c.getUint8(O)===255&&c.getUint8(O+1)===225){P=O;break}O+=1}if(P){var D=P+4,A=P+10;if(xb(c,D,4)===\"Exif\"){var T=c.getUint16(A);if(m=T===18761,(m||T===19789)&&c.getUint16(A+2,m)===42){var C=c.getUint32(A+4,m);C>=8&&(w=A+C)}}}if(w){var k=c.getUint16(w,m),ue,le;for(le=0;le<k;le+=1)if(ue=w+le*12+2,c.getUint16(ue,m)===274){ue+=8,g=c.getUint16(ue,m),c.setUint16(ue,1,m);break}}}catch{g=1}return g}n(Cb,\"resetAndGetOrientation\");function Tb(v){var c=0,g=1,m=1;switch(v){case 2:g=-1;break;case 3:c=-180;break;case 4:m=-1;break;case 5:c=90,m=-1;break;case 6:c=90;break;case 7:c=90,g=-1;break;case 8:c=-90;break}return{rotate:c,scaleX:g,scaleY:m}}n(Tb,\"parseOrientation\");var Ab={render:n(function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},\"render\"),initContainer:n(function(){var c=this.element,g=this.options,m=this.container,P=this.cropper;je(P,xe),bi(c,xe);var w={width:Math.max(m.offsetWidth,Number(g.minContainerWidth)||200),height:Math.max(m.offsetHeight,Number(g.minContainerHeight)||100)};this.containerData=w,vi(P,{width:w.width,height:w.height}),je(c,xe),bi(P,xe)},\"initContainer\"),initCanvas:n(function(){var c=this.containerData,g=this.imageData,m=this.options.viewMode,P=Math.abs(g.rotate)%180===90,w=P?g.naturalHeight:g.naturalWidth,_=P?g.naturalWidth:g.naturalHeight,O=w/_,D=c.width,A=c.height;c.height*O>c.width?m===3?D=c.height*O:A=c.width/O:m===3?A=c.width/O:D=c.height*O;var T={aspectRatio:O,naturalWidth:w,naturalHeight:_,width:D,height:A};T.left=(c.width-D)/2,T.top=(c.height-A)/2,T.oldLeft=T.left,T.oldTop=T.top,this.canvasData=T,this.limited=m===1||m===2,this.limitCanvas(!0,!0),this.initialImageData=Se({},g),this.initialCanvasData=Se({},T)},\"initCanvas\"),limitCanvas:n(function(c,g){var m=this.options,P=this.containerData,w=this.canvasData,_=this.cropBoxData,O=m.viewMode,D=w.aspectRatio,A=this.cropped&&_;if(c){var T=Number(m.minCanvasWidth)||0,C=Number(m.minCanvasHeight)||0;O>1?(T=Math.max(T,P.width),C=Math.max(C,P.height),O===3&&(C*D>T?T=C*D:C=T/D)):O>0&&(T?T=Math.max(T,A?_.width:0):C?C=Math.max(C,A?_.height:0):A&&(T=_.width,C=_.height,C*D>T?T=C*D:C=T/D));var k=Gr({aspectRatio:D,width:T,height:C});T=k.width,C=k.height,w.minWidth=T,w.minHeight=C,w.maxWidth=1/0,w.maxHeight=1/0}if(g)if(O>(A?0:1)){var ue=P.width-w.width,le=P.height-w.height;w.minLeft=Math.min(0,ue),w.minTop=Math.min(0,le),w.maxLeft=Math.max(0,ue),w.maxTop=Math.max(0,le),A&&this.limited&&(w.minLeft=Math.min(_.left,_.left+(_.width-w.width)),w.minTop=Math.min(_.top,_.top+(_.height-w.height)),w.maxLeft=_.left,w.maxTop=_.top,O===2&&(w.width>=P.width&&(w.minLeft=Math.min(0,ue),w.maxLeft=Math.max(0,ue)),w.height>=P.height&&(w.minTop=Math.min(0,le),w.maxTop=Math.max(0,le))))}else w.minLeft=-w.width,w.minTop=-w.height,w.maxLeft=P.width,w.maxTop=P.height},\"limitCanvas\"),renderCanvas:n(function(c,g){var m=this.canvasData,P=this.imageData;if(g){var w=Pb({width:P.naturalWidth*Math.abs(P.scaleX||1),height:P.naturalHeight*Math.abs(P.scaleY||1),degree:P.rotate||0}),_=w.width,O=w.height,D=m.width*(_/m.naturalWidth),A=m.height*(O/m.naturalHeight);m.left-=(D-m.width)/2,m.top-=(A-m.height)/2,m.width=D,m.height=A,m.aspectRatio=_/O,m.naturalWidth=_,m.naturalHeight=O,this.limitCanvas(!0,!1)}(m.width>m.maxWidth||m.width<m.minWidth)&&(m.left=m.oldLeft),(m.height>m.maxHeight||m.height<m.minHeight)&&(m.top=m.oldTop),m.width=Math.min(Math.max(m.width,m.minWidth),m.maxWidth),m.height=Math.min(Math.max(m.height,m.minHeight),m.maxHeight),this.limitCanvas(!1,!0),m.left=Math.min(Math.max(m.left,m.minLeft),m.maxLeft),m.top=Math.min(Math.max(m.top,m.minTop),m.maxTop),m.oldLeft=m.left,m.oldTop=m.top,vi(this.canvas,Se({width:m.width,height:m.height},hn({translateX:m.left,translateY:m.top}))),this.renderImage(c),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},\"renderCanvas\"),renderImage:n(function(c){var g=this.canvasData,m=this.imageData,P=m.naturalWidth*(g.width/g.naturalWidth),w=m.naturalHeight*(g.height/g.naturalHeight);Se(m,{width:P,height:w,left:(g.width-P)/2,top:(g.height-w)/2}),vi(this.image,Se({width:m.width,height:m.height},hn(Se({translateX:m.left,translateY:m.top},m)))),c&&this.output()},\"renderImage\"),initCropBox:n(function(){var c=this.options,g=this.canvasData,m=c.aspectRatio||c.initialAspectRatio,P=Number(c.autoCropArea)||.8,w={width:g.width,height:g.height};m&&(g.height*m>g.width?w.height=w.width/m:w.width=w.height*m),this.cropBoxData=w,this.limitCropBox(!0,!0),w.width=Math.min(Math.max(w.width,w.minWidth),w.maxWidth),w.height=Math.min(Math.max(w.height,w.minHeight),w.maxHeight),w.width=Math.max(w.minWidth,w.width*P),w.height=Math.max(w.minHeight,w.height*P),w.left=g.left+(g.width-w.width)/2,w.top=g.top+(g.height-w.height)/2,w.oldLeft=w.left,w.oldTop=w.top,this.initialCropBoxData=Se({},w)},\"initCropBox\"),limitCropBox:n(function(c,g){var m=this.options,P=this.containerData,w=this.canvasData,_=this.cropBoxData,O=this.limited,D=m.aspectRatio;if(c){var A=Number(m.minCropBoxWidth)||0,T=Number(m.minCropBoxHeight)||0,C=O?Math.min(P.width,w.width,w.width+w.left,P.width-w.left):P.width,k=O?Math.min(P.height,w.height,w.height+w.top,P.height-w.top):P.height;A=Math.min(A,P.width),T=Math.min(T,P.height),D&&(A&&T?T*D>A?T=A/D:A=T*D:A?T=A/D:T&&(A=T*D),k*D>C?k=C/D:C=k*D),_.minWidth=Math.min(A,C),_.minHeight=Math.min(T,k),_.maxWidth=C,_.maxHeight=k}g&&(O?(_.minLeft=Math.max(0,w.left),_.minTop=Math.max(0,w.top),_.maxLeft=Math.min(P.width,w.left+w.width)-_.width,_.maxTop=Math.min(P.height,w.top+w.height)-_.height):(_.minLeft=0,_.minTop=0,_.maxLeft=P.width-_.width,_.maxTop=P.height-_.height))},\"limitCropBox\"),renderCropBox:n(function(){var c=this.options,g=this.containerData,m=this.cropBoxData;(m.width>m.maxWidth||m.width<m.minWidth)&&(m.left=m.oldLeft),(m.height>m.maxHeight||m.height<m.minHeight)&&(m.top=m.oldTop),m.width=Math.min(Math.max(m.width,m.minWidth),m.maxWidth),m.height=Math.min(Math.max(m.height,m.minHeight),m.maxHeight),this.limitCropBox(!1,!0),m.left=Math.min(Math.max(m.left,m.minLeft),m.maxLeft),m.top=Math.min(Math.max(m.top,m.minTop),m.maxTop),m.oldLeft=m.left,m.oldTop=m.top,c.movable&&c.cropBoxMovable&&un(this.face,L,m.width>=g.width&&m.height>=g.height?G:U),vi(this.cropBox,Se({width:m.width,height:m.height},hn({translateX:m.left,translateY:m.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},\"renderCropBox\"),output:n(function(){this.preview(),xo(this.element,ne,this.getData())},\"output\")},Rb={initPreview:n(function(){var c=this.element,g=this.crossOrigin,m=this.options.preview,P=g?this.crossOriginUrl:this.url,w=c.alt||\"The image to preview\",_=document.createElement(\"img\");if(g&&(_.crossOrigin=g),_.src=P,_.alt=w,this.viewBox.appendChild(_),this.viewBoxImage=_,!!m){var O=m;typeof m==\"string\"?O=c.ownerDocument.querySelectorAll(m):m.querySelector&&(O=[m]),this.previews=O,Re(O,function(D){var A=document.createElement(\"img\");un(D,Q,{width:D.offsetWidth,height:D.offsetHeight,html:D.innerHTML}),g&&(A.crossOrigin=g),A.src=P,A.alt=w,A.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;\"',D.innerHTML=\"\",D.appendChild(A)})}},\"initPreview\"),resetPreview:n(function(){Re(this.previews,function(c){var g=ph(c,Q);vi(c,{width:g.width,height:g.height}),c.innerHTML=g.html,vb(c,Q)})},\"resetPreview\"),preview:n(function(){var c=this.imageData,g=this.canvasData,m=this.cropBoxData,P=m.width,w=m.height,_=c.width,O=c.height,D=m.left-g.left-c.left,A=m.top-g.top-c.top;!this.cropped||this.disabled||(vi(this.viewBoxImage,Se({width:_,height:O},hn(Se({translateX:-D,translateY:-A},c)))),Re(this.previews,function(T){var C=ph(T,Q),k=C.width,ue=C.height,le=k,Ce=ue,fe=1;P&&(fe=k/P,Ce=w*fe),w&&Ce>ue&&(fe=ue/w,le=P*fe,Ce=ue),vi(T,{width:le,height:Ce}),vi(T.getElementsByTagName(\"img\")[0],Se({width:_*fe,height:O*fe},hn(Se({translateX:-D*fe,translateY:-A*fe},c))))}))},\"preview\")},Ub={bind:n(function(){var c=this.element,g=this.options,m=this.cropper;St(g.cropstart)&&hi(c,Ee,g.cropstart),St(g.cropmove)&&hi(c,Fe,g.cropmove),St(g.cropend)&&hi(c,re,g.cropend),St(g.crop)&&hi(c,ne,g.crop),St(g.zoom)&&hi(c,ur,g.zoom),hi(m,Ge,this.onCropStart=this.cropStart.bind(this)),g.zoomable&&g.zoomOnWheel&&hi(m,qr,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),g.toggleDragModeOnDblclick&&hi(m,Ft,this.onDblclick=this.dblclick.bind(this)),hi(c.ownerDocument,lr,this.onCropMove=this.cropMove.bind(this)),hi(c.ownerDocument,So,this.onCropEnd=this.cropEnd.bind(this)),g.responsive&&hi(window,$r,this.onResize=this.resize.bind(this))},\"bind\"),unbind:n(function(){var c=this.element,g=this.options,m=this.cropper;St(g.cropstart)&&wi(c,Ee,g.cropstart),St(g.cropmove)&&wi(c,Fe,g.cropmove),St(g.cropend)&&wi(c,re,g.cropend),St(g.crop)&&wi(c,ne,g.crop),St(g.zoom)&&wi(c,ur,g.zoom),wi(m,Ge,this.onCropStart),g.zoomable&&g.zoomOnWheel&&wi(m,qr,this.onWheel,{passive:!1,capture:!0}),g.toggleDragModeOnDblclick&&wi(m,Ft,this.onDblclick),wi(c.ownerDocument,lr,this.onCropMove),wi(c.ownerDocument,So,this.onCropEnd),g.responsive&&wi(window,$r,this.onResize)},\"unbind\")},kb={resize:n(function(){if(!this.disabled){var c=this.options,g=this.container,m=this.containerData,P=g.offsetWidth/m.width;if(P!==1||g.offsetHeight!==m.height){var w,_;c.restore&&(w=this.getCanvasData(),_=this.getCropBoxData()),this.render(),c.restore&&(this.setCanvasData(Re(w,function(O,D){w[D]=O*P})),this.setCropBoxData(Re(_,function(O,D){_[D]=O*P})))}}},\"resize\"),dblclick:n(function(){this.disabled||this.options.dragMode===pe||this.setDragMode(Fl(this.dragBox,_e)?ye:X)},\"dblclick\"),wheel:n(function(c){var g=this,m=Number(this.options.wheelZoomRatio)||.1,P=1;this.disabled||(c.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){g.wheeling=!1},50),c.deltaY?P=c.deltaY>0?1:-1:c.wheelDelta?P=-c.wheelDelta/120:c.detail&&(P=c.detail>0?1:-1),this.zoom(-P*m,c)))},\"wheel\"),cropStart:n(function(c){var g=c.buttons,m=c.button;if(!(this.disabled||(c.type===\"mousedown\"||c.type===\"pointerdown\"&&c.pointerType===\"mouse\")&&(ie(g)&&g!==1||ie(m)&&m!==0||c.ctrlKey))){var P=this.options,w=this.pointers,_;c.changedTouches?Re(c.changedTouches,function(O){w[O.identifier]=El(O)}):w[c.pointerId||0]=El(c),Object.keys(w).length>1&&P.zoomable&&P.zoomOnTouch?_=J:_=ph(c.target,L),nt.test(_)&&xo(this.element,Ee,{originalEvent:c,action:_})!==!1&&(c.preventDefault(),this.action=_,this.cropping=!1,_===j&&(this.cropping=!0,je(this.dragBox,R)))}},\"cropStart\"),cropMove:n(function(c){var g=this.action;if(!(this.disabled||!g)){var m=this.pointers;c.preventDefault(),xo(this.element,Fe,{originalEvent:c,action:g})!==!1&&(c.changedTouches?Re(c.changedTouches,function(P){Se(m[P.identifier]||{},El(P,!0))}):Se(m[c.pointerId||0]||{},El(c,!0)),this.change(c))}},\"cropMove\"),cropEnd:n(function(c){if(!this.disabled){var g=this.action,m=this.pointers;c.changedTouches?Re(c.changedTouches,function(P){delete m[P.identifier]}):delete m[c.pointerId||0],g&&(c.preventDefault(),Object.keys(m).length||(this.action=\"\"),this.cropping&&(this.cropping=!1,Wr(this.dragBox,R,this.cropped&&this.options.modal)),xo(this.element,re,{originalEvent:c,action:g}))}},\"cropEnd\")},Db={change:n(function(c){var g=this.options,m=this.canvasData,P=this.containerData,w=this.cropBoxData,_=this.pointers,O=this.action,D=g.aspectRatio,A=w.left,T=w.top,C=w.width,k=w.height,ue=A+C,le=T+k,Ce=0,fe=0,Ze=P.width,lt=P.height,Ke=!0,dr;!D&&c.shiftKey&&(D=C&&k?C/k:1),this.limited&&(Ce=w.minLeft,fe=w.minTop,Ze=Ce+Math.min(P.width,m.width,m.left+m.width),lt=fe+Math.min(P.height,m.height,m.top+m.height));var Wt=_[Object.keys(_)[0]],M={x:Wt.endX-Wt.startX,y:Wt.endY-Wt.startY},me=n(function(di){switch(di){case B:ue+M.x>Ze&&(M.x=Ze-ue);break;case z:A+M.x<Ce&&(M.x=Ce-A);break;case oe:T+M.y<fe&&(M.y=fe-T);break;case K:le+M.y>lt&&(M.y=lt-le);break}},\"check\");switch(O){case U:A+=M.x,T+=M.y;break;case B:if(M.x>=0&&(ue>=Ze||D&&(T<=fe||le>=lt))){Ke=!1;break}me(B),C+=M.x,C<0&&(O=z,C=-C,A-=C),D&&(k=C/D,T+=(w.height-k)/2);break;case oe:if(M.y<=0&&(T<=fe||D&&(A<=Ce||ue>=Ze))){Ke=!1;break}me(oe),k-=M.y,T+=M.y,k<0&&(O=K,k=-k,T-=k),D&&(C=k*D,A+=(w.width-C)/2);break;case z:if(M.x<=0&&(A<=Ce||D&&(T<=fe||le>=lt))){Ke=!1;break}me(z),C-=M.x,A+=M.x,C<0&&(O=B,C=-C,A-=C),D&&(k=C/D,T+=(w.height-k)/2);break;case K:if(M.y>=0&&(le>=lt||D&&(A<=Ce||ue>=Ze))){Ke=!1;break}me(K),k+=M.y,k<0&&(O=oe,k=-k,T-=k),D&&(C=k*D,A+=(w.width-C)/2);break;case Be:if(D){if(M.y<=0&&(T<=fe||ue>=Ze)){Ke=!1;break}me(oe),k-=M.y,T+=M.y,C=k*D}else me(oe),me(B),M.x>=0?ue<Ze?C+=M.x:M.y<=0&&T<=fe&&(Ke=!1):C+=M.x,M.y<=0?T>fe&&(k-=M.y,T+=M.y):(k-=M.y,T+=M.y);C<0&&k<0?(O=We,k=-k,C=-C,T-=k,A-=C):C<0?(O=Je,C=-C,A-=C):k<0&&(O=wt,k=-k,T-=k);break;case Je:if(D){if(M.y<=0&&(T<=fe||A<=Ce)){Ke=!1;break}me(oe),k-=M.y,T+=M.y,C=k*D,A+=w.width-C}else me(oe),me(z),M.x<=0?A>Ce?(C-=M.x,A+=M.x):M.y<=0&&T<=fe&&(Ke=!1):(C-=M.x,A+=M.x),M.y<=0?T>fe&&(k-=M.y,T+=M.y):(k-=M.y,T+=M.y);C<0&&k<0?(O=wt,k=-k,C=-C,T-=k,A-=C):C<0?(O=Be,C=-C,A-=C):k<0&&(O=We,k=-k,T-=k);break;case We:if(D){if(M.x<=0&&(A<=Ce||le>=lt)){Ke=!1;break}me(z),C-=M.x,A+=M.x,k=C/D}else me(K),me(z),M.x<=0?A>Ce?(C-=M.x,A+=M.x):M.y>=0&&le>=lt&&(Ke=!1):(C-=M.x,A+=M.x),M.y>=0?le<lt&&(k+=M.y):k+=M.y;C<0&&k<0?(O=Be,k=-k,C=-C,T-=k,A-=C):C<0?(O=wt,C=-C,A-=C):k<0&&(O=Je,k=-k,T-=k);break;case wt:if(D){if(M.x>=0&&(ue>=Ze||le>=lt)){Ke=!1;break}me(B),C+=M.x,k=C/D}else me(K),me(B),M.x>=0?ue<Ze?C+=M.x:M.y>=0&&le>=lt&&(Ke=!1):C+=M.x,M.y>=0?le<lt&&(k+=M.y):k+=M.y;C<0&&k<0?(O=Je,k=-k,C=-C,T-=k,A-=C):C<0?(O=We,C=-C,A-=C):k<0&&(O=Be,k=-k,T-=k);break;case G:this.move(M.x,M.y),Ke=!1;break;case J:this.zoom(wb(_),c),Ke=!1;break;case j:if(!M.x||!M.y){Ke=!1;break}dr=Gp(this.cropper),A=Wt.startX-dr.left,T=Wt.startY-dr.top,C=w.minWidth,k=w.minHeight,M.x>0?O=M.y>0?wt:Be:M.x<0&&(A-=C,O=M.y>0?We:Je),M.y<0&&(T-=k),this.cropped||(bi(this.cropBox,xe),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}Ke&&(w.width=C,w.height=k,w.left=A,w.top=T,this.action=O,this.renderCropBox()),Re(_,function(et){et.startX=et.endX,et.startY=et.endY})},\"change\")},Ib={crop:n(function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&je(this.dragBox,R),bi(this.cropBox,xe),this.setCropBoxData(this.initialCropBoxData)),this},\"crop\"),reset:n(function(){return this.ready&&!this.disabled&&(this.imageData=Se({},this.initialImageData),this.canvasData=Se({},this.initialCanvasData),this.cropBoxData=Se({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},\"reset\"),clear:n(function(){return this.cropped&&!this.disabled&&(Se(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),bi(this.dragBox,R),je(this.cropBox,xe)),this},\"clear\"),replace:n(function(c){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&c&&(this.isImg&&(this.element.src=c),g?(this.url=c,this.image.src=c,this.ready&&(this.viewBoxImage.src=c,Re(this.previews,function(m){m.getElementsByTagName(\"img\")[0].src=c}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(c))),this},\"replace\"),enable:n(function(){return this.ready&&this.disabled&&(this.disabled=!1,bi(this.cropper,ze)),this},\"enable\"),disable:n(function(){return this.ready&&!this.disabled&&(this.disabled=!0,je(this.cropper,ze)),this},\"disable\"),destroy:n(function(){var c=this.element;return c[F]?(c[F]=void 0,this.isImg&&this.replaced&&(c.src=this.originalUrl),this.uncreate(),this):this},\"destroy\"),move:n(function(c){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c,m=this.canvasData,P=m.left,w=m.top;return this.moveTo(Po(c)?c:P+Number(c),Po(g)?g:w+Number(g))},\"move\"),moveTo:n(function(c){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c,m=this.canvasData,P=!1;return c=Number(c),g=Number(g),this.ready&&!this.disabled&&this.options.movable&&(ie(c)&&(m.left=c,P=!0),ie(g)&&(m.top=g,P=!0),P&&this.renderCanvas(!0)),this},\"moveTo\"),zoom:n(function(c,g){var m=this.canvasData;return c=Number(c),c<0?c=1/(1-c):c=1+c,this.zoomTo(m.width*c/m.naturalWidth,null,g)},\"zoom\"),zoomTo:n(function(c,g,m){var P=this.options,w=this.canvasData,_=w.width,O=w.height,D=w.naturalWidth,A=w.naturalHeight;if(c=Number(c),c>=0&&this.ready&&!this.disabled&&P.zoomable){var T=D*c,C=A*c;if(xo(this.element,ur,{ratio:c,oldRatio:_/D,originalEvent:m})===!1)return this;if(m){var k=this.pointers,ue=Gp(this.cropper),le=k&&Object.keys(k).length?Sb(k):{pageX:m.pageX,pageY:m.pageY};w.left-=(T-_)*((le.pageX-ue.left-w.left)/_),w.top-=(C-O)*((le.pageY-ue.top-w.top)/O)}else Vr(g)&&ie(g.x)&&ie(g.y)?(w.left-=(T-_)*((g.x-w.left)/_),w.top-=(C-O)*((g.y-w.top)/O)):(w.left-=(T-_)/2,w.top-=(C-O)/2);w.width=T,w.height=C,this.renderCanvas(!0)}return this},\"zoomTo\"),rotate:n(function(c){return this.rotateTo((this.imageData.rotate||0)+Number(c))},\"rotate\"),rotateTo:n(function(c){return c=Number(c),ie(c)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=c%360,this.renderCanvas(!0,!0)),this},\"rotateTo\"),scaleX:n(function(c){var g=this.imageData.scaleY;return this.scale(c,ie(g)?g:1)},\"scaleX\"),scaleY:n(function(c){var g=this.imageData.scaleX;return this.scale(ie(g)?g:1,c)},\"scaleY\"),scale:n(function(c){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c,m=this.imageData,P=!1;return c=Number(c),g=Number(g),this.ready&&!this.disabled&&this.options.scalable&&(ie(c)&&(m.scaleX=c,P=!0),ie(g)&&(m.scaleY=g,P=!0),P&&this.renderCanvas(!0,!0)),this},\"scale\"),getData:n(function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=this.options,m=this.imageData,P=this.canvasData,w=this.cropBoxData,_;if(this.ready&&this.cropped){_={x:w.left-P.left,y:w.top-P.top,width:w.width,height:w.height};var O=m.width/m.naturalWidth;if(Re(_,function(T,C){_[C]=T/O}),c){var D=Math.round(_.y+_.height),A=Math.round(_.x+_.width);_.x=Math.round(_.x),_.y=Math.round(_.y),_.width=A-_.x,_.height=D-_.y}}else _={x:0,y:0,width:0,height:0};return g.rotatable&&(_.rotate=m.rotate||0),g.scalable&&(_.scaleX=m.scaleX||1,_.scaleY=m.scaleY||1),_},\"getData\"),setData:n(function(c){var g=this.options,m=this.imageData,P=this.canvasData,w={};if(this.ready&&!this.disabled&&Vr(c)){var _=!1;g.rotatable&&ie(c.rotate)&&c.rotate!==m.rotate&&(m.rotate=c.rotate,_=!0),g.scalable&&(ie(c.scaleX)&&c.scaleX!==m.scaleX&&(m.scaleX=c.scaleX,_=!0),ie(c.scaleY)&&c.scaleY!==m.scaleY&&(m.scaleY=c.scaleY,_=!0)),_&&this.renderCanvas(!0,!0);var O=m.width/m.naturalWidth;ie(c.x)&&(w.left=c.x*O+P.left),ie(c.y)&&(w.top=c.y*O+P.top),ie(c.width)&&(w.width=c.width*O),ie(c.height)&&(w.height=c.height*O),this.setCropBoxData(w)}return this},\"setData\"),getContainerData:n(function(){return this.ready?Se({},this.containerData):{}},\"getContainerData\"),getImageData:n(function(){return this.sized?Se({},this.imageData):{}},\"getImageData\"),getCanvasData:n(function(){var c=this.canvasData,g={};return this.ready&&Re([\"left\",\"top\",\"width\",\"height\",\"naturalWidth\",\"naturalHeight\"],function(m){g[m]=c[m]}),g},\"getCanvasData\"),setCanvasData:n(function(c){var g=this.canvasData,m=g.aspectRatio;return this.ready&&!this.disabled&&Vr(c)&&(ie(c.left)&&(g.left=c.left),ie(c.top)&&(g.top=c.top),ie(c.width)?(g.width=c.width,g.height=c.width/m):ie(c.height)&&(g.height=c.height,g.width=c.height*m),this.renderCanvas(!0)),this},\"setCanvasData\"),getCropBoxData:n(function(){var c=this.cropBoxData,g;return this.ready&&this.cropped&&(g={left:c.left,top:c.top,width:c.width,height:c.height}),g||{}},\"getCropBoxData\"),setCropBoxData:n(function(c){var g=this.cropBoxData,m=this.options.aspectRatio,P,w;return this.ready&&this.cropped&&!this.disabled&&Vr(c)&&(ie(c.left)&&(g.left=c.left),ie(c.top)&&(g.top=c.top),ie(c.width)&&c.width!==g.width&&(P=!0,g.width=c.width),ie(c.height)&&c.height!==g.height&&(w=!0,g.height=c.height),m&&(P?g.height=g.width/m:w&&(g.width=g.height*m)),this.renderCropBox()),this},\"setCropBoxData\"),getCroppedCanvas:n(function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var g=this.canvasData,m=_b(this.image,this.imageData,g,c);if(!this.cropped)return m;var P=this.getData(),w=P.x,_=P.y,O=P.width,D=P.height,A=m.width/Math.floor(g.naturalWidth);A!==1&&(w*=A,_*=A,O*=A,D*=A);var T=O/D,C=Gr({aspectRatio:T,width:c.maxWidth||1/0,height:c.maxHeight||1/0}),k=Gr({aspectRatio:T,width:c.minWidth||0,height:c.minHeight||0},\"cover\"),ue=Gr({aspectRatio:T,width:c.width||(A!==1?m.width:O),height:c.height||(A!==1?m.height:D)}),le=ue.width,Ce=ue.height;le=Math.min(C.width,Math.max(k.width,le)),Ce=Math.min(C.height,Math.max(k.height,Ce));var fe=document.createElement(\"canvas\"),Ze=fe.getContext(\"2d\");fe.width=Mi(le),fe.height=Mi(Ce),Ze.fillStyle=c.fillColor||\"transparent\",Ze.fillRect(0,0,le,Ce);var lt=c.imageSmoothingEnabled,Ke=lt===void 0?!0:lt,dr=c.imageSmoothingQuality;Ze.imageSmoothingEnabled=Ke,dr&&(Ze.imageSmoothingQuality=dr);var Wt=m.width,M=m.height,me=w,et=_,di,cr,ps,fs,Kr,Li;me<=-O||me>Wt?(me=0,di=0,ps=0,Kr=0):me<=0?(ps=-me,me=0,di=Math.min(Wt,O+me),Kr=di):me<=Wt&&(ps=0,di=Math.min(O,Wt-me),Kr=di),di<=0||et<=-D||et>M?(et=0,cr=0,fs=0,Li=0):et<=0?(fs=-et,et=0,cr=Math.min(M,D+et),Li=cr):et<=M&&(fs=0,cr=Math.min(D,M-et),Li=cr);var jt=[me,et,di,cr];if(Kr>0&&Li>0){var ms=le/O;jt.push(ps*ms,fs*ms,Kr*ms,Li*ms)}return Ze.drawImage.apply(Ze,[m].concat(l(jt.map(function(Ol){return Math.floor(Mi(Ol))})))),fe},\"getCroppedCanvas\"),setAspectRatio:n(function(c){var g=this.options;return!this.disabled&&!Po(c)&&(g.aspectRatio=Math.max(0,c)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},\"setAspectRatio\"),setDragMode:n(function(c){var g=this.options,m=this.dragBox,P=this.face;if(this.ready&&!this.disabled){var w=c===X,_=g.movable&&c===ye;c=w||_?c:pe,g.dragMode=c,un(m,L,c),Wr(m,_e,w),Wr(m,I,_),g.cropBoxMovable||(un(P,L,c),Wr(P,_e,w),Wr(P,I,_))}return this},\"setDragMode\")},Nb=S.Cropper,Qp=function(){function v(c){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e(this,v),!c||!Sl.test(c.tagName))throw new Error(\"The first argument is required and must be an <img> or <canvas> element.\");this.element=c,this.options=Se({},nn,Vr(g)&&g),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return n(v,\"Cropper\"),r(v,[{key:\"init\",value:n(function(){var g=this.element,m=g.tagName.toLowerCase(),P;if(!g[F]){if(g[F]=this,m===\"img\"){if(this.isImg=!0,P=g.getAttribute(\"src\")||\"\",this.originalUrl=P,!P)return;P=g.src}else m===\"canvas\"&&window.HTMLCanvasElement&&(P=g.toDataURL());this.load(P)}},\"init\")},{key:\"load\",value:n(function(g){var m=this;if(g){this.url=g,this.imageData={};var P=this.element,w=this.options;if(!w.rotatable&&!w.scalable&&(w.checkOrientation=!1),!w.checkOrientation||!window.ArrayBuffer){this.clone();return}if(at.test(g)){wl.test(g)?this.read(Eb(g)):this.clone();return}var _=new XMLHttpRequest,O=this.clone.bind(this);this.reloading=!0,this.xhr=_,_.onabort=O,_.onerror=O,_.ontimeout=O,_.onprogress=function(){_.getResponseHeader(\"content-type\")!==hr&&_.abort()},_.onload=function(){m.read(_.response)},_.onloadend=function(){m.reloading=!1,m.xhr=null},w.checkCrossOrigin&&Kp(g)&&P.crossOrigin&&(g=Xp(g)),_.open(\"GET\",g),_.responseType=\"arraybuffer\",_.withCredentials=P.crossOrigin===\"use-credentials\",_.send()}},\"load\")},{key:\"read\",value:n(function(g){var m=this.options,P=this.imageData,w=Cb(g),_=0,O=1,D=1;if(w>1){this.url=Ob(g,hr);var A=Tb(w);_=A.rotate,O=A.scaleX,D=A.scaleY}m.rotatable&&(P.rotate=_),m.scalable&&(P.scaleX=O,P.scaleY=D),this.clone()},\"read\")},{key:\"clone\",value:n(function(){var g=this.element,m=this.url,P=g.crossOrigin,w=m;this.options.checkCrossOrigin&&Kp(m)&&(P||(P=\"anonymous\"),w=Xp(m)),this.crossOrigin=P,this.crossOriginUrl=w;var _=document.createElement(\"img\");P&&(_.crossOrigin=P),_.src=w||m,_.alt=g.alt||\"The image to crop\",this.image=_,_.onload=this.start.bind(this),_.onerror=this.stop.bind(this),je(_,ui),g.parentNode.insertBefore(_,g.nextSibling)},\"clone\")},{key:\"start\",value:n(function(){var g=this,m=this.image;m.onload=null,m.onerror=null,this.sizing=!0;var P=S.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(S.navigator.userAgent),w=n(function(A,T){Se(g.imageData,{naturalWidth:A,naturalHeight:T,aspectRatio:A/T}),g.sizing=!1,g.sized=!0,g.build()},\"done\");if(m.naturalWidth&&!P){w(m.naturalWidth,m.naturalHeight);return}var _=document.createElement(\"img\"),O=document.body||document.documentElement;this.sizingImage=_,_.onload=function(){w(_.width,_.height),P||O.removeChild(_)},_.src=m.src,P||(_.style.cssText=\"left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;\",O.appendChild(_))},\"start\")},{key:\"stop\",value:n(function(){var g=this.image;g.onload=null,g.onerror=null,g.parentNode.removeChild(g),this.image=null},\"stop\")},{key:\"build\",value:n(function(){if(!(!this.sized||this.ready)){var g=this.element,m=this.options,P=this.image,w=g.parentNode,_=document.createElement(\"div\");_.innerHTML=Pl;var O=_.querySelector(\".\".concat(F,\"-container\")),D=O.querySelector(\".\".concat(F,\"-canvas\")),A=O.querySelector(\".\".concat(F,\"-drag-box\")),T=O.querySelector(\".\".concat(F,\"-crop-box\")),C=T.querySelector(\".\".concat(F,\"-face\"));this.container=w,this.cropper=O,this.canvas=D,this.dragBox=A,this.cropBox=T,this.viewBox=O.querySelector(\".\".concat(F,\"-view-box\")),this.face=C,D.appendChild(P),je(g,xe),w.insertBefore(O,g.nextSibling),this.isImg||bi(P,ui),this.initPreview(),this.bind(),m.initialAspectRatio=Math.max(0,m.initialAspectRatio)||NaN,m.aspectRatio=Math.max(0,m.aspectRatio)||NaN,m.viewMode=Math.max(0,Math.min(3,Math.round(m.viewMode)))||0,je(T,xe),m.guides||je(T.getElementsByClassName(\"\".concat(F,\"-dashed\")),xe),m.center||je(T.getElementsByClassName(\"\".concat(F,\"-center\")),xe),m.background&&je(O,\"\".concat(F,\"-bg\")),m.highlight||je(C,V),m.cropBoxMovable&&(je(C,I),un(C,L,U)),m.cropBoxResizable||(je(T.getElementsByClassName(\"\".concat(F,\"-line\")),xe),je(T.getElementsByClassName(\"\".concat(F,\"-point\")),xe)),this.render(),this.ready=!0,this.setDragMode(m.dragMode),m.autoCrop&&this.crop(),this.setData(m.data),St(m.ready)&&hi(g,Hr,m.ready,{once:!0}),xo(g,Hr)}},\"build\")},{key:\"unbuild\",value:n(function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),bi(this.element,xe))},\"unbuild\")},{key:\"uncreate\",value:n(function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()},\"uncreate\")}],[{key:\"noConflict\",value:n(function(){return window.Cropper=Nb,v},\"noConflict\")},{key:\"setDefaults\",value:n(function(g){Se(nn,Vr(g)&&g)},\"setDefaults\")}]),v}();return Se(Qp.prototype,Ab,Rb,Ub,kb,Db,Ib),Qp})});var sv=he((uD,Bu)=>{\"use strict\";Bu.exports=cc;Bu.exports.isMobile=cc;Bu.exports.default=cc;var wP=/(android|bb\\d+|meego).+mobile|armv7l|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,SP=/CrOS/,PP=/android|ipad|playbook|silk/i;function cc(i){i||(i={});let e=i.ua;if(!e&&typeof navigator<\"u\"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers[\"user-agent\"]==\"string\"&&(e=e.headers[\"user-agent\"]),typeof e!=\"string\")return!1;let t=wP.test(e)&&!SP.test(e)||!!i.tablet&&PP.test(e);return!t&&i.tablet&&i.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf(\"Macintosh\")!==-1&&e.indexOf(\"Safari\")!==-1&&(t=!0),t}n(cc,\"isMobile\")});var Kv=he((c9,Gv)=>{\"use strict\";Gv.exports=n(function(e,t){if(t=t.split(\":\")[0],e=+e,!e)return!1;switch(t){case\"http\":case\"ws\":return e!==80;case\"https\":case\"wss\":return e!==443;case\"ftp\":return e!==21;case\"gopher\":return e!==70;case\"file\":return!1}return e!==0},\"required\")});var Qv=he(Vc=>{\"use strict\";var U_=Object.prototype.hasOwnProperty,k_;function Xv(i){try{return decodeURIComponent(i.replace(/\\+/g,\" \"))}catch{return null}}n(Xv,\"decode\");function Yv(i){try{return encodeURIComponent(i)}catch{return null}}n(Yv,\"encode\");function D_(i){for(var e=/([^=?#&]+)=?([^&]*)/g,t={},r;r=e.exec(i);){var s=Xv(r[1]),o=Xv(r[2]);s===null||o===null||s in t||(t[s]=o)}return t}n(D_,\"querystring\");function I_(i,e){e=e||\"\";var t=[],r,s;typeof e!=\"string\"&&(e=\"?\");for(s in i)if(U_.call(i,s)){if(r=i[s],!r&&(r===null||r===k_||isNaN(r))&&(r=\"\"),s=Yv(s),r=Yv(r),s===null||r===null)continue;t.push(s+\"=\"+r)}return t.length?e+t.join(\"&\"):\"\"}n(I_,\"querystringify\");Vc.stringify=I_;Vc.parse=D_});var o0=he((g9,s0)=>{\"use strict\";var Zv=Kv(),Yu=Qv(),N_=/^[\\x00-\\x20\\u00a0\\u1680\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000\\ufeff]+/,e0=/[\\n\\r\\t]/g,M_=/^[A-Za-z][A-Za-z0-9+-.]*:\\/\\//,t0=/:\\d+$/,L_=/^([a-z][a-z0-9.+-]*:)?(\\/\\/)?([\\\\/]+)?([\\S\\s]*)/i,B_=/^[a-zA-Z]:/;function Gc(i){return(i||\"\").toString().replace(N_,\"\")}n(Gc,\"trimLeft\");var Wc=[[\"#\",\"hash\"],[\"?\",\"query\"],n(function(e,t){return rr(t.protocol)?e.replace(/\\\\/g,\"/\"):e},\"sanitize\"),[\"/\",\"pathname\"],[\"@\",\"auth\",1],[NaN,\"host\",void 0,1,1],[/:(\\d*)$/,\"port\",void 0,1],[NaN,\"hostname\",void 0,1,1]],Jv={hash:1,query:1};function i0(i){var e;typeof window<\"u\"?e=window:typeof global<\"u\"?e=global:typeof self<\"u\"?e=self:e={};var t=e.location||{};i=i||t;var r={},s=typeof i,o;if(i.protocol===\"blob:\")r=new sr(unescape(i.pathname),{});else if(s===\"string\"){r=new sr(i,{});for(o in Jv)delete r[o]}else if(s===\"object\"){for(o in i)o in Jv||(r[o]=i[o]);r.slashes===void 0&&(r.slashes=M_.test(i.href))}return r}n(i0,\"lolcation\");function rr(i){return i===\"file:\"||i===\"ftp:\"||i===\"http:\"||i===\"https:\"||i===\"ws:\"||i===\"wss:\"}n(rr,\"isSpecial\");function r0(i,e){i=Gc(i),i=i.replace(e0,\"\"),e=e||{};var t=L_.exec(i),r=t[1]?t[1].toLowerCase():\"\",s=!!t[2],o=!!t[3],a=0,l;return s?o?(l=t[2]+t[3]+t[4],a=t[2].length+t[3].length):(l=t[2]+t[4],a=t[2].length):o?(l=t[3]+t[4],a=t[3].length):l=t[4],r===\"file:\"?a>=2&&(l=l.slice(2)):rr(r)?l=t[4]:r?s&&(l=l.slice(2)):a>=2&&rr(e.protocol)&&(l=t[4]),{protocol:r,slashes:s||rr(r),slashesCount:a,rest:l}}n(r0,\"extractProtocol\");function z_(i,e){if(i===\"\")return e;for(var t=(e||\"/\").split(\"/\").slice(0,-1).concat(i.split(\"/\")),r=t.length,s=t[r-1],o=!1,a=0;r--;)t[r]===\".\"?t.splice(r,1):t[r]===\"..\"?(t.splice(r,1),a++):a&&(r===0&&(o=!0),t.splice(r,1),a--);return o&&t.unshift(\"\"),(s===\".\"||s===\"..\")&&t.push(\"\"),t.join(\"/\")}n(z_,\"resolve\");function sr(i,e,t){if(i=Gc(i),i=i.replace(e0,\"\"),!(this instanceof sr))return new sr(i,e,t);var r,s,o,a,l,h,p=Wc.slice(),d=typeof e,f=this,y=0;for(d!==\"object\"&&d!==\"string\"&&(t=e,e=null),t&&typeof t!=\"function\"&&(t=Yu.parse),e=i0(e),s=r0(i||\"\",e),r=!s.protocol&&!s.slashes,f.slashes=s.slashes||r&&e.slashes,f.protocol=s.protocol||e.protocol||\"\",i=s.rest,(s.protocol===\"file:\"&&(s.slashesCount!==2||B_.test(i))||!s.slashes&&(s.protocol||s.slashesCount<2||!rr(f.protocol)))&&(p[3]=[/(.*)/,\"pathname\"]);y<p.length;y++){if(a=p[y],typeof a==\"function\"){i=a(i,f);continue}o=a[0],h=a[1],o!==o?f[h]=i:typeof o==\"string\"?(l=o===\"@\"?i.lastIndexOf(o):i.indexOf(o),~l&&(typeof a[2]==\"number\"?(f[h]=i.slice(0,l),i=i.slice(l+a[2])):(f[h]=i.slice(l),i=i.slice(0,l)))):(l=o.exec(i))&&(f[h]=l[1],i=i.slice(0,l.index)),f[h]=f[h]||r&&a[3]&&e[h]||\"\",a[4]&&(f[h]=f[h].toLowerCase())}t&&(f.query=t(f.query)),r&&e.slashes&&f.pathname.charAt(0)!==\"/\"&&(f.pathname!==\"\"||e.pathname!==\"\")&&(f.pathname=z_(f.pathname,e.pathname)),f.pathname.charAt(0)!==\"/\"&&rr(f.protocol)&&(f.pathname=\"/\"+f.pathname),Zv(f.port,f.protocol)||(f.host=f.hostname,f.port=\"\"),f.username=f.password=\"\",f.auth&&(l=f.auth.indexOf(\":\"),~l?(f.username=f.auth.slice(0,l),f.username=encodeURIComponent(decodeURIComponent(f.username)),f.password=f.auth.slice(l+1),f.password=encodeURIComponent(decodeURIComponent(f.password))):f.username=encodeURIComponent(decodeURIComponent(f.auth)),f.auth=f.password?f.username+\":\"+f.password:f.username),f.origin=f.protocol!==\"file:\"&&rr(f.protocol)&&f.host?f.protocol+\"//\"+f.host:\"null\",f.href=f.toString()}n(sr,\"Url\");function j_(i,e,t){var r=this;switch(i){case\"query\":typeof e==\"string\"&&e.length&&(e=(t||Yu.parse)(e)),r[i]=e;break;case\"port\":r[i]=e,Zv(e,r.protocol)?e&&(r.host=r.hostname+\":\"+e):(r.host=r.hostname,r[i]=\"\");break;case\"hostname\":r[i]=e,r.port&&(e+=\":\"+r.port),r.host=e;break;case\"host\":r[i]=e,t0.test(e)?(e=e.split(\":\"),r.port=e.pop(),r.hostname=e.join(\":\")):(r.hostname=e,r.port=\"\");break;case\"protocol\":r.protocol=e.toLowerCase(),r.slashes=!t;break;case\"pathname\":case\"hash\":if(e){var s=i===\"pathname\"?\"/\":\"#\";r[i]=e.charAt(0)!==s?s+e:e}else r[i]=e;break;case\"username\":case\"password\":r[i]=encodeURIComponent(e);break;case\"auth\":var o=e.indexOf(\":\");~o?(r.username=e.slice(0,o),r.username=encodeURIComponent(decodeURIComponent(r.username)),r.password=e.slice(o+1),r.password=encodeURIComponent(decodeURIComponent(r.password))):r.username=encodeURIComponent(decodeURIComponent(e))}for(var a=0;a<Wc.length;a++){var l=Wc[a];l[4]&&(r[l[1]]=r[l[1]].toLowerCase())}return r.auth=r.password?r.username+\":\"+r.password:r.username,r.origin=r.protocol!==\"file:\"&&rr(r.protocol)&&r.host?r.protocol+\"//\"+r.host:\"null\",r.href=r.toString(),r}n(j_,\"set\");function H_(i){(!i||typeof i!=\"function\")&&(i=Yu.stringify);var e,t=this,r=t.host,s=t.protocol;s&&s.charAt(s.length-1)!==\":\"&&(s+=\":\");var o=s+(t.protocol&&t.slashes||rr(t.protocol)?\"//\":\"\");return t.username?(o+=t.username,t.password&&(o+=\":\"+t.password),o+=\"@\"):t.password?(o+=\":\"+t.password,o+=\"@\"):t.protocol!==\"file:\"&&rr(t.protocol)&&!r&&t.pathname!==\"/\"&&(o+=\"@\"),(r[r.length-1]===\":\"||t0.test(t.hostname)&&!t.port)&&(r+=\":\"),o+=r+t.pathname,e=typeof t.query==\"object\"?i(t.query):t.query,e&&(o+=e.charAt(0)!==\"?\"?\"?\"+e:e),t.hash&&(o+=t.hash),o}n(H_,\"toString\");sr.prototype={set:j_,toString:H_};sr.extractProtocol=r0;sr.location=i0;sr.trimLeft=Gc;sr.qs=Yu;s0.exports=sr});var cp=he((CI,dp)=>{typeof dp<\"u\"&&(dp.exports=ni);function ni(i){if(i)return j5(i)}n(ni,\"Emitter\");function j5(i){for(var e in ni.prototype)i[e]=ni.prototype[e];return i}n(j5,\"mixin\");ni.prototype.on=ni.prototype.addEventListener=function(i,e){return this._callbacks=this._callbacks||{},(this._callbacks[\"$\"+i]=this._callbacks[\"$\"+i]||[]).push(e),this};ni.prototype.once=function(i,e){function t(){this.off(i,t),e.apply(this,arguments)}return n(t,\"on\"),t.fn=e,this.on(i,t),this};ni.prototype.off=ni.prototype.removeListener=ni.prototype.removeAllListeners=ni.prototype.removeEventListener=function(i,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks[\"$\"+i];if(!t)return this;if(arguments.length==1)return delete this._callbacks[\"$\"+i],this;for(var r,s=0;s<t.length;s++)if(r=t[s],r===e||r.fn===e){t.splice(s,1);break}return t.length===0&&delete this._callbacks[\"$\"+i],this};ni.prototype.emit=function(i){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks[\"$\"+i],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(t){t=t.slice(0);for(var r=0,s=t.length;r<s;++r)t[r].apply(this,e)}return this};ni.prototype.listeners=function(i){return this._callbacks=this._callbacks||{},this._callbacks[\"$\"+i]||[]};ni.prototype.hasListeners=function(i){return!!this.listeners(i).length}});var J0=he((jp,Hp)=>{(function(i,e){typeof jp==\"object\"&&typeof Hp<\"u\"?Hp.exports=e():typeof define==\"function\"&&define.amd?define(e):(i=typeof globalThis<\"u\"?globalThis:i||self,i.Compressor=e())})(jp,function(){\"use strict\";function i(V,R){var I=Object.keys(V);if(Object.getOwnPropertySymbols){var L=Object.getOwnPropertySymbols(V);R&&(L=L.filter(function(Q){return Object.getOwnPropertyDescriptor(V,Q).enumerable})),I.push.apply(I,L)}return I}n(i,\"ownKeys\");function e(V){for(var R=1;R<arguments.length;R++){var I=arguments[R]!=null?arguments[R]:{};R%2?i(Object(I),!0).forEach(function(L){o(V,L,I[L])}):Object.getOwnPropertyDescriptors?Object.defineProperties(V,Object.getOwnPropertyDescriptors(I)):i(Object(I)).forEach(function(L){Object.defineProperty(V,L,Object.getOwnPropertyDescriptor(I,L))})}return V}n(e,\"_objectSpread2\");function t(V,R){if(!(V instanceof R))throw new TypeError(\"Cannot call a class as a function\")}n(t,\"_classCallCheck\");function r(V,R){for(var I=0;I<R.length;I++){var L=R[I];L.enumerable=L.enumerable||!1,L.configurable=!0,\"value\"in L&&(L.writable=!0),Object.defineProperty(V,L.key,L)}}n(r,\"_defineProperties\");function s(V,R,I){return R&&r(V.prototype,R),I&&r(V,I),V}n(s,\"_createClass\");function o(V,R,I){return R in V?Object.defineProperty(V,R,{value:I,enumerable:!0,configurable:!0,writable:!0}):V[R]=I,V}n(o,\"_defineProperty\");function a(){return a=Object.assign||function(V){for(var R=1;R<arguments.length;R++){var I=arguments[R];for(var L in I)Object.prototype.hasOwnProperty.call(I,L)&&(V[L]=I[L])}return V},a.apply(this,arguments)}n(a,\"_extends\");var l={exports:{}};(function(V){typeof window>\"u\"||function(R){var I=R.HTMLCanvasElement&&R.HTMLCanvasElement.prototype,L=R.Blob&&function(){try{return!!new Blob}catch{return!1}}(),Q=L&&R.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),X=R.BlobBuilder||R.WebKitBlobBuilder||R.MozBlobBuilder||R.MSBlobBuilder,ye=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,pe=(L||X)&&R.atob&&R.ArrayBuffer&&R.Uint8Array&&function(ne){var re,Fe,Ee,Ft,Et,te,Ot,Ge,lr;if(re=ne.match(ye),!re)throw new Error(\"invalid data URI\");for(Fe=re[2]?re[1]:\"text/plain\"+(re[3]||\";charset=US-ASCII\"),Ee=!!re[4],Ft=ne.slice(re[0].length),Ee?Et=atob(Ft):Et=decodeURIComponent(Ft),te=new ArrayBuffer(Et.length),Ot=new Uint8Array(te),Ge=0;Ge<Et.length;Ge+=1)Ot[Ge]=Et.charCodeAt(Ge);return L?new Blob([Q?Ot:te],{type:Fe}):(lr=new X,lr.append(te),lr.getBlob(Fe))};R.HTMLCanvasElement&&!I.toBlob&&(I.mozGetAsFile?I.toBlob=function(ne,re,Fe){var Ee=this;setTimeout(function(){Fe&&I.toDataURL&&pe?ne(pe(Ee.toDataURL(re,Fe))):ne(Ee.mozGetAsFile(\"blob\",re))})}:I.toDataURL&&pe&&(I.msToBlob?I.toBlob=function(ne,re,Fe){var Ee=this;setTimeout(function(){(re&&re!==\"image/png\"||Fe)&&I.toDataURL&&pe?ne(pe(Ee.toDataURL(re,Fe))):ne(Ee.msToBlob(re))})}:I.toBlob=function(ne,re,Fe){var Ee=this;setTimeout(function(){ne(pe(Ee.toDataURL(re,Fe)))})})),V.exports?V.exports=pe:R.dataURLtoBlob=pe}(window)})(l);var h=l.exports,p=n(function(R){return typeof Blob>\"u\"?!1:R instanceof Blob||Object.prototype.toString.call(R)===\"[object Blob]\"},\"isBlob\"),d={strict:!0,checkOrientation:!0,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:\"none\",quality:.8,mimeType:\"auto\",convertTypes:[\"image/png\"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},f=typeof window<\"u\"&&typeof window.document<\"u\",y=f?window:{},b=n(function(R){return R>0&&R<1/0},\"isPositiveNumber\"),S=Array.prototype.slice;function E(V){return Array.from?Array.from(V):S.call(V)}n(E,\"toArray\");var x=/^image\\/.+$/;function F(V){return x.test(V)}n(F,\"isImageType\");function U(V){var R=F(V)?V.substr(6):\"\";return R===\"jpeg\"&&(R=\"jpg\"),\".\".concat(R)}n(U,\"imageTypeToExtension\");var j=String.fromCharCode;function G(V,R,I){var L=\"\",Q;for(I+=R,Q=R;Q<I;Q+=1)L+=j(V.getUint8(Q));return L}n(G,\"getStringFromCharCode\");var J=y.btoa;function B(V,R){for(var I=[],L=8192,Q=new Uint8Array(V);Q.length>0;)I.push(j.apply(null,E(Q.subarray(0,L)))),Q=Q.subarray(L);return\"data:\".concat(R,\";base64,\").concat(J(I.join(\"\")))}n(B,\"arrayBufferToDataURL\");function z(V){var R=new DataView(V),I;try{var L,Q,X;if(R.getUint8(0)===255&&R.getUint8(1)===216)for(var ye=R.byteLength,pe=2;pe+1<ye;){if(R.getUint8(pe)===255&&R.getUint8(pe+1)===225){Q=pe;break}pe+=1}if(Q){var ne=Q+4,re=Q+10;if(G(R,ne,4)===\"Exif\"){var Fe=R.getUint16(re);if(L=Fe===18761,(L||Fe===19789)&&R.getUint16(re+2,L)===42){var Ee=R.getUint32(re+4,L);Ee>=8&&(X=re+Ee)}}}if(X){var Ft=R.getUint16(X,L),Et,te;for(te=0;te<Ft;te+=1)if(Et=X+te*12+2,R.getUint16(Et,L)===274){Et+=8,I=R.getUint16(Et,L),R.setUint16(Et,1,L);break}}}catch{I=1}return I}n(z,\"resetAndGetOrientation\");function K(V){var R=0,I=1,L=1;switch(V){case 2:I=-1;break;case 3:R=-180;break;case 4:L=-1;break;case 5:R=90,L=-1;break;case 6:R=90;break;case 7:R=90,I=-1;break;case 8:R=-90;break}return{rotate:R,scaleX:I,scaleY:L}}n(K,\"parseOrientation\");var oe=/\\.\\d*(?:0|9){12}\\d*$/;function Be(V){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return oe.test(V)?Math.round(V*R)/R:V}n(Be,\"normalizeDecimalNumber\");function Je(V){var R=V.aspectRatio,I=V.height,L=V.width,Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:\"none\",X=b(L),ye=b(I);if(X&&ye){var pe=I*R;(Q===\"contain\"||Q===\"none\")&&pe>L||Q===\"cover\"&&pe<L?I=L/R:L=I*R}else X?I=L/R:ye&&(L=I*R);return{width:L,height:I}}n(Je,\"getAdjustedSizes\");var wt=y.ArrayBuffer,We=y.FileReader,_e=y.URL||y.webkitURL,ze=/\\.\\w+$/,xe=y.Compressor,ui=function(){function V(R,I){t(this,V),this.file=R,this.image=new Image,this.options=e(e({},d),I),this.aborted=!1,this.result=null,this.init()}return n(V,\"Compressor\"),s(V,[{key:\"init\",value:n(function(){var I=this,L=this.file,Q=this.options;if(!p(L)){this.fail(new Error(\"The first argument must be a File or Blob object.\"));return}var X=L.type;if(!F(X)){this.fail(new Error(\"The first argument must be an image File or Blob object.\"));return}if(!_e||!We){this.fail(new Error(\"The current browser does not support image compression.\"));return}if(wt||(Q.checkOrientation=!1),_e&&!Q.checkOrientation)this.load({url:_e.createObjectURL(L)});else{var ye=new We,pe=Q.checkOrientation&&X===\"image/jpeg\";this.reader=ye,ye.onload=function(ne){var re=ne.target,Fe=re.result,Ee={};if(pe){var Ft=z(Fe);Ft>1||!_e?(Ee.url=B(Fe,X),Ft>1&&a(Ee,K(Ft))):Ee.url=_e.createObjectURL(L)}else Ee.url=Fe;I.load(Ee)},ye.onabort=function(){I.fail(new Error(\"Aborted to read the image with FileReader.\"))},ye.onerror=function(){I.fail(new Error(\"Failed to read the image with FileReader.\"))},ye.onloadend=function(){I.reader=null},pe?ye.readAsArrayBuffer(L):ye.readAsDataURL(L)}},\"init\")},{key:\"load\",value:n(function(I){var L=this,Q=this.file,X=this.image;X.onload=function(){L.draw(e(e({},I),{},{naturalWidth:X.naturalWidth,naturalHeight:X.naturalHeight}))},X.onabort=function(){L.fail(new Error(\"Aborted to load the image.\"))},X.onerror=function(){L.fail(new Error(\"Failed to load the image.\"))},y.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(y.navigator.userAgent)&&(X.crossOrigin=\"anonymous\"),X.alt=Q.name,X.src=I.url},\"load\")},{key:\"draw\",value:n(function(I){var L=this,Q=I.naturalWidth,X=I.naturalHeight,ye=I.rotate,pe=ye===void 0?0:ye,ne=I.scaleX,re=ne===void 0?1:ne,Fe=I.scaleY,Ee=Fe===void 0?1:Fe,Ft=this.file,Et=this.image,te=this.options,Ot=document.createElement(\"canvas\"),Ge=Ot.getContext(\"2d\"),lr=Math.abs(pe)%180===90,So=(te.resize===\"contain\"||te.resize===\"cover\")&&b(te.width)&&b(te.height),Hr=Math.max(te.maxWidth,0)||1/0,$r=Math.max(te.maxHeight,0)||1/0,qr=Math.max(te.minWidth,0)||0,ur=Math.max(te.minHeight,0)||0,hr=Q/X,nt=te.width,at=te.height;if(lr){var wl=[$r,Hr];Hr=wl[0],$r=wl[1];var Sl=[ur,qr];qr=Sl[0],ur=Sl[1];var nn=[at,nt];nt=nn[0],at=nn[1]}So&&(hr=nt/at);var Pl=Je({aspectRatio:hr,width:Hr,height:$r},\"contain\");Hr=Pl.width,$r=Pl.height;var _l=Je({aspectRatio:hr,width:qr,height:ur},\"cover\");if(qr=_l.width,ur=_l.height,So){var ie=Je({aspectRatio:hr,width:nt,height:at},te.resize);nt=ie.width,at=ie.height}else{var an=Je({aspectRatio:hr,width:nt,height:at}),Po=an.width;nt=Po===void 0?Q:Po;var Ni=an.height;at=Ni===void 0?X:Ni}nt=Math.floor(Be(Math.min(Math.max(nt,qr),Hr))),at=Math.floor(Be(Math.min(Math.max(at,ur),$r)));var hh=-nt/2,Vr=-at/2,St=nt,dh=at,_o=[];if(So){var Re=0,Se=0,ln=Q,Mi=X,xl=Je({aspectRatio:hr,width:Q,height:X},{contain:\"cover\",cover:\"contain\"}[te.resize]);ln=xl.width,Mi=xl.height,Re=(Q-ln)/2,Se=(X-Mi)/2,_o.push(Re,Se,ln,Mi)}if(_o.push(hh,Vr,St,dh),lr){var vi=[at,nt];nt=vi[0],at=vi[1]}Ot.width=nt,Ot.height=at,F(te.mimeType)||(te.mimeType=Ft.type);var Fl=\"transparent\";if(Ft.size>te.convertSize&&te.convertTypes.indexOf(te.mimeType)>=0&&(te.mimeType=\"image/jpeg\"),te.mimeType===\"image/jpeg\"&&(Fl=\"#fff\"),Ge.fillStyle=Fl,Ge.fillRect(0,0,nt,at),te.beforeDraw&&te.beforeDraw.call(this,Ge,Ot),!this.aborted&&(Ge.save(),Ge.translate(nt/2,at/2),Ge.rotate(pe*Math.PI/180),Ge.scale(re,Ee),Ge.drawImage.apply(Ge,[Et].concat(_o)),Ge.restore(),te.drew&&te.drew.call(this,Ge,Ot),!this.aborted)){var je=n(function(Wr){L.aborted||L.done({naturalWidth:Q,naturalHeight:X,result:Wr})},\"done\");Ot.toBlob?Ot.toBlob(je,te.mimeType,te.quality):je(h(Ot.toDataURL(te.mimeType,te.quality)))}},\"draw\")},{key:\"done\",value:n(function(I){var L=I.naturalWidth,Q=I.naturalHeight,X=I.result,ye=this.file,pe=this.image,ne=this.options;if(_e&&!ne.checkOrientation&&_e.revokeObjectURL(pe.src),X)if(ne.strict&&X.size>ye.size&&ne.mimeType===ye.type&&!(ne.width>L||ne.height>Q||ne.minWidth>L||ne.minHeight>Q||ne.maxWidth<L||ne.maxHeight<Q))X=ye;else{var re=new Date;X.lastModified=re.getTime(),X.lastModifiedDate=re,X.name=ye.name,X.name&&X.type!==ye.type&&(X.name=X.name.replace(ze,U(X.type)))}else X=ye;this.result=X,ne.success&&ne.success.call(this,X)},\"done\")},{key:\"fail\",value:n(function(I){var L=this.options;if(L.error)L.error.call(this,I);else throw I},\"fail\")},{key:\"abort\",value:n(function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error(\"The compression process has been aborted.\")):(this.image.onload=null,this.image.onabort()))},\"abort\")}],[{key:\"noConflict\",value:n(function(){return window.Compressor=xe,V},\"noConflict\")},{key:\"setDefaults\",value:n(function(I){a(d,I)},\"setDefaults\")}]),V}();return ui})});var qp={};Tl(qp,{Audio:()=>ns,AwsS3:()=>no,AwsS3Multipart:()=>Ri,BasePlugin:()=>ve,Box:()=>Xi,Compressor:()=>on,Core:()=>qx,Dashboard:()=>is,DefaultStore:()=>kl,DragDrop:()=>Gi,DropTarget:()=>Ns,Dropbox:()=>Yi,Facebook:()=>Qi,FileInput:()=>rs,Form:()=>go,GoldenRetriever:()=>bo,GoogleDrive:()=>Ji,ImageEditor:()=>ss,Informer:()=>qi,Instagram:()=>Zi,OneDrive:()=>er,ProgressBar:()=>os,ReduxDevTools:()=>wo,ReduxStore:()=>fg,RemoteSources:()=>zs,ScreenCapture:()=>as,StatusBar:()=>$i,ThumbnailGenerator:()=>Cr,Transloadit:()=>yi,Tus:()=>or,UIPlugin:()=>Z,Unsplash:()=>tr,Uppy:()=>Ah,Url:()=>Ti,Webcam:()=>ls,XHRUpload:()=>mo,Zoom:()=>ir,debugLogger:()=>mn,locales:()=>Wx,server:()=>Bh,views:()=>Vx});function Ct(i,e){return Object.prototype.hasOwnProperty.call(i,e)}n(Ct,\"has\");function rf(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(rf,\"_classPrivateFieldLooseBase\");var Vb=0;function Wb(i){return\"__private_\"+Vb+++\"_\"+i}n(Wb,\"_classPrivateFieldLooseKey\");function Gb(i,e,t){let r=[];return i.forEach(s=>typeof s!=\"string\"?r.push(s):e[Symbol.split](s).forEach((o,a,l)=>{o!==\"\"&&r.push(o),a<l.length-1&&r.push(t)})),r}n(Gb,\"insertReplacement\");function sf(i,e){let t=/\\$/g,r=\"$$$$\",s=[i];if(e==null)return s;for(let o of Object.keys(e))if(o!==\"_\"){let a=e[o];typeof a==\"string\"&&(a=t[Symbol.replace](a,r)),s=Gb(s,new RegExp(`%\\\\{${o}\\\\}`,\"g\"),a)}return s}n(sf,\"interpolate\");var dn=Wb(\"apply\"),Xr=class{constructor(e){Object.defineProperty(this,dn,{value:Kb}),this.locale={strings:{},pluralize(t){return t===1?0:1}},Array.isArray(e)?e.forEach(rf(this,dn)[dn],this):rf(this,dn)[dn](e)}translate(e,t){return this.translateArray(e,t).join(\"\")}translateArray(e,t){if(!Ct(this.locale.strings,e))throw new Error(`missing string: ${e}`);let r=this.locale.strings[e];if(typeof r==\"object\"){if(t&&typeof t.smart_count<\"u\"){let o=this.locale.pluralize(t.smart_count);return sf(r[o],t)}throw new Error(\"Attempted to use a string with plural forms, but no value was given for %{smart_count}\")}return sf(r,t)}};n(Xr,\"Translator\");function Kb(i){if(!(i!=null&&i.strings))return;let e=this.locale;this.locale={...e,strings:{...e.strings,...i.strings}},this.locale.pluralize=i.pluralize||e.pluralize}n(Kb,\"_apply2\");var Zf=de(yh(),1);var Xb=\"useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict\";var Pt=n((i=21)=>{let e=\"\",t=i;for(;t--;)e+=Xb[Math.random()*64|0];return e},\"nanoid\");var em=de(Rl(),1);function Ul(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(Ul,\"_classPrivateFieldLooseBase\");var H1=0;function Lf(i){return\"__private_\"+H1+++\"_\"+i}n(Lf,\"_classPrivateFieldLooseKey\");var $1={version:\"3.1.0\"},gs=Lf(\"callbacks\"),Ph=Lf(\"publish\"),pn=class{constructor(){Object.defineProperty(this,Ph,{value:q1}),this.state={},Object.defineProperty(this,gs,{writable:!0,value:new Set})}getState(){return this.state}setState(e){let t={...this.state},r={...this.state,...e};this.state=r,Ul(this,Ph)[Ph](t,r,e)}subscribe(e){return Ul(this,gs)[gs].add(e),()=>{Ul(this,gs)[gs].delete(e)}}};n(pn,\"DefaultStore\");function q1(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];Ul(this,gs)[gs].forEach(r=>{r(...e)})}n(q1,\"_publish2\");pn.VERSION=$1.version;var kl=pn;function Bi(i){let e=i.lastIndexOf(\".\");return e===-1||e===i.length-1?{name:i,extension:void 0}:{name:i.slice(0,e),extension:i.slice(e+1)}}n(Bi,\"getFileNameAndExtension\");var fn={__proto__:null,md:\"text/markdown\",markdown:\"text/markdown\",mp4:\"video/mp4\",mp3:\"audio/mp3\",svg:\"image/svg+xml\",jpg:\"image/jpeg\",png:\"image/png\",webp:\"image/webp\",gif:\"image/gif\",heic:\"image/heic\",heif:\"image/heif\",yaml:\"text/yaml\",yml:\"text/yaml\",csv:\"text/csv\",tsv:\"text/tab-separated-values\",tab:\"text/tab-separated-values\",avi:\"video/x-msvideo\",mks:\"video/x-matroska\",mkv:\"video/x-matroska\",mov:\"video/quicktime\",dicom:\"application/dicom\",doc:\"application/msword\",docm:\"application/vnd.ms-word.document.macroenabled.12\",docx:\"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",dot:\"application/msword\",dotm:\"application/vnd.ms-word.template.macroenabled.12\",dotx:\"application/vnd.openxmlformats-officedocument.wordprocessingml.template\",xla:\"application/vnd.ms-excel\",xlam:\"application/vnd.ms-excel.addin.macroenabled.12\",xlc:\"application/vnd.ms-excel\",xlf:\"application/x-xliff+xml\",xlm:\"application/vnd.ms-excel\",xls:\"application/vnd.ms-excel\",xlsb:\"application/vnd.ms-excel.sheet.binary.macroenabled.12\",xlsm:\"application/vnd.ms-excel.sheet.macroenabled.12\",xlsx:\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",xlt:\"application/vnd.ms-excel\",xltm:\"application/vnd.ms-excel.template.macroenabled.12\",xltx:\"application/vnd.openxmlformats-officedocument.spreadsheetml.template\",xlw:\"application/vnd.ms-excel\",txt:\"text/plain\",text:\"text/plain\",conf:\"text/plain\",log:\"text/plain\",pdf:\"application/pdf\",zip:\"application/zip\",\"7z\":\"application/x-7z-compressed\",rar:\"application/x-rar-compressed\",tar:\"application/x-tar\",gz:\"application/gzip\",dmg:\"application/x-apple-diskimage\"};function ys(i){var e;if(i.type)return i.type;let t=i.name?(e=Bi(i.name).extension)==null?void 0:e.toLowerCase():null;return t&&t in fn?fn[t]:\"application/octet-stream\"}n(ys,\"getFileType\");function V1(i){return i.charCodeAt(0).toString(32)}n(V1,\"encodeCharacter\");function Bf(i){let e=\"\";return i.replace(/[^A-Z0-9]/gi,t=>(e+=`-${V1(t)}`,\"/\"))+e}n(Bf,\"encodeFilename\");function zf(i){let e=\"uppy\";return typeof i.name==\"string\"&&(e+=`-${Bf(i.name.toLowerCase())}`),i.type!==void 0&&(e+=`-${i.type}`),i.meta&&typeof i.meta.relativePath==\"string\"&&(e+=`-${Bf(i.meta.relativePath.toLowerCase())}`),i.data.size!==void 0&&(e+=`-${i.data.size}`),i.data.lastModified!==void 0&&(e+=`-${i.data.lastModified}`),e}n(zf,\"generateFileID\");function W1(i){return!i.isRemote||!i.remote?!1:new Set([\"box\",\"dropbox\",\"drive\",\"facebook\",\"unsplash\"]).has(i.remote.provider)}n(W1,\"hasFileStableId\");function Dl(i){if(W1(i))return i.id;let e=ys(i);return zf({...i,type:e})}n(Dl,\"getSafeFileId\");function _h(i){if(i==null&&typeof navigator<\"u\"&&(i=navigator.userAgent),!i)return!0;let e=/Edge\\/(\\d+\\.\\d+)/.exec(i);if(!e)return!0;let t=e[1],[r,s]=t.split(\".\");return r=parseInt(r,10),s=parseInt(s,10),r<15||r===15&&s<15063||r>18||r===18&&s>=18218}n(_h,\"supportsUploadProgress\");function xh(i,e){return e.name?e.name:i.split(\"/\")[0]===\"image\"?`${i.split(\"/\")[0]}.${i.split(\"/\")[1]}`:\"noname\"}n(xh,\"getFileName\");function Fh(i){return i<10?`0${i}`:i.toString()}n(Fh,\"pad\");function Fo(){let i=new Date,e=Fh(i.getHours()),t=Fh(i.getMinutes()),r=Fh(i.getSeconds());return`${e}:${t}:${r}`}n(Fo,\"getTimeStamp\");var jf={debug:()=>{},warn:()=>{},error:function(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return console.error(`[Uppy] [${Fo()}]`,...e)}},mn={debug:function(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return console.debug(`[Uppy] [${Fo()}]`,...e)},warn:function(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return console.warn(`[Uppy] [${Fo()}]`,...e)},error:function(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return console.error(`[Uppy] [${Fo()}]`,...e)}};var Nl=de(Il(),1),Kf=de(Gf(),1);var Xf={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]},Tt=class extends Error{constructor(e,t){let{isUserFacing:r=!0,file:s}=t===void 0?{}:t;super(e),this.isRestriction=!0,this.isUserFacing=r,s!=null&&(this.file=s)}};n(Tt,\"RestrictionError\");var gn=class{constructor(e,t){this.i18n=t,this.getOpts=()=>{let r=e();if(r.restrictions.allowedFileTypes!=null&&!Array.isArray(r.restrictions.allowedFileTypes))throw new TypeError(\"`restrictions.allowedFileTypes` must be an array\");return r}}validateAggregateRestrictions(e,t){let{maxTotalFileSize:r,maxNumberOfFiles:s}=this.getOpts().restrictions;if(s&&e.filter(a=>!a.isGhost).length+t.length>s)throw new Tt(`${this.i18n(\"youCanOnlyUploadX\",{smart_count:s})}`);if(r){let o=e.reduce((a,l)=>a+l.size,0);for(let a of t)if(a.size!=null&&(o+=a.size,o>r))throw new Tt(this.i18n(\"exceedsSize\",{size:(0,Nl.default)(r),file:a.name}))}}validateSingleFile(e){let{maxFileSize:t,minFileSize:r,allowedFileTypes:s}=this.getOpts().restrictions;if(s&&!s.some(a=>a.includes(\"/\")?e.type?(0,Kf.default)(e.type.replace(/;.*?$/,\"\"),a):!1:a[0]===\".\"&&e.extension?e.extension.toLowerCase()===a.slice(1).toLowerCase():!1)){let a=s.join(\", \");throw new Tt(this.i18n(\"youCanOnlyUploadFileTypes\",{types:a}),{file:e})}if(t&&e.size!=null&&e.size>t)throw new Tt(this.i18n(\"exceedsSize\",{size:(0,Nl.default)(t),file:e.name}),{file:e});if(r&&e.size!=null&&e.size<r)throw new Tt(this.i18n(\"inferiorSize\",{size:(0,Nl.default)(r)}),{file:e})}validate(e,t){t.forEach(r=>{this.validateSingleFile(r)}),this.validateAggregateRestrictions(e,t)}validateMinNumberOfFiles(e){let{minNumberOfFiles:t}=this.getOpts().restrictions;if(Object.keys(e).length<t)throw new Tt(this.i18n(\"youHaveToAtLeastSelectX\",{smart_count:t}))}getMissingRequiredMetaFields(e){let t=new Tt(this.i18n(\"missingRequiredMetaFieldOnFile\",{fileName:e.name})),{requiredMetaFields:r}=this.getOpts().restrictions,s=[];for(let o of r)(!Object.hasOwn(e.meta,o)||e.meta[o]===\"\")&&s.push(o);return{missingFields:s,error:t}}};n(gn,\"Restricter\");var Yf={strings:{addBulkFilesFailed:{0:\"Failed to add %{smart_count} file due to an internal error\",1:\"Failed to add %{smart_count} files due to internal errors\"},youCanOnlyUploadX:{0:\"You can only upload %{smart_count} file\",1:\"You can only upload %{smart_count} files\"},youHaveToAtLeastSelectX:{0:\"You have to select at least %{smart_count} file\",1:\"You have to select at least %{smart_count} files\"},exceedsSize:\"%{file} exceeds maximum allowed size of %{size}\",missingRequiredMetaField:\"Missing required meta fields\",missingRequiredMetaFieldOnFile:\"Missing required meta fields in %{fileName}\",inferiorSize:\"This file is smaller than the allowed size of %{size}\",youCanOnlyUploadFileTypes:\"You can only upload: %{types}\",noMoreFilesAllowed:\"Cannot add more files\",noDuplicates:\"Cannot add the duplicate file '%{fileName}', it already exists\",companionError:\"Connection with Companion failed\",authAborted:\"Authentication aborted\",companionUnauthorizeHint:\"To unauthorize to your %{provider} account, please go to %{url}\",failedToUpload:\"Failed to upload %{file}\",noInternetConnection:\"No Internet connection\",connectedToInternet:\"Connected to the Internet\",noFilesFound:\"You have no files or folders here\",noSearchResults:\"Unfortunately, there are no results for this search\",selectX:{0:\"Select %{smart_count}\",1:\"Select %{smart_count}\"},allFilesFromFolderNamed:\"All files from folder %{name}\",openFolderNamed:\"Open folder %{name}\",cancel:\"Cancel\",logOut:\"Log out\",filter:\"Filter\",resetFilter:\"Reset filter\",loading:\"Loading...\",loadedXFiles:\"Loaded %{numFiles} files\",authenticateWithTitle:\"Please authenticate with %{pluginName} to select files\",authenticateWith:\"Connect to %{pluginName}\",signInWithGoogle:\"Sign in with Google\",searchImages:\"Search for images\",enterTextToSearch:\"Enter text to search for images\",search:\"Search\",resetSearch:\"Reset search\",emptyFolderAdded:\"No files were added from empty folder\",addedNumFiles:\"Added %{numFiles} file(s)\",folderAlreadyAdded:'The folder \"%{folder}\" was already added',folderAdded:{0:\"Added %{smart_count} file from %{folder}\",1:\"Added %{smart_count} files from %{folder}\"},additionalRestrictionsFailed:\"%{count} additional restrictions were not fulfilled\"}};var Qf,Jf;function q(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(q,\"_classPrivateFieldLooseBase\");var X1=0;function Xe(i){return\"__private_\"+X1+++\"_\"+i}n(Xe,\"_classPrivateFieldLooseKey\");var Y1={version:\"3.7.1\"},Ml=n(()=>({totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null}),\"getDefaultUploadState\"),ht=Xe(\"plugins\"),Gt=Xe(\"restricter\"),yn=Xe(\"storeUnsubscribe\"),pr=Xe(\"emitter\"),vs=Xe(\"preProcessors\"),bs=Xe(\"uploaders\"),gr=Xe(\"postProcessors\"),Kt=Xe(\"informAndEmit\"),Pn=Xe(\"checkRequiredMetaFieldsOnFile\"),Eh=Xe(\"checkRequiredMetaFields\"),vn=Xe(\"assertNewUploadAllowed\"),Th=Xe(\"transformFile\"),bn=Xe(\"startIfAutoProceed\"),wn=Xe(\"checkAndUpdateFileState\"),Oh=Xe(\"addListeners\"),Si=Xe(\"updateOnlineStatus\"),fr=Xe(\"createUpload\"),Ch=Xe(\"getUpload\"),ws=Xe(\"removeUpload\"),mr=Xe(\"runUpload\");Qf=Symbol.for(\"uppy test: getPlugins\");Jf=Symbol.for(\"uppy test: createUpload\");var Sn=class{constructor(e){Object.defineProperty(this,mr,{value:lw}),Object.defineProperty(this,ws,{value:aw}),Object.defineProperty(this,Ch,{value:nw}),Object.defineProperty(this,fr,{value:ow}),Object.defineProperty(this,Oh,{value:sw}),Object.defineProperty(this,wn,{value:rw}),Object.defineProperty(this,bn,{value:iw}),Object.defineProperty(this,Th,{value:tw}),Object.defineProperty(this,vn,{value:ew}),Object.defineProperty(this,Eh,{value:Z1}),Object.defineProperty(this,Pn,{value:J1}),Object.defineProperty(this,Kt,{value:Q1}),Object.defineProperty(this,ht,{writable:!0,value:Object.create(null)}),Object.defineProperty(this,Gt,{writable:!0,value:void 0}),Object.defineProperty(this,yn,{writable:!0,value:void 0}),Object.defineProperty(this,pr,{writable:!0,value:(0,Zf.default)()}),Object.defineProperty(this,vs,{writable:!0,value:new Set}),Object.defineProperty(this,bs,{writable:!0,value:new Set}),Object.defineProperty(this,gr,{writable:!0,value:new Set}),this.calculateProgress=(0,em.default)((r,s)=>{let o=this.getFile(r?.id);if(r==null||!o){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}if(o.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${r.id}`);return}let a=Number.isFinite(s.bytesTotal)&&s.bytesTotal>0;this.setFileState(r.id,{progress:{...o.progress,bytesUploaded:s.bytesUploaded,bytesTotal:s.bytesTotal,percentage:a?Math.round(s.bytesUploaded/s.bytesTotal*100):0}}),this.calculateTotalProgress()},500,{leading:!0,trailing:!0}),Object.defineProperty(this,Si,{writable:!0,value:this.updateOnlineStatus.bind(this)}),this.defaultLocale=Yf;let t={id:\"uppy\",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:Xf,meta:{},onBeforeFileAdded:(r,s)=>!Object.hasOwn(s,r.id),onBeforeUpload:r=>r,store:new kl,logger:jf,infoTimeout:5e3};this.opts={...t,...e,restrictions:{...t.restrictions,...e&&e.restrictions}},e&&e.logger&&e.debug?this.log(\"You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.\",\"warning\"):e&&e.debug&&(this.opts.logger=mn),this.log(`Using Core v${this.constructor.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({...Ml(),plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:_h(),individualCancellation:!0,resumableUploads:!1},meta:{...this.opts.meta},info:[]}),q(this,Gt)[Gt]=new gn(()=>this.opts,this.i18n),q(this,yn)[yn]=this.store.subscribe((r,s,o)=>{this.emit(\"state-update\",r,s,o),this.updateAll(s)}),this.opts.debug&&typeof window<\"u\"&&(window[this.opts.id]=this),q(this,Oh)[Oh]()}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];q(this,pr)[pr].emit(e,...r)}on(e,t){return q(this,pr)[pr].on(e,t),this}once(e,t){return q(this,pr)[pr].once(e,t),this}off(e,t){return q(this,pr)[pr].off(e,t),this}updateAll(e){this.iteratePlugins(t=>{t.update(e)})}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){let t=this.getState().files;this.setState({files:{...t,...Object.fromEntries(Object.entries(e).map(r=>{let[s,o]=r;return[s,{...t[s],...o}]}))}})}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Can\\u2019t set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:t})}i18nInit(){let e=new Xr([this.defaultLocale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.locale=e.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e&&e.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(t=>{t.setOptions(e)}),this.setState()}resetProgress(){let e={percentage:0,bytesUploaded:0,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},r={};Object.keys(t).forEach(s=>{r[s]={...t[s],progress:{...t[s].progress,...e}}}),this.setState({files:r,...Ml()}),this.emit(\"reset-progress\")}clearUploadedFiles(){this.setState({...Ml(),files:{}})}addPreProcessor(e){q(this,vs)[vs].add(e)}removePreProcessor(e){return q(this,vs)[vs].delete(e)}addPostProcessor(e){q(this,gr)[gr].add(e)}removePostProcessor(e){return q(this,gr)[gr].delete(e)}addUploader(e){q(this,bs)[bs].add(e)}removeUploader(e){return q(this,bs)[bs].delete(e)}setMeta(e){let t={...this.getState().meta,...e},r={...this.getState().files};Object.keys(r).forEach(s=>{r[s]={...r[s],meta:{...r[s].meta,...e}}}),this.log(\"Adding metadata:\"),this.log(e),this.setState({meta:t,files:r})}setFileMeta(e,t){let r={...this.getState().files};if(!r[e]){this.log(\"Was trying to set metadata for a file that has been removed: \",e);return}let s={...r[e].meta,...t};r[e]={...r[e],meta:s},this.setState({files:r})}getFile(e){return this.getState().files[e]}getFiles(){let{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map(t=>this.getFile(t))}getObjectOfFilesPerState(){let{files:e,totalProgress:t,error:r}=this.getState(),s=Object.values(e),o=s.filter(S=>{let{progress:E}=S;return!E.uploadComplete&&E.uploadStarted}),a=s.filter(S=>!S.progress.uploadStarted),l=s.filter(S=>S.progress.uploadStarted||S.progress.preprocess||S.progress.postprocess),h=s.filter(S=>S.progress.uploadStarted),p=s.filter(S=>S.isPaused),d=s.filter(S=>S.progress.uploadComplete),f=s.filter(S=>S.error),y=o.filter(S=>!S.isPaused),b=s.filter(S=>S.progress.preprocess||S.progress.postprocess);return{newFiles:a,startedFiles:l,uploadStartedFiles:h,pausedFiles:p,completeFiles:d,erroredFiles:f,inProgressFiles:o,inProgressNotPausedFiles:y,processingFiles:b,isUploadStarted:h.length>0,isAllComplete:t===100&&d.length===s.length&&b.length===0,isAllErrored:!!r&&f.length===s.length,isAllPaused:o.length!==0&&p.length===o.length,isUploadInProgress:o.length>0,isSomeGhost:s.some(S=>S.isGhost)}}validateRestrictions(e,t){t===void 0&&(t=this.getFiles());try{q(this,Gt)[Gt].validate(t,[e])}catch(r){return r}return null}checkIfFileAlreadyExists(e){let{files:t}=this.getState();return!!(t[e]&&!t[e].isGhost)}addFile(e){q(this,vn)[vn](e);let{nextFilesState:t,validFilesToAdd:r,errors:s}=q(this,wn)[wn]([e]),o=s.filter(l=>l.isRestriction);if(q(this,Kt)[Kt](o),s.length>0)throw s[0];this.setState({files:t});let[a]=r;return this.emit(\"file-added\",a),this.emit(\"files-added\",r),this.log(`Added file: ${a.name}, ${a.id}, mime type: ${a.type}`),q(this,bn)[bn](),a.id}addFiles(e){q(this,vn)[vn]();let{nextFilesState:t,validFilesToAdd:r,errors:s}=q(this,wn)[wn](e),o=s.filter(l=>l.isRestriction);q(this,Kt)[Kt](o);let a=s.filter(l=>!l.isRestriction);if(a.length>0){let l=`Multiple errors occurred while adding files:\n`;if(a.forEach(h=>{l+=`\n * ${h.message}`}),this.info({message:this.i18n(\"addBulkFilesFailed\",{smart_count:a.length}),details:l},\"error\",this.opts.infoTimeout),typeof AggregateError==\"function\")throw new AggregateError(a,l);{let h=new Error(l);throw h.errors=a,h}}this.setState({files:t}),r.forEach(l=>{this.emit(\"file-added\",l)}),this.emit(\"files-added\",r),r.length>5?this.log(`Added batch of ${r.length} files`):Object.values(r).forEach(l=>{this.log(`Added file: ${l.name}\n id: ${l.id}\n type: ${l.type}`)}),r.length>0&&q(this,bn)[bn]()}removeFiles(e,t){let{files:r,currentUploads:s}=this.getState(),o={...r},a={...s},l=Object.create(null);e.forEach(f=>{r[f]&&(l[f]=r[f],delete o[f])});function h(f){return l[f]===void 0}n(h,\"fileIsNotRemoved\"),Object.keys(a).forEach(f=>{let y=s[f].fileIDs.filter(h);if(y.length===0){delete a[f];return}let{capabilities:b}=this.getState();if(y.length!==s[f].fileIDs.length&&!b.individualCancellation)throw new Error(\"individualCancellation is disabled\");a[f]={...s[f],fileIDs:y}});let p={currentUploads:a,files:o};Object.keys(o).length===0&&(p.allowNewUpload=!0,p.error=null,p.recoveredState=null),this.setState(p),this.calculateTotalProgress();let d=Object.keys(l);d.forEach(f=>{this.emit(\"file-removed\",l[f],t)}),d.length>5?this.log(`Removed ${d.length} files`):this.log(`Removed files: ${d.join(\", \")}`)}removeFile(e,t){t===void 0&&(t=null),this.removeFiles([e],t)}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).uploadComplete)return;let r=!(this.getFile(e).isPaused||!1);return this.setFileState(e,{isPaused:r}),this.emit(\"upload-pause\",e,r),r}pauseAll(){let e={...this.getState().files};Object.keys(e).filter(r=>!e[r].progress.uploadComplete&&e[r].progress.uploadStarted).forEach(r=>{let s={...e[r],isPaused:!0};e[r]=s}),this.setState({files:e}),this.emit(\"pause-all\")}resumeAll(){let e={...this.getState().files};Object.keys(e).filter(r=>!e[r].progress.uploadComplete&&e[r].progress.uploadStarted).forEach(r=>{let s={...e[r],isPaused:!1,error:null};e[r]=s}),this.setState({files:e}),this.emit(\"resume-all\")}retryAll(){let e={...this.getState().files},t=Object.keys(e).filter(s=>e[s].error);if(t.forEach(s=>{let o={...e[s],isPaused:!1,error:null};e[s]=o}),this.setState({files:e,error:null}),this.emit(\"retry-all\",t),t.length===0)return Promise.resolve({successful:[],failed:[]});let r=q(this,fr)[fr](t,{forceAllowNewUpload:!0});return q(this,mr)[mr](r)}cancelAll(e){let{reason:t=\"user\"}=e===void 0?{}:e;if(this.emit(\"cancel-all\",{reason:t}),t===\"user\"){let{files:r}=this.getState(),s=Object.keys(r);s.length&&this.removeFiles(s,\"cancel-all\"),this.setState(Ml())}}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit(\"upload-retry\",e);let t=q(this,fr)[fr]([e],{forceAllowNewUpload:!0});return q(this,mr)[mr](t)}logout(){this.iteratePlugins(e=>{e.provider&&e.provider.logout&&e.provider.logout()})}calculateTotalProgress(){let t=this.getFiles().filter(p=>p.progress.uploadStarted||p.progress.preprocess||p.progress.postprocess);if(t.length===0){this.emit(\"progress\",0),this.setState({totalProgress:0});return}let r=t.filter(p=>p.progress.bytesTotal!=null),s=t.filter(p=>p.progress.bytesTotal==null);if(r.length===0){let p=t.length*100,d=s.reduce((y,b)=>y+b.progress.percentage,0),f=Math.round(d/p*100);this.setState({totalProgress:f});return}let o=r.reduce((p,d)=>p+d.progress.bytesTotal,0),a=o/r.length;o+=a*s.length;let l=0;r.forEach(p=>{l+=p.progress.bytesUploaded}),s.forEach(p=>{l+=a*(p.progress.percentage||0)/100});let h=o===0?0:Math.round(l/o*100);h>100&&(h=100),this.setState({totalProgress:h}),this.emit(\"progress\",h)}updateOnlineStatus(){(typeof window.navigator.onLine<\"u\"?window.navigator.onLine:!0)?(this.emit(\"is-online\"),this.wasOffline&&(this.emit(\"back-online\"),this.info(this.i18n(\"connectedToInternet\"),\"success\",3e3),this.wasOffline=!1)):(this.emit(\"is-offline\"),this.info(this.i18n(\"noInternetConnection\"),\"error\",0),this.wasOffline=!0)}getID(){return this.opts.id}use(e,t){if(typeof e!=\"function\"){let a=`Expected a plugin class, but got ${e===null?\"null\":typeof e}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(a)}let r=new e(this,t),s=r.id;if(!s)throw new Error(\"Your plugin must have an id\");if(!r.type)throw new Error(\"Your plugin must have a type\");let o=this.getPlugin(s);if(o){let a=`Already found a plugin named '${o.id}'. Tried to use: '${s}'.\nUppy plugins must have unique \\`id\\` options. See https://uppy.io/docs/plugins/#id.`;throw new Error(a)}return e.VERSION&&this.log(`Using ${s} v${e.VERSION}`),r.type in q(this,ht)[ht]?q(this,ht)[ht][r.type].push(r):q(this,ht)[ht][r.type]=[r],r.install(),this.emit(\"plugin-added\",r),this}getPlugin(e){for(let t of Object.values(q(this,ht)[ht])){let r=t.find(s=>s.id===e);if(r!=null)return r}}[Qf](e){return q(this,ht)[ht][e]}iteratePlugins(e){Object.values(q(this,ht)[ht]).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit(\"plugin-remove\",e),e.uninstall&&e.uninstall();let t=q(this,ht)[ht][e.type],r=t.findIndex(a=>a.id===e.id);r!==-1&&t.splice(r,1);let o={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(o)}close(e){let{reason:t}=e===void 0?{}:e;this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll({reason:t}),q(this,yn)[yn](),this.iteratePlugins(r=>{this.removePlugin(r)}),typeof window<\"u\"&&window.removeEventListener&&(window.removeEventListener(\"online\",q(this,Si)[Si]),window.removeEventListener(\"offline\",q(this,Si)[Si]))}hideInfo(){let{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit(\"info-hidden\")}info(e,t,r){t===void 0&&(t=\"info\"),r===void 0&&(r=3e3);let s=typeof e==\"object\";this.setState({info:[...this.getState().info,{type:t,message:s?e.message:e,details:s?e.details:null}]}),setTimeout(()=>this.hideInfo(),r),this.emit(\"info-visible\")}log(e,t){let{logger:r}=this.opts;switch(t){case\"error\":r.error(e);break;case\"warning\":r.warn(e);break;default:r.debug(e);break}}restore(e){return this.log(`Core: attempting to restore upload \"${e}\"`),this.getState().currentUploads[e]?q(this,mr)[mr](e):(q(this,ws)[ws](e),Promise.reject(new Error(\"Nonexistent upload\")))}[Jf](){return q(this,fr)[fr](...arguments)}addResultData(e,t){if(!q(this,Ch)[Ch](e)){this.log(`Not setting result for an upload that has been removed: ${e}`);return}let{currentUploads:r}=this.getState(),s={...r[e],result:{...r[e].result,...t}};this.setState({currentUploads:{...r,[e]:s}})}upload(){var e;(e=q(this,ht)[ht].uploader)!=null&&e.length||this.log(\"No uploader type plugins are used\",\"warning\");let{files:t}=this.getState(),r=this.opts.onBeforeUpload(t);return r===!1?Promise.reject(new Error(\"Not starting the upload because onBeforeUpload returned false\")):(r&&typeof r==\"object\"&&(t=r,this.setState({files:t})),Promise.resolve().then(()=>q(this,Gt)[Gt].validateMinNumberOfFiles(t)).catch(s=>{throw q(this,Kt)[Kt]([s]),s}).then(()=>{if(!q(this,Eh)[Eh](t))throw new Tt(this.i18n(\"missingRequiredMetaField\"))}).catch(s=>{throw s}).then(()=>{let{currentUploads:s}=this.getState(),o=Object.values(s).flatMap(h=>h.fileIDs),a=[];Object.keys(t).forEach(h=>{let p=this.getFile(h);!p.progress.uploadStarted&&o.indexOf(h)===-1&&a.push(p.id)});let l=q(this,fr)[fr](a);return q(this,mr)[mr](l)}).catch(s=>{throw this.emit(\"error\",s),this.log(s,\"error\"),s}))}};n(Sn,\"Uppy\");function Q1(i){for(let o of i){let{file:a,isRestriction:l}=o;l?this.emit(\"restriction-failed\",a,o):this.emit(\"error\",o),this.log(o,\"warning\")}let e=i.filter(o=>o.isUserFacing),t=4,r=e.slice(0,t),s=e.slice(t);r.forEach(o=>{let{message:a,details:l=\"\"}=o;this.info({message:a,details:l},\"error\",this.opts.infoTimeout)}),s.length>0&&this.info({message:this.i18n(\"additionalRestrictionsFailed\",{count:s.length})})}n(Q1,\"_informAndEmit2\");function J1(i){let{missingFields:e,error:t}=q(this,Gt)[Gt].getMissingRequiredMetaFields(i);return e.length>0?(this.setFileState(i.id,{missingRequiredMetaFields:e}),this.log(t.message),this.emit(\"restriction-failed\",i,t),!1):!0}n(J1,\"_checkRequiredMetaFieldsOnFile2\");function Z1(i){let e=!0;for(let t of Object.values(i))q(this,Pn)[Pn](t)||(e=!1);return e}n(Z1,\"_checkRequiredMetaFields2\");function ew(i){let{allowNewUpload:e}=this.getState();if(e===!1){let t=new Tt(this.i18n(\"noMoreFilesAllowed\"),{file:i});throw q(this,Kt)[Kt]([t]),t}}n(ew,\"_assertNewUploadAllowed2\");function tw(i){let e=i instanceof File?{name:i.name,type:i.type,size:i.size,data:i}:i,t=ys(e),r=xh(t,e),s=Bi(r).extension,o=!!e.isRemote,a=Dl(e),l=e.meta||{};l.name=r,l.type=t;let h=Number.isFinite(e.data.size)?e.data.size:null;return{source:e.source||\"\",id:a,name:r,extension:s||\"\",meta:{...this.getState().meta,...l},type:t,data:e.data,progress:{percentage:0,bytesUploaded:0,bytesTotal:h,uploadComplete:!1,uploadStarted:null},size:h,isRemote:o,remote:e.remote||\"\",preview:e.preview}}n(tw,\"_transformFile2\");function iw(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(i=>{i.isRestriction||this.log(i.stack||i.message||i)})},4))}n(iw,\"_startIfAutoProceed2\");function rw(i){let{files:e}=this.getState(),t={...e},r=[],s=[];for(let a of i)try{var o;let l=q(this,Th)[Th](a);if((o=e[l.id])!=null&&o.isGhost){let{isGhost:p,...d}=e[l.id];l={...d,data:a.data},this.log(`Replaced the blob in the restored ghost file: ${l.name}, ${l.id}`)}let h=this.opts.onBeforeFileAdded(l,t);if(!h&&this.checkIfFileAlreadyExists(l.id))throw new Tt(this.i18n(\"noDuplicates\",{fileName:l.name}),{file:a});if(h===!1)throw new Tt(\"Cannot add the file because onBeforeFileAdded returned false.\",{isUserFacing:!1,file:a});typeof h==\"object\"&&h!==null&&(l=h),q(this,Gt)[Gt].validateSingleFile(l),t[l.id]=l,r.push(l)}catch(l){s.push(l)}try{q(this,Gt)[Gt].validateAggregateRestrictions(Object.values(e),r)}catch(a){return s.push(a),{nextFilesState:e,validFilesToAdd:[],errors:s}}return{nextFilesState:t,validFilesToAdd:r,errors:s}}n(rw,\"_checkAndUpdateFileState2\");function sw(){let i=n((r,s,o)=>{let a=r.message||\"Unknown error\";r.details&&(a+=` ${r.details}`),this.setState({error:a}),s!=null&&s.id in this.getState().files&&this.setFileState(s.id,{error:a,response:o})},\"errorHandler\");this.on(\"error\",i),this.on(\"upload-error\",(r,s,o)=>{if(i(s,r,o),typeof s==\"object\"&&s.message){this.log(s.message,\"error\");let a=new Error(this.i18n(\"failedToUpload\",{file:r?.name}));a.isUserFacing=!0,a.details=s.message,s.details&&(a.details+=` ${s.details}`),q(this,Kt)[Kt]([a])}else q(this,Kt)[Kt]([s])});let e;this.on(\"upload-stalled\",(r,s)=>{let{message:o}=r,a=s.map(l=>l.meta.name).join(\", \");e||(this.info({message:o,details:a},\"warning\",this.opts.infoTimeout),e=setTimeout(()=>{e=null},this.opts.infoTimeout)),this.log(`${o} ${a}`.trim(),\"warning\")}),this.on(\"upload\",()=>{this.setState({error:null})});let t=n(r=>{let s=r.filter(a=>{let l=a!=null&&this.getFile(a.id);return l||this.log(`Not setting progress for a file that has been removed: ${a?.id}`),l}),o=Object.fromEntries(s.map(a=>[a.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,percentage:0,bytesUploaded:0,bytesTotal:a.size}}]));this.patchFilesState(o)},\"onUploadStarted\");this.on(\"upload-start\",r=>{r.forEach(s=>{this.emit(\"upload-started\",s)}),t(r)}),this.on(\"upload-progress\",this.calculateProgress),this.on(\"upload-success\",(r,s)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}let o=this.getFile(r.id).progress;this.setFileState(r.id,{progress:{...o,postprocess:q(this,gr)[gr].size>0?{mode:\"indeterminate\"}:null,uploadComplete:!0,percentage:100,bytesUploaded:o.bytesTotal},response:s,uploadURL:s.uploadURL,isPaused:!1}),r.size==null&&this.setFileState(r.id,{size:s.bytesUploaded||o.bytesTotal}),this.calculateTotalProgress()}),this.on(\"preprocess-progress\",(r,s)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}this.setFileState(r.id,{progress:{...this.getFile(r.id).progress,preprocess:s}})}),this.on(\"preprocess-complete\",r=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}let s={...this.getState().files};s[r.id]={...s[r.id],progress:{...s[r.id].progress}},delete s[r.id].progress.preprocess,this.setState({files:s})}),this.on(\"postprocess-progress\",(r,s)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}this.setFileState(r.id,{progress:{...this.getState().files[r.id].progress,postprocess:s}})}),this.on(\"postprocess-complete\",r=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}let s={...this.getState().files};s[r.id]={...s[r.id],progress:{...s[r.id].progress}},delete s[r.id].progress.postprocess,this.setState({files:s})}),this.on(\"restored\",()=>{this.calculateTotalProgress()}),this.on(\"dashboard:file-edit-complete\",r=>{r&&q(this,Pn)[Pn](r)}),typeof window<\"u\"&&window.addEventListener&&(window.addEventListener(\"online\",q(this,Si)[Si]),window.addEventListener(\"offline\",q(this,Si)[Si]),setTimeout(q(this,Si)[Si],3e3))}n(sw,\"_addListeners2\");function ow(i,e){e===void 0&&(e={});let{forceAllowNewUpload:t=!1}=e,{allowNewUpload:r,currentUploads:s}=this.getState();if(!r&&!t)throw new Error(\"Cannot create a new upload: already uploading.\");let o=Pt();return this.emit(\"upload\",{id:o,fileIDs:i}),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:{...s,[o]:{fileIDs:i,step:0,result:{}}}}),o}n(ow,\"_createUpload2\");function nw(i){let{currentUploads:e}=this.getState();return e[i]}n(nw,\"_getUpload2\");function aw(i){let e={...this.getState().currentUploads};delete e[i],this.setState({currentUploads:e})}n(aw,\"_removeUpload2\");async function lw(i){let e=n(()=>{let{currentUploads:o}=this.getState();return o[i]},\"getCurrentUpload\"),t=e(),r=[...q(this,vs)[vs],...q(this,bs)[bs],...q(this,gr)[gr]];try{for(let o=t.step||0;o<r.length&&t;o++){let a=r[o];this.setState({currentUploads:{...this.getState().currentUploads,[i]:{...t,step:o}}});let{fileIDs:l}=t;await a(l,i),t=e()}}catch(o){throw q(this,ws)[ws](i),o}if(t){t.fileIDs.forEach(h=>{let p=this.getFile(h);p&&p.progress.postprocess&&this.emit(\"postprocess-complete\",p)});let o=t.fileIDs.map(h=>this.getFile(h)),a=o.filter(h=>!h.error),l=o.filter(h=>h.error);await this.addResultData(i,{successful:a,failed:l,uploadID:i}),t=e()}let s;return t&&(s=t.result,this.emit(\"complete\",s),q(this,ws)[ws](i)),s==null&&this.log(`Not setting result for an upload that has been removed: ${i}`),s}n(lw,\"_runUpload2\");Sn.VERSION=Y1.version;var Ah=Sn;var Fn,ee,nm,uw,_n,tm,hw,Ll={},am=[],dw=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function yr(i,e){for(var t in e)i[t]=e[t];return i}n(yr,\"s\");function lm(i){var e=i.parentNode;e&&e.removeChild(i)}n(lm,\"a\");function u(i,e,t){var r,s,o,a={};for(o in e)o==\"key\"?r=e[o]:o==\"ref\"?s=e[o]:a[o]=e[o];if(arguments.length>2&&(a.children=arguments.length>3?Fn.call(arguments,2):t),typeof i==\"function\"&&i.defaultProps!=null)for(o in i.defaultProps)a[o]===void 0&&(a[o]=i.defaultProps[o]);return xn(i,a,r,s,null)}n(u,\"h\");function xn(i,e,t,r,s){var o={type:i,props:e,key:t,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s??++nm};return s==null&&ee.vnode!=null&&ee.vnode(o),o}n(xn,\"v\");function um(){return{current:null}}n(um,\"y\");function Ht(i){return i.children}n(Ht,\"p\");function we(i,e){this.props=i,this.context=e}n(we,\"d\");function Eo(i,e){if(e==null)return i.__?Eo(i.__,i.__.__k.indexOf(i)+1):null;for(var t;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null)return t.__e;return typeof i.type==\"function\"?Eo(i):null}n(Eo,\"_\");function hm(i){var e,t;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,e=0;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null){i.__e=i.__c.base=t.__e;break}return hm(i)}}n(hm,\"k\");function im(i){(!i.__d&&(i.__d=!0)&&_n.push(i)&&!Bl.__r++||tm!==ee.debounceRendering)&&((tm=ee.debounceRendering)||setTimeout)(Bl)}n(im,\"b\");function Bl(){for(var i;Bl.__r=_n.length;)i=_n.sort(function(e,t){return e.__v.__b-t.__v.__b}),_n=[],i.some(function(e){var t,r,s,o,a,l;e.__d&&(a=(o=(t=e).__v).__e,(l=t.__P)&&(r=[],(s=yr({},o)).__v=o.__v+1,Rh(l,o,s,t.__n,l.ownerSVGElement!==void 0,o.__h!=null?[a]:null,r,a??Eo(o),o.__h),fm(r,o),o.__e!=a&&hm(o)))})}n(Bl,\"g\");function dm(i,e,t,r,s,o,a,l,h,p){var d,f,y,b,S,E,x,F=r&&r.__k||am,U=F.length;for(t.__k=[],d=0;d<e.length;d++)if((b=t.__k[d]=(b=e[d])==null||typeof b==\"boolean\"?null:typeof b==\"string\"||typeof b==\"number\"||typeof b==\"bigint\"?xn(null,b,null,null,b):Array.isArray(b)?xn(Ht,{children:b},null,null,null):b.__b>0?xn(b.type,b.props,b.key,null,b.__v):b)!=null){if(b.__=t,b.__b=t.__b+1,(y=F[d])===null||y&&b.key==y.key&&b.type===y.type)F[d]=void 0;else for(f=0;f<U;f++){if((y=F[f])&&b.key==y.key&&b.type===y.type){F[f]=void 0;break}y=null}Rh(i,b,y=y||Ll,s,o,a,l,h,p),S=b.__e,(f=b.ref)&&y.ref!=f&&(x||(x=[]),y.ref&&x.push(y.ref,null,b),x.push(f,b.__c||S,b)),S!=null?(E==null&&(E=S),typeof b.type==\"function\"&&b.__k===y.__k?b.__d=h=cm(b,h,i):h=pm(i,b,y,F,S,h),typeof t.type==\"function\"&&(t.__d=h)):h&&y.__e==h&&h.parentNode!=i&&(h=Eo(y))}for(t.__e=E,d=U;d--;)F[d]!=null&&(typeof t.type==\"function\"&&F[d].__e!=null&&F[d].__e==t.__d&&(t.__d=Eo(r,d+1)),gm(F[d],F[d]));if(x)for(d=0;d<x.length;d++)mm(x[d],x[++d],x[++d])}n(dm,\"w\");function cm(i,e,t){for(var r,s=i.__k,o=0;s&&o<s.length;o++)(r=s[o])&&(r.__=i,e=typeof r.type==\"function\"?cm(r,e,t):pm(t,r,r,s,r.__e,e));return e}n(cm,\"m\");function ci(i,e){return e=e||[],i==null||typeof i==\"boolean\"||(Array.isArray(i)?i.some(function(t){ci(t,e)}):e.push(i)),e}n(ci,\"x\");function pm(i,e,t,r,s,o){var a,l,h;if(e.__d!==void 0)a=e.__d,e.__d=void 0;else if(t==null||s!=o||s.parentNode==null)e:if(o==null||o.parentNode!==i)i.appendChild(s),a=null;else{for(l=o,h=0;(l=l.nextSibling)&&h<r.length;h+=2)if(l==s)break e;i.insertBefore(s,o),a=o}return a!==void 0?a:s.nextSibling}n(pm,\"A\");function cw(i,e,t,r,s){var o;for(o in t)o===\"children\"||o===\"key\"||o in e||zl(i,o,null,t[o],r);for(o in e)s&&typeof e[o]!=\"function\"||o===\"children\"||o===\"key\"||o===\"value\"||o===\"checked\"||t[o]===e[o]||zl(i,o,e[o],t[o],r)}n(cw,\"C\");function rm(i,e,t){e[0]===\"-\"?i.setProperty(e,t):i[e]=t==null?\"\":typeof t!=\"number\"||dw.test(e)?t:t+\"px\"}n(rm,\"$\");function zl(i,e,t,r,s){var o;e:if(e===\"style\")if(typeof t==\"string\")i.style.cssText=t;else{if(typeof r==\"string\"&&(i.style.cssText=r=\"\"),r)for(e in r)t&&e in t||rm(i.style,e,\"\");if(t)for(e in t)r&&t[e]===r[e]||rm(i.style,e,t[e])}else if(e[0]===\"o\"&&e[1]===\"n\")o=e!==(e=e.replace(/Capture$/,\"\")),e=e.toLowerCase()in i?e.toLowerCase().slice(2):e.slice(2),i.l||(i.l={}),i.l[e+o]=t,t?r||i.addEventListener(e,o?om:sm,o):i.removeEventListener(e,o?om:sm,o);else if(e!==\"dangerouslySetInnerHTML\"){if(s)e=e.replace(/xlink(H|:h)/,\"h\").replace(/sName$/,\"s\");else if(e!==\"href\"&&e!==\"list\"&&e!==\"form\"&&e!==\"tabIndex\"&&e!==\"download\"&&e in i)try{i[e]=t??\"\";break e}catch{}typeof t==\"function\"||(t!=null&&(t!==!1||e[0]===\"a\"&&e[1]===\"r\")?i.setAttribute(e,t):i.removeAttribute(e))}}n(zl,\"H\");function sm(i){this.l[i.type+!1](ee.event?ee.event(i):i)}n(sm,\"I\");function om(i){this.l[i.type+!0](ee.event?ee.event(i):i)}n(om,\"T\");function Rh(i,e,t,r,s,o,a,l,h){var p,d,f,y,b,S,E,x,F,U,j,G,J,B=e.type;if(e.constructor!==void 0)return null;t.__h!=null&&(h=t.__h,l=e.__e=t.__e,e.__h=null,o=[l]),(p=ee.__b)&&p(e);try{e:if(typeof B==\"function\"){if(x=e.props,F=(p=B.contextType)&&r[p.__c],U=p?F?F.props.value:p.__:r,t.__c?E=(d=e.__c=t.__c).__=d.__E:(\"prototype\"in B&&B.prototype.render?e.__c=d=new B(x,U):(e.__c=d=new we(x,U),d.constructor=B,d.render=fw),F&&F.sub(d),d.props=x,d.state||(d.state={}),d.context=U,d.__n=r,f=d.__d=!0,d.__h=[]),d.__s==null&&(d.__s=d.state),B.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=yr({},d.__s)),yr(d.__s,B.getDerivedStateFromProps(x,d.__s))),y=d.props,b=d.state,f)B.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(B.getDerivedStateFromProps==null&&x!==y&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(x,U),!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(x,d.__s,U)===!1||e.__v===t.__v){d.props=x,d.state=d.__s,e.__v!==t.__v&&(d.__d=!1),d.__v=e,e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(z){z&&(z.__=e)}),d.__h.length&&a.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate(x,d.__s,U),d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(y,b,S)})}if(d.context=U,d.props=x,d.__v=e,d.__P=i,j=ee.__r,G=0,\"prototype\"in B&&B.prototype.render)d.state=d.__s,d.__d=!1,j&&j(e),p=d.render(d.props,d.state,d.context);else do d.__d=!1,j&&j(e),p=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++G<25);d.state=d.__s,d.getChildContext!=null&&(r=yr(yr({},r),d.getChildContext())),f||d.getSnapshotBeforeUpdate==null||(S=d.getSnapshotBeforeUpdate(y,b)),J=p!=null&&p.type===Ht&&p.key==null?p.props.children:p,dm(i,Array.isArray(J)?J:[J],e,t,r,s,o,a,l,h),d.base=e.__e,e.__h=null,d.__h.length&&a.push(d),E&&(d.__E=d.__=null),d.__e=!1}else o==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=pw(t.__e,e,t,r,s,o,a,h);(p=ee.diffed)&&p(e)}catch(z){e.__v=null,(h||o!=null)&&(e.__e=l,e.__h=!!h,o[o.indexOf(l)]=null),ee.__e(z,e,t)}}n(Rh,\"j\");function fm(i,e){ee.__c&&ee.__c(e,i),i.some(function(t){try{i=t.__h,t.__h=[],i.some(function(r){r.call(t)})}catch(r){ee.__e(r,t.__v)}})}n(fm,\"z\");function pw(i,e,t,r,s,o,a,l){var h,p,d,f=t.props,y=e.props,b=e.type,S=0;if(b===\"svg\"&&(s=!0),o!=null){for(;S<o.length;S++)if((h=o[S])&&\"setAttribute\"in h==!!b&&(b?h.localName===b:h.nodeType===3)){i=h,o[S]=null;break}}if(i==null){if(b===null)return document.createTextNode(y);i=s?document.createElementNS(\"http://www.w3.org/2000/svg\",b):document.createElement(b,y.is&&y),o=null,l=!1}if(b===null)f===y||l&&i.data===y||(i.data=y);else{if(o=o&&Fn.call(i.childNodes),p=(f=t.props||Ll).dangerouslySetInnerHTML,d=y.dangerouslySetInnerHTML,!l){if(o!=null)for(f={},S=0;S<i.attributes.length;S++)f[i.attributes[S].name]=i.attributes[S].value;(d||p)&&(d&&(p&&d.__html==p.__html||d.__html===i.innerHTML)||(i.innerHTML=d&&d.__html||\"\"))}if(cw(i,y,f,s,l),d)e.__k=[];else if(S=e.props.children,dm(i,Array.isArray(S)?S:[S],e,t,r,s&&b!==\"foreignObject\",o,a,o?o[0]:t.__k&&Eo(t,0),l),o!=null)for(S=o.length;S--;)o[S]!=null&&lm(o[S]);l||(\"value\"in y&&(S=y.value)!==void 0&&(S!==i.value||b===\"progress\"&&!S||b===\"option\"&&S!==f.value)&&zl(i,\"value\",S,f.value,!1),\"checked\"in y&&(S=y.checked)!==void 0&&S!==i.checked&&zl(i,\"checked\",S,f.checked,!1))}return i}n(pw,\"L\");function mm(i,e,t){try{typeof i==\"function\"?i(e):i.current=e}catch(r){ee.__e(r,t)}}n(mm,\"M\");function gm(i,e,t){var r,s;if(ee.unmount&&ee.unmount(i),(r=i.ref)&&(r.current&&r.current!==i.__e||mm(r,null,e)),(r=i.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){ee.__e(o,e)}r.base=r.__P=null}if(r=i.__k)for(s=0;s<r.length;s++)r[s]&&gm(r[s],e,typeof i.type!=\"function\");t||i.__e==null||lm(i.__e),i.__e=i.__d=void 0}n(gm,\"N\");function fw(i,e,t){return this.constructor(i,t)}n(fw,\"O\");function Uh(i,e,t){var r,s,o;ee.__&&ee.__(i,e),s=(r=typeof t==\"function\")?null:t&&t.__k||e.__k,o=[],Rh(e,i=(!r&&t||e).__k=u(Ht,null,[i]),s||Ll,Ll,e.ownerSVGElement!==void 0,!r&&t?[t]:s?null:e.firstChild?Fn.call(e.childNodes):null,o,!r&&t?t:s?s.__e:e.firstChild,r),fm(o,i)}n(Uh,\"P\");function jl(i,e,t){var r,s,o,a=yr({},i.props);for(o in e)o==\"key\"?r=e[o]:o==\"ref\"?s=e[o]:a[o]=e[o];return arguments.length>2&&(a.children=arguments.length>3?Fn.call(arguments,2):t),xn(i.type,a,r||i.key,s||i.ref,null)}n(jl,\"q\");Fn=am.slice,ee={__e:function(i,e,t,r){for(var s,o,a;e=e.__;)if((s=e.__c)&&!s.__)try{if((o=s.constructor)&&o.getDerivedStateFromError!=null&&(s.setState(o.getDerivedStateFromError(i)),a=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(i,r||{}),a=s.__d),a)return s.__E=s}catch(l){i=l}throw i}},nm=0,uw=n(function(i){return i!=null&&i.constructor===void 0},\"i\"),we.prototype.setState=function(i,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=yr({},this.state),typeof i==\"function\"&&(i=i(yr({},t),this.props)),i&&yr(t,i),i!=null&&this.__v&&(e&&this.__h.push(e),im(this))},we.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),im(this))},we.prototype.render=Ht,_n=[],Bl.__r=0,hw=0;function En(i){return typeof i!=\"object\"||i===null||!(\"nodeType\"in i)?!1:i.nodeType===Node.ELEMENT_NODE}n(En,\"isDOMElement\");function On(i,e){return e===void 0&&(e=document),typeof i==\"string\"?e.querySelector(i):En(i)?i:null}n(On,\"findDOMElement\");function mw(i){for(var e;i&&!i.dir;)i=i.parentNode;return(e=i)==null?void 0:e.dir}n(mw,\"getTextDirection\");var Hl=mw;var ve=class{constructor(e,t){t===void 0&&(t={}),this.uppy=e,this.opts=t}getPluginState(){let{plugins:e}=this.uppy.getState();return e[this.id]||{}}setPluginState(e){let{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(),this.i18nInit()}i18nInit(){let e=new Xr([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState()}addTarget(){throw new Error(\"Extend the addTarget method to add your plugin to another plugin's target\")}install(){}uninstall(){}render(){throw new Error(\"Extend the render method to add your plugin to a DOM element\")}update(){}afterUpdate(){}};n(ve,\"BasePlugin\");function ym(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(ym,\"_classPrivateFieldLooseBase\");var gw=0;function yw(i){return\"__private_\"+gw+++\"_\"+i}n(yw,\"_classPrivateFieldLooseKey\");function vw(i){let e=null,t=null;return function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return t=s,e||(e=Promise.resolve().then(()=>(e=null,i(...t)))),e}}n(vw,\"debounce\");var Cn=yw(\"updateUI\"),Oo=class extends ve{constructor(){super(...arguments),Object.defineProperty(this,Cn,{writable:!0,value:void 0})}getTargetPlugin(e){let t;if(typeof e==\"object\"&&e instanceof Oo)t=e;else if(typeof e==\"function\"){let r=e;this.uppy.iteratePlugins(s=>{s instanceof r&&(t=s)})}return t}mount(e,t){let r=t.id,s=On(e);if(s){this.isTargetDOMEl=!0;let l=document.createElement(\"div\");return l.classList.add(\"uppy-Root\"),ym(this,Cn)[Cn]=vw(h=>{this.uppy.getPlugin(this.id)&&(Uh(this.render(h),l),this.afterUpdate())}),this.uppy.log(`Installing ${r} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(s.innerHTML=\"\"),Uh(this.render(this.uppy.getState()),l),this.el=l,s.appendChild(l),l.dir=this.opts.direction||Hl(l)||\"ltr\",this.onMount(),this.el}let o=this.getTargetPlugin(e);if(o)return this.uppy.log(`Installing ${r} to ${o.id}`),this.parent=o,this.el=o.addTarget(t),this.onMount(),this.el;this.uppy.log(`Not installing ${r}`);let a=`Invalid target option given to ${r}.`;throw typeof e==\"function\"?a+=\" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.\":a+=\"If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\\n\\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.\",new Error(a)}update(e){if(this.el!=null){var t,r;(t=(r=ym(this,Cn))[Cn])==null||t.call(r,e)}}unmount(){if(this.isTargetDOMEl){var e;(e=this.el)==null||e.remove()}this.onUnmount()}onMount(){}onUnmount(){}};n(Oo,\"UIPlugin\");var Z=Oo;var Bh={};Tl(Bh,{Provider:()=>be,RequestClient:()=>tt,SearchProvider:()=>Yr,Socket:()=>Co});var xm=de(Pm(),1);var ww=Object.prototype.toString,Sw=n(i=>ww.call(i)===\"[object Error]\",\"isError\"),Pw=new Set([\"Failed to fetch\",\"NetworkError when attempting to fetch resource.\",\"The Internet connection appears to be offline.\",\"Load failed\",\"Network request failed\",\"fetch failed\"]);function kh(i){return i&&Sw(i)&&i.name===\"TypeError\"&&typeof i.message==\"string\"?i.message===\"Load failed\"?i.stack===void 0:Pw.has(i.message):!1}n(kh,\"isNetworkError\");var Ps=class extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name=\"AbortError\",this.message=e}};n(Ps,\"AbortError\");var _m=n((i,e,t)=>{let r=t.retries-(e-1);return i.attemptNumber=e,i.retriesLeft=r,i},\"decorateErrorWithCounts\");async function $l(i,e){return new Promise((t,r)=>{e={onFailedAttempt(){},retries:10,...e};let s=xm.default.operation(e),o=n(()=>{s.stop(),r(e.signal?.reason)},\"abortHandler\");e.signal&&!e.signal.aborted&&e.signal.addEventListener(\"abort\",o,{once:!0});let a=n(()=>{e.signal?.removeEventListener(\"abort\",o),s.stop()},\"cleanUp\");s.attempt(async l=>{try{let h=await i(l);a(),t(h)}catch(h){try{if(!(h instanceof Error))throw new TypeError(`Non-error was thrown: \"${h}\". You should only throw errors.`);if(h instanceof Ps)throw h.originalError;if(h instanceof TypeError&&!kh(h))throw h;if(await e.onFailedAttempt(_m(h,l,e)),!s.retry(h))throw s.mainError()}catch(p){_m(p,l,e),a(),r(p)}}})})}n($l,\"pRetry\");var ql=class extends Error{constructor(e,t){t===void 0&&(t=null),super(\"This looks like a network error, the endpoint might be blocked by an internet provider or a firewall.\"),this.cause=e,this.isNetworkError=!0,this.request=t}};n(ql,\"NetworkError\");var Pi=ql;function _s(){return fetch(...arguments).catch(i=>{throw i.name===\"AbortError\"?i:new Pi(i)})}n(_s,\"fetchWithNetworkError\");var Vl=class extends Error{constructor(e,t){super(e),this.cause=t?.cause,this.cause&&Ct(this.cause,\"isNetworkError\")?this.isNetworkError=this.cause.isNetworkError:this.isNetworkError=!1}};n(Vl,\"ErrorWithCause\");var vr=Vl;var Fm=de(Rl(),1);function _w(i,e,t){let{progress:r,bytesUploaded:s,bytesTotal:o}=e;r&&(i.uppy.log(`Upload progress: ${r}`),i.uppy.emit(\"upload-progress\",t,{uploader:i,bytesUploaded:s,bytesTotal:o}))}n(_w,\"emitSocketProgress\");var Em=(0,Fm.default)(_w,300,{leading:!0,trailing:!0});function Dh(i){var e;let r=(e=/^(?:https?:\\/\\/|\\/\\/)?(?:[^@\\n]+@)?(?:www\\.)?([^\\n]+)/i.exec(i))==null?void 0:e[1];return`${/^http:\\/\\//i.test(i)?\"ws\":\"wss\"}://${r}`}n(Dh,\"getSocketHost\");var Wl=class extends Error{constructor(){super(\"Authorization required\"),this.name=\"AuthError\",this.isAuthError=!0}};n(Wl,\"AuthError\");var Gl=Wl;var Om;function zi(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(zi,\"_classPrivateFieldLooseBase\");var xw=0;function Kl(i){return\"__private_\"+xw+++\"_\"+i}n(Kl,\"_classPrivateFieldLooseKey\");var Fw={version:\"3.6.1\"};function Ew(i){return i.replace(/\\/$/,\"\")}n(Ew,\"stripSlash\");var Cm=10,Ow=5*60*1e3,Cw=401,Rn=class extends Error{constructor(e){let{statusCode:t,message:r}=e;super(r),this.statusCode=void 0,this.statusCode=t}};n(Rn,\"HttpError\");async function Tw(i){if(i.status===Cw)throw new Gl;if(i.ok)return i.json();let e=`Failed request with status: ${i.status}. ${i.statusText}`;try{let t=await i.json();e=t.message?`${e} message: ${t.message}`:e,e=t.requestId?`${e} request-Id: ${t.requestId}`:e}catch{}throw new Rn({statusCode:i.status,message:e})}n(Tw,\"handleJSONResponse\");var Tn=new Map,br=Kl(\"companionHeaders\"),xs=Kl(\"getUrl\"),Ih=Kl(\"requestSocketToken\"),An=Kl(\"awaitRemoteFileUpload\");Om=Symbol.for(\"uppy test: getCompanionHeaders\");var tt=class{constructor(e,t){Object.defineProperty(this,An,{value:Rw}),Object.defineProperty(this,xs,{value:Aw}),Object.defineProperty(this,br,{writable:!0,value:void 0}),Object.defineProperty(this,Ih,{writable:!0,value:async r=>{let{file:s,postBody:o,signal:a}=r;if(s.remote.url==null)throw new Error(\"Cannot connect to an undefined URL\");return(await this.post(s.remote.url,{...s.remote.body,...o},a)).token}}),this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),zi(this,br)[br]=t?.companionHeaders}setCompanionHeaders(e){zi(this,br)[br]=e}[Om](){return zi(this,br)[br]}get hostname(){let{companion:e}=this.uppy.getState(),t=this.opts.companionUrl;return Ew(e&&e[t]?e[t]:t)}async headers(){return{...{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Uppy-Versions\":`@uppy/companion-client=${tt.VERSION}`},...zi(this,br)[br]}}onReceiveResponse(e){let{headers:t}=e,s=this.uppy.getState().companion||{},o=this.opts.companionUrl;t.has(\"i-am\")&&t.get(\"i-am\")!==s[o]&&this.uppy.setState({companion:{...s,[o]:t.get(\"i-am\")}})}async preflight(e){let t=Tn.get(this.hostname);if(t!=null)return t;let r=[\"accept\",\"content-type\",\"uppy-auth-token\"],s=(async()=>{try{let a=(await fetch(zi(this,xs)[xs](e),{method:\"OPTIONS\"})).headers.get(\"access-control-allow-headers\");if(a==null||a===\"*\")return Tn.set(this.hostname,r),r;this.uppy.log(`[CompanionClient] adding allowed preflight headers to companion cache: ${this.hostname} ${a}`);let l=a.split(\",\").map(h=>h.trim().toLowerCase());return Tn.set(this.hostname,l),l}catch(o){return this.uppy.log(`[CompanionClient] unable to make preflight request ${o}`,\"warning\"),Tn.delete(this.hostname),r}})();return Tn.set(this.hostname,s),s}async preflightAndHeaders(e){let[t,r]=await Promise.all([this.preflight(e),this.headers()]);return Object.fromEntries(Object.entries(r).filter(s=>{let[o]=s;return t.includes(o.toLowerCase())?!0:(this.uppy.log(`[CompanionClient] excluding disallowed header ${o}`),!1)}))}async request(e){let{path:t,method:r=\"GET\",data:s,skipPostResponse:o,signal:a}=e;try{let l=await this.preflightAndHeaders(t),h=await _s(zi(this,xs)[xs](t),{method:r,signal:a,headers:l,credentials:this.opts.companionCookiesRule||\"same-origin\",body:s?JSON.stringify(s):null});return o||this.onReceiveResponse(h),await Tw(h)}catch(l){throw l instanceof Gl||l.name===\"AbortError\"?l:new vr(`Could not ${r} ${zi(this,xs)[xs](t)}`,{cause:l})}}async get(e,t){return t===void 0&&(t=void 0),typeof t==\"boolean\"&&(t={skipPostResponse:t}),this.request({...t,path:e})}async post(e,t,r){return r===void 0&&(r=void 0),typeof r==\"boolean\"&&(r={skipPostResponse:r}),this.request({...r,path:e,method:\"POST\",data:t})}async delete(e,t,r){return t===void 0&&(t=void 0),typeof r==\"boolean\"&&(r={skipPostResponse:r}),this.request({...r,path:e,method:\"DELETE\",data:t})}async uploadRemoteFile(e,t,r){var s=this;r===void 0&&(r={});try{let{signal:o,getQueue:a}=r;return await $l(async()=>{var l;let h=(l=this.uppy.getFile(e.id))==null?void 0:l.serverToken;if(h!=null)return this.uppy.log(`Connecting to exiting websocket ${h}`),zi(this,An)[An]({file:e,queue:a(),signal:o});let d=await a().wrapPromiseFunction(async function(){try{return await zi(s,Ih)[Ih](...arguments)}catch(f){if(f instanceof Gl)throw new Ps(f);if(f.cause==null)throw f;let y=f.cause,b=n(()=>[408,409,429,418,423].includes(y.statusCode)||y.statusCode>=500&&y.statusCode<=599&&![501,505].includes(y.statusCode),\"isRetryableHttpError\");throw y instanceof Rn&&!b()?new Ps(y):y}},{priority:-1})({file:e,postBody:t,signal:o}).abortOn(o);if(this.uppy.getFile(e.id))return this.uppy.setFileState(e.id,{serverToken:d}),zi(this,An)[An]({file:this.uppy.getFile(e.id),queue:a(),signal:o})},{retries:Cm,signal:o,onFailedAttempt:l=>this.uppy.log(`Retrying upload due to: ${l.message}`,\"warning\")})}catch(o){if(o.name===\"AbortError\")return;throw this.uppy.emit(\"upload-error\",e,o),o}}};n(tt,\"RequestClient\");function Aw(i){return/^(https?:|)\\/\\//.test(i)?i:`${this.hostname}/${i}`}n(Aw,\"_getUrl2\");async function Rw(i){let{file:e,queue:t,signal:r}=i,s,{capabilities:o}=this.uppy.getState();try{return await new Promise((a,l)=>{let h=e.serverToken,p=Dh(e.remote.companionUrl),d,f,y,{isPaused:b}=e,S=n((z,K)=>{if(d==null||d.readyState!==d.OPEN){var oe;this.uppy.log(`Cannot send \"${z}\" to socket ${e.id} because the socket state was ${String((oe=d)==null?void 0:oe.readyState)}`,\"warning\");return}d.send(JSON.stringify({action:z,payload:K??{}}))},\"socketSend\");function E(){o.resumableUploads&&S(b?\"pause\":\"resume\")}n(E,\"sendState\");let x=n(async()=>{f&&f.abort(),f=new AbortController;let z=n(oe=>{var Be;this.uppy.setFileState(e.id,{serverToken:null}),(Be=f)==null||Be.abort==null||Be.abort(),l(oe)},\"onFatalError\");function K(){clearTimeout(y),!b&&(y=setTimeout(()=>z(new Error(\"Timeout waiting for message from Companion socket\")),Ow))}n(K,\"resetActivityTimeout\");try{await t.wrapPromiseFunction(async()=>{await $l(n(async()=>new Promise((Be,Je)=>{d=new WebSocket(`${p}/api/${h}`),K(),d.addEventListener(\"close\",()=>{d=void 0,Je(new Error(\"Socket closed unexpectedly\"))}),d.addEventListener(\"error\",We=>{this.uppy.log(`Companion socket error ${JSON.stringify(We)}, closing socket`,\"warning\"),d.close()}),d.addEventListener(\"open\",()=>{E()}),d.addEventListener(\"message\",We=>{K();try{let{action:ze,payload:xe}=JSON.parse(We.data);switch(ze){case\"progress\":{Em(this,xe,e);break}case\"success\":{var _e;this.uppy.emit(\"upload-success\",e,{uploadURL:xe.url}),(_e=f)==null||_e.abort==null||_e.abort(),a();break}case\"error\":{let{message:ui}=xe.error;throw Object.assign(new Error(ui),{cause:xe.error})}default:this.uppy.log(`Companion socket unknown action ${ze}`,\"warning\")}}catch(ze){z(ze)}});let wt=n(()=>{this.uppy.log(`Closing socket ${e.id}`,\"info\"),clearTimeout(y),d&&d.close(),d=void 0},\"closeSocket\");f.signal.addEventListener(\"abort\",()=>{wt()})}),\"reconnectWebsocket\"),{retries:Cm,signal:f.signal,onFailedAttempt:()=>{f.signal.aborted||this.uppy.log(`Retrying websocket ${e.id}`,\"info\")}})})().abortOn(f.signal)}catch(oe){if(f.signal.aborted)return;z(oe)}},\"createWebsocket\"),F=n(z=>{if(o.resumableUploads)if(b=z,d&&E(),z){var K;(K=f)==null||K.abort==null||K.abort()}else x()},\"pause\"),U=n(z=>{var K;o.individualCancellation&&z.id===e.id&&(S(\"cancel\"),(K=f)==null||K.abort==null||K.abort(),this.uppy.log(`upload ${e.id} was removed`,\"info\"),a())},\"onFileRemove\"),j=n(z=>{var K;let{reason:oe}=z;oe===\"user\"&&S(\"cancel\"),(K=f)==null||K.abort==null||K.abort(),this.uppy.log(`upload ${e.id} was canceled`,\"info\"),a()},\"onCancelAll\"),G=n((z,K)=>{z===e.id&&F(K)},\"onFilePausedChange\"),J=n(()=>F(!0),\"onPauseAll\"),B=n(()=>F(!1),\"onResumeAll\");this.uppy.on(\"file-removed\",U),this.uppy.on(\"cancel-all\",j),this.uppy.on(\"upload-pause\",G),this.uppy.on(\"pause-all\",J),this.uppy.on(\"resume-all\",B),s=n(()=>{this.uppy.off(\"file-removed\",U),this.uppy.off(\"cancel-all\",j),this.uppy.off(\"upload-pause\",G),this.uppy.off(\"pause-all\",J),this.uppy.off(\"resume-all\",B)},\"removeEventHandlers\"),r.addEventListener(\"abort\",()=>{var z;(z=f)==null||z.abort()}),x()})}finally{s?.()}}n(Rw,\"_awaitRemoteFileUpload2\");tt.VERSION=Fw.version;var Nh={};Tl(Nh,{getItem:()=>kw,removeItem:()=>Dw,setItem:()=>Uw});function Uw(i,e){return new Promise(t=>{localStorage.setItem(i,e),t()})}n(Uw,\"setItem\");function kw(i){return Promise.resolve(localStorage.getItem(i))}n(kw,\"getItem\");function Dw(i){return new Promise(e=>{localStorage.removeItem(i),e()})}n(Dw,\"removeItem\");function wr(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(wr,\"_classPrivateFieldLooseBase\");var Iw=0;function Mh(i){return\"__private_\"+Iw+++\"_\"+i}n(Mh,\"_classPrivateFieldLooseKey\");var Nw=n(i=>i.split(\"-\").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(\" \"),\"getName\");function Mw(){return location.origin}n(Mw,\"getOrigin\");function Tm(i){if(typeof i==\"string\")return new RegExp(`^${i}$`);if(i instanceof RegExp)return i}n(Tm,\"getRegex\");function Lw(i,e){return(Array.isArray(e)?e.map(Tm):[Tm(e)]).some(r=>r?.test(i)||r?.test(`${i}/`))}n(Lw,\"isOriginAllowed\");var _i=Mh(\"refreshingTokenPromise\"),Un=Mh(\"getAuthToken\"),kn=Mh(\"removeAuthToken\"),be=class extends tt{constructor(e,t){super(e,t),Object.defineProperty(this,kn,{value:zw}),Object.defineProperty(this,Un,{value:Bw}),Object.defineProperty(this,_i,{writable:!0,value:void 0}),this.provider=t.provider,this.id=this.provider,this.name=this.opts.name||Nw(this.id),this.pluginId=this.opts.pluginId,this.tokenKey=`companion-${this.pluginId}-auth-token`,this.companionKeysParams=this.opts.companionKeysParams,this.preAuthToken=null}async headers(){let[e,t]=await Promise.all([super.headers(),wr(this,Un)[Un]()]),r={};return t&&(r[\"uppy-auth-token\"]=t),this.companionKeysParams&&(r[\"uppy-credentials-params\"]=btoa(JSON.stringify({params:this.companionKeysParams}))),{...e,...r}}onReceiveResponse(e){super.onReceiveResponse(e);let t=this.uppy.getPlugin(this.pluginId),s=t.getPluginState().authenticated?e.status!==401:e.status<400;return t.setPluginState({authenticated:s}),e}async setAuthToken(e){return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey,e)}async ensurePreAuth(){if(this.companionKeysParams&&!this.preAuthToken&&(await this.fetchPreAuthToken(),!this.preAuthToken))throw new Error(\"Could not load authentication data required for third-party login. Please try again later.\")}authUrl(e){e===void 0&&(e={});let t=new URLSearchParams({state:btoa(JSON.stringify({origin:Mw()})),...e});return this.preAuthToken&&t.set(\"uppyPreAuthToken\",this.preAuthToken),`${this.hostname}/${this.id}/connect?${t}`}async login(e){return await this.ensurePreAuth(),new Promise((t,r)=>{let s=this.authUrl(e),o=window.open(s,\"_blank\"),a=n(l=>{if(l.source!==o){let d=\"\";try{d=JSON.stringify(l.data)}catch{}this.uppy.log(`ignoring event from unknown source ${d}`,\"warning\");return}let{companionAllowedHosts:h}=this.uppy.getPlugin(this.pluginId).opts;if(!Lw(l.origin,h)){r(new Error(`rejecting event from ${l.origin} vs allowed pattern ${h}`));return}let p=typeof l.data==\"string\"?JSON.parse(l.data):l.data;if(p.error){let{uppy:d}=this,f=d.i18n(\"authAborted\");d.info({message:f},\"warning\",5e3),r(new Error(\"auth aborted\"));return}if(!p.token){r(new Error(\"did not receive token from auth window\"));return}o.close(),window.removeEventListener(\"message\",a),this.setAuthToken(p.token).then(()=>t()).catch(r)},\"handleToken\");window.addEventListener(\"message\",a)})}refreshTokenUrl(){return`${this.hostname}/${this.id}/refresh-token`}fileUrl(e){return`${this.hostname}/${this.id}/get/${e}`}async request(){await wr(this,_i)[_i];try{return await super.request(...arguments)}catch(e){let t=await wr(this,Un)[Un]();if(!e.isAuthError||!t)throw e;return wr(this,_i)[_i]==null&&(wr(this,_i)[_i]=(async()=>{try{this.uppy.log(\"[CompanionClient] Refreshing expired auth token\",\"info\");let r=await super.request({path:this.refreshTokenUrl(),method:\"POST\"});await this.setAuthToken(r.uppyAuthToken)}catch(r){throw r.isAuthError&&await wr(this,kn)[kn](),e}finally{wr(this,_i)[_i]=void 0}})()),await wr(this,_i)[_i],super.request(...arguments)}}async fetchPreAuthToken(){if(this.companionKeysParams)try{let e=await this.post(`${this.id}/preauth/`,{params:this.companionKeysParams});this.preAuthToken=e.token}catch(e){this.uppy.log(`[CompanionClient] unable to fetch preAuthToken ${e}`,\"warning\")}}list(e,t){return this.get(`${this.id}/list/${e||\"\"}`,t)}async logout(e){let t=await this.get(`${this.id}/logout`,e);return await wr(this,kn)[kn](),t}static initPlugin(e,t,r){if(e.type=\"acquirer\",e.files=[],r&&(e.opts={...r,...t}),t.serverUrl||t.serverPattern)throw new Error(\"`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`\");if(t.companionAllowedHosts){let s=t.companionAllowedHosts;if(typeof s!=\"string\"&&!Array.isArray(s)&&!(s instanceof RegExp))throw new TypeError(`${e.id}: the option \"companionAllowedHosts\" must be one of string, Array, RegExp`);e.opts.companionAllowedHosts=s}else/^(?!https?:\\/\\/).*$/i.test(t.companionUrl)?e.opts.companionAllowedHosts=`https://${t.companionUrl.replace(/^\\/\\//,\"\")}`:e.opts.companionAllowedHosts=new URL(t.companionUrl).origin;e.storage=e.opts.storage||Nh}};n(be,\"Provider\");async function Bw(){return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey)}n(Bw,\"_getAuthToken2\");async function zw(){return this.uppy.getPlugin(this.pluginId).storage.removeItem(this.tokenKey)}n(zw,\"_removeAuthToken2\");var jw=n(i=>i.split(\"-\").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(\" \"),\"getName\"),Yr=class extends tt{constructor(e,t){super(e,t),this.provider=t.provider,this.id=this.provider,this.name=this.opts.name||jw(this.id),this.pluginId=this.opts.pluginId}fileUrl(e){return`${this.hostname}/search/${this.id}/get/${e}`}search(e,t){return this.get(`search/${this.id}/list?q=${encodeURIComponent(e)}${t?`&${t}`:\"\"}`)}};n(Yr,\"SearchProvider\");var Um=de(yh(),1);var Am,Rm;function Me(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(Me,\"_classPrivateFieldLooseBase\");var Hw=0;function Dn(i){return\"__private_\"+Hw+++\"_\"+i}n(Dn,\"_classPrivateFieldLooseKey\");var Sr=Dn(\"queued\"),Fs=Dn(\"emitter\"),xi=Dn(\"isOpen\"),it=Dn(\"socket\"),Lh=Dn(\"handleMessage\");Am=Symbol.for(\"uppy test: getSocket\");Rm=Symbol.for(\"uppy test: getQueued\");var Co=class{constructor(e){Object.defineProperty(this,Sr,{writable:!0,value:[]}),Object.defineProperty(this,Fs,{writable:!0,value:(0,Um.default)()}),Object.defineProperty(this,xi,{writable:!0,value:!1}),Object.defineProperty(this,it,{writable:!0,value:void 0}),Object.defineProperty(this,Lh,{writable:!0,value:t=>{try{let r=JSON.parse(t.data);this.emit(r.action,r.payload)}catch(r){console.log(r)}}}),this.opts=e,(!e||e.autoOpen!==!1)&&this.open()}get isOpen(){return Me(this,xi)[xi]}[Am](){return Me(this,it)[it]}[Rm](){return Me(this,Sr)[Sr]}open(){Me(this,it)[it]==null&&(Me(this,it)[it]=new WebSocket(this.opts.target),Me(this,it)[it].onopen=()=>{for(Me(this,xi)[xi]=!0;Me(this,Sr)[Sr].length>0&&Me(this,xi)[xi];){let e=Me(this,Sr)[Sr].shift();this.send(e.action,e.payload)}},Me(this,it)[it].onclose=()=>{Me(this,xi)[xi]=!1,Me(this,it)[it]=null},Me(this,it)[it].onmessage=Me(this,Lh)[Lh])}close(){var e;(e=Me(this,it)[it])==null||e.close()}send(e,t){if(!Me(this,xi)[xi]){Me(this,Sr)[Sr].push({action:e,payload:t});return}Me(this,it)[it].send(JSON.stringify({action:e,payload:t}))}on(e,t){Me(this,Fs)[Fs].on(e,t)}emit(e,t){Me(this,Fs)[Fs].emit(e,t)}once(e,t){Me(this,Fs)[Fs].once(e,t)}};n(Co,\"UppySocket\");var td={};Tl(td,{ProviderViews:()=>Te,SearchProviderViews:()=>ji,defaultPickerIcon:()=>ko});var jh=de(Dm(),1);var To=class extends Error{constructor(e){super(e),this.name=\"TimeoutError\"}};n(To,\"TimeoutError\");var Yl=class extends Error{constructor(e){super(),this.name=\"AbortError\",this.message=e}};n(Yl,\"AbortError\");var Im=n(i=>globalThis.DOMException===void 0?new Yl(i):new DOMException(i),\"getDOMException\"),Nm=n(i=>{let e=i.reason===void 0?Im(\"This operation was aborted.\"):i.reason;return e instanceof Error?e:Im(e)},\"getAbortedReason\");function Hh(i,e,t,r){let s,o=new Promise((a,l)=>{if(typeof e!=\"number\"||Math.sign(e)!==1)throw new TypeError(`Expected \\`milliseconds\\` to be a positive number, got \\`${e}\\``);if(e===Number.POSITIVE_INFINITY){a(i);return}if(r={customTimers:{setTimeout,clearTimeout},...r},r.signal){let{signal:h}=r;h.aborted&&l(Nm(h)),h.addEventListener(\"abort\",()=>{l(Nm(h))})}s=r.customTimers.setTimeout.call(void 0,()=>{if(typeof t==\"function\"){try{a(t())}catch(d){l(d)}return}let h=typeof t==\"string\"?t:`Promise timed out after ${e} milliseconds`,p=t instanceof Error?t:new To(h);typeof i.cancel==\"function\"&&i.cancel(),l(p)},e),(async()=>{try{a(await i)}catch(h){l(h)}finally{r.customTimers.clearTimeout.call(void 0,s)}})()});return o.clear=()=>{clearTimeout(s),s=void 0},o}n(Hh,\"pTimeout\");function $h(i,e,t){let r=0,s=i.length;for(;s>0;){let o=Math.trunc(s/2),a=r+o;t(i[a],e)<=0?(r=++a,s-=o+1):s=o}return r}n($h,\"lowerBound\");var Es=function(i,e,t,r){if(t===\"a\"&&!r)throw new TypeError(\"Private accessor was defined without a getter\");if(typeof e==\"function\"?i!==e||!r:!e.has(i))throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");return t===\"m\"?r:t===\"a\"?r.call(i):r?r.value:e.get(i)},Pr,Ql=class{constructor(){Pr.set(this,[])}enqueue(e,t){t={priority:0,...t};let r={priority:t.priority,run:e};if(this.size&&Es(this,Pr,\"f\")[this.size-1].priority>=t.priority){Es(this,Pr,\"f\").push(r);return}let s=$h(Es(this,Pr,\"f\"),r,(o,a)=>a.priority-o.priority);Es(this,Pr,\"f\").splice(s,0,r)}dequeue(){let e=Es(this,Pr,\"f\").shift();return e?.run}filter(e){return Es(this,Pr,\"f\").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return Es(this,Pr,\"f\").length}};n(Ql,\"PriorityQueue\");Pr=new WeakMap;var Mm=Ql;var Ue=function(i,e,t,r,s){if(r===\"m\")throw new TypeError(\"Private method is not writable\");if(r===\"a\"&&!s)throw new TypeError(\"Private accessor was defined without a setter\");if(typeof e==\"function\"?i!==e||!s:!e.has(i))throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");return r===\"a\"?s.call(i,t):s?s.value=t:e.set(i,t),t},W=function(i,e,t,r){if(t===\"a\"&&!r)throw new TypeError(\"Private accessor was defined without a getter\");if(typeof e==\"function\"?i!==e||!r:!e.has(i))throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");return t===\"m\"?r:t===\"a\"?r.call(i):r?r.value:e.get(i)},He,Mn,Ln,Jr,su,Bn,Jl,Fi,Nn,Xt,Zl,Yt,zn,Qr,eu,Lm,Bm,Hm,zm,jm,tu,qh,Vh,ou,$m,iu,jn=class extends Error{};n(jn,\"AbortError\");var ru=class extends jh.default{constructor(e){var t,r,s,o;if(super(),He.add(this),Mn.set(this,void 0),Ln.set(this,void 0),Jr.set(this,0),su.set(this,void 0),Bn.set(this,void 0),Jl.set(this,0),Fi.set(this,void 0),Nn.set(this,void 0),Xt.set(this,void 0),Zl.set(this,void 0),Yt.set(this,0),zn.set(this,void 0),Qr.set(this,void 0),eu.set(this,void 0),Object.defineProperty(this,\"timeout\",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Mm,...e},!(typeof e.intervalCap==\"number\"&&e.intervalCap>=1))throw new TypeError(`Expected \\`intervalCap\\` to be a number from 1 and up, got \\`${(r=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:\"\"}\\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \\`interval\\` to be a finite number >= 0, got \\`${(o=(s=e.interval)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:\"\"}\\` (${typeof e.interval})`);Ue(this,Mn,e.carryoverConcurrencyCount,\"f\"),Ue(this,Ln,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,\"f\"),Ue(this,su,e.intervalCap,\"f\"),Ue(this,Bn,e.interval,\"f\"),Ue(this,Xt,new e.queueClass,\"f\"),Ue(this,Zl,e.queueClass,\"f\"),this.concurrency=e.concurrency,this.timeout=e.timeout,Ue(this,eu,e.throwOnTimeout===!0,\"f\"),Ue(this,Qr,e.autoStart===!1,\"f\")}get concurrency(){return W(this,zn,\"f\")}set concurrency(e){if(!(typeof e==\"number\"&&e>=1))throw new TypeError(`Expected \\`concurrency\\` to be a number from 1 and up, got \\`${e}\\` (${typeof e})`);Ue(this,zn,e,\"f\"),W(this,He,\"m\",ou).call(this)}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:W(this,eu,\"f\"),...t},new Promise((r,s)=>{W(this,Xt,\"f\").enqueue(async()=>{var o,a,l;Ue(this,Yt,(a=W(this,Yt,\"f\"),a++,a),\"f\"),Ue(this,Jr,(l=W(this,Jr,\"f\"),l++,l),\"f\");try{if(!((o=t.signal)===null||o===void 0)&&o.aborted)throw new jn(\"The task was aborted.\");let h=e({signal:t.signal});t.timeout&&(h=Hh(Promise.resolve(h),t.timeout)),t.signal&&(h=Promise.race([h,W(this,He,\"m\",$m).call(this,t.signal)]));let p=await h;r(p),this.emit(\"completed\",p)}catch(h){if(h instanceof To&&!t.throwOnTimeout){r();return}s(h),this.emit(\"error\",h)}finally{W(this,He,\"m\",Hm).call(this)}},t),this.emit(\"add\"),W(this,He,\"m\",tu).call(this)})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return W(this,Qr,\"f\")?(Ue(this,Qr,!1,\"f\"),W(this,He,\"m\",ou).call(this),this):this}pause(){Ue(this,Qr,!0,\"f\")}clear(){Ue(this,Xt,new(W(this,Zl,\"f\")),\"f\")}async onEmpty(){W(this,Xt,\"f\").size!==0&&await W(this,He,\"m\",iu).call(this,\"empty\")}async onSizeLessThan(e){W(this,Xt,\"f\").size<e||await W(this,He,\"m\",iu).call(this,\"next\",()=>W(this,Xt,\"f\").size<e)}async onIdle(){W(this,Yt,\"f\")===0&&W(this,Xt,\"f\").size===0||await W(this,He,\"m\",iu).call(this,\"idle\")}get size(){return W(this,Xt,\"f\").size}sizeBy(e){return W(this,Xt,\"f\").filter(e).length}get pending(){return W(this,Yt,\"f\")}get isPaused(){return W(this,Qr,\"f\")}};n(ru,\"PQueue\");Mn=new WeakMap,Ln=new WeakMap,Jr=new WeakMap,su=new WeakMap,Bn=new WeakMap,Jl=new WeakMap,Fi=new WeakMap,Nn=new WeakMap,Xt=new WeakMap,Zl=new WeakMap,Yt=new WeakMap,zn=new WeakMap,Qr=new WeakMap,eu=new WeakMap,He=new WeakSet,Lm=n(function(){return W(this,Ln,\"f\")||W(this,Jr,\"f\")<W(this,su,\"f\")},\"_PQueue_doesIntervalAllowAnother_get\"),Bm=n(function(){return W(this,Yt,\"f\")<W(this,zn,\"f\")},\"_PQueue_doesConcurrentAllowAnother_get\"),Hm=n(function(){var e;Ue(this,Yt,(e=W(this,Yt,\"f\"),e--,e),\"f\"),W(this,He,\"m\",tu).call(this),this.emit(\"next\")},\"_PQueue_next\"),zm=n(function(){W(this,He,\"m\",Vh).call(this),W(this,He,\"m\",qh).call(this),Ue(this,Nn,void 0,\"f\")},\"_PQueue_onResumeInterval\"),jm=n(function(){let e=Date.now();if(W(this,Fi,\"f\")===void 0){let t=W(this,Jl,\"f\")-e;if(t<0)Ue(this,Jr,W(this,Mn,\"f\")?W(this,Yt,\"f\"):0,\"f\");else return W(this,Nn,\"f\")===void 0&&Ue(this,Nn,setTimeout(()=>{W(this,He,\"m\",zm).call(this)},t),\"f\"),!0}return!1},\"_PQueue_isIntervalPaused_get\"),tu=n(function(){if(W(this,Xt,\"f\").size===0)return W(this,Fi,\"f\")&&clearInterval(W(this,Fi,\"f\")),Ue(this,Fi,void 0,\"f\"),this.emit(\"empty\"),W(this,Yt,\"f\")===0&&this.emit(\"idle\"),!1;if(!W(this,Qr,\"f\")){let e=!W(this,He,\"a\",jm);if(W(this,He,\"a\",Lm)&&W(this,He,\"a\",Bm)){let t=W(this,Xt,\"f\").dequeue();return t?(this.emit(\"active\"),t(),e&&W(this,He,\"m\",qh).call(this),!0):!1}}return!1},\"_PQueue_tryToStartAnother\"),qh=n(function(){W(this,Ln,\"f\")||W(this,Fi,\"f\")!==void 0||(Ue(this,Fi,setInterval(()=>{W(this,He,\"m\",Vh).call(this)},W(this,Bn,\"f\")),\"f\"),Ue(this,Jl,Date.now()+W(this,Bn,\"f\"),\"f\"))},\"_PQueue_initializeIntervalIfNeeded\"),Vh=n(function(){W(this,Jr,\"f\")===0&&W(this,Yt,\"f\")===0&&W(this,Fi,\"f\")&&(clearInterval(W(this,Fi,\"f\")),Ue(this,Fi,void 0,\"f\")),Ue(this,Jr,W(this,Mn,\"f\")?W(this,Yt,\"f\"):0,\"f\"),W(this,He,\"m\",ou).call(this)},\"_PQueue_onInterval\"),ou=n(function(){for(;W(this,He,\"m\",tu).call(this););},\"_PQueue_processQueue\"),$m=n(async function(e){return new Promise((t,r)=>{e.addEventListener(\"abort\",()=>{r(new jn(\"The task was aborted.\"))},{once:!0})})},\"_PQueue_throwOnAbort\"),iu=n(async function(e,t){return new Promise(r=>{let s=n(()=>{t&&!t()||(this.off(e,s),r())},\"listener\");this.on(e,s)})},\"_PQueue_onEvent\");var qm=ru;function Vw(){return u(\"svg\",{width:\"26\",height:\"26\",viewBox:\"0 0 26 26\",xmlns:\"http://www.w3.org/2000/svg\"},u(\"g\",{fill:\"none\",\"fill-rule\":\"evenodd\"},u(\"circle\",{fill:\"#FFF\",cx:\"13\",cy:\"13\",r:\"13\"}),u(\"path\",{d:\"M21.64 13.205c0-.639-.057-1.252-.164-1.841H13v3.481h4.844a4.14 4.14 0 01-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z\",fill:\"#4285F4\",\"fill-rule\":\"nonzero\"}),u(\"path\",{d:\"M13 22c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H4.957v2.332A8.997 8.997 0 0013 22z\",fill:\"#34A853\",\"fill-rule\":\"nonzero\"}),u(\"path\",{d:\"M7.964 14.71A5.41 5.41 0 017.682 13c0-.593.102-1.17.282-1.71V8.958H4.957A8.996 8.996 0 004 13c0 1.452.348 2.827.957 4.042l3.007-2.332z\",fill:\"#FBBC05\",\"fill-rule\":\"nonzero\"}),u(\"path\",{d:\"M13 7.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C17.463 4.891 15.426 4 13 4a8.997 8.997 0 00-8.043 4.958l3.007 2.332C8.672 9.163 10.656 7.58 13 7.58z\",fill:\"#EA4335\",\"fill-rule\":\"nonzero\"}),u(\"path\",{d:\"M4 4h18v18H4z\"})))}n(Vw,\"GoogleIcon\");function Ww(i){let{pluginName:e,pluginIcon:t,i18nArray:r,handleAuth:s}=i,o=e===\"Google Drive\",a=u(\"span\",{className:\"uppy-Provider-authTitleName\"},e,u(\"br\",null));return u(\"div\",{className:\"uppy-Provider-auth\"},u(\"div\",{className:\"uppy-Provider-authIcon\"},t()),u(\"div\",{className:\"uppy-Provider-authTitle\"},r(\"authenticateWithTitle\",{pluginName:a})),o?u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn uppy-Provider-btn-google\",onClick:s,\"data-uppy-super-focusable\":!0},u(Vw,null),r(\"signInWithGoogle\")):u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn\",onClick:s,\"data-uppy-super-focusable\":!0},r(\"authenticateWith\",{pluginName:e})))}n(Ww,\"AuthView\");var Vm=Ww;var Wm=n(i=>{let{i18n:e,logout:t,username:r}=i;return[u(\"span\",{className:\"uppy-ProviderBrowser-user\",key:\"username\"},r),u(\"button\",{type:\"button\",onClick:t,className:\"uppy-u-reset uppy-c-btn uppy-ProviderBrowser-userLogout\",key:\"logout\"},e(\"logOut\"))]},\"default\");var Gw=n(i=>{let{getFolder:e,title:t,isLast:r}=i;return u(Ht,null,u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn\",onClick:e},t),r?\"\":\" / \")},\"Breadcrumb\"),Gm=n(i=>{let{getFolder:e,title:t,breadcrumbsIcon:r,breadcrumbs:s}=i;return u(\"div\",{className:\"uppy-Provider-breadcrumbs\"},u(\"div\",{className:\"uppy-Provider-breadcrumbsIcon\"},r),s.map((o,a)=>u(Gw,{key:o.id,getFolder:()=>e(o.requestPath),title:a===0?t:o.name,isLast:a+1===s.length})))},\"default\");var Km=n(i=>{let e=[];return i.showBreadcrumbs&&e.push(Gm({getFolder:i.getFolder,breadcrumbs:i.breadcrumbs,breadcrumbsIcon:i.pluginIcon&&i.pluginIcon(),title:i.title})),e.push(Wm({logout:i.logout,username:i.username,i18n:i.i18n})),e},\"default\");var Zh=de(Qt(),1);function Hn(i){return{...i,type:i.mimeType,extension:i.name?Bi(i.name).extension:null}}n(Hn,\"remoteFileObjToLocal\");var uu,Rt,Wh,Xm,$n=0,ig=[],au=[],Ym=ee.__b,Qm=ee.__r,Jm=ee.diffed,Zm=ee.__c,eg=ee.unmount;function Kh(i,e){ee.__h&&ee.__h(Rt,i,$n||e),$n=0;var t=Rt.__H||(Rt.__H={__:[],__h:[]});return i>=t.__.length&&t.__.push({__V:au}),t.__[i]}n(Kh,\"p\");function Ao(i){return $n=1,Kw(sg,i)}n(Ao,\"y\");function Kw(i,e,t){var r=Kh(uu++,2);return r.t=i,r.__c||(r.__=[t?t(e):sg(void 0,e),function(s){var o=r.t(r.__[0],s);r.__[0]!==o&&(r.__=[o,r.__[1]],r.__c.setState({}))}],r.__c=Rt),r.__}n(Kw,\"d\");function Os(i,e){var t=Kh(uu++,3);!ee.__s&&rg(t.__H,e)&&(t.__=i,t.u=e,Rt.__H.__h.push(t))}n(Os,\"_\");function Xh(i){return $n=5,Ro(function(){return{current:i}},[])}n(Xh,\"s\");function Ro(i,e){var t=Kh(uu++,7);return rg(t.__H,e)?(t.__V=i(),t.u=e,t.__h=i,t.__V):t.__}n(Ro,\"F\");function qn(i,e){return $n=8,Ro(function(){return i},e)}n(qn,\"T\");function Xw(){for(var i;i=ig.shift();)if(i.__P)try{i.__H.__h.forEach(lu),i.__H.__h.forEach(Gh),i.__H.__h=[]}catch(e){i.__H.__h=[],ee.__e(e,i.__v)}}n(Xw,\"b\");ee.__b=function(i){Rt=null,Ym&&Ym(i)},ee.__r=function(i){Qm&&Qm(i),uu=0;var e=(Rt=i.__c).__H;e&&(Wh===Rt?(e.__h=[],Rt.__h=[],e.__.forEach(function(t){t.__V=au,t.u=void 0})):(e.__h.forEach(lu),e.__h.forEach(Gh),e.__h=[])),Wh=Rt},ee.diffed=function(i){Jm&&Jm(i);var e=i.__c;e&&e.__H&&(e.__H.__h.length&&(ig.push(e)!==1&&Xm===ee.requestAnimationFrame||((Xm=ee.requestAnimationFrame)||function(t){var r,s=n(function(){clearTimeout(o),tg&&cancelAnimationFrame(r),setTimeout(t)},\"u\"),o=setTimeout(s,100);tg&&(r=requestAnimationFrame(s))})(Xw)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.__V!==au&&(t.__=t.__V),t.u=void 0,t.__V=au})),Wh=Rt=null},ee.__c=function(i,e){e.some(function(t){try{t.__h.forEach(lu),t.__h=t.__h.filter(function(r){return!r.__||Gh(r)})}catch(r){e.some(function(s){s.__h&&(s.__h=[])}),e=[],ee.__e(r,t.__v)}}),Zm&&Zm(i,e)},ee.unmount=function(i){eg&&eg(i);var e,t=i.__c;t&&t.__H&&(t.__H.__.forEach(function(r){try{lu(r)}catch(s){e=s}}),e&&ee.__e(e,t.__v))};var tg=typeof requestAnimationFrame==\"function\";function lu(i){var e=Rt,t=i.__c;typeof t==\"function\"&&(i.__c=void 0,t()),Rt=e}n(lu,\"j\");function Gh(i){var e=Rt;i.__c=i.__(),Rt=e}n(Gh,\"k\");function rg(i,e){return!i||i.length!==e.length||e.some(function(t,r){return t!==i[r]})}n(rg,\"w\");function sg(i,e){return typeof e==\"function\"?e(i):e}n(sg,\"z\");function Yh(){return Yh=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Yh.apply(this,arguments)}n(Yh,\"_extends\");var Yw={position:\"relative\",width:\"100%\",minHeight:\"100%\"},Qw={position:\"absolute\",top:0,left:0,width:\"100%\",overflow:\"visible\"},hu=class extends we{constructor(e){super(e),this.handleScroll=()=>{this.setState({offset:this.base.scrollTop})},this.handleResize=()=>{this.resize()},this.focusElement=null,this.state={offset:0,height:0}}componentDidMount(){this.resize(),window.addEventListener(\"resize\",this.handleResize)}componentWillUpdate(){this.base.contains(document.activeElement)&&(this.focusElement=document.activeElement)}componentDidUpdate(){this.focusElement&&this.focusElement.parentNode&&document.activeElement!==this.focusElement&&this.focusElement.focus(),this.focusElement=null,this.resize()}componentWillUnmount(){window.removeEventListener(\"resize\",this.handleResize)}resize(){let{height:e}=this.state;e!==this.base.offsetHeight&&this.setState({height:this.base.offsetHeight})}render(e){let{data:t,rowHeight:r,renderRow:s,overscanCount:o=10,...a}=e,{offset:l,height:h}=this.state,p=Math.floor(l/r),d=Math.floor(h/r);o&&(p=Math.max(0,p-p%o),d+=o);let f=p+d+4,y=t.slice(p,f),b={...Yw,height:t.length*r},S={...Qw,top:p*r};return u(\"div\",Yh({onScroll:this.handleScroll},a),u(\"div\",{role:\"presentation\",style:b},u(\"div\",{role:\"presentation\",style:S},y.map(s))))}};n(hu,\"VirtualList\");var du=hu;function Vn(i){let{search:e,searchOnInput:t,searchTerm:r,showButton:s,inputLabel:o,clearSearchLabel:a,buttonLabel:l,clearSearch:h,inputClassName:p,buttonCSSClassName:d}=i,[f,y]=Ao(r??\"\"),b=qn(F=>{F.preventDefault(),e(f)},[e,f]),S=qn(F=>{let U=F.target.value;y(U),t&&e(U)},[y,t,e]),E=n(()=>{y(\"\"),h&&h()},\"handleReset\"),[x]=Ao(()=>{let F=document.createElement(\"form\");return F.setAttribute(\"tabindex\",\"-1\"),F.id=Pt(),F});return Os(()=>(document.body.appendChild(x),x.addEventListener(\"submit\",b),()=>{x.removeEventListener(\"submit\",b),document.body.removeChild(x)}),[x,b]),u(Ht,null,u(\"input\",{className:`uppy-u-reset ${p}`,type:\"search\",\"aria-label\":o,placeholder:o,value:f,onInput:S,form:x.id,\"data-uppy-super-focusable\":!0}),!s&&u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",class:\"uppy-c-icon uppy-ProviderBrowser-searchFilterIcon\",width:\"12\",height:\"12\",viewBox:\"0 0 12 12\"},u(\"path\",{d:\"M8.638 7.99l3.172 3.172a.492.492 0 1 1-.697.697L7.91 8.656a4.977 4.977 0 0 1-2.983.983C2.206 9.639 0 7.481 0 4.819 0 2.158 2.206 0 4.927 0c2.721 0 4.927 2.158 4.927 4.82a4.74 4.74 0 0 1-1.216 3.17zm-3.71.685c2.176 0 3.94-1.726 3.94-3.856 0-2.129-1.764-3.855-3.94-3.855C2.75.964.984 2.69.984 4.819c0 2.13 1.765 3.856 3.942 3.856z\"})),!s&&f&&u(\"button\",{className:\"uppy-u-reset uppy-ProviderBrowser-searchFilterReset\",type:\"button\",\"aria-label\":a,title:a,onClick:E},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",viewBox:\"0 0 19 19\"},u(\"path\",{d:\"M17.318 17.232L9.94 9.854 9.586 9.5l-.354.354-7.378 7.378h.707l-.62-.62v.706L9.318 9.94l.354-.354-.354-.354L1.94 1.854v.707l.62-.62h-.706l7.378 7.378.354.354.354-.354 7.378-7.378h-.707l.622.62v-.706L9.854 9.232l-.354.354.354.354 7.378 7.378.708-.707-7.38-7.378v.708l7.38-7.38.353-.353-.353-.353-.622-.622-.353-.353-.354.352-7.378 7.38h.708L2.56 1.23 2.208.88l-.353.353-.622.62-.353.355.352.353 7.38 7.38v-.708l-7.38 7.38-.353.353.352.353.622.622.353.353.354-.353 7.38-7.38h-.708l7.38 7.38z\"}))),s&&u(\"button\",{className:`uppy-u-reset uppy-c-btn uppy-c-btn-primary ${d}`,type:\"submit\",form:x.id},l))}n(Vn,\"SearchFilterInput\");var og=n(i=>{let{cancel:e,done:t,i18n:r,selected:s}=i;return u(\"div\",{className:\"uppy-ProviderBrowser-footer\"},u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-c-btn-primary\",onClick:t,type:\"button\"},r(\"selectX\",{smart_count:s})),u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-c-btn-link\",onClick:e,type:\"button\"},r(\"cancel\")))},\"default\");var ug=de(Qt(),1);function Jw(){return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:11,height:14.5,viewBox:\"0 0 44 58\"},u(\"path\",{d:\"M27.437.517a1 1 0 0 0-.094.03H4.25C2.037.548.217 2.368.217 4.58v48.405c0 2.212 1.82 4.03 4.03 4.03H39.03c2.21 0 4.03-1.818 4.03-4.03V15.61a1 1 0 0 0-.03-.28 1 1 0 0 0 0-.093 1 1 0 0 0-.03-.032 1 1 0 0 0 0-.03 1 1 0 0 0-.032-.063 1 1 0 0 0-.03-.063 1 1 0 0 0-.032 0 1 1 0 0 0-.03-.063 1 1 0 0 0-.032-.03 1 1 0 0 0-.03-.063 1 1 0 0 0-.063-.062l-14.593-14a1 1 0 0 0-.062-.062A1 1 0 0 0 28 .708a1 1 0 0 0-.374-.157 1 1 0 0 0-.156 0 1 1 0 0 0-.03-.03l-.003-.003zM4.25 2.547h22.218v9.97c0 2.21 1.82 4.03 4.03 4.03h10.564v36.438a2.02 2.02 0 0 1-2.032 2.032H4.25c-1.13 0-2.032-.9-2.032-2.032V4.58c0-1.13.902-2.032 2.03-2.032zm24.218 1.345l10.375 9.937.75.718H30.5c-1.13 0-2.032-.9-2.032-2.03V3.89z\"}))}n(Jw,\"FileIcon\");function Zw(){return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",style:{minWidth:16,marginRight:3},viewBox:\"0 0 276.157 276.157\"},u(\"path\",{d:\"M273.08 101.378c-3.3-4.65-8.86-7.32-15.254-7.32h-24.34V67.59c0-10.2-8.3-18.5-18.5-18.5h-85.322c-3.63 0-9.295-2.875-11.436-5.805l-6.386-8.735c-4.982-6.814-15.104-11.954-23.546-11.954H58.73c-9.292 0-18.638 6.608-21.737 15.372l-2.033 5.752c-.958 2.71-4.72 5.37-7.596 5.37H18.5C8.3 49.09 0 57.39 0 67.59v167.07c0 .886.16 1.73.443 2.52.152 3.306 1.18 6.424 3.053 9.064 3.3 4.652 8.86 7.32 15.255 7.32h188.487c11.395 0 23.27-8.425 27.035-19.18l40.677-116.188c2.11-6.035 1.43-12.164-1.87-16.816zM18.5 64.088h8.864c9.295 0 18.64-6.607 21.738-15.37l2.032-5.75c.96-2.712 4.722-5.373 7.597-5.373h29.565c3.63 0 9.295 2.876 11.437 5.806l6.386 8.735c4.982 6.815 15.104 11.954 23.546 11.954h85.322c1.898 0 3.5 1.602 3.5 3.5v26.47H69.34c-11.395 0-23.27 8.423-27.035 19.178L15 191.23V67.59c0-1.898 1.603-3.5 3.5-3.5zm242.29 49.15l-40.676 116.188c-1.674 4.78-7.812 9.135-12.877 9.135H18.75c-1.447 0-2.576-.372-3.02-.997-.442-.625-.422-1.814.057-3.18l40.677-116.19c1.674-4.78 7.812-9.134 12.877-9.134h188.487c1.448 0 2.577.372 3.02.997.443.625.423 1.814-.056 3.18z\"}))}n(Zw,\"FolderIcon\");function e2(){return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",style:{width:16,marginRight:4},viewBox:\"0 0 58 58\"},u(\"path\",{d:\"M36.537 28.156l-11-7a1.005 1.005 0 0 0-1.02-.033C24.2 21.3 24 21.635 24 22v14a1 1 0 0 0 1.537.844l11-7a1.002 1.002 0 0 0 0-1.688zM26 34.18V23.82L34.137 29 26 34.18z\"}),u(\"path\",{d:\"M57 6H1a1 1 0 0 0-1 1v44a1 1 0 0 0 1 1h56a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zM10 28H2v-9h8v9zm-8 2h8v9H2v-9zm10 10V8h34v42H12V40zm44-12h-8v-9h8v9zm-8 2h8v9h-8v-9zm8-22v9h-8V8h8zM2 8h8v9H2V8zm0 42v-9h8v9H2zm54 0h-8v-9h8v9z\"}))}n(e2,\"VideoIcon\");var ng=n(i=>{let{itemIconString:e}=i;if(e!==null)switch(e){case\"file\":return u(Jw,null);case\"folder\":return u(Zw,null);case\"video\":return u(e2,null);default:{let{alt:t}=i;return u(\"img\",{src:e,alt:t,loading:\"lazy\",width:16,height:16})}}},\"default\");var ag=de(Qt(),1);function t2(i){let{className:e,isDisabled:t,restrictionError:r,isChecked:s,title:o,itemIconEl:a,showTitles:l,toggleCheckbox:h,recordShiftKeyPress:p,id:d,children:f}=i,y=(0,ag.default)(\"uppy-u-reset\",\"uppy-ProviderBrowserItem-checkbox\",\"uppy-ProviderBrowserItem-checkbox--grid\",{\"uppy-ProviderBrowserItem-checkbox--is-checked\":s});return u(\"li\",{className:e,title:t?r?.message:null},u(\"input\",{type:\"checkbox\",className:y,onChange:h,onKeyDown:p,onMouseDown:p,name:\"listitem\",id:d,checked:s,disabled:t,\"data-uppy-super-focusable\":!0}),u(\"label\",{htmlFor:d,\"aria-label\":o,className:\"uppy-u-reset uppy-ProviderBrowserItem-inner\"},a,l&&o,f))}n(t2,\"GridListItem\");var Qh=t2;function i2(i){let{className:e,isDisabled:t,restrictionError:r,isCheckboxDisabled:s,isChecked:o,toggleCheckbox:a,recordShiftKeyPress:l,type:h,id:p,itemIconEl:d,title:f,handleFolderClick:y,showTitles:b,i18n:S}=i;return u(\"li\",{className:e,title:t?r?.message:null},s?null:u(\"input\",{type:\"checkbox\",className:`uppy-u-reset uppy-ProviderBrowserItem-checkbox ${o?\"uppy-ProviderBrowserItem-checkbox--is-checked\":\"\"}`,onChange:a,onKeyDown:l,onMouseDown:l,name:\"listitem\",id:p,checked:o,\"aria-label\":h===\"file\"?null:S(\"allFilesFromFolderNamed\",{name:f}),disabled:t,\"data-uppy-super-focusable\":!0}),h===\"file\"?u(\"label\",{htmlFor:p,className:\"uppy-u-reset uppy-ProviderBrowserItem-inner\"},u(\"div\",{className:\"uppy-ProviderBrowserItem-iconWrap\"},d),b&&f):u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn uppy-ProviderBrowserItem-inner\",onClick:y,\"aria-label\":S(\"openFolderNamed\",{name:f})},u(\"div\",{className:\"uppy-ProviderBrowserItem-iconWrap\"},d),b&&u(\"span\",null,f)))}n(i2,\"ListItem\");var lg=i2;function Wn(){return Wn=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Wn.apply(this,arguments)}n(Wn,\"_extends\");var Jh=n(i=>{let{author:e,getItemIcon:t,isChecked:r,isDisabled:s,viewType:o}=i,a=t(),l=(0,ug.default)(\"uppy-ProviderBrowserItem\",{\"uppy-ProviderBrowserItem--selected\":r},{\"uppy-ProviderBrowserItem--disabled\":s},{\"uppy-ProviderBrowserItem--noPreview\":a===\"video\"}),h=u(ng,{itemIconString:a});switch(o){case\"grid\":return u(Qh,Wn({},i,{className:l,itemIconEl:h}));case\"list\":return u(lg,Wn({},i,{className:l,itemIconEl:h}));case\"unsplash\":return u(Qh,Wn({},i,{className:l,itemIconEl:h}),u(\"a\",{href:`${e.url}?utm_source=Companion&utm_medium=referral`,target:\"_blank\",rel:\"noopener noreferrer\",className:\"uppy-ProviderBrowserItem-author\",tabIndex:\"-1\"},e.name));default:throw new Error(`There is no such type ${o}`)}},\"default\");var r2=\"shared-with-me\";function hg(i){let{currentSelection:e,uppyFiles:t,viewType:r,isChecked:s,toggleCheckbox:o,recordShiftKeyPress:a,showTitles:l,i18n:h,validateRestrictions:p,getNextFolder:d,columns:f,f:y}=i;if(y.isFolder){var b;return Jh({columns:f,showTitles:l,viewType:r,i18n:h,id:y.id,title:y.name,getItemIcon:()=>y.icon,isChecked:s(y),toggleCheckbox:E=>o(E,y),recordShiftKeyPress:a,type:\"folder\",isDisabled:(b=s(y))==null?void 0:b.loading,isCheckboxDisabled:y.id===r2,handleFolderClick:()=>d(y)})}let S=p(Hn(y),[...t,...e]);return Jh({id:y.id,title:y.name,author:y.author,getItemIcon:()=>y.icon,isChecked:s(y),toggleCheckbox:E=>o(E,y),recordShiftKeyPress:a,columns:f,showTitles:l,viewType:r,i18n:h,type:\"file\",isDisabled:S&&!s(y),restrictionError:S})}n(hg,\"ListItem\");function s2(i){let{currentSelection:e,folders:t,files:r,uppyFiles:s,viewType:o,headerComponent:a,showBreadcrumbs:l,isChecked:h,toggleCheckbox:p,recordShiftKeyPress:d,handleScroll:f,showTitles:y,i18n:b,validateRestrictions:S,isLoading:E,showSearchFilter:x,search:F,searchTerm:U,clearSearch:j,searchOnInput:G,searchInputLabel:J,clearSearchLabel:B,getNextFolder:z,cancel:K,done:oe,columns:Be,noResultsLabel:Je,loadAllFiles:wt}=i,We=e.length,_e=Ro(()=>[...t,...r],[t,r]);return u(\"div\",{className:(0,Zh.default)(\"uppy-ProviderBrowser\",`uppy-ProviderBrowser-viewType--${o}`)},a&&u(\"div\",{className:\"uppy-ProviderBrowser-header\"},u(\"div\",{className:(0,Zh.default)(\"uppy-ProviderBrowser-headerBar\",!l&&\"uppy-ProviderBrowser-headerBar--simple\")},a)),x&&u(\"div\",{class:\"uppy-ProviderBrowser-searchFilter\"},u(Vn,{search:F,searchTerm:U,clearSearch:j,inputLabel:J,clearSearchLabel:B,inputClassName:\"uppy-ProviderBrowser-searchFilterInput\",searchOnInput:G})),(()=>E?u(\"div\",{className:\"uppy-Provider-loading\"},u(\"span\",null,b(\"loading\"))):!t.length&&!r.length?u(\"div\",{className:\"uppy-Provider-empty\"},Je):wt?u(\"div\",{className:\"uppy-ProviderBrowser-body\"},u(\"ul\",{className:\"uppy-ProviderBrowser-list\"},u(du,{data:_e,renderRow:ze=>u(hg,{currentSelection:e,uppyFiles:s,viewType:o,isChecked:h,toggleCheckbox:p,recordShiftKeyPress:d,showTitles:y,i18n:b,validateRestrictions:S,getNextFolder:z,columns:Be,f:ze}),rowHeight:31}))):u(\"div\",{className:\"uppy-ProviderBrowser-body\"},u(\"ul\",{className:\"uppy-ProviderBrowser-list\",onScroll:f,role:\"listbox\",tabIndex:\"-1\"},_e.map(ze=>u(hg,{currentSelection:e,uppyFiles:s,viewType:o,isChecked:h,toggleCheckbox:p,recordShiftKeyPress:d,showTitles:y,i18n:b,validateRestrictions:S,getNextFolder:z,columns:Be,f:ze})))))(),We>0&&u(og,{selected:We,done:oe,cancel:K,i18n:b}))}n(s2,\"Browser\");var cu=s2;var dg=n(i=>{let{i18n:e,loading:t}=i;return u(\"div\",{className:\"uppy-Provider-loading\"},u(\"span\",null,e(\"loading\")),typeof t==\"string\"&&u(\"span\",{style:{marginTop:\".7em\"}},t))},\"default\");var Ei=class extends we{componentWillUnmount(){let{onUnmount:e}=this.props;e()}render(){let{children:e}=this.props;return ci(e)[0]}};n(Ei,\"CloseWrapper\");function Uo(i){return i?/^[^/]+\\/(jpe?g|gif|png|svg|svg\\+xml|bmp|webp|avif)$/.test(i):!1}n(Uo,\"isPreviewSupported\");var Zr=class{constructor(e,t){this.filterItems=r=>{let s=this.plugin.getPluginState();return!s.filterInput||s.filterInput===\"\"?r:r.filter(o=>o.name.toLowerCase().indexOf(s.filterInput.toLowerCase())!==-1)},this.recordShiftKeyPress=r=>{this.isShiftKeyPressed=r.shiftKey},this.toggleCheckbox=(r,s)=>{r.stopPropagation(),r.preventDefault(),r.currentTarget.focus();let{folders:o,files:a}=this.plugin.getPluginState(),l=this.filterItems(o.concat(a));if(this.lastCheckbox&&this.isShiftKeyPressed){let{currentSelection:p}=this.plugin.getPluginState(),d=l.indexOf(this.lastCheckbox),f=l.indexOf(s),y=d<f?l.slice(d,f+1):l.slice(f,d+1),b=[];for(let S of y){let{uppy:E}=this.plugin,x=E.validateRestrictions(Hn(S),[...E.getFiles(),...b]);x?E.info({message:x.message},\"error\",E.opts.infoTimeout):b.push(S)}this.plugin.setPluginState({currentSelection:[...new Set([...p,...b])]});return}this.lastCheckbox=s;let{currentSelection:h}=this.plugin.getPluginState();this.isChecked(s)?this.plugin.setPluginState({currentSelection:h.filter(p=>p.id!==s.id)}):this.plugin.setPluginState({currentSelection:h.concat([s])})},this.isChecked=r=>{let{currentSelection:s}=this.plugin.getPluginState();return s.some(o=>o.id===r.id)},this.plugin=e,this.provider=t.provider,this.isHandlingScroll=!1,this.preFirstRender=this.preFirstRender.bind(this),this.handleError=this.handleError.bind(this),this.clearSelection=this.clearSelection.bind(this),this.cancelPicking=this.cancelPicking.bind(this)}preFirstRender(){this.plugin.setPluginState({didFirstRender:!0}),this.plugin.onFirstRender()}shouldHandleScroll(e){let{scrollHeight:t,scrollTop:r,offsetHeight:s}=e.target;return t-(r+s)<50&&!this.isHandlingScroll}clearSelection(){this.plugin.setPluginState({currentSelection:[],filterInput:\"\"})}cancelPicking(){this.clearSelection();let e=this.plugin.uppy.getPlugin(\"Dashboard\");e&&e.hideAllPanels()}handleError(e){var t;let{uppy:r}=this.plugin,s=r.i18n(\"companionError\");r.log(e.toString()),!(e.isAuthError||((t=e.cause)==null?void 0:t.name)===\"AbortError\")&&r.info({message:s,details:e.toString()},\"error\",5e3)}getTagFile(e){let t={id:e.id,source:this.plugin.id,data:e,name:e.name||e.id,type:e.mimeType,isRemote:!0,meta:{},body:{fileId:e.id},remote:{companionUrl:this.plugin.opts.companionUrl,url:`${this.provider.fileUrl(e.requestPath)}`,body:{fileId:e.id},providerName:this.provider.name,provider:this.provider.provider}};Object.defineProperty(t.remote,\"requestClient\",{value:this.provider,enumerable:!1});let r=ys(t);return r&&Uo(r)&&(t.preview=e.thumbnail),e.author&&(e.author.name!=null&&(t.meta.authorName=String(e.author.name)),e.author.url&&(t.meta.authorUrl=e.author.url)),e.relDirPath!=null&&(t.meta.relativePath=e.relDirPath?`${e.relDirPath}/${t.name}`:null),e.absDirPath!=null&&(t.meta.absolutePath=e.absDirPath?`/${e.absDirPath}/${t.name}`:`/${t.name}`),t}setLoading(e){this.plugin.setPluginState({loading:e})}};n(Zr,\"View\");function Jt(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(Jt,\"_classPrivateFieldLooseBase\");var o2=0;function Yn(i){return\"__private_\"+o2+++\"_\"+i}n(Yn,\"_classPrivateFieldLooseKey\");var n2={version:\"3.7.0\"};function a2(i){return i.slice(1).map(e=>e.name).join(\"/\")}n(a2,\"formatBreadcrumbs\");function ed(i,e){return i?`${i}/${e}`:e}n(ed,\"prependPath\");function ko(){return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"30\",height:\"30\",viewBox:\"0 0 30 30\"},u(\"path\",{d:\"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z\"}))}n(ko,\"defaultPickerIcon\");var Cs=Yn(\"abortController\"),_r=Yn(\"withAbort\"),Xn=Yn(\"list\"),Gn=Yn(\"listFilesAndFolders\"),Kn=Yn(\"recursivelyListAllFiles\"),Te=class extends Zr{constructor(e,t){super(e,t),Object.defineProperty(this,Kn,{value:d2}),Object.defineProperty(this,Gn,{value:h2}),Object.defineProperty(this,Xn,{value:u2}),Object.defineProperty(this,_r,{value:l2}),Object.defineProperty(this,Cs,{writable:!0,value:void 0});let r={viewType:\"list\",showTitles:!0,showFilter:!0,showBreadcrumbs:!0,loadAllFiles:!1};this.opts={...r,...t},this.filterQuery=this.filterQuery.bind(this),this.clearFilter=this.clearFilter.bind(this),this.getFolder=this.getFolder.bind(this),this.getNextFolder=this.getNextFolder.bind(this),this.logout=this.logout.bind(this),this.handleAuth=this.handleAuth.bind(this),this.handleScroll=this.handleScroll.bind(this),this.donePicking=this.donePicking.bind(this),this.render=this.render.bind(this),this.plugin.setPluginState({authenticated:!1,files:[],folders:[],breadcrumbs:[],filterInput:\"\",isSearchVisible:!1,currentSelection:[]})}tearDown(){}async getFolder(e,t){this.setLoading(!0);try{await Jt(this,_r)[_r](async r=>{this.lastCheckbox=void 0;let{breadcrumbs:s}=this.plugin.getPluginState(),o=s.findIndex(h=>e===h.requestPath);o!==-1?s=s.slice(0,o+1):s=[...s,{requestPath:e,name:t}],this.nextPagePath=e;let a=[],l=[];do{let{files:h,folders:p}=await Jt(this,Gn)[Gn]({breadcrumbs:s,signal:r});a=a.concat(h),l=l.concat(p),this.setLoading(this.plugin.uppy.i18n(\"loadedXFiles\",{numFiles:a.length+l.length}))}while(this.opts.loadAllFiles&&this.nextPagePath);this.plugin.setPluginState({folders:l,files:a,breadcrumbs:s,filterInput:\"\"})})}catch(r){this.handleError(r)}finally{this.setLoading(!1)}}getNextFolder(e){this.getFolder(e.requestPath,e.name),this.lastCheckbox=void 0}async logout(){try{await Jt(this,_r)[_r](async e=>{let t=await this.provider.logout({signal:e});if(t.ok){if(!t.revoked){let s=this.plugin.uppy.i18n(\"companionUnauthorizeHint\",{provider:this.plugin.title,url:t.manual_revoke_url});this.plugin.uppy.info(s,\"info\",7e3)}let r={authenticated:!1,files:[],folders:[],breadcrumbs:[],filterInput:\"\"};this.plugin.setPluginState(r)}})}catch(e){this.handleError(e)}}filterQuery(e){this.plugin.setPluginState({filterInput:e})}clearFilter(){this.plugin.setPluginState({filterInput:\"\"})}async handleAuth(){let e=`@uppy/provider-views=${Te.VERSION}`;try{await this.provider.login({uppyVersions:e}),this.plugin.setPluginState({authenticated:!0}),this.preFirstRender()}catch(t){this.plugin.uppy.log(`login failed: ${t.message}`)}}async handleScroll(e){if(this.shouldHandleScroll(e)&&this.nextPagePath){this.isHandlingScroll=!0;try{await Jt(this,_r)[_r](async t=>{let{files:r,folders:s,breadcrumbs:o}=this.plugin.getPluginState(),{files:a,folders:l}=await Jt(this,Gn)[Gn]({breadcrumbs:o,signal:t}),h=r.concat(a),p=s.concat(l);this.plugin.setPluginState({folders:p,files:h})})}catch(t){this.handleError(t)}finally{this.isHandlingScroll=!1}}}async donePicking(){this.setLoading(!0);try{await Jt(this,_r)[_r](async e=>{let{currentSelection:t}=this.plugin.getPluginState(),r=[],s=[];for(let o of t){let{requestPath:a}=o,l=n(h=>({...h,relDirPath:h.absDirPath.replace(o.absDirPath,\"\").replace(/^\\//,\"\")}),\"withRelDirPath\");if(o.isFolder){let h=!0,p=0,d=new qm({concurrency:6}),f=n(b=>{for(let S of b){let E=this.getTagFile(S),x=Dl(E);this.plugin.uppy.checkIfFileAlreadyExists(x)||(s.push(l(S)),p++,this.setLoading(this.plugin.uppy.i18n(\"addedNumFiles\",{numFiles:p}))),h=!1}},\"onFiles\");await Jt(this,Kn)[Kn]({requestPath:a,absDirPath:ed(o.absDirPath,o.name),relDirPath:o.name,queue:d,onFiles:f,signal:e}),await d.onIdle();let y;h?y=this.plugin.uppy.i18n(\"emptyFolderAdded\"):p===0?y=this.plugin.uppy.i18n(\"folderAlreadyAdded\",{folder:o.name}):y=this.plugin.uppy.i18n(\"folderAdded\",{smart_count:p,folder:o.name}),r.push(y)}else s.push(l(o))}this.plugin.uppy.log(\"Adding files from a remote provider\"),this.plugin.uppy.addFiles(s.map(o=>this.getTagFile(o))),this.plugin.setPluginState({filterInput:\"\"}),r.forEach(o=>this.plugin.uppy.info(o)),this.clearSelection()})}catch(e){this.handleError(e)}finally{this.setLoading(!1)}}render(e,t){var r=this;t===void 0&&(t={});let{authenticated:s,didFirstRender:o}=this.plugin.getPluginState(),{i18n:a}=this.plugin.uppy;o||this.preFirstRender();let l={...this.opts,...t},{files:h,folders:p,filterInput:d,loading:f,currentSelection:y}=this.plugin.getPluginState(),{isChecked:b,toggleCheckbox:S,recordShiftKeyPress:E,filterItems:x}=this,F=d!==\"\",U=this.plugin.icon||ko,j={showBreadcrumbs:l.showBreadcrumbs,getFolder:this.getFolder,breadcrumbs:this.plugin.getPluginState().breadcrumbs,pluginIcon:U,title:this.plugin.title,logout:this.logout,username:this.username,i18n:a},G={isChecked:b,toggleCheckbox:S,recordShiftKeyPress:E,currentSelection:y,files:F?x(h):h,folders:F?x(p):p,username:this.username,getNextFolder:this.getNextFolder,getFolder:this.getFolder,loadAllFiles:this.opts.loadAllFiles,showSearchFilter:l.showFilter,search:this.filterQuery,clearSearch:this.clearFilter,searchTerm:d,searchOnInput:!0,searchInputLabel:a(\"filter\"),clearSearchLabel:a(\"resetFilter\"),noResultsLabel:a(\"noFilesFound\"),logout:this.logout,handleScroll:this.handleScroll,done:this.donePicking,cancel:this.cancelPicking,headerComponent:Km(j),title:this.plugin.title,viewType:l.viewType,showTitles:l.showTitles,showBreadcrumbs:l.showBreadcrumbs,pluginIcon:U,i18n:this.plugin.uppy.i18n,uppyFiles:this.plugin.uppy.getFiles(),validateRestrictions:function(){return r.plugin.uppy.validateRestrictions(...arguments)}};return f?u(Ei,{onUnmount:this.clearSelection},u(dg,{i18n:this.plugin.uppy.i18n,loading:f})):s?u(Ei,{onUnmount:this.clearSelection},u(cu,G)):u(Ei,{onUnmount:this.clearSelection},u(Vm,{pluginName:this.plugin.title,pluginIcon:U,handleAuth:this.handleAuth,i18n:this.plugin.uppy.i18n,i18nArray:this.plugin.uppy.i18nArray}))}};n(Te,\"ProviderView\");async function l2(i){var e;(e=Jt(this,Cs)[Cs])==null||e.abort();let t=new AbortController;Jt(this,Cs)[Cs]=t;let r=n(()=>{t.abort(),this.clearSelection()},\"cancelRequest\");try{this.plugin.uppy.on(\"dashboard:close-panel\",r),this.plugin.uppy.on(\"cancel-all\",r),await i(t.signal)}finally{this.plugin.uppy.off(\"dashboard:close-panel\",r),this.plugin.uppy.off(\"cancel-all\",r),Jt(this,Cs)[Cs]=void 0}}n(l2,\"_withAbort2\");async function u2(i){let{requestPath:e,absDirPath:t,signal:r}=i,{username:s,nextPagePath:o,items:a}=await this.provider.list(e,{signal:r});return this.username=s||this.username,{items:a.map(l=>({...l,absDirPath:t})),nextPagePath:o}}n(u2,\"_list2\");async function h2(i){let{breadcrumbs:e,signal:t}=i,r=a2(e),{items:s,nextPagePath:o}=await Jt(this,Xn)[Xn]({requestPath:this.nextPagePath,absDirPath:r,signal:t});this.nextPagePath=o;let a=[],l=[];return s.forEach(h=>{h.isFolder?l.push(h):a.push(h)}),{files:a,folders:l}}n(h2,\"_listFilesAndFolders2\");async function d2(i){let{requestPath:e,absDirPath:t,relDirPath:r,queue:s,onFiles:o,signal:a}=i,l=e;for(;l;){let h=await Jt(this,Xn)[Xn]({requestPath:l,absDirPath:t,signal:a});l=h.nextPagePath;let p=h.items.filter(y=>!y.isFolder),d=h.items.filter(y=>y.isFolder);o(p);let f=d.map(async y=>s.add(async()=>Jt(this,Kn)[Kn]({requestPath:y.requestPath,absDirPath:ed(t,y.name),relDirPath:ed(r,y.name),queue:s,onFiles:o,signal:a})));await Promise.all(f)}}n(d2,\"_recursivelyListAllFiles2\");Te.VERSION=n2.version;function cg(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(cg,\"_classPrivateFieldLooseBase\");var c2=0;function p2(i){return\"__private_\"+c2+++\"_\"+i}n(p2,\"_classPrivateFieldLooseKey\");var f2={version:\"3.7.0\"},Qn=p2(\"updateFilesAndInputMode\"),ji=class extends Zr{constructor(e,t){super(e,t),Object.defineProperty(this,Qn,{value:m2});let r={viewType:\"grid\",showTitles:!1,showFilter:!1,showBreadcrumbs:!1};this.opts={...r,...t},this.search=this.search.bind(this),this.clearSearch=this.clearSearch.bind(this),this.resetPluginState=this.resetPluginState.bind(this),this.handleScroll=this.handleScroll.bind(this),this.donePicking=this.donePicking.bind(this),this.render=this.render.bind(this),this.defaultState={isInputMode:!0,files:[],folders:[],breadcrumbs:[],filterInput:\"\",currentSelection:[],searchTerm:null},this.plugin.setPluginState(this.defaultState)}tearDown(){}resetPluginState(){this.plugin.setPluginState(this.defaultState)}async search(e){let{searchTerm:t}=this.plugin.getPluginState();if(!(e&&e===t)){this.setLoading(!0);try{let r=await this.provider.search(e);cg(this,Qn)[Qn](r,[])}catch(r){this.handleError(r)}finally{this.setLoading(!1)}}}clearSearch(){this.plugin.setPluginState({currentSelection:[],files:[],searchTerm:null})}async handleScroll(e){let t=this.nextPageQuery||null;if(this.shouldHandleScroll(e)&&t){this.isHandlingScroll=!0;try{let{files:r,searchTerm:s}=this.plugin.getPluginState(),o=await this.provider.search(s,t);cg(this,Qn)[Qn](o,r)}catch(r){this.handleError(r)}finally{this.isHandlingScroll=!1}}}donePicking(){let{currentSelection:e}=this.plugin.getPluginState();this.plugin.uppy.log(\"Adding remote search provider files\"),this.plugin.uppy.addFiles(e.map(t=>this.getTagFile(t))),this.resetPluginState()}render(e,t){var r=this;t===void 0&&(t={});let{didFirstRender:s,isInputMode:o,searchTerm:a}=this.plugin.getPluginState(),{i18n:l}=this.plugin.uppy;s||this.preFirstRender();let h={...this.opts,...t},{files:p,folders:d,filterInput:f,loading:y,currentSelection:b}=this.plugin.getPluginState(),{isChecked:S,toggleCheckbox:E,filterItems:x,recordShiftKeyPress:F}=this,U=f!==\"\",j={isChecked:S,toggleCheckbox:E,recordShiftKeyPress:F,currentSelection:b,files:U?x(p):p,folders:U?x(d):d,handleScroll:this.handleScroll,done:this.donePicking,cancel:this.cancelPicking,showSearchFilter:h.showFilter,search:this.search,clearSearch:this.clearSearch,searchTerm:a,searchOnInput:!1,searchInputLabel:l(\"search\"),clearSearchLabel:l(\"resetSearch\"),noResultsLabel:l(\"noSearchResults\"),title:this.plugin.title,viewType:h.viewType,showTitles:h.showTitles,showFilter:h.showFilter,isLoading:y,showBreadcrumbs:h.showBreadcrumbs,pluginIcon:this.plugin.icon,i18n:l,uppyFiles:this.plugin.uppy.getFiles(),validateRestrictions:function(){return r.plugin.uppy.validateRestrictions(...arguments)}};return o?u(Ei,{onUnmount:this.resetPluginState},u(\"div\",{className:\"uppy-SearchProvider\"},u(Vn,{search:this.search,clearSelection:this.clearSelection,inputLabel:l(\"enterTextToSearch\"),buttonLabel:l(\"searchImages\"),inputClassName:\"uppy-c-textInput uppy-SearchProvider-input\",buttonCSSClassName:\"uppy-SearchProvider-searchButton\",showButton:!0}))):u(Ei,{onUnmount:this.resetPluginState},u(cu,j))}};n(ji,\"SearchProviderView\");function m2(i,e){this.nextPageQuery=i.nextPageQuery,i.items.forEach(t=>{e.push(t)}),this.plugin.setPluginState({currentSelection:[],isInputMode:!1,files:e,searchTerm:i.searchedFor})}n(m2,\"_updateFilesAndInputMode2\");ji.VERSION=f2.version;var pg;function Hi(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(Hi,\"_classPrivateFieldLooseBase\");var g2=0;function id(i){return\"__private_\"+g2+++\"_\"+i}n(id,\"_classPrivateFieldLooseKey\");var y2={version:\"3.0.5\"},v2=\"uppy/STATE_UPDATE\",b2=n(i=>e=>e.uppy[i],\"defaultSelector\");function w2(i,e){let t=Object.keys(e),r={};return t.forEach(s=>{i[s]!==e[s]&&(r[s]=e[s])}),r}n(w2,\"getPatch\");var xr=id(\"id\"),Jn=id(\"selector\"),Fr=id(\"store\");pg=Symbol.for(\"uppy test: get id\");var Zn=class{constructor(e){Object.defineProperty(this,xr,{writable:!0,value:void 0}),Object.defineProperty(this,Jn,{writable:!0,value:void 0}),Object.defineProperty(this,Fr,{writable:!0,value:void 0}),Hi(this,Fr)[Fr]=e.store,Hi(this,xr)[xr]=e.id||Pt(),Hi(this,Jn)[Jn]=e.selector||b2(Hi(this,xr)[xr]),this.setState({})}setState(e){Hi(this,Fr)[Fr].dispatch({type:v2,id:Hi(this,xr)[xr],payload:e})}getState(){return Hi(this,Jn)[Jn](Hi(this,Fr)[Fr].getState())}subscribe(e){let t=this.getState();return Hi(this,Fr)[Fr].subscribe(()=>{let r=this.getState();if(t!==r){let s=w2(t,r);e(t,r,s),t=r}})}[pg](){return Hi(this,xr)[xr]}};n(Zn,\"ReduxStore\");Zn.VERSION=y2.version;var fg=Zn;function pu(i,e,t,r){return t===0||i===e?i:r===0?e:i+(e-i)*2**(-r/t)}n(pu,\"emaFilter\");var Ut={STATE_ERROR:\"error\",STATE_WAITING:\"waiting\",STATE_PREPROCESSING:\"preprocessing\",STATE_UPLOADING:\"uploading\",STATE_POSTPROCESSING:\"postprocessing\",STATE_COMPLETE:\"complete\"};var ud=de(Qt(),1);function ea(i){let e=[],t,r;for(let{progress:o}of Object.values(i)){let{preprocess:a,postprocess:l}=o;r==null&&(a||l)&&({mode:t,message:r}=a||l),a?.mode===\"determinate\"&&e.push(a.value),l?.mode===\"determinate\"&&e.push(l.value)}let s=e.reduce((o,a)=>o+a/e.length,0);return{mode:t,message:r,value:s}}n(ea,\"calculateProcessingProgress\");var nd=de(Qt(),1),od=de(Il(),1);function rd(i){let e=Math.floor(i/3600)%24,t=Math.floor(i/60)%60,r=Math.floor(i%60);return{hours:e,minutes:t,seconds:r}}n(rd,\"secondsToTime\");function sd(i){let e=rd(i),t=e.hours===0?\"\":`${e.hours}h`,r=e.minutes===0?\"\":`${e.hours===0?e.minutes:` ${e.minutes.toString(10).padStart(2,\"0\")}`}m`,s=e.hours!==0?\"\":`${e.minutes===0?e.seconds:` ${e.seconds.toString(10).padStart(2,\"0\")}`}s`;return`${t}${r}${s}`}n(sd,\"prettyETA\");var S2=\"\\xB7\",mg=n(()=>` ${S2} `,\"renderDot\");function gg(i){let{newFiles:e,isUploadStarted:t,recoveredState:r,i18n:s,uploadState:o,isSomeGhost:a,startUpload:l}=i,h=(0,nd.default)(\"uppy-u-reset\",\"uppy-c-btn\",\"uppy-StatusBar-actionBtn\",\"uppy-StatusBar-actionBtn--upload\",{\"uppy-c-btn-primary\":o===Ut.STATE_WAITING},{\"uppy-StatusBar-actionBtn--disabled\":a}),p=e&&t&&!r?s(\"uploadXNewFiles\",{smart_count:e}):s(\"uploadXFiles\",{smart_count:e});return u(\"button\",{type:\"button\",className:h,\"aria-label\":s(\"uploadXFiles\",{smart_count:e}),onClick:l,disabled:a,\"data-uppy-super-focusable\":!0},p)}n(gg,\"UploadBtn\");function yg(i){let{i18n:e,uppy:t}=i;return u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry\",\"aria-label\":e(\"retryUpload\"),onClick:()=>t.retryAll().catch(()=>{}),\"data-uppy-super-focusable\":!0,\"data-cy\":\"retry\"},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"8\",height:\"10\",viewBox:\"0 0 8 10\"},u(\"path\",{d:\"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z\"})),e(\"retry\"))}n(yg,\"RetryBtn\");function vg(i){let{i18n:e,uppy:t}=i;return u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-StatusBar-actionCircleBtn\",title:e(\"cancel\"),\"aria-label\":e(\"cancel\"),onClick:()=>t.cancelAll(),\"data-cy\":\"cancel\",\"data-uppy-super-focusable\":!0},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"16\",height:\"16\",viewBox:\"0 0 16 16\"},u(\"g\",{fill:\"none\",fillRule:\"evenodd\"},u(\"circle\",{fill:\"#888\",cx:\"8\",cy:\"8\",r:\"8\"}),u(\"path\",{fill:\"#FFF\",d:\"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z\"}))))}n(vg,\"CancelBtn\");function bg(i){let{isAllPaused:e,i18n:t,isAllComplete:r,resumableUploads:s,uppy:o}=i,a=t(e?\"resume\":\"pause\");function l(){return r?null:s?e?o.resumeAll():o.pauseAll():o.cancelAll()}return n(l,\"togglePauseResume\"),u(\"button\",{title:a,\"aria-label\":a,className:\"uppy-u-reset uppy-StatusBar-actionCircleBtn\",type:\"button\",onClick:l,\"data-cy\":\"togglePauseResume\",\"data-uppy-super-focusable\":!0},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"16\",height:\"16\",viewBox:\"0 0 16 16\"},u(\"g\",{fill:\"none\",fillRule:\"evenodd\"},u(\"circle\",{fill:\"#888\",cx:\"8\",cy:\"8\",r:\"8\"}),u(\"path\",{fill:\"#FFF\",d:e?\"M6 4.25L11.5 8 6 11.75z\":\"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z\"}))))}n(bg,\"PauseResumeButton\");function wg(i){let{i18n:e,doneButtonHandler:t}=i;return u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done\",onClick:t,\"data-uppy-super-focusable\":!0},e(\"done\"))}n(wg,\"DoneBtn\");function Sg(){return u(\"svg\",{className:\"uppy-StatusBar-spinner\",\"aria-hidden\":\"true\",focusable:\"false\",width:\"14\",height:\"14\"},u(\"path\",{d:\"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0\",fillRule:\"evenodd\"}))}n(Sg,\"LoadingSpinner\");function Pg(i){let{progress:e}=i,{value:t,mode:r,message:s}=e,o=Math.round(t*100),a=\"\\xB7\";return u(\"div\",{className:\"uppy-StatusBar-content\"},u(Sg,null),r===\"determinate\"?`${o}% ${a} `:\"\",s)}n(Pg,\"ProgressBarProcessing\");function P2(i){let{numUploads:e,complete:t,totalUploadedSize:r,totalSize:s,totalETA:o,i18n:a}=i,l=e>1;return u(\"div\",{className:\"uppy-StatusBar-statusSecondary\"},l&&a(\"filesUploadedOfTotal\",{complete:t,smart_count:e}),u(\"span\",{className:\"uppy-StatusBar-additionalInfo\"},l&&mg(),a(\"dataUploadedOfTotal\",{complete:(0,od.default)(r),total:(0,od.default)(s)}),mg(),a(\"xTimeLeft\",{time:sd(o)})))}n(P2,\"ProgressDetails\");function _g(i){let{i18n:e,complete:t,numUploads:r}=i;return u(\"div\",{className:\"uppy-StatusBar-statusSecondary\"},e(\"filesUploadedOfTotal\",{complete:t,smart_count:r}))}n(_g,\"FileUploadCount\");function _2(i){let{i18n:e,newFiles:t,startUpload:r}=i,s=(0,nd.default)(\"uppy-u-reset\",\"uppy-c-btn\",\"uppy-StatusBar-actionBtn\",\"uppy-StatusBar-actionBtn--uploadNewlyAdded\");return u(\"div\",{className:\"uppy-StatusBar-statusSecondary\"},u(\"div\",{className:\"uppy-StatusBar-statusSecondaryHint\"},e(\"xMoreFilesAdded\",{smart_count:t})),u(\"button\",{type:\"button\",className:s,\"aria-label\":e(\"uploadXFiles\",{smart_count:t}),onClick:r},e(\"upload\")))}n(_2,\"UploadNewlyAddedFiles\");function xg(i){let{i18n:e,supportsUploadProgress:t,totalProgress:r,showProgressDetails:s,isUploadStarted:o,isAllComplete:a,isAllPaused:l,newFiles:h,numUploads:p,complete:d,totalUploadedSize:f,totalSize:y,totalETA:b,startUpload:S}=i,E=h&&o;if(!o||a)return null;let x=e(l?\"paused\":\"uploading\");function F(){return!l&&!E&&s?t?u(P2,{numUploads:p,complete:d,totalUploadedSize:f,totalSize:y,totalETA:b,i18n:e}):u(_g,{i18n:e,complete:d,numUploads:p}):null}return n(F,\"renderProgressDetails\"),u(\"div\",{className:\"uppy-StatusBar-content\",\"aria-label\":x,title:x},l?null:u(Sg,null),u(\"div\",{className:\"uppy-StatusBar-status\"},u(\"div\",{className:\"uppy-StatusBar-statusPrimary\"},t?`${x}: ${r}%`:x),F(),E?u(_2,{i18n:e,newFiles:h,startUpload:S}):null))}n(xg,\"ProgressBarUploading\");function Fg(i){let{i18n:e}=i;return u(\"div\",{className:\"uppy-StatusBar-content\",role:\"status\",title:e(\"complete\")},u(\"div\",{className:\"uppy-StatusBar-status\"},u(\"div\",{className:\"uppy-StatusBar-statusPrimary\"},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-StatusBar-statusIndicator uppy-c-icon\",width:\"15\",height:\"11\",viewBox:\"0 0 15 11\"},u(\"path\",{d:\"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z\"})),e(\"complete\"))))}n(Fg,\"ProgressBarComplete\");function Eg(i){let{error:e,i18n:t,complete:r,numUploads:s}=i;function o(){let a=`${t(\"uploadFailed\")} \n\n ${e}`;alert(a)}return n(o,\"displayErrorAlert\"),u(\"div\",{className:\"uppy-StatusBar-content\",title:t(\"uploadFailed\")},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-StatusBar-statusIndicator uppy-c-icon\",width:\"11\",height:\"11\",viewBox:\"0 0 11 11\"},u(\"path\",{d:\"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z\"})),u(\"div\",{className:\"uppy-StatusBar-status\"},u(\"div\",{className:\"uppy-StatusBar-statusPrimary\"},t(\"uploadFailed\"),u(\"button\",{className:\"uppy-u-reset uppy-StatusBar-details\",\"aria-label\":t(\"showErrorDetails\"),\"data-microtip-position\":\"top-right\",\"data-microtip-size\":\"medium\",onClick:o,type:\"button\"},\"?\")),u(_g,{i18n:t,complete:r,numUploads:s})))}n(Eg,\"ProgressBarError\");var{STATE_ERROR:Og,STATE_WAITING:Cg,STATE_PREPROCESSING:ad,STATE_UPLOADING:fu,STATE_POSTPROCESSING:ld,STATE_COMPLETE:mu}=Ut;function hd(i){let{newFiles:e,allowNewUpload:t,isUploadInProgress:r,isAllPaused:s,resumableUploads:o,error:a,hideUploadButton:l,hidePauseResumeButton:h,hideCancelButton:p,hideRetryButton:d,recoveredState:f,uploadState:y,totalProgress:b,files:S,supportsUploadProgress:E,hideAfterFinish:x,isSomeGhost:F,doneButtonHandler:U,isUploadStarted:j,i18n:G,startUpload:J,uppy:B,isAllComplete:z,showProgressDetails:K,numUploads:oe,complete:Be,totalSize:Je,totalETA:wt,totalUploadedSize:We}=i;function _e(){switch(y){case ld:case ad:{let re=ea(S);return re.mode===\"determinate\"?re.value*100:b}case Og:return null;case fu:return E?b:null;default:return b}}n(_e,\"getProgressValue\");function ze(){switch(y){case ld:case ad:{let{mode:re}=ea(S);return re===\"indeterminate\"}case fu:return!E;default:return!1}}n(ze,\"getIsIndeterminate\");function xe(){if(f)return!1;switch(y){case Cg:return l||e===0;case mu:return x;default:return!1}}n(xe,\"getIsHidden\");let ui=_e(),V=xe(),R=ui??100,I=!a&&e&&!r&&!s&&t&&!l,L=!p&&y!==Cg&&y!==mu,Q=o&&!h&&y===fu,X=a&&!z&&!d,ye=U&&y===mu,pe=(0,ud.default)(\"uppy-StatusBar-progress\",{\"is-indeterminate\":ze()}),ne=(0,ud.default)(\"uppy-StatusBar\",`is-${y}`,{\"has-ghosts\":F});return u(\"div\",{className:ne,\"aria-hidden\":V},u(\"div\",{className:pe,style:{width:`${R}%`},role:\"progressbar\",\"aria-label\":`${R}%`,\"aria-valuetext\":`${R}%`,\"aria-valuemin\":\"0\",\"aria-valuemax\":\"100\",\"aria-valuenow\":ui}),(()=>{switch(y){case ad:case ld:return u(Pg,{progress:ea(S)});case mu:return u(Fg,{i18n:G});case Og:return u(Eg,{error:a,i18n:G,numUploads:oe,complete:Be});case fu:return u(xg,{i18n:G,supportsUploadProgress:E,totalProgress:b,showProgressDetails:K,isUploadStarted:j,isAllComplete:z,isAllPaused:s,newFiles:e,numUploads:oe,complete:Be,totalUploadedSize:We,totalSize:Je,totalETA:wt,startUpload:J});default:return null}})(),u(\"div\",{className:\"uppy-StatusBar-actions\"},f||I?u(gg,{newFiles:e,isUploadStarted:j,recoveredState:f,i18n:G,isSomeGhost:F,startUpload:J,uploadState:y}):null,X?u(yg,{i18n:G,uppy:B}):null,Q?u(bg,{isAllPaused:s,i18n:G,isAllComplete:z,resumableUploads:o,uppy:B}):null,L?u(vg,{i18n:G,uppy:B}):null,ye?u(wg,{i18n:G,doneButtonHandler:U}):null))}n(hd,\"StatusBar\");var Tg={strings:{uploading:\"Uploading\",complete:\"Complete\",uploadFailed:\"Upload failed\",paused:\"Paused\",retry:\"Retry\",cancel:\"Cancel\",pause:\"Pause\",resume:\"Resume\",done:\"Done\",filesUploadedOfTotal:{0:\"%{complete} of %{smart_count} file uploaded\",1:\"%{complete} of %{smart_count} files uploaded\"},dataUploadedOfTotal:\"%{complete} of %{total}\",xTimeLeft:\"%{time} left\",uploadXFiles:{0:\"Upload %{smart_count} file\",1:\"Upload %{smart_count} files\"},uploadXNewFiles:{0:\"Upload +%{smart_count} file\",1:\"Upload +%{smart_count} files\"},upload:\"Upload\",retryUpload:\"Retry upload\",xMoreFilesAdded:{0:\"%{smart_count} more file added\",1:\"%{smart_count} more files added\"},showErrorDetails:\"Show error details\"}};function ke(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(ke,\"_classPrivateFieldLooseBase\");var x2=0;function Do(i){return\"__private_\"+x2+++\"_\"+i}n(Do,\"_classPrivateFieldLooseKey\");var F2={version:\"3.2.5\"},E2=2e3,O2=2e3;function C2(i,e,t,r){if(i)return Ut.STATE_ERROR;if(e)return Ut.STATE_COMPLETE;if(t)return Ut.STATE_WAITING;let s=Ut.STATE_WAITING,o=Object.keys(r);for(let a=0;a<o.length;a++){let{progress:l}=r[o[a]];if(l.uploadStarted&&!l.uploadComplete)return Ut.STATE_UPLOADING;l.preprocess&&s!==Ut.STATE_UPLOADING&&(s=Ut.STATE_PREPROCESSING),l.postprocess&&s!==Ut.STATE_UPLOADING&&s!==Ut.STATE_PREPROCESSING&&(s=Ut.STATE_POSTPROCESSING)}return s}n(C2,\"getUploadingState\");var fi=Do(\"lastUpdateTime\"),Oi=Do(\"previousUploadedBytes\"),Er=Do(\"previousSpeed\"),Zt=Do(\"previousETA\"),dd=Do(\"computeSmoothETA\"),ta=Do(\"onUploadStart\"),$i=class extends Z{constructor(e,t){super(e,t),Object.defineProperty(this,dd,{value:T2}),Object.defineProperty(this,fi,{writable:!0,value:void 0}),Object.defineProperty(this,Oi,{writable:!0,value:void 0}),Object.defineProperty(this,Er,{writable:!0,value:void 0}),Object.defineProperty(this,Zt,{writable:!0,value:void 0}),this.startUpload=()=>this.uppy.upload().catch(()=>{}),Object.defineProperty(this,ta,{writable:!0,value:()=>{let{recoveredState:s}=this.uppy.getState();if(ke(this,Er)[Er]=null,ke(this,Zt)[Zt]=null,s){ke(this,Oi)[Oi]=Object.values(s.files).reduce((o,a)=>{let{progress:l}=a;return o+l.bytesUploaded},0),this.uppy.emit(\"restore-confirmed\");return}ke(this,fi)[fi]=performance.now(),ke(this,Oi)[Oi]=0}}),this.id=this.opts.id||\"StatusBar\",this.title=\"StatusBar\",this.type=\"progressindicator\",this.defaultLocale=Tg;let r={target:\"body\",hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null};this.opts={...r,...t},this.i18nInit(),this.render=this.render.bind(this),this.install=this.install.bind(this)}render(e){let{capabilities:t,files:r,allowNewUpload:s,totalProgress:o,error:a,recoveredState:l}=e,{newFiles:h,startedFiles:p,completeFiles:d,isUploadStarted:f,isAllComplete:y,isAllErrored:b,isAllPaused:S,isUploadInProgress:E,isSomeGhost:x}=this.uppy.getObjectOfFilesPerState(),F=l?Object.values(r):h,U=!!t.resumableUploads,j=t.uploadProgress!==!1,G=0,J=0;p.forEach(z=>{G+=z.progress.bytesTotal||0,J+=z.progress.bytesUploaded||0});let B=ke(this,dd)[dd]({uploaded:J,total:G,remaining:G-J});return hd({error:a,uploadState:C2(a,y,l,e.files||{}),allowNewUpload:s,totalProgress:o,totalSize:G,totalUploadedSize:J,isAllComplete:!1,isAllPaused:S,isAllErrored:b,isUploadStarted:f,isUploadInProgress:E,isSomeGhost:x,recoveredState:l,complete:d.length,newFiles:F.length,numUploads:p.length,totalETA:B,files:r,i18n:this.i18n,uppy:this.uppy,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:U,supportsUploadProgress:j,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish,isTargetDOMEl:this.isTargetDOMEl})}onMount(){let e=this.el;Hl(e)||(e.dir=\"ltr\")}install(){let{target:e}=this.opts;e&&this.mount(e,this),this.uppy.on(\"upload\",ke(this,ta)[ta]),ke(this,fi)[fi]=performance.now(),ke(this,Oi)[Oi]=this.uppy.getFiles().reduce((t,r)=>t+r.progress.bytesUploaded,0)}uninstall(){this.unmount(),this.uppy.off(\"upload\",ke(this,ta)[ta])}};n($i,\"StatusBar\");function T2(i){var e,t;if(i.total===0||i.remaining===0)return 0;(t=(e=ke(this,fi))[fi])!=null||(e[fi]=performance.now());let r=performance.now()-ke(this,fi)[fi];if(r===0){var s;return Math.round(((s=ke(this,Zt)[Zt])!=null?s:0)/100)/10}let o=i.uploaded-ke(this,Oi)[Oi];if(ke(this,Oi)[Oi]=i.uploaded,o<=0){var a;return Math.round(((a=ke(this,Zt)[Zt])!=null?a:0)/100)/10}let l=o/r,h=ke(this,Er)[Er]==null?l:pu(l,ke(this,Er)[Er],E2,r);ke(this,Er)[Er]=h;let p=i.remaining/h,d=Math.max(ke(this,Zt)[Zt]-r,0),f=ke(this,Zt)[Zt]==null?p:pu(p,d,O2,r);return ke(this,Zt)[Zt]=f,ke(this,fi)[fi]=performance.now(),Math.round(f/100)/10}n(T2,\"_computeSmoothETA2\");$i.VERSION=F2.version;var Ag=300,Io=class extends we{constructor(){super(...arguments),this.ref=um()}componentWillEnter(e){this.ref.current.style.opacity=\"1\",this.ref.current.style.transform=\"none\",setTimeout(e,Ag)}componentWillLeave(e){this.ref.current.style.opacity=\"0\",this.ref.current.style.transform=\"translateY(350%)\",setTimeout(e,Ag)}render(){let{children:e}=this.props;return u(\"div\",{className:\"uppy-Informer-animated\",ref:this.ref},e)}};n(Io,\"FadeIn\");function A2(i,e){return Object.assign(i,e)}n(A2,\"assign\");function R2(i,e){var t;return(t=i?.key)!=null?t:e}n(R2,\"getKey\");function U2(i,e){let t=i._ptgLinkedRefs||(i._ptgLinkedRefs={});return t[e]||(t[e]=r=>{i.refs[e]=r})}n(U2,\"linkRef\");function ia(i){let e={};for(let t=0;t<i.length;t++)if(i[t]!=null){let r=R2(i[t],t.toString(36));e[r]=i[t]}return e}n(ia,\"getChildMapping\");function k2(i,e){i=i||{},e=e||{};let t=n(a=>e.hasOwnProperty(a)?e[a]:i[a],\"getValueForKey\"),r={},s=[];for(let a in i)e.hasOwnProperty(a)?s.length&&(r[a]=s,s=[]):s.push(a);let o={};for(let a in e){if(r.hasOwnProperty(a))for(let l=0;l<r[a].length;l++){let h=r[a][l];o[r[a][l]]=t(h)}o[a]=t(a)}for(let a=0;a<s.length;a++)o[s[a]]=t(s[a]);return o}n(k2,\"mergeChildMappings\");var D2=n(i=>i,\"identity\"),ra=class extends we{constructor(e,t){super(e,t),this.refs={},this.state={children:ia(ci(ci(this.props.children))||[])},this.performAppear=this.performAppear.bind(this),this.performEnter=this.performEnter.bind(this),this.performLeave=this.performLeave.bind(this)}componentWillMount(){this.currentlyTransitioningKeys={},this.keysToAbortLeave=[],this.keysToEnter=[],this.keysToLeave=[]}componentDidMount(){let e=this.state.children;for(let t in e)e[t]&&this.performAppear(t)}componentWillReceiveProps(e){let t=ia(ci(e.children)||[]),r=this.state.children;this.setState(o=>({children:k2(o.children,t)}));let s;for(s in t)if(t.hasOwnProperty(s)){let o=r&&r.hasOwnProperty(s);t[s]&&o&&this.currentlyTransitioningKeys[s]?(this.keysToEnter.push(s),this.keysToAbortLeave.push(s)):t[s]&&!o&&!this.currentlyTransitioningKeys[s]&&this.keysToEnter.push(s)}for(s in r)if(r.hasOwnProperty(s)){let o=t&&t.hasOwnProperty(s);r[s]&&!o&&!this.currentlyTransitioningKeys[s]&&this.keysToLeave.push(s)}}componentDidUpdate(){let{keysToEnter:e}=this;this.keysToEnter=[],e.forEach(this.performEnter);let{keysToLeave:t}=this;this.keysToLeave=[],t.forEach(this.performLeave)}_finishAbort(e){let t=this.keysToAbortLeave.indexOf(e);t!==-1&&this.keysToAbortLeave.splice(t,1)}performAppear(e){this.currentlyTransitioningKeys[e]=!0;let t=this.refs[e];t!=null&&t.componentWillAppear?t.componentWillAppear(this._handleDoneAppearing.bind(this,e)):this._handleDoneAppearing(e)}_handleDoneAppearing(e){let t=this.refs[e];t!=null&&t.componentDidAppear&&t.componentDidAppear(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);let r=ia(ci(this.props.children)||[]);(!r||!r.hasOwnProperty(e))&&this.performLeave(e)}performEnter(e){this.currentlyTransitioningKeys[e]=!0;let t=this.refs[e];t!=null&&t.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)}_handleDoneEntering(e){let t=this.refs[e];t!=null&&t.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);let r=ia(ci(this.props.children)||[]);(!r||!r.hasOwnProperty(e))&&this.performLeave(e)}performLeave(e){if(this.keysToAbortLeave.indexOf(e)!==-1)return;this.currentlyTransitioningKeys[e]=!0;let r=this.refs[e];r!=null&&r.componentWillLeave?r.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)}_handleDoneLeaving(e){if(this.keysToAbortLeave.indexOf(e)!==-1)return;let r=this.refs[e];r!=null&&r.componentDidLeave&&r.componentDidLeave(),delete this.currentlyTransitioningKeys[e];let s=ia(ci(this.props.children)||[]);if(s&&s.hasOwnProperty(e))this.performEnter(e);else{let o=A2({},this.state.children);delete o[e],this.setState({children:o})}}render(e,t){let{childFactory:r,transitionLeave:s,transitionName:o,transitionAppear:a,transitionEnter:l,transitionLeaveTimeout:h,transitionEnterTimeout:p,transitionAppearTimeout:d,component:f,...y}=e,{children:b}=t,S=Object.entries(b).map(E=>{let[x,F]=E;if(!F)return;let U=U2(this,x);return jl(r(F),{ref:U,key:x})}).filter(Boolean);return u(f,y,S)}};n(ra,\"TransitionGroup\");ra.defaultProps={component:\"span\",childFactory:D2};var Rg=ra;var I2={version:\"3.0.4\"},qi=class extends Z{constructor(e,t){super(e,t),this.render=s=>u(\"div\",{className:\"uppy uppy-Informer\"},u(Rg,null,s.info.map(o=>u(Io,{key:o.message},u(\"p\",{role:\"alert\"},o.message,\" \",o.details&&u(\"span\",{\"aria-label\":o.details,\"data-microtip-position\":\"top-left\",\"data-microtip-size\":\"medium\",role:\"tooltip\",onClick:()=>alert(`${o.message} \n\n ${o.details}`)},\"?\")))))),this.type=\"progressindicator\",this.id=this.opts.id||\"Informer\",this.title=\"Informer\";let r={};this.opts={...r,...t}}install(){let{target:e}=this.opts;e&&this.mount(e,this)}};n(qi,\"Informer\");qi.VERSION=I2.version;var N2=/^data:([^/]+\\/[^,;]+(?:[^,]*?))(;base64)?,([\\s\\S]*)$/;function cd(i,e,t){var r,s;let o=N2.exec(i),a=(r=(s=e.mimeType)!=null?s:o?.[1])!=null?r:\"plain/text\",l;if(o?.[2]!=null){let h=atob(decodeURIComponent(o[3])),p=new Uint8Array(h.length);for(let d=0;d<h.length;d++)p[d]=h.charCodeAt(d);l=[p]}else o?.[3]!=null&&(l=[decodeURIComponent(o[3])]);return t?new File(l,e.name||\"\",{type:a}):new Blob(l,{type:a})}n(cd,\"dataURItoBlob\");function gu(i){return i.startsWith(\"blob:\")}n(gu,\"isObjectURL\");function ge(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}n(ge,\"e\");var zg=typeof self<\"u\"?self:global,la=typeof navigator<\"u\",M2=la&&typeof HTMLImageElement>\"u\",Ug=!(typeof global>\"u\"||typeof process>\"u\"||!process.versions||!process.versions.node),jg=zg.Buffer,Hg=!!jg,L2=n(i=>i!==void 0,\"h\");function $g(i){return i===void 0||(i instanceof Map?i.size===0:Object.values(i).filter(L2).length===0)}n($g,\"f\");function ut(i){let e=new Error(i);throw delete e.stack,e}n(ut,\"l\");function kg(i){let e=function(t){let r=0;return t.ifd0.enabled&&(r+=1024),t.exif.enabled&&(r+=2048),t.makerNote&&(r+=2048),t.userComment&&(r+=1024),t.gps.enabled&&(r+=512),t.interop.enabled&&(r+=100),t.ifd1.enabled&&(r+=1024),r+2048}(i);return i.jfif.enabled&&(e+=50),i.xmp.enabled&&(e+=2e4),i.iptc.enabled&&(e+=14e3),i.icc.enabled&&(e+=6e3),e}n(kg,\"o\");var pd=n(i=>String.fromCharCode.apply(null,i),\"u\"),Dg=typeof TextDecoder<\"u\"?new TextDecoder(\"utf-8\"):void 0,$t=class{static from(e,t){return e instanceof this&&e.le===t?e:new $t(e,void 0,void 0,t)}constructor(e,t=0,r,s){if(typeof s==\"boolean\"&&(this.le=s),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){r===void 0&&(r=e.byteLength-t);let o=new DataView(e,t,r);this._swapDataView(o)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof $t){r===void 0&&(r=e.byteLength-t),(t+=e.byteOffset)+r>e.byteOffset+e.byteLength&&ut(\"Creating view outside of available memory in ArrayBuffer\");let o=new DataView(e.buffer,t,r);this._swapDataView(o)}else if(typeof e==\"number\"){let o=new DataView(new ArrayBuffer(e));this._swapDataView(o)}else ut(\"Invalid input argument for BufferView: \"+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,r=$t){return e instanceof DataView||e instanceof $t?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||ut(\"BufferView.set(): Invalid data argument.\"),this.toUint8().set(e,t),new r(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new $t(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return s=this.getUint8Array(e,t),Dg?Dg.decode(s):Hg?Buffer.from(s).toString(\"utf8\"):decodeURIComponent(escape(pd(s)));var s}getLatin1String(e=0,t=this.byteLength){let r=this.getUint8Array(e,t);return pd(r)}getUnicodeString(e=0,t=this.byteLength){let r=[];for(let s=0;s<t&&e+s<this.byteLength;s+=2)r.push(this.getUint16(e+s));return pd(r)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,r){switch(t){case 1:return this.getUint8(e,r);case 2:return this.getUint16(e,r);case 4:return this.getUint32(e,r);case 8:return this.getUint64&&this.getUint64(e,r)}}getUint(e,t,r){switch(t){case 8:return this.getUint8(e,r);case 16:return this.getUint16(e,r);case 32:return this.getUint32(e,r);case 64:return this.getUint64&&this.getUint64(e,r)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}};n($t,\"c\");function md(i,e){ut(`${i} '${e}' was not loaded, try using full build of exifr.`)}n(md,\"p\");var zo=class extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||md(this.kind,e),t&&(e in t||function(r,s){ut(`Unknown ${r} '${s}'.`)}(this.kind,e),t[e].enabled||md(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}};n(zo,\"g\");var xu=new zo(\"file parser\"),ei=new zo(\"segment parser\"),da=new zo(\"file reader\"),B2=zg.fetch;function Ig(i,e){return(t=i).startsWith(\"data:\")||t.length>1e4?yd(i,e,\"base64\"):Ug&&i.includes(\"://\")?gd(i,e,\"url\",Pu):Ug?yd(i,e,\"fs\"):la?gd(i,e,\"url\",Pu):void ut(\"Invalid input argument\");var t}n(Ig,\"k\");async function gd(i,e,t,r){return da.has(t)?yd(i,e,t):r?async function(s,o){let a=await o(s);return new $t(a)}(i,r):void ut(`Parser ${t} is not loaded`)}n(gd,\"O\");async function yd(i,e,t){let r=new(da.get(t))(i,e);return await r.read(),r}n(yd,\"v\");var Pu=n(i=>B2(i).then(e=>e.arrayBuffer()),\"S\"),ua=n(i=>new Promise((e,t)=>{let r=new FileReader;r.onloadend=()=>e(r.result||new ArrayBuffer),r.onerror=t,r.readAsArrayBuffer(i)}),\"A\"),yu=class extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}};n(yu,\"U\");function qg(i,e,t){let r=new yu;for(let[s,o]of t)r.set(s,o);if(Array.isArray(e))for(let s of e)i.set(s,r);else i.set(e,r);return r}n(qg,\"x\");function Vg(i,e,t){let r,s=i.get(e);for(r of t)s.set(r[0],r[1])}n(Vg,\"C\");var ca=new Map,vd=new Map,bd=new Map,No=[\"chunked\",\"firstChunkSize\",\"firstChunkSizeNode\",\"firstChunkSizeBrowser\",\"chunkSize\",\"chunkLimit\"],Fu=[\"jfif\",\"xmp\",\"icc\",\"iptc\",\"ihdr\"],ha=[\"tiff\",...Fu],Ye=[\"ifd0\",\"ifd1\",\"exif\",\"gps\",\"interop\"],Mo=[...ha,...Ye],Lo=[\"makerNote\",\"userComment\"],Eu=[\"translateKeys\",\"translateValues\",\"reviveValues\",\"multiSegment\"],Bo=[...Eu,\"sanitize\",\"mergeOutput\",\"silentErrors\"],na=class{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}};n(na,\"_\");var es=class extends na{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,r,s){if(super(),ge(this,\"enabled\",!1),ge(this,\"skip\",new Set),ge(this,\"pick\",new Set),ge(this,\"deps\",new Set),ge(this,\"translateKeys\",!1),ge(this,\"translateValues\",!1),ge(this,\"reviveValues\",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(s),this.canBeFiltered=Ye.includes(e),this.canBeFiltered&&(this.dict=ca.get(e)),r!==void 0)if(Array.isArray(r))this.parse=this.enabled=!0,this.canBeFiltered&&r.length>0&&this.translateTagSet(r,this.pick);else if(typeof r==\"object\"){if(this.enabled=!0,this.parse=r.parse!==!1,this.canBeFiltered){let{pick:o,skip:a}=r;o&&o.length>0&&this.translateTagSet(o,this.pick),a&&a.length>0&&this.translateTagSet(a,this.skip)}this.applyInheritables(r)}else r===!0||r===!1?this.parse=this.enabled=r:ut(`Invalid options argument: ${r}`)}applyInheritables(e){let t,r;for(t of Eu)r=e[t],r!==void 0&&(this[t]=r)}translateTagSet(e,t){if(this.dict){let r,s,{tagKeys:o,tagValues:a}=this.dict;for(r of e)typeof r==\"string\"?(s=a.indexOf(r),s===-1&&(s=o.indexOf(Number(r))),s!==-1&&t.add(Number(o[s]))):t.add(r)}else for(let r of e)t.add(r)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,_u(this.pick,this.deps)):this.enabled&&this.pick.size>0&&_u(this.pick,this.deps)}};n(es,\"D\");var kt={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},Ng=new Map,ts=class extends na{static useCached(e){let t=Ng.get(e);return t!==void 0||(t=new this(e),Ng.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e==\"object\"?this.setupFromObject(e):ut(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=la?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of No)this[e]=kt[e];for(e of Bo)this[e]=kt[e];for(e of Lo)this[e]=kt[e];for(e of Mo)this[e]=new es(e,kt[e],void 0,this)}setupFromTrue(){let e;for(e of No)this[e]=kt[e];for(e of Bo)this[e]=kt[e];for(e of Lo)this[e]=!0;for(e of Mo)this[e]=new es(e,!0,void 0,this)}setupFromArray(e){let t;for(t of No)this[t]=kt[t];for(t of Bo)this[t]=kt[t];for(t of Lo)this[t]=kt[t];for(t of Mo)this[t]=new es(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,Ye)}setupFromObject(e){let t;for(t of(Ye.ifd0=Ye.ifd0||Ye.image,Ye.ifd1=Ye.ifd1||Ye.thumbnail,Object.assign(this,e),No))this[t]=fd(e[t],kt[t]);for(t of Bo)this[t]=fd(e[t],kt[t]);for(t of Lo)this[t]=fd(e[t],kt[t]);for(t of ha)this[t]=new es(t,kt[t],e[t],this);for(t of Ye)this[t]=new es(t,kt[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,Ye,Mo),e.tiff===!0?this.batchEnableWithBool(Ye,!0):e.tiff===!1?this.batchEnableWithUserValue(Ye,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,Ye):typeof e.tiff==\"object\"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,Ye)}batchEnableWithBool(e,t){for(let r of e)this[r].enabled=t}batchEnableWithUserValue(e,t){for(let r of e){let s=t[r];this[r].enabled=s!==!1&&s!==void 0}}setupGlobalFilters(e,t,r,s=r){if(e&&e.length){for(let a of s)this[a].enabled=!1;let o=Mg(e,r);for(let[a,l]of o)_u(this[a].pick,l),this[a].enabled=!0}else if(t&&t.length){let o=Mg(t,r);for(let[a,l]of o)_u(this[a].skip,l)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:r,iptc:s,icc:o}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),r.enabled||e.skip.add(700),s.enabled||e.skip.add(33723),o.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:r,interop:s}=this;s.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),r.needed&&e.deps.add(34853),this.tiff.enabled=Ye.some(o=>this[o].enabled===!0)||this.makerNote||this.userComment;for(let o of Ye)this[o].finalizeFilters()}get onlyTiff(){return!Fu.map(e=>this[e].enabled).some(e=>e===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let e of ha)this[e].enabled&&!ei.has(e)&&md(\"segment parser\",e)}};n(ts,\"R\");function Mg(i,e){let t,r,s,o,a=[];for(s of e){for(o of(t=ca.get(s),r=[],t))(i.includes(o[0])||i.includes(o[1]))&&r.push(o[0]);r.length&&a.push([s,r])}return a}n(Mg,\"K\");function fd(i,e){return i!==void 0?i:e!==void 0?e:void 0}n(fd,\"W\");function _u(i,e){for(let t of e)i.add(t)}n(_u,\"X\");ge(ts,\"default\",kt);var Ts=class{constructor(e){ge(this,\"parsers\",{}),ge(this,\"output\",{}),ge(this,\"errors\",[]),ge(this,\"pushToErrors\",t=>this.errors.push(t)),this.options=ts.useCached(e)}async read(e){this.file=await function(t,r){return typeof t==\"string\"?Ig(t,r):la&&!M2&&t instanceof HTMLImageElement?Ig(t.src,r):t instanceof Uint8Array||t instanceof ArrayBuffer||t instanceof DataView?new $t(t):la&&t instanceof Blob?gd(t,r,\"blob\",ua):void ut(\"Invalid input argument\")}(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[r,s]of xu)if(s.canHandle(e,t))return this.fileParser=new s(this.options,this.file,this.parsers),e[r]=!0;this.file.close&&this.file.close(),ut(\"Unknown file format\")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),$g(r=e)?void 0:r;var r}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map(async r=>{let s=await r.parse();r.assignToOutput(e,s)});this.options.silentErrors&&(t=t.map(r=>r.catch(this.pushToErrors))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,r=ei.get(\"tiff\",e);var s;if(t.tiff?s={start:0,type:\"tiff\"}:t.jpeg&&(s=await this.fileParser.getOrFindSegment(\"tiff\")),s===void 0)return;let o=await this.fileParser.ensureSegmentChunk(s),a=this.parsers.tiff=new r(o,e,t),l=await a.extractThumbnail();return t.close&&t.close(),l}};n(Ts,\"H\");async function Wg(i,e){let t=new Ts(e);return await t.read(i),t.parse()}n(Wg,\"Y\");var z2=Object.freeze({__proto__:null,parse:Wg,Exifr:Ts,fileParsers:xu,segmentParsers:ei,fileReaders:da,tagKeys:ca,tagValues:vd,tagRevivers:bd,createDictionary:qg,extendDictionary:Vg,fetchUrlAsArrayBuffer:Pu,readBlobAsArrayBuffer:ua,chunkedProps:No,otherSegments:Fu,segments:ha,tiffBlocks:Ye,segmentsAndBlocks:Mo,tiffExtractables:Lo,inheritables:Eu,allFormatters:Bo,Options:ts}),Or=class{static findPosition(e,t){let r=e.getUint16(t+2)+2,s=typeof this.headerLength==\"function\"?this.headerLength(e,t,r):this.headerLength,o=t+s,a=r-s;return{offset:t,length:r,headerLength:s,start:o,size:a,end:o+a}}static parse(e,t={}){return new this(e,new ts({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof $t?e:new $t(e)}constructor(e,t={},r){ge(this,\"errors\",[]),ge(this,\"raw\",new Map),ge(this,\"handleError\",s=>{if(!this.options.silentErrors)throw s;this.errors.push(s.message)}),this.chunk=this.normalizeInput(e),this.file=r,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let r=bd.get(t),s=vd.get(t),o=ca.get(t),a=this.options[t],l=a.reviveValues&&!!r,h=a.translateValues&&!!s,p=a.translateKeys&&!!o,d={};for(let[f,y]of e)l&&r.has(f)?y=r.get(f)(y):h&&s.has(f)&&(y=this.translateValue(y,s.get(f))),p&&o.has(f)&&(f=o.get(f)||f),d[f]=y;return d}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,r){if(this.globalOptions.mergeOutput)return Object.assign(e,r);e[t]?Object.assign(e[t],r):e[t]=r}};n(Or,\"J\");ge(Or,\"headerLength\",4),ge(Or,\"type\",void 0),ge(Or,\"multiSegment\",!1),ge(Or,\"canHandle\",()=>!1);function j2(i){return i===192||i===194||i===196||i===219||i===221||i===218||i===254}n(j2,\"q\");function H2(i){return i>=224&&i<=239}n(H2,\"Q\");function $2(i,e,t){for(let[r,s]of ei)if(s.canHandle(i,e,t))return r}n($2,\"Z\");var aa=class extends class{constructor(e,t,r){ge(this,\"errors\",[]),ge(this,\"ensureSegmentChunk\",async s=>{let o=s.start,a=s.size||65536;if(this.file.chunked)if(this.file.available(o,a))s.chunk=this.file.subarray(o,a);else try{s.chunk=await this.file.readChunk(o,a)}catch(l){ut(`Couldn't read segment: ${JSON.stringify(s)}. ${l.message}`)}else this.file.byteLength>o+a?s.chunk=this.file.subarray(o,a):s.size===void 0?s.chunk=this.file.subarray(o):ut(\"Segment unreachable: \"+JSON.stringify(s));return s.chunk}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=r}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let r=new(ei.get(e))(t,this.options,this.file);return this.parsers[e]=r}createParsers(e){for(let t of e){let{type:r,chunk:s}=t,o=this.options[r];if(o&&o.enabled){let a=this.parsers[r];a&&a.append||a||this.createParser(r,s)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}{constructor(...e){super(...e),ge(this,\"appSegments\",[]),ge(this,\"jpegSegments\",[]),ge(this,\"unknownSegments\",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(ei.keyList())):(e=e===void 0?ei.keyList().filter(t=>this.options[t].enabled):e.filter(t=>this.options[t].enabled&&ei.has(t)),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:r,findAll:s,wanted:o,remaining:a}=this;if(!s&&this.file.chunked&&(s=Array.from(o).some(l=>{let h=ei.get(l),p=this.options[l];return h.multiSegment&&p.multiSegment}),s&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,r.byteLength),!this.options.onlyTiff&&r.chunked){let l=!1;for(;a.size>0&&!l&&(r.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:h}=r,p=this.appSegments.some(d=>!this.file.available(d.offset||d.start,d.length||d.size));if(l=e>h&&!p?!await r.readNextChunk(e):!await r.readNextChunk(h),(e=this.findAppSegmentsInRange(e,r.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let r,s,o,a,l,h,{file:p,findAll:d,wanted:f,remaining:y,options:b}=this;for(;e<t;e++)if(p.getUint8(e)===255){if(r=p.getUint8(e+1),H2(r)){if(s=p.getUint16(e+2),o=$2(p,e,s),o&&f.has(o)&&(a=ei.get(o),l=a.findPosition(p,e),h=b[o],l.type=o,this.appSegments.push(l),!d&&(a.multiSegment&&h.multiSegment?(this.unfinishedMultiSegment=l.chunkNumber<l.chunkCount,this.unfinishedMultiSegment||y.delete(o)):y.delete(o),y.size===0)))break;b.recordUnknownSegments&&(l=Or.findPosition(p,e),l.marker=r,this.unknownSegments.push(l)),e+=s+1}else if(j2(r)){if(s=p.getUint16(e+2),r===218&&b.stopAfterSos!==!1)return;b.recordJpegSegments&&this.jpegSegments.push({offset:e,length:s,marker:r}),e+=s+1}}return e}mergeMultiSegments(){if(!this.appSegments.some(t=>t.multiSegment))return;let e=function(t,r){let s,o,a,l=new Map;for(let h=0;h<t.length;h++)s=t[h],o=s[r],l.has(o)?a=l.get(o):l.set(o,a=[]),a.push(s);return Array.from(l)}(this.appSegments,\"type\");this.mergedAppSegments=e.map(([t,r])=>{let s=ei.get(t,this.options);return s.handleMultiSegments?{type:t,chunk:s.handleMultiSegments(r)}:r[0]})}getSegment(e){return this.appSegments.find(t=>t.type===e)}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}};n(aa,\"ee\");ge(aa,\"type\",\"jpeg\"),xu.set(\"jpeg\",aa);var q2=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4],vu=class extends Or{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,r=new Map){let{pick:s,skip:o}=this.options[t];s=new Set(s);let a=s.size>0,l=o.size===0,h=this.chunk.getUint16(e);e+=2;for(let p=0;p<h;p++){let d=this.chunk.getUint16(e);if(a){if(s.has(d)&&(r.set(d,this.parseTag(e,d,t)),s.delete(d),s.size===0))break}else!l&&o.has(d)||r.set(d,this.parseTag(e,d,t));e+=12}return r}parseTag(e,t,r){let{chunk:s}=this,o=s.getUint16(e+2),a=s.getUint32(e+4),l=q2[o];if(l*a<=4?e+=8:e=s.getUint32(e+8),(o<1||o>13)&&ut(`Invalid TIFF value type. block: ${r.toUpperCase()}, tag: ${t.toString(16)}, type: ${o}, offset ${e}`),e>s.byteLength&&ut(`Invalid TIFF value offset. block: ${r.toUpperCase()}, tag: ${t.toString(16)}, type: ${o}, offset ${e} is outside of chunk size ${s.byteLength}`),o===1)return s.getUint8Array(e,a);if(o===2)return(h=function(p){for(;p.endsWith(\"\\0\");)p=p.slice(0,-1);return p}(h=s.getString(e,a)).trim())===\"\"?void 0:h;var h;if(o===7)return s.getUint8Array(e,a);if(a===1)return this.parseTagValue(o,e);{let p=new(function(f){switch(f){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(o))(a),d=l;for(let f=0;f<a;f++)p[f]=this.parseTagValue(o,e),e+=d;return p}}parseTagValue(e,t){let{chunk:r}=this;switch(e){case 1:return r.getUint8(t);case 3:return r.getUint16(t);case 4:return r.getUint32(t);case 5:return r.getUint32(t)/r.getUint32(t+4);case 6:return r.getInt8(t);case 8:return r.getInt16(t);case 9:return r.getInt32(t);case 10:return r.getInt32(t)/r.getInt32(t+4);case 11:return r.getFloat(t);case 12:return r.getDouble(t);case 13:return r.getUint32(t);default:ut(`Invalid tiff type ${e}`)}}};n(vu,\"se\");var jo=class extends vu{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse(\"parseExifBlock\"),e.gps.enabled&&await this.safeParse(\"parseGpsBlock\"),e.interop.enabled&&await this.safeParse(\"parseInteropBlock\"),e.ifd1.enabled&&await this.safeParse(\"parseThumbnailBlock\"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let r=new Map;return this[t]=r,this.parseTags(e,t,r),r}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&ut(\"Malformed EXIF data\"),!e.chunked&&this.ifd0Offset>e.byteLength&&ut(`IFD0 offset points to outside of file.\nthis.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,kg(this.options));let t=this.parseBlock(this.ifd0Offset,\"ifd0\");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,kg(this.options));let e=this.parseBlock(this.exifOffset,\"exif\");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let r=e.get(t);r&&r.length===1&&e.set(t,r[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,\"gps\");return e&&e.has(2)&&e.has(4)&&(e.set(\"latitude\",Lg(...e.get(2),e.get(1))),e.set(\"longitude\",Lg(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,\"interop\")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,\"ifd1\"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,r,s={};for(t of Ye)if(e=this[t],!$g(e))if(r=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t===\"ifd1\")continue;Object.assign(s,r)}else s[t]=r;return this.makerNote&&(s.makerNote=this.makerNote),this.userComment&&(s.userComment=this.userComment),s}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[r,s]of Object.entries(t))this.assignObjectToOutput(e,r,s)}};n(jo,\"ie\");function Lg(i,e,t,r){var s=i+e/60+t/3600;return r!==\"S\"&&r!==\"W\"||(s*=-1),s}n(Lg,\"ne\");ge(jo,\"type\",\"tiff\"),ge(jo,\"headerLength\",10),ei.set(\"tiff\",jo);var R4=Object.freeze({__proto__:null,default:z2,Exifr:Ts,fileParsers:xu,segmentParsers:ei,fileReaders:da,tagKeys:ca,tagValues:vd,tagRevivers:bd,createDictionary:qg,extendDictionary:Vg,fetchUrlAsArrayBuffer:Pu,readBlobAsArrayBuffer:ua,chunkedProps:No,otherSegments:Fu,segments:ha,tiffBlocks:Ye,segmentsAndBlocks:Mo,tiffExtractables:Lo,inheritables:Eu,allFormatters:Bo,Options:ts,parse:Wg}),wd={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},U4=Object.assign({},wd,{firstChunkSize:4e4,gps:[1,2,3,4]});var k4=Object.assign({},wd,{tiff:!1,ifd1:!0,mergeOutput:!1});var V2=Object.assign({},wd,{firstChunkSize:4e4,ifd0:[274]});async function W2(i){let e=new Ts(V2);await e.read(i);let t=await e.parse();if(t&&t.ifd0)return t.ifd0[274]}n(W2,\"ce\");var G2=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}}),sa=!0,oa=!0;if(typeof navigator==\"object\"){let i=navigator.userAgent;if(i.includes(\"iPad\")||i.includes(\"iPhone\")){let e=i.match(/OS (\\d+)_(\\d+)/);if(e){let[,t,r]=e;sa=Number(t)+.1*Number(r)<13.4,oa=!1}}else if(i.includes(\"OS X 10\")){let[,e]=i.match(/OS X 10[_.](\\d+)/);sa=oa=Number(e)<15}if(i.includes(\"Chrome/\")){let[,e]=i.match(/Chrome\\/(\\d+)/);sa=oa=Number(e)<81}else if(i.includes(\"Firefox/\")){let[,e]=i.match(/Firefox\\/(\\d+)/);sa=oa=Number(e)<77}}async function Gg(i){let e=await W2(i);return Object.assign({canvas:sa,css:oa},G2[e])}n(Gg,\"ye\");var bu=class extends $t{constructor(...e){super(...e),ge(this,\"ranges\",new wu),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,r){if(e===0&&this.byteLength===0&&r){let s=new DataView(r.buffer||r,r.byteOffset,r.byteLength);this._swapDataView(s)}else{let s=e+t;if(s>this.byteLength){let{dataView:o}=this._extend(s);this._swapDataView(o)}}}_extend(e){let t;t=Hg?jg.allocUnsafe(e):new Uint8Array(e);let r=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:r}}subarray(e,t,r=!1){return t=t||this._lengthToEnd(e),r&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,r=!1){r&&this._tryExtend(t,e.byteLength,e);let s=super.set(e,t);return this.ranges.add(t,s.byteLength),s}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}};n(bu,\"be\");var wu=class{constructor(){ge(this,\"list\",[])}get length(){return this.list.length}add(e,t,r=0){let s=e+t,o=this.list.filter(a=>Bg(e,a.offset,s)||Bg(e,a.end,s));if(o.length>0){e=Math.min(e,...o.map(l=>l.offset)),s=Math.max(s,...o.map(l=>l.end)),t=s-e;let a=o.shift();a.offset=e,a.length=t,a.end=s,this.list=this.list.filter(l=>!o.includes(l))}else this.list.push({offset:e,length:t,end:s})}available(e,t){let r=e+t;return this.list.some(s=>s.offset<=e&&r<=s.end)}};n(wu,\"we\");function Bg(i,e,t){return i<=e&&e<=t}n(Bg,\"ke\");var Su=class extends bu{constructor(e,t){super(0),ge(this,\"chunksRead\",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,r=await this.readChunk(e,t);return!!r&&r.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}};n(Su,\"Oe\");da.set(\"blob\",class extends Su{async readWhole(){this.chunked=!1;let i=await ua(this.input);this._swapArrayBuffer(i)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(i,e){let t=e?i+e:void 0,r=this.input.slice(i,t),s=await ua(r);return this.set(s,i,!0)}});var Kg={strings:{generatingThumbnails:\"Generating thumbnails...\"}};var K2={version:\"3.0.6\"};function X2(i,e,t){try{i.getContext(\"2d\").getImageData(0,0,1,1)}catch(r){if(r.code===18)return Promise.reject(new Error(\"cannot read image, probably an svg with external resources\"))}return i.toBlob?new Promise(r=>{i.toBlob(r,e,t)}).then(r=>{if(r===null)throw new Error(\"cannot read image, probably an svg with external resources\");return r}):Promise.resolve().then(()=>cd(i.toDataURL(e,t),{})).then(r=>{if(r===null)throw new Error(\"could not extract blob, probably an old browser\");return r})}n(X2,\"canvasToBlob\");function Y2(i,e){let t=i.width,r=i.height;(e.deg===90||e.deg===270)&&(t=i.height,r=i.width);let s=document.createElement(\"canvas\");s.width=t,s.height=r;let o=s.getContext(\"2d\");return o.translate(t/2,r/2),e.canvas&&(o.rotate(e.rad),o.scale(e.scaleX,e.scaleY)),o.drawImage(i,-i.width/2,-i.height/2,i.width,i.height),s}n(Y2,\"rotateImage\");function Q2(i){let e=i.width/i.height,t=5e6,r=4096,s=Math.floor(Math.sqrt(t*e)),o=Math.floor(t/Math.sqrt(t*e));if(s>r&&(s=r,o=Math.round(s/e)),o>r&&(o=r,s=Math.round(e*o)),i.width>s){let a=document.createElement(\"canvas\");return a.width=s,a.height=o,a.getContext(\"2d\").drawImage(i,0,0,s,o),a}return i}n(Q2,\"protect\");var Cr=class extends Z{constructor(e,t){super(e,t),this.onFileAdded=s=>{!s.preview&&s.data&&Uo(s.type)&&!s.isRemote&&this.addToQueue(s.id)},this.onCancelRequest=s=>{let o=this.queue.indexOf(s.id);o!==-1&&this.queue.splice(o,1)},this.onFileRemoved=s=>{let o=this.queue.indexOf(s.id);o!==-1&&this.queue.splice(o,1),s.preview&&gu(s.preview)&&URL.revokeObjectURL(s.preview)},this.onRestored=()=>{this.uppy.getFiles().filter(o=>o.isRestored).forEach(o=>{(!o.preview||gu(o.preview))&&this.addToQueue(o.id)})},this.onAllFilesRemoved=()=>{this.queue=[]},this.waitUntilAllProcessed=s=>{s.forEach(a=>{let l=this.uppy.getFile(a);this.uppy.emit(\"preprocess-progress\",l,{mode:\"indeterminate\",message:this.i18n(\"generatingThumbnails\")})});let o=n(()=>{s.forEach(a=>{let l=this.uppy.getFile(a);this.uppy.emit(\"preprocess-complete\",l)})},\"emitPreprocessCompleteForAll\");return new Promise(a=>{this.queueProcessing?this.uppy.once(\"thumbnail:all-generated\",()=>{o(),a()}):(o(),a())})},this.type=\"modifier\",this.id=this.opts.id||\"ThumbnailGenerator\",this.title=\"Thumbnail Generator\",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType||\"image/jpeg\",this.defaultLocale=Kg;let r={thumbnailWidth:null,thumbnailHeight:null,waitForThumbnailsBeforeUpload:!1,lazy:!1};if(this.opts={...r,...t},this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error(\"ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.\")}createThumbnail(e,t,r){let s=URL.createObjectURL(e.data),o=new Promise((l,h)=>{let p=new Image;p.src=s,p.addEventListener(\"load\",()=>{URL.revokeObjectURL(s),l(p)}),p.addEventListener(\"error\",d=>{URL.revokeObjectURL(s),h(d.error||new Error(\"Could not create thumbnail\"))})}),a=Gg(e.data).catch(()=>1);return Promise.all([o,a]).then(l=>{let[h,p]=l,d=this.getProportionalDimensions(h,t,r,p.deg),f=Y2(h,p),y=this.resizeImage(f,d.width,d.height);return X2(y,this.thumbnailType,80)}).then(l=>URL.createObjectURL(l))}getProportionalDimensions(e,t,r,s){let o=e.width/e.height;return(s===90||s===270)&&(o=e.height/e.width),t!=null?{width:t,height:Math.round(t/o)}:r!=null?{width:Math.round(r*o),height:r}:{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/o)}}resizeImage(e,t,r){let s=Q2(e),o=Math.ceil(Math.log2(s.width/t));o<1&&(o=1);let a=t*2**(o-1),l=r*2**(o-1),h=2;for(;o--;){let p=document.createElement(\"canvas\");p.width=a,p.height=l,p.getContext(\"2d\").drawImage(s,0,0,a,l),s=p,a=Math.round(a/h),l=Math.round(l/h)}return s}setPreviewURL(e,t){this.uppy.setFileState(e,{preview:t})}addToQueue(e){this.queue.push(e),this.queueProcessing===!1&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){let e=this.uppy.getFile(this.queue.shift());return e?this.requestThumbnail(e).catch(()=>{}).then(()=>this.processQueue()):(this.uppy.log(\"[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug\",\"error\"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log(\"[ThumbnailGenerator] Emptied thumbnail queue\"),this.uppy.emit(\"thumbnail:all-generated\"),Promise.resolve()}requestThumbnail(e){return Uo(e.type)&&!e.isRemote?this.createThumbnail(e,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then(t=>{this.setPreviewURL(e.id,t),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${e.id}`),this.uppy.emit(\"thumbnail:generated\",this.uppy.getFile(e.id),t)}).catch(t=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${e.id}:`,\"warning\"),this.uppy.log(t,\"warning\"),this.uppy.emit(\"thumbnail:error\",this.uppy.getFile(e.id),t)}):Promise.resolve()}install(){this.uppy.on(\"file-removed\",this.onFileRemoved),this.uppy.on(\"cancel-all\",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on(\"thumbnail:request\",this.onFileAdded),this.uppy.on(\"thumbnail:cancel\",this.onCancelRequest)):(this.uppy.on(\"file-added\",this.onFileAdded),this.uppy.on(\"restored\",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off(\"file-removed\",this.onFileRemoved),this.uppy.off(\"cancel-all\",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off(\"thumbnail:request\",this.onFileAdded),this.uppy.off(\"thumbnail:cancel\",this.onCancelRequest)):(this.uppy.off(\"file-added\",this.onFileAdded),this.uppy.off(\"restored\",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}};n(Cr,\"ThumbnailGenerator\");Cr.VERSION=K2.version;function Ou(i){if(typeof i==\"string\"){let e=document.querySelectorAll(i);return e.length===0?null:Array.from(e)}return typeof i==\"object\"&&En(i)?[i]:null}n(Ou,\"findAllDOMElements\");var Qe=Array.from;function Cu(i,e,t,r){let{onSuccess:s}=r;i.readEntries(o=>{let a=[...e,...o];o.length?queueMicrotask(()=>{Cu(i,a,t,{onSuccess:s})}):s(a)},o=>{t(o),s(e)})}n(Cu,\"getFilesAndDirectoriesFromDirectory\");function Xg(i,e){return i==null?i:{kind:i.isFile?\"file\":i.isDirectory?\"directory\":void 0,name:i.name,getFile(){return new Promise((t,r)=>i.file(t,r))},async*values(){let t=i.createReader();yield*await new Promise(s=>{Cu(t,[],e,{onSuccess:o=>s(o.map(a=>Xg(a,e)))})})},isSameEntry:void 0}}n(Xg,\"getAsFileSystemHandleFromEntry\");function Yg(i,e,t){try{return t===void 0&&(t=void 0),async function*(){let r=n(()=>`${e}/${i.name}`,\"getNextRelativePath\");if(i.kind===\"file\"){let s=await i.getFile();s!=null?(s.relativePath=e?r():null,yield s):t!=null&&(yield t)}else if(i.kind===\"directory\")for await(let s of i.values())yield*Yg(s,e?r():i.name);else t!=null&&(yield t)}()}catch(r){return Promise.reject(r)}}n(Yg,\"createPromiseToAddFileOrParseDirectory\");async function*Sd(i,e){let t=await Promise.all(Array.from(i.items,async r=>{var s;let o,a=n(()=>typeof r.getAsEntry==\"function\"?r.getAsEntry():r.webkitGetAsEntry(),\"getAsEntry\");return(s=o)!=null||(o=Xg(a(),e)),{fileSystemHandle:o,lastResortFile:r.getAsFile()}}));for(let{lastResortFile:r,fileSystemHandle:s}of t)if(s!=null)try{yield*Yg(s,\"\",r)}catch(o){r!=null?yield r:e(o)}else r!=null&&(yield r)}n(Sd,\"getFilesFromDataTransfer\");function Pd(i){let e=Qe(i.files);return Promise.resolve(e)}n(Pd,\"fallbackApi\");async function As(i,e){var t;let r=(t=e?.logDropError)!=null?t:Function.prototype;try{let s=[];for await(let o of Sd(i,r))s.push(o);return s}catch{return Pd(i)}}n(As,\"getDroppedFiles\");var Qg=Number.isNaN||n(function(e){return typeof e==\"number\"&&e!==e},\"ponyfill\");function J2(i,e){return!!(i===e||Qg(i)&&Qg(e))}n(J2,\"isEqual\");function Z2(i,e){if(i.length!==e.length)return!1;for(var t=0;t<i.length;t++)if(!J2(i[t],e[t]))return!1;return!0}n(Z2,\"areInputsEqual\");function _d(i,e){e===void 0&&(e=Z2);var t=null;function r(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];if(t&&t.lastThis===this&&e(s,t.lastArgs))return t.lastResult;var a=i.apply(this,s);return t={lastResult:a,lastArgs:s,lastThis:this},a}return n(r,\"memoized\"),r.clear=n(function(){t=null},\"clear\"),r}n(_d,\"memoizeOne\");var Tu=['a[href]:not([tabindex^=\"-\"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^=\"-\"]):not([inert]):not([aria-hidden])',\"input:not([disabled]):not([inert]):not([aria-hidden])\",\"select:not([disabled]):not([inert]):not([aria-hidden])\",\"textarea:not([disabled]):not([inert]):not([aria-hidden])\",\"button:not([disabled]):not([inert]):not([aria-hidden])\",'iframe:not([tabindex^=\"-\"]):not([inert]):not([aria-hidden])','object:not([tabindex^=\"-\"]):not([inert]):not([aria-hidden])','embed:not([tabindex^=\"-\"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^=\"-\"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^=\"-\"]):not([inert]):not([aria-hidden])'];function pa(i,e){if(e){let t=i.querySelector(`[data-uppy-paneltype=\"${e}\"]`);if(t)return t}return i}n(pa,\"getActiveOverlayEl\");function Jg(i,e){let t=e[0];t&&(t.focus(),i.preventDefault())}n(Jg,\"focusOnFirstNode\");function eS(i,e){let t=e[e.length-1];t&&(t.focus(),i.preventDefault())}n(eS,\"focusOnLastNode\");function tS(i){return i.contains(document.activeElement)}n(tS,\"isFocusInOverlay\");function xd(i,e,t){let r=pa(t,e),s=Qe(r.querySelectorAll(Tu)),o=s.indexOf(document.activeElement);tS(r)?i.shiftKey&&o===0?eS(i,s):!i.shiftKey&&o===s.length-1&&Jg(i,s):Jg(i,s)}n(xd,\"trapFocus\");function Zg(i,e,t){e===null||xd(i,e,t)}n(Zg,\"forInline\");var ey=de(Sh(),1);function Fd(){let i=!1;return(0,ey.default)(n((t,r)=>{let s=pa(t,r),o=s.contains(document.activeElement);if(o&&i)return;let a=s.querySelector(\"[data-uppy-super-focusable]\");if(!(o&&!a))if(a)a.focus({preventScroll:!0}),i=!0;else{let l=s.querySelector(Tu);l?.focus({preventScroll:!0}),i=!1}},\"superFocus\"),260)}n(Fd,\"createSuperFocus\");var xy=de(Qt(),1);function fa(){let i=document.body;return!(!(\"draggable\"in i)||!(\"ondragstart\"in i&&\"ondrop\"in i)||!(\"FormData\"in window)||!(\"FileReader\"in window))}n(fa,\"isDragDropSupported\");var ay=de(Qt(),1),ly=de(iy(),1);function rS(){return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"25\",height:\"25\",viewBox:\"0 0 25 25\"},u(\"g\",{fill:\"#686DE0\",fillRule:\"evenodd\"},u(\"path\",{d:\"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z\",fillRule:\"nonzero\"}),u(\"path\",{d:\"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z\",fillRule:\"nonzero\"}),u(\"circle\",{cx:\"7.5\",cy:\"9.5\",r:\"1.5\"})))}n(rS,\"iconImage\");function sS(){return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"25\",height:\"25\",viewBox:\"0 0 25 25\"},u(\"path\",{d:\"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z\",fill:\"#049BCF\",fillRule:\"nonzero\"}))}n(sS,\"iconAudio\");function oS(){return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"25\",height:\"25\",viewBox:\"0 0 25 25\"},u(\"path\",{d:\"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z\",fill:\"#19AF67\",fillRule:\"nonzero\"}))}n(oS,\"iconVideo\");function nS(){return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"25\",height:\"25\",viewBox:\"0 0 25 25\"},u(\"path\",{d:\"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z\",fill:\"#E2514A\",fillRule:\"nonzero\"}))}n(nS,\"iconPDF\");function aS(){return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"25\",height:\"25\",viewBox:\"0 0 25 25\"},u(\"path\",{d:\"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z\",fill:\"#00C469\",fillRule:\"nonzero\"}))}n(aS,\"iconArchive\");function lS(){return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"25\",height:\"25\",viewBox:\"0 0 25 25\"},u(\"g\",{fill:\"#A7AFB7\",fillRule:\"nonzero\"},u(\"path\",{d:\"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z\"}),u(\"path\",{d:\"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z\"})))}n(lS,\"iconFile\");function uS(){return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"25\",height:\"25\",viewBox:\"0 0 25 25\"},u(\"path\",{d:\"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z\",fill:\"#5A5E69\",fillRule:\"nonzero\"}))}n(uS,\"iconText\");function Rs(i){let e={color:\"#838999\",icon:lS()};if(!i)return e;let t=i.split(\"/\")[0],r=i.split(\"/\")[1];return t===\"text\"?{color:\"#5a5e69\",icon:uS()}:t===\"image\"?{color:\"#686de0\",icon:rS()}:t===\"audio\"?{color:\"#068dbb\",icon:sS()}:t===\"video\"?{color:\"#19af67\",icon:oS()}:t===\"application\"&&r===\"pdf\"?{color:\"#e25149\",icon:nS()}:t===\"application\"&&[\"zip\",\"x-7z-compressed\",\"x-rar-compressed\",\"x-tar\",\"x-gzip\",\"x-apple-diskimage\"].indexOf(r)!==-1?{color:\"#00C469\",icon:aS()}:e}n(Rs,\"getIconByMime\");function ma(i){let{file:e}=i;if(e.preview)return u(\"img\",{className:\"uppy-Dashboard-Item-previewImg\",alt:e.name,src:e.preview});let{color:t,icon:r}=Rs(e.type);return u(\"div\",{className:\"uppy-Dashboard-Item-previewIconWrap\"},u(\"span\",{className:\"uppy-Dashboard-Item-previewIcon\",style:{color:t}},r),u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-Dashboard-Item-previewIconBg\",width:\"58\",height:\"76\",viewBox:\"0 0 58 76\"},u(\"rect\",{fill:\"#FFF\",width:\"58\",height:\"76\",rx:\"3\",fillRule:\"evenodd\"})))}n(ma,\"FilePreview\");var hS=n((i,e)=>(typeof e==\"function\"?e():e).filter(s=>s.id===i)[0].name,\"metaFieldIdToName\");function ga(i){let{file:e,toggleFileCard:t,i18n:r,metaFields:s}=i,{missingRequiredMetaFields:o}=e;if(!(o!=null&&o.length))return null;let a=o.map(l=>hS(l,s)).join(\", \");return u(\"div\",{className:\"uppy-Dashboard-Item-errorMessage\"},r(\"missingRequiredMetaFields\",{smart_count:o.length,fields:a}),\" \",u(\"button\",{type:\"button\",class:\"uppy-u-reset uppy-Dashboard-Item-errorMessageBtn\",onClick:()=>t(!0,e.id)},r(\"editFile\")))}n(ga,\"renderMissingMetaFieldsError\");function Ed(i){let{file:e,i18n:t,toggleFileCard:r,metaFields:s,showLinkToFileUploadResult:o}=i,a=\"rgba(255, 255, 255, 0.5)\",l=e.preview?a:Rs(i.file.type).color;return u(\"div\",{className:\"uppy-Dashboard-Item-previewInnerWrap\",style:{backgroundColor:l}},o&&e.uploadURL&&u(\"a\",{className:\"uppy-Dashboard-Item-previewLink\",href:e.uploadURL,rel:\"noreferrer noopener\",target:\"_blank\",\"aria-label\":e.meta.name},u(\"span\",{hidden:!0},e.meta.name)),u(ma,{file:e}),u(ga,{file:e,i18n:t,toggleFileCard:r,metaFields:s}))}n(Ed,\"FilePreviewAndLink\");function dS(i){if(!i.isUploaded){if(i.error&&!i.hideRetryButton){i.uppy.retryUpload(i.file.id);return}i.resumableUploads&&!i.hidePauseResumeButton?i.uppy.pauseResume(i.file.id):i.individualCancellation&&!i.hideCancelButton&&i.uppy.removeFile(i.file.id)}}n(dS,\"onPauseResumeCancelRetry\");function ry(i){return i.isUploaded?i.i18n(\"uploadComplete\"):i.error?i.i18n(\"retryUpload\"):i.resumableUploads?i.file.isPaused?i.i18n(\"resumeUpload\"):i.i18n(\"pauseUpload\"):i.individualCancellation?i.i18n(\"cancelUpload\"):\"\"}n(ry,\"progressIndicatorTitle\");function Od(i){return u(\"div\",{className:\"uppy-Dashboard-Item-progress\"},u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-progressIndicator\",type:\"button\",\"aria-label\":ry(i),title:ry(i),onClick:()=>dS(i)},i.children))}n(Od,\"ProgressIndicatorButton\");function Au(i){let{children:e}=i;return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"70\",height:\"70\",viewBox:\"0 0 36 36\",className:\"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle\"},e)}n(Au,\"ProgressCircleContainer\");function Cd(i){let{progress:e}=i,t=2*Math.PI*15;return u(\"g\",null,u(\"circle\",{className:\"uppy-Dashboard-Item-progressIcon--bg\",r:\"15\",cx:\"18\",cy:\"18\",\"stroke-width\":\"2\",fill:\"none\"}),u(\"circle\",{className:\"uppy-Dashboard-Item-progressIcon--progress\",r:\"15\",cx:\"18\",cy:\"18\",transform:\"rotate(-90, 18, 18)\",fill:\"none\",\"stroke-width\":\"2\",\"stroke-dasharray\":t,\"stroke-dashoffset\":t-t/100*e}))}n(Cd,\"ProgressCircle\");function Td(i){if(!i.file.progress.uploadStarted)return null;if(i.isUploaded)return u(\"div\",{className:\"uppy-Dashboard-Item-progress\"},u(\"div\",{className:\"uppy-Dashboard-Item-progressIndicator\"},u(Au,null,u(\"circle\",{r:\"15\",cx:\"18\",cy:\"18\",fill:\"#1bb240\"}),u(\"polygon\",{className:\"uppy-Dashboard-Item-progressIcon--check\",transform:\"translate(2, 3)\",points:\"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634\"}))));if(!i.recoveredState)return i.error&&!i.hideRetryButton?u(Od,i,u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry\",width:\"28\",height:\"31\",viewBox:\"0 0 16 19\"},u(\"path\",{d:\"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z\"}),u(\"path\",{d:\"M7.9 3H10v2H7.9z\"}),u(\"path\",{d:\"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z\"}),u(\"path\",{d:\"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z\"}))):i.resumableUploads&&!i.hidePauseResumeButton?u(Od,i,u(Au,null,u(Cd,{progress:i.file.progress.percentage}),i.file.isPaused?u(\"polygon\",{className:\"uppy-Dashboard-Item-progressIcon--play\",transform:\"translate(3, 3)\",points:\"12 20 12 10 20 15\"}):u(\"g\",{className:\"uppy-Dashboard-Item-progressIcon--pause\",transform:\"translate(14.5, 13)\"},u(\"rect\",{x:\"0\",y:\"0\",width:\"2\",height:\"10\",rx:\"0\"}),u(\"rect\",{x:\"5\",y:\"0\",width:\"2\",height:\"10\",rx:\"0\"})))):!i.resumableUploads&&i.individualCancellation&&!i.hideCancelButton?u(Od,i,u(Au,null,u(Cd,{progress:i.file.progress.percentage}),u(\"polygon\",{className:\"cancel\",transform:\"translate(2, 2)\",points:\"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12\"}))):u(\"div\",{className:\"uppy-Dashboard-Item-progress\"},u(\"div\",{className:\"uppy-Dashboard-Item-progressIndicator\"},u(Au,null,u(Cd,{progress:i.file.progress.percentage}))))}n(Td,\"FileProgress\");var ny=de(oy(),1);var Ad=\"...\";function Ru(i,e){if(e===0)return\"\";if(i.length<=e)return i;if(e<=Ad.length+1)return`${i.slice(0,e-1)}\\u2026`;let t=e-Ad.length,r=Math.ceil(t/2),s=Math.floor(t/2);return i.slice(0,r)+Ad+i.slice(-s)}n(Ru,\"truncateString\");var cS=n(i=>{let{author:e,name:t}=i.file.meta;function r(){return i.isSingleFile&&i.containerHeight>=350?90:i.containerWidth<=352?35:i.containerWidth<=576?60:e?20:30}return n(r,\"getMaxNameLength\"),u(\"div\",{className:\"uppy-Dashboard-Item-name\",title:t},Ru(t,r()))},\"renderFileName\"),pS=n(i=>{let{author:e}=i.file.meta,{providerName:t}=i.file.remote,r=\"\\xB7\";return e?u(\"div\",{className:\"uppy-Dashboard-Item-author\"},u(\"a\",{href:`${e.url}?utm_source=Companion&utm_medium=referral`,target:\"_blank\",rel:\"noopener noreferrer\"},Ru(e.name,13)),t?u(Ht,null,` ${r} `,t,` ${r} `):null):null},\"renderAuthor\"),fS=n(i=>i.file.size&&u(\"div\",{className:\"uppy-Dashboard-Item-statusSize\"},(0,ny.default)(i.file.size)),\"renderFileSize\"),mS=n(i=>i.file.isGhost&&u(\"span\",null,\" \\u2022 \",u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-reSelect\",type:\"button\",onClick:i.toggleAddFilesPanel},i.i18n(\"reSelect\"))),\"ReSelectButton\"),gS=n(i=>{let{file:e,onClick:t}=i;return e.error?u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-errorDetails\",\"aria-label\":e.error,\"data-microtip-position\":\"bottom\",\"data-microtip-size\":\"medium\",onClick:t,type:\"button\"},\"?\"):null},\"ErrorButton\");function Rd(i){let{file:e}=i;return u(\"div\",{className:\"uppy-Dashboard-Item-fileInfo\",\"data-uppy-file-source\":e.source},u(\"div\",{className:\"uppy-Dashboard-Item-fileName\"},cS(i),u(gS,{file:i.file,onClick:()=>alert(i.file.error)})),u(\"div\",{className:\"uppy-Dashboard-Item-status\"},pS(i),fS(i),mS(i)),u(ga,{file:i.file,i18n:i.i18n,toggleFileCard:i.toggleFileCard,metaFields:i.metaFields}))}n(Rd,\"FileInfo\");function Ud(i,e){return e===void 0&&(e=\"Copy the URL below\"),new Promise(t=>{let r=document.createElement(\"textarea\");r.setAttribute(\"style\",{position:\"fixed\",top:0,left:0,width:\"2em\",height:\"2em\",padding:0,border:\"none\",outline:\"none\",boxShadow:\"none\",background:\"transparent\"}),r.value=i,document.body.appendChild(r),r.select();let s=n(()=>{document.body.removeChild(r),window.prompt(e,i),t()},\"magicCopyFailed\");try{return document.execCommand(\"copy\")?(document.body.removeChild(r),t()):s(\"copy command unavailable\")}catch(o){return document.body.removeChild(r),s(o)}})}n(Ud,\"copyToClipboard\");function yS(i){let{file:e,uploadInProgressOrComplete:t,metaFields:r,canEditFile:s,i18n:o,onClick:a}=i;return!t&&r&&r.length>0||!t&&s(e)?u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit\",type:\"button\",\"aria-label\":o(\"editFileWithFilename\",{file:e.meta.name}),title:o(\"editFileWithFilename\",{file:e.meta.name}),onClick:()=>a()},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"14\",height:\"14\",viewBox:\"0 0 14 14\"},u(\"g\",{fillRule:\"evenodd\"},u(\"path\",{d:\"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z\",fillRule:\"nonzero\"}),u(\"rect\",{x:\"1\",y:\"12.293\",width:\"11\",height:\"1\",rx:\".5\"}),u(\"path\",{fillRule:\"nonzero\",d:\"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z\"})))):null}n(yS,\"EditButton\");function vS(i){let{i18n:e,onClick:t,file:r}=i;return u(\"button\",{className:\"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove\",type:\"button\",\"aria-label\":e(\"removeFile\",{file:r.meta.name}),title:e(\"removeFile\",{file:r.meta.name}),onClick:()=>t()},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"18\",height:\"18\",viewBox:\"0 0 18 18\"},u(\"path\",{d:\"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z\"}),u(\"path\",{fill:\"#FFF\",d:\"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z\"})))}n(vS,\"RemoveButton\");var bS=n((i,e)=>{Ud(e.file.uploadURL,e.i18n(\"copyLinkToClipboardFallback\")).then(()=>{e.uppy.log(\"Link copied to clipboard.\"),e.uppy.info(e.i18n(\"copyLinkToClipboardSuccess\"),\"info\",3e3)}).catch(e.uppy.log).then(()=>i.target.focus({preventScroll:!0}))},\"copyLinkToClipboard\");function wS(i){let{i18n:e}=i;return u(\"button\",{className:\"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink\",type:\"button\",\"aria-label\":e(\"copyLink\"),title:e(\"copyLink\"),onClick:t=>bS(t,i)},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"14\",height:\"14\",viewBox:\"0 0 14 12\"},u(\"path\",{d:\"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z\"})))}n(wS,\"CopyLinkButton\");function kd(i){let{uppy:e,file:t,uploadInProgressOrComplete:r,canEditFile:s,metaFields:o,showLinkToFileUploadResult:a,showRemoveButton:l,i18n:h,toggleFileCard:p,openFileEditor:d}=i;return u(\"div\",{className:\"uppy-Dashboard-Item-actionWrapper\"},u(yS,{i18n:h,file:t,uploadInProgressOrComplete:r,canEditFile:s,metaFields:o,onClick:n(()=>{o&&o.length>0?p(!0,t.id):d(t)},\"editAction\")}),a&&t.uploadURL?u(wS,{file:t,uppy:e,i18n:h}):null,l?u(vS,{i18n:h,file:t,uppy:e,onClick:()=>i.uppy.removeFile(t.id,\"removed-by-user\")}):null)}n(kd,\"Buttons\");var Ho=class extends we{componentDidMount(){let{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}shouldComponentUpdate(e){return!(0,ly.default)(this.props,e)}componentDidUpdate(){let{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}componentWillUnmount(){let{file:e}=this.props;e.preview||this.props.handleCancelThumbnail(e)}render(){let{file:e}=this.props,t=e.progress.preprocess||e.progress.postprocess,r=e.progress.uploadComplete&&!t&&!e.error,s=e.progress.uploadStarted||t,o=e.progress.uploadStarted&&!e.progress.uploadComplete||t,a=e.error||!1,{isGhost:l}=e,h=(this.props.individualCancellation||!o)&&!r;r&&this.props.showRemoveButtonAfterComplete&&(h=!0);let p=(0,ay.default)({\"uppy-Dashboard-Item\":!0,\"is-inprogress\":o&&!this.props.recoveredState,\"is-processing\":t,\"is-complete\":r,\"is-error\":!!a,\"is-resumable\":this.props.resumableUploads,\"is-noIndividualCancellation\":!this.props.individualCancellation,\"is-ghost\":l});return u(\"div\",{className:p,id:`uppy_${e.id}`,role:this.props.role},u(\"div\",{className:\"uppy-Dashboard-Item-preview\"},u(Ed,{file:e,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,i18n:this.props.i18n,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields}),u(Td,{uppy:this.props.uppy,file:e,error:a,isUploaded:r,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,recoveredState:this.props.recoveredState,showRemoveButtonAfterComplete:this.props.showRemoveButtonAfterComplete,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,i18n:this.props.i18n})),u(\"div\",{className:\"uppy-Dashboard-Item-fileInfoAndButtons\"},u(Rd,{file:e,id:this.props.id,acquirers:this.props.acquirers,containerWidth:this.props.containerWidth,containerHeight:this.props.containerHeight,i18n:this.props.i18n,toggleAddFilesPanel:this.props.toggleAddFilesPanel,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields,isSingleFile:this.props.isSingleFile}),u(kd,{file:e,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:h,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:s,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,uppy:this.props.uppy,i18n:this.props.i18n})))}};n(Ho,\"FileItem\");function SS(i,e){let t=[],r=[];return i.forEach(s=>{r.length<e?r.push(s):(t.push(r),r=[s])}),r.length&&t.push(r),t}n(SS,\"chunks\");var uy=n(i=>{let{id:e,error:t,i18n:r,uppy:s,files:o,acquirers:a,resumableUploads:l,hideRetryButton:h,hidePauseResumeButton:p,hideCancelButton:d,showLinkToFileUploadResult:f,showRemoveButtonAfterComplete:y,isWide:b,metaFields:S,isSingleFile:E,toggleFileCard:x,handleRequestThumbnail:F,handleCancelThumbnail:U,recoveredState:j,individualCancellation:G,itemsPerRow:J,openFileEditor:B,canEditFile:z,toggleAddFilesPanel:K,containerWidth:oe,containerHeight:Be}=i,Je=J===1?71:200,wt=Ro(()=>{let _e=n((xe,ui)=>o[ui].isGhost-o[xe].isGhost,\"sortByGhostComesFirst\"),ze=Object.keys(o);return j&&ze.sort(_e),SS(ze,J)},[o,J,j]),We=n(_e=>u(\"div\",{class:\"uppy-Dashboard-filesInner\",role:\"presentation\",key:_e[0]},_e.map(ze=>u(Ho,{key:ze,uppy:s,id:e,error:t,i18n:r,acquirers:a,resumableUploads:l,individualCancellation:G,hideRetryButton:h,hidePauseResumeButton:p,hideCancelButton:d,showLinkToFileUploadResult:f,showRemoveButtonAfterComplete:y,isWide:b,metaFields:S,recoveredState:j,isSingleFile:E,containerWidth:oe,containerHeight:Be,toggleFileCard:x,handleRequestThumbnail:F,handleCancelThumbnail:U,role:\"listitem\",openFileEditor:B,canEditFile:z,toggleAddFilesPanel:K,file:o[ze]}))),\"renderRow\");return E?u(\"div\",{class:\"uppy-Dashboard-files\"},We(wt[0])):u(du,{class:\"uppy-Dashboard-files\",role:\"list\",data:wt,renderRow:We,rowHeight:Je})},\"default\");var hy;hy=Symbol.for(\"uppy test: disable unused locale key warning\");var Uu=class extends we{constructor(){super(...arguments),this.triggerFileInputClick=()=>{this.fileInput.click()},this.triggerFolderInputClick=()=>{this.folderInput.click()},this.triggerVideoCameraInputClick=()=>{this.mobileVideoFileInput.click()},this.triggerPhotoCameraInputClick=()=>{this.mobilePhotoFileInput.click()},this.onFileInputChange=e=>{this.props.handleInputChange(e),e.target.value=null},this.renderHiddenInput=(e,t)=>u(\"input\",{className:\"uppy-Dashboard-input\",hidden:!0,\"aria-hidden\":\"true\",tabIndex:-1,webkitdirectory:e,type:\"file\",name:\"files[]\",multiple:this.props.maxNumberOfFiles!==1,onChange:this.onFileInputChange,accept:this.props.allowedFileTypes,ref:t}),this.renderHiddenCameraInput=(e,t,r)=>{let o={photo:\"image/*\",video:\"video/*\"}[e];return u(\"input\",{className:\"uppy-Dashboard-input\",hidden:!0,\"aria-hidden\":\"true\",tabIndex:-1,type:\"file\",name:`camera-${e}`,onChange:this.onFileInputChange,capture:t,accept:o,ref:r})},this.renderMyDeviceAcquirer=()=>u(\"div\",{className:\"uppy-DashboardTab\",role:\"presentation\",\"data-uppy-acquirer-id\":\"MyDevice\"},u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn\",role:\"tab\",tabIndex:0,\"data-uppy-super-focusable\":!0,onClick:this.triggerFileInputClick},u(\"div\",{className:\"uppy-DashboardTab-inner\"},u(\"svg\",{className:\"uppy-DashboardTab-iconMyDevice\",\"aria-hidden\":\"true\",focusable:\"false\",width:\"32\",height:\"32\",viewBox:\"0 0 32 32\"},u(\"path\",{d:\"M8.45 22.087l-1.305-6.674h17.678l-1.572 6.674H8.45zm4.975-12.412l1.083 1.765a.823.823 0 00.715.386h7.951V13.5H8.587V9.675h4.838zM26.043 13.5h-1.195v-2.598c0-.463-.336-.75-.798-.75h-8.356l-1.082-1.766A.823.823 0 0013.897 8H7.728c-.462 0-.815.256-.815.718V13.5h-.956a.97.97 0 00-.746.37.972.972 0 00-.19.81l1.724 8.565c.095.44.484.755.933.755H24c.44 0 .824-.3.929-.727l2.043-8.568a.972.972 0 00-.176-.825.967.967 0 00-.753-.38z\",fill:\"currentcolor\",\"fill-rule\":\"evenodd\"}))),u(\"div\",{className:\"uppy-DashboardTab-name\"},this.props.i18n(\"myDevice\")))),this.renderPhotoCamera=()=>u(\"div\",{className:\"uppy-DashboardTab\",role:\"presentation\",\"data-uppy-acquirer-id\":\"MobilePhotoCamera\"},u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn\",role:\"tab\",tabIndex:0,\"data-uppy-super-focusable\":!0,onClick:this.triggerPhotoCameraInputClick},u(\"div\",{className:\"uppy-DashboardTab-inner\"},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"32\",height:\"32\",viewBox:\"0 0 32 32\"},u(\"path\",{d:\"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z\",fill:\"#02B383\",\"fill-rule\":\"nonzero\"}))),u(\"div\",{className:\"uppy-DashboardTab-name\"},this.props.i18n(\"takePictureBtn\")))),this.renderVideoCamera=()=>u(\"div\",{className:\"uppy-DashboardTab\",role:\"presentation\",\"data-uppy-acquirer-id\":\"MobileVideoCamera\"},u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn\",role:\"tab\",tabIndex:0,\"data-uppy-super-focusable\":!0,onClick:this.triggerVideoCameraInputClick},u(\"div\",{className:\"uppy-DashboardTab-inner\"},u(\"svg\",{\"aria-hidden\":\"true\",width:\"32\",height:\"32\",viewBox:\"0 0 32 32\"},u(\"path\",{fill:\"#FF675E\",fillRule:\"nonzero\",d:\"m21.254 14.277 2.941-2.588c.797-.313 1.243.818 1.09 1.554-.01 2.094.02 4.189-.017 6.282-.126.915-1.145 1.08-1.58.34l-2.434-2.142c-.192.287-.504 1.305-.738.468-.104-1.293-.028-2.596-.05-3.894.047-.312.381.823.426 1.069.063-.384.206-.744.362-1.09zm-12.939-3.73c3.858.013 7.717-.025 11.574.02.912.129 1.492 1.237 1.351 2.217-.019 2.412.04 4.83-.03 7.239-.17 1.025-1.166 1.59-2.029 1.429-3.705-.012-7.41.025-11.114-.019-.913-.129-1.492-1.237-1.352-2.217.018-2.404-.036-4.813.029-7.214.136-.82.83-1.473 1.571-1.454z \"}))),u(\"div\",{className:\"uppy-DashboardTab-name\"},this.props.i18n(\"recordVideoBtn\")))),this.renderBrowseButton=(e,t)=>{let r=this.props.acquirers.length;return u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn uppy-Dashboard-browse\",onClick:t,\"data-uppy-super-focusable\":r===0},e)},this.renderDropPasteBrowseTagline=e=>{let t=this.renderBrowseButton(this.props.i18n(\"browseFiles\"),this.triggerFileInputClick),r=this.renderBrowseButton(this.props.i18n(\"browseFolders\"),this.triggerFolderInputClick),s=this.props.fileManagerSelectionType,o=s.charAt(0).toUpperCase()+s.slice(1);return u(\"div\",{class:\"uppy-Dashboard-AddFiles-title\"},this.props.disableLocalFiles?this.props.i18n(\"importFiles\"):e>0?this.props.i18nArray(`dropPasteImport${o}`,{browseFiles:t,browseFolders:r,browse:t}):this.props.i18nArray(`dropPaste${o}`,{browseFiles:t,browseFolders:r,browse:t}))},this.renderAcquirer=e=>u(\"div\",{className:\"uppy-DashboardTab\",role:\"presentation\",\"data-uppy-acquirer-id\":e.id},u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn\",role:\"tab\",tabIndex:0,\"data-cy\":e.id,\"aria-controls\":`uppy-DashboardContent-panel--${e.id}`,\"aria-selected\":this.props.activePickerPanel.id===e.id,\"data-uppy-super-focusable\":!0,onClick:()=>this.props.showPanel(e.id)},u(\"div\",{className:\"uppy-DashboardTab-inner\"},e.icon()),u(\"div\",{className:\"uppy-DashboardTab-name\"},e.name))),this.renderAcquirers=e=>{let t=[...e],r=t.splice(e.length-2,e.length);return u(Ht,null,t.map(s=>this.renderAcquirer(s)),u(\"span\",{role:\"presentation\",style:{\"white-space\":\"nowrap\"}},r.map(s=>this.renderAcquirer(s))))},this.renderSourcesList=(e,t)=>{let{showNativePhotoCameraButton:r,showNativeVideoCameraButton:s}=this.props,o=[],a=\"myDevice\";t||(o.push({key:a,elements:this.renderMyDeviceAcquirer()}),r&&o.push({key:\"nativePhotoCameraButton\",elements:this.renderPhotoCamera()}),s&&o.push({key:\"nativePhotoCameraButton\",elements:this.renderVideoCamera()})),o.push(...e.map(f=>({key:f.id,elements:this.renderAcquirer(f)}))),o.length===1&&o[0].key===a&&(o=[]);let h=[...o],p=h.splice(o.length-2,o.length),d=n(f=>f.map(y=>{let{key:b,elements:S}=y;return u(Ht,{key:b},S)}),\"renderList\");return u(Ht,null,this.renderDropPasteBrowseTagline(o.length),u(\"div\",{className:\"uppy-Dashboard-AddFiles-list\",role:\"tablist\"},d(h),u(\"span\",{role:\"presentation\",style:{\"white-space\":\"nowrap\"}},d(p))))}}[hy](){this.props.i18nArray(\"dropPasteBoth\"),this.props.i18nArray(\"dropPasteFiles\"),this.props.i18nArray(\"dropPasteFolders\"),this.props.i18nArray(\"dropPasteImportBoth\"),this.props.i18nArray(\"dropPasteImportFiles\"),this.props.i18nArray(\"dropPasteImportFolders\")}renderPoweredByUppy(){let{i18nArray:e}=this.props,t=u(\"span\",null,u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon uppy-Dashboard-poweredByIcon\",width:\"11\",height:\"11\",viewBox:\"0 0 11 11\"},u(\"path\",{d:\"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z\",fillRule:\"evenodd\"})),u(\"span\",{className:\"uppy-Dashboard-poweredByUppy\"},\"Uppy\")),r=e(\"poweredBy\",{uppy:t});return u(\"a\",{tabIndex:\"-1\",href:\"https://uppy.io\",rel:\"noreferrer noopener\",target:\"_blank\",className:\"uppy-Dashboard-poweredBy\"},r)}render(){let{showNativePhotoCameraButton:e,showNativeVideoCameraButton:t,nativeCameraFacingMode:r}=this.props;return u(\"div\",{className:\"uppy-Dashboard-AddFiles\"},this.renderHiddenInput(!1,s=>{this.fileInput=s}),this.renderHiddenInput(!0,s=>{this.folderInput=s}),e&&this.renderHiddenCameraInput(\"photo\",r,s=>{this.mobilePhotoFileInput=s}),t&&this.renderHiddenCameraInput(\"video\",r,s=>{this.mobileVideoFileInput=s}),this.renderSourcesList(this.props.acquirers,this.props.disableLocalFiles),u(\"div\",{className:\"uppy-Dashboard-AddFiles-info\"},this.props.note&&u(\"div\",{className:\"uppy-Dashboard-note\"},this.props.note),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy(this.props)))}};n(Uu,\"AddFiles\");var ku=Uu;var dy=de(Qt(),1);var PS=n(i=>u(\"div\",{className:(0,dy.default)(\"uppy-Dashboard-AddFilesPanel\",i.className),\"data-uppy-panelType\":\"AddFiles\",\"aria-hidden\":!i.showAddFilesPanel},u(\"div\",{className:\"uppy-DashboardContent-bar\"},u(\"div\",{className:\"uppy-DashboardContent-title\",role:\"heading\",\"aria-level\":\"1\"},i.i18n(\"addingMoreFiles\")),u(\"button\",{className:\"uppy-DashboardContent-back\",type:\"button\",onClick:()=>i.toggleAddFilesPanel(!1)},i.i18n(\"back\"))),u(ku,i)),\"AddFilesPanel\"),cy=PS;var py=de(Qt(),1);function _S(i){let{tagName:e}=i.target;if(e===\"INPUT\"||e===\"TEXTAREA\"){i.stopPropagation();return}i.preventDefault(),i.stopPropagation()}n(_S,\"ignoreEvent\");var Vi=_S;function xS(i){let{activePickerPanel:e,className:t,hideAllPanels:r,i18n:s,state:o,uppy:a}=i;return u(\"div\",{className:(0,py.default)(\"uppy-DashboardContent-panel\",t),role:\"tabpanel\",\"data-uppy-panelType\":\"PickerPanel\",id:`uppy-DashboardContent-panel--${e.id}`,onDragOver:Vi,onDragLeave:Vi,onDrop:Vi,onPaste:Vi},u(\"div\",{className:\"uppy-DashboardContent-bar\"},u(\"div\",{className:\"uppy-DashboardContent-title\",role:\"heading\",\"aria-level\":\"1\"},s(\"importFrom\",{name:e.name})),u(\"button\",{className:\"uppy-DashboardContent-back\",type:\"button\",onClick:r},s(\"cancel\"))),u(\"div\",{className:\"uppy-DashboardContent-panelBody\"},a.getPlugin(e.id).render(o)))}n(xS,\"PickerPanelContent\");var fy=xS;var my=de(Qt(),1);function FS(i){let e=i.files[i.fileCardFor],t=n(()=>{i.uppy.emit(\"file-editor:cancel\",e),i.hideAllPanels()},\"handleCancel\");return u(\"div\",{className:(0,my.default)(\"uppy-DashboardContent-panel\",i.className),role:\"tabpanel\",\"data-uppy-panelType\":\"FileEditor\",id:\"uppy-DashboardContent-panel--editor\"},u(\"div\",{className:\"uppy-DashboardContent-bar\"},u(\"div\",{className:\"uppy-DashboardContent-title\",role:\"heading\",\"aria-level\":\"1\"},i.i18nArray(\"editing\",{file:u(\"span\",{className:\"uppy-DashboardContent-titleFile\"},e.meta?e.meta.name:e.name)})),u(\"button\",{className:\"uppy-DashboardContent-back\",type:\"button\",onClick:t},i.i18n(\"cancel\")),u(\"button\",{className:\"uppy-DashboardContent-save\",type:\"button\",onClick:i.saveFileEditor},i.i18n(\"save\"))),u(\"div\",{className:\"uppy-DashboardContent-panelBody\"},i.editors.map(r=>i.uppy.getPlugin(r.id).render(i.state))))}n(FS,\"EditorPanel\");var gy=FS;var Wi={STATE_ERROR:\"error\",STATE_WAITING:\"waiting\",STATE_PREPROCESSING:\"preprocessing\",STATE_UPLOADING:\"uploading\",STATE_POSTPROCESSING:\"postprocessing\",STATE_COMPLETE:\"complete\",STATE_PAUSED:\"paused\"};function ES(i,e,t,r){if(r===void 0&&(r={}),i)return Wi.STATE_ERROR;if(e)return Wi.STATE_COMPLETE;if(t)return Wi.STATE_PAUSED;let s=Wi.STATE_WAITING,o=Object.keys(r);for(let a=0;a<o.length;a++){let{progress:l}=r[o[a]];if(l.uploadStarted&&!l.uploadComplete)return Wi.STATE_UPLOADING;l.preprocess&&s!==Wi.STATE_UPLOADING&&(s=Wi.STATE_PREPROCESSING),l.postprocess&&s!==Wi.STATE_UPLOADING&&s!==Wi.STATE_PREPROCESSING&&(s=Wi.STATE_POSTPROCESSING)}return s}n(ES,\"getUploadingState\");function OS(i){let{files:e,i18n:t,isAllComplete:r,isAllErrored:s,isAllPaused:o,inProgressNotPausedFiles:a,newFiles:l,processingFiles:h}=i;switch(ES(s,r,o,e)){case\"uploading\":return t(\"uploadingXFiles\",{smart_count:a.length});case\"preprocessing\":case\"postprocessing\":return t(\"processingXFiles\",{smart_count:h.length});case\"paused\":return t(\"uploadPaused\");case\"waiting\":return t(\"xFilesSelected\",{smart_count:l.length});case\"complete\":return t(\"uploadComplete\");case\"error\":return t(\"error\");default:}}n(OS,\"UploadStatus\");function CS(i){let{i18n:e,isAllComplete:t,hideCancelButton:r,maxNumberOfFiles:s,toggleAddFilesPanel:o,uppy:a}=i,{allowNewUpload:l}=i;return l&&s&&(l=i.totalFileCount<i.maxNumberOfFiles),u(\"div\",{className:\"uppy-DashboardContent-bar\"},!t&&!r?u(\"button\",{className:\"uppy-DashboardContent-back\",type:\"button\",onClick:()=>a.cancelAll()},e(\"cancel\")):u(\"div\",null),u(\"div\",{className:\"uppy-DashboardContent-title\",role:\"heading\",\"aria-level\":\"1\"},u(OS,i)),l?u(\"button\",{className:\"uppy-DashboardContent-addMore\",type:\"button\",\"aria-label\":e(\"addMoreFiles\"),title:e(\"addMoreFiles\"),onClick:()=>o(!0)},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"15\",height:\"15\",viewBox:\"0 0 15 15\"},u(\"path\",{d:\"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z\"})),u(\"span\",{className:\"uppy-DashboardContent-addMoreCaption\"},e(\"addMore\"))):u(\"div\",null))}n(CS,\"PanelTopBar\");var yy=CS;var vy=de(Qt(),1);function Dd(i){let{computedMetaFields:e,requiredMetaFields:t,updateMeta:r,form:s,formState:o}=i,a={text:\"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input\"};return e.map(l=>{let h=`uppy-Dashboard-FileCard-input-${l.id}`,p=t.includes(l.id);return u(\"fieldset\",{key:l.id,className:\"uppy-Dashboard-FileCard-fieldset\"},u(\"label\",{className:\"uppy-Dashboard-FileCard-label\",htmlFor:h},l.name),l.render!==void 0?l.render({value:o[l.id],onChange:d=>r(d,l.id),fieldCSSClasses:a,required:p,form:s.id},u):u(\"input\",{className:a.text,id:h,form:s.id,type:l.type||\"text\",required:p,value:o[l.id],placeholder:l.placeholder,onInput:d=>r(d.target.value,l.id),\"data-uppy-super-focusable\":!0}))})}n(Dd,\"RenderMetaFields\");function Id(i){var e;let{files:t,fileCardFor:r,toggleFileCard:s,saveFileCard:o,metaFields:a,requiredMetaFields:l,openFileEditor:h,i18n:p,i18nArray:d,className:f,canEditFile:y}=i,b=n(()=>typeof a==\"function\"?a(t[r]):a,\"getMetaFields\"),S=t[r],E=(e=b())!=null?e:[],x=y(S),F={};E.forEach(K=>{var oe;F[K.id]=(oe=S.meta[K.id])!=null?oe:\"\"});let[U,j]=Ao(F),G=qn(K=>{K.preventDefault(),o(U,r)},[o,U,r]),J=n((K,oe)=>{j({...U,[oe]:K})},\"updateMeta\"),B=n(()=>{s(!1)},\"handleCancel\"),[z]=Ao(()=>{let K=document.createElement(\"form\");return K.setAttribute(\"tabindex\",\"-1\"),K.id=Pt(),K});return Os(()=>(document.body.appendChild(z),z.addEventListener(\"submit\",G),()=>{z.removeEventListener(\"submit\",G),document.body.removeChild(z)}),[z,G]),u(\"div\",{className:(0,vy.default)(\"uppy-Dashboard-FileCard\",f),\"data-uppy-panelType\":\"FileCard\",onDragOver:Vi,onDragLeave:Vi,onDrop:Vi,onPaste:Vi},u(\"div\",{className:\"uppy-DashboardContent-bar\"},u(\"div\",{className:\"uppy-DashboardContent-title\",role:\"heading\",\"aria-level\":\"1\"},d(\"editing\",{file:u(\"span\",{className:\"uppy-DashboardContent-titleFile\"},S.meta?S.meta.name:S.name)})),u(\"button\",{className:\"uppy-DashboardContent-back\",type:\"button\",form:z.id,title:p(\"finishEditingFile\"),onClick:B},p(\"cancel\"))),u(\"div\",{className:\"uppy-Dashboard-FileCard-inner\"},u(\"div\",{className:\"uppy-Dashboard-FileCard-preview\",style:{backgroundColor:Rs(S.type).color}},u(ma,{file:S}),x&&u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit\",onClick:K=>{G(K),h(S)}},p(\"editFile\"))),u(\"div\",{className:\"uppy-Dashboard-FileCard-info\"},u(Dd,{computedMetaFields:E,requiredMetaFields:l,updateMeta:J,form:z,formState:U})),u(\"div\",{className:\"uppy-Dashboard-FileCard-actions\"},u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn\",type:\"submit\",form:z.id},p(\"saveChanges\")),u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn\",type:\"button\",onClick:B,form:z.id},p(\"cancel\")))))}n(Id,\"FileCard\");var wy=de(Qt(),1);var $o=\"uppy-transition-slideDownUp\",by=250,Du=class extends we{constructor(e){super(e),this.state={cachedChildren:null,className:\"\"}}componentWillUpdate(e){let{cachedChildren:t}=this.state,r=ci(e.children)[0];if(t===r)return null;let s={cachedChildren:r};r&&!t&&(s.className=`${$o}-enter`,cancelAnimationFrame(this.animationFrame),clearTimeout(this.leaveTimeout),this.leaveTimeout=void 0,this.animationFrame=requestAnimationFrame(()=>{this.setState({className:`${$o}-enter ${$o}-enter-active`}),this.enterTimeout=setTimeout(()=>{this.setState({className:\"\"})},by)})),t&&!r&&this.leaveTimeout===void 0&&(s.cachedChildren=t,s.className=`${$o}-leave`,cancelAnimationFrame(this.animationFrame),clearTimeout(this.enterTimeout),this.enterTimeout=void 0,this.animationFrame=requestAnimationFrame(()=>{this.setState({className:`${$o}-leave ${$o}-leave-active`}),this.leaveTimeout=setTimeout(()=>{this.setState({cachedChildren:null,className:\"\"})},by)})),this.setState(s)}render(){let{cachedChildren:e,className:t}=this.state;return e?jl(e,{className:(0,wy.default)(t,e.props.className)}):null}};n(Du,\"Slide\");var ya=Du;function Us(){return Us=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Us.apply(this,arguments)}n(Us,\"_extends\");var Sy=900,Py=700,Nd=576,_y=330;function Md(i){let e=i.totalFileCount===0,t=i.totalFileCount===1,r=i.containerWidth>Nd,s=i.containerHeight>_y,o=(0,xy.default)({\"uppy-Dashboard\":!0,\"uppy-Dashboard--isDisabled\":i.disabled,\"uppy-Dashboard--animateOpenClose\":i.animateOpenClose,\"uppy-Dashboard--isClosing\":i.isClosing,\"uppy-Dashboard--isDraggingOver\":i.isDraggingOver,\"uppy-Dashboard--modal\":!i.inline,\"uppy-size--md\":i.containerWidth>Nd,\"uppy-size--lg\":i.containerWidth>Py,\"uppy-size--xl\":i.containerWidth>Sy,\"uppy-size--height-md\":i.containerHeight>_y,\"uppy-Dashboard--isAddFilesPanelVisible\":i.showAddFilesPanel,\"uppy-Dashboard--isInnerWrapVisible\":i.areInsidesReadyToBeVisible,\"uppy-Dashboard--singleFile\":i.singleFileFullScreen&&t&&s}),a=1;i.containerWidth>Sy?a=5:i.containerWidth>Py?a=4:i.containerWidth>Nd&&(a=3);let l=i.showSelectedFiles&&!e,h=i.recoveredState?Object.keys(i.recoveredState.files).length:null,p=i.files?Object.keys(i.files).filter(y=>i.files[y].isGhost).length:null,d=n(()=>p>0?i.i18n(\"recoveredXFiles\",{smart_count:p}):i.i18n(\"recoveredAllFiles\"),\"renderRestoredText\");return u(\"div\",{className:o,\"data-uppy-theme\":i.theme,\"data-uppy-num-acquirers\":i.acquirers.length,\"data-uppy-drag-drop-supported\":!i.disableLocalFiles&&fa(),\"aria-hidden\":i.inline?\"false\":i.isHidden,\"aria-disabled\":i.disabled,\"aria-label\":i.inline?i.i18n(\"dashboardTitle\"):i.i18n(\"dashboardWindowTitle\"),onPaste:i.handlePaste,onDragOver:i.handleDragOver,onDragLeave:i.handleDragLeave,onDrop:i.handleDrop},u(\"div\",{\"aria-hidden\":\"true\",className:\"uppy-Dashboard-overlay\",tabIndex:-1,onClick:i.handleClickOutside}),u(\"div\",{className:\"uppy-Dashboard-inner\",\"aria-modal\":!i.inline&&\"true\",role:!i.inline&&\"dialog\",style:{width:i.inline&&i.width?i.width:\"\",height:i.inline&&i.height?i.height:\"\"}},i.inline?null:u(\"button\",{className:\"uppy-u-reset uppy-Dashboard-close\",type:\"button\",\"aria-label\":i.i18n(\"closeModal\"),title:i.i18n(\"closeModal\"),onClick:i.closeModal},u(\"span\",{\"aria-hidden\":\"true\"},\"\\xD7\")),u(\"div\",{className:\"uppy-Dashboard-innerWrap\"},u(\"div\",{className:\"uppy-Dashboard-dropFilesHereHint\"},i.i18n(\"dropHint\")),l&&u(yy,i),h&&u(\"div\",{className:\"uppy-Dashboard-serviceMsg\"},u(\"svg\",{className:\"uppy-Dashboard-serviceMsg-icon\",\"aria-hidden\":\"true\",focusable:\"false\",width:\"21\",height:\"16\",viewBox:\"0 0 24 19\"},u(\"g\",{transform:\"translate(0 -1)\",fill:\"none\",fillRule:\"evenodd\"},u(\"path\",{d:\"M12.857 1.43l10.234 17.056A1 1 0 0122.234 20H1.766a1 1 0 01-.857-1.514L11.143 1.429a1 1 0 011.714 0z\",fill:\"#FFD300\"}),u(\"path\",{fill:\"#000\",d:\"M11 6h2l-.3 8h-1.4z\"}),u(\"circle\",{fill:\"#000\",cx:\"12\",cy:\"17\",r:\"1\"}))),u(\"strong\",{className:\"uppy-Dashboard-serviceMsg-title\"},i.i18n(\"sessionRestored\")),u(\"div\",{className:\"uppy-Dashboard-serviceMsg-text\"},d())),l?u(uy,{id:i.id,error:i.error,i18n:i.i18n,uppy:i.uppy,files:i.files,acquirers:i.acquirers,resumableUploads:i.resumableUploads,hideRetryButton:i.hideRetryButton,hidePauseResumeButton:i.hidePauseResumeButton,hideCancelButton:i.hideCancelButton,showLinkToFileUploadResult:i.showLinkToFileUploadResult,showRemoveButtonAfterComplete:i.showRemoveButtonAfterComplete,isWide:i.isWide,metaFields:i.metaFields,toggleFileCard:i.toggleFileCard,handleRequestThumbnail:i.handleRequestThumbnail,handleCancelThumbnail:i.handleCancelThumbnail,recoveredState:i.recoveredState,individualCancellation:i.individualCancellation,openFileEditor:i.openFileEditor,canEditFile:i.canEditFile,toggleAddFilesPanel:i.toggleAddFilesPanel,isSingleFile:t,itemsPerRow:a}):u(ku,Us({},i,{isSizeMD:r})),u(ya,null,i.showAddFilesPanel?u(cy,Us({key:\"AddFiles\"},i,{isSizeMD:r})):null),u(ya,null,i.fileCardFor?u(Id,Us({key:\"FileCard\"},i)):null),u(ya,null,i.activePickerPanel?u(fy,Us({key:\"Picker\"},i)):null),u(ya,null,i.showFileEditor?u(gy,Us({key:\"Editor\"},i)):null),u(\"div\",{className:\"uppy-Dashboard-progressindicators\"},i.progressindicators.map(y=>i.uppy.getPlugin(y.id).render(i.state))))))}n(Md,\"Dashboard\");var Fy={strings:{closeModal:\"Close Modal\",addMoreFiles:\"Add more files\",addingMoreFiles:\"Adding more files\",importFrom:\"Import from %{name}\",dashboardWindowTitle:\"Uppy Dashboard Window (Press escape to close)\",dashboardTitle:\"Uppy Dashboard\",copyLinkToClipboardSuccess:\"Link copied to clipboard.\",copyLinkToClipboardFallback:\"Copy the URL below\",copyLink:\"Copy link\",back:\"Back\",removeFile:\"Remove file\",editFile:\"Edit file\",editing:\"Editing %{file}\",error:\"Error\",finishEditingFile:\"Finish editing file\",saveChanges:\"Save changes\",myDevice:\"My Device\",dropHint:\"Drop your files here\",uploadComplete:\"Upload complete\",uploadPaused:\"Upload paused\",resumeUpload:\"Resume upload\",pauseUpload:\"Pause upload\",retryUpload:\"Retry upload\",cancelUpload:\"Cancel upload\",xFilesSelected:{0:\"%{smart_count} file selected\",1:\"%{smart_count} files selected\"},uploadingXFiles:{0:\"Uploading %{smart_count} file\",1:\"Uploading %{smart_count} files\"},processingXFiles:{0:\"Processing %{smart_count} file\",1:\"Processing %{smart_count} files\"},poweredBy:\"Powered by %{uppy}\",addMore:\"Add more\",editFileWithFilename:\"Edit file %{file}\",save:\"Save\",cancel:\"Cancel\",dropPasteFiles:\"Drop files here or %{browseFiles}\",dropPasteFolders:\"Drop files here or %{browseFolders}\",dropPasteBoth:\"Drop files here, %{browseFiles} or %{browseFolders}\",dropPasteImportFiles:\"Drop files here, %{browseFiles} or import from:\",dropPasteImportFolders:\"Drop files here, %{browseFolders} or import from:\",dropPasteImportBoth:\"Drop files here, %{browseFiles}, %{browseFolders} or import from:\",importFiles:\"Import files from:\",browseFiles:\"browse files\",browseFolders:\"browse folders\",recoveredXFiles:{0:\"We could not fully recover 1 file. Please re-select it and resume the upload.\",1:\"We could not fully recover %{smart_count} files. Please re-select them and resume the upload.\"},recoveredAllFiles:\"We restored all files. You can now resume the upload.\",sessionRestored:\"Session restored\",reSelect:\"Re-select\",missingRequiredMetaFields:{0:\"Missing required meta field: %{fields}.\",1:\"Missing required meta fields: %{fields}.\"},takePictureBtn:\"Take Picture\",recordVideoBtn:\"Record Video\"}};function Ae(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(Ae,\"_classPrivateFieldLooseBase\");var TS=0;function Ci(i){return\"__private_\"+TS+++\"_\"+i}n(Ci,\"_classPrivateFieldLooseKey\");var AS={version:\"3.7.1\"},Ld=_d.default||_d,Ey=9,RS=27;function Oy(){let i={};return i.promise=new Promise((e,t)=>{i.resolve=e,i.reject=t}),i}n(Oy,\"createPromise\");var ks=Ci(\"disabledNodes\"),Tr=Ci(\"generateLargeThumbnailIfSingleFile\"),va=Ci(\"openFileEditorWhenFilesAdded\"),Ds=Ci(\"attachRenderFunctionToTarget\"),Bd=Ci(\"isTargetSupported\"),zd=Ci(\"getAcquirers\"),jd=Ci(\"getProgressIndicators\"),Ar=Ci(\"getEditors\"),Hd=Ci(\"addSpecifiedPluginsFromOptions\"),$d=Ci(\"autoDiscoverPlugins\"),Is=Ci(\"addSupportedPluginIfNoTarget\"),is=class extends Z{constructor(e,t){var r;super(e,t),r=this,Object.defineProperty(this,ks,{writable:!0,value:null}),this.removeTarget=o=>{let l=this.getPluginState().targets.filter(h=>h.id!==o.id);this.setPluginState({targets:l})},this.addTarget=o=>{let a=o.id||o.constructor.name,l=o.title||a,h=o.type;if(h!==\"acquirer\"&&h!==\"progressindicator\"&&h!==\"editor\"){let y=\"Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor\";this.uppy.log(y,\"error\");return}let p={id:a,name:l,type:h},f=this.getPluginState().targets.slice();return f.push(p),this.setPluginState({targets:f}),this.el},this.hideAllPanels=()=>{let o=this.getPluginState(),a={activePickerPanel:!1,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1};o.activePickerPanel===a.activePickerPanel&&o.showAddFilesPanel===a.showAddFilesPanel&&o.showFileEditor===a.showFileEditor&&o.activeOverlayType===a.activeOverlayType||(this.setPluginState(a),this.uppy.emit(\"dashboard:close-panel\",o.activePickerPanel.id))},this.showPanel=o=>{let{targets:a}=this.getPluginState(),l=a.filter(h=>h.type===\"acquirer\"&&h.id===o)[0];this.setPluginState({activePickerPanel:l,activeOverlayType:\"PickerPanel\"}),this.uppy.emit(\"dashboard:show-panel\",o)},this.canEditFile=o=>{let{targets:a}=this.getPluginState();return Ae(this,Ar)[Ar](a).some(h=>this.uppy.getPlugin(h.id).canEditFile(o))},this.openFileEditor=o=>{let{targets:a}=this.getPluginState(),l=Ae(this,Ar)[Ar](a);this.setPluginState({showFileEditor:!0,fileCardFor:o.id||null,activeOverlayType:\"FileEditor\"}),l.forEach(h=>{this.uppy.getPlugin(h.id).selectFile(o)})},this.saveFileEditor=()=>{let{targets:o}=this.getPluginState();Ae(this,Ar)[Ar](o).forEach(l=>{this.uppy.getPlugin(l.id).save()}),this.hideAllPanels()},this.openModal=()=>{let{promise:o,resolve:a}=Oy();if(this.savedScrollPosition=window.pageYOffset,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add(\"uppy-Dashboard-isFixed\"),this.opts.animateOpenClose&&this.getPluginState().isClosing){let l=n(()=>{this.setPluginState({isHidden:!1}),this.el.removeEventListener(\"animationend\",l,!1),a()},\"handler\");this.el.addEventListener(\"animationend\",l,!1)}else this.setPluginState({isHidden:!1}),a();return this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener(\"keydown\",this.handleKeyDownInModal),this.uppy.emit(\"dashboard:modal-open\"),o},this.closeModal=function(o){o===void 0&&(o={});let{manualClose:a=!0}=o,{isHidden:l,isClosing:h}=r.getPluginState();if(l||h)return;let{promise:p,resolve:d}=Oy();if(r.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove(\"uppy-Dashboard-isFixed\"),r.opts.animateOpenClose){r.setPluginState({isClosing:!0});let y=n(()=>{r.setPluginState({isHidden:!0,isClosing:!1}),r.superFocus.cancel(),r.savedActiveElement.focus(),r.el.removeEventListener(\"animationend\",y,!1),d()},\"handler\");r.el.addEventListener(\"animationend\",y,!1)}else r.setPluginState({isHidden:!0}),r.superFocus.cancel(),r.savedActiveElement.focus(),d();if(document.removeEventListener(\"keydown\",r.handleKeyDownInModal),a&&r.opts.browserBackButtonClose){var f;(f=history.state)!=null&&f[r.modalName]&&history.back()}return r.uppy.emit(\"dashboard:modal-closed\"),p},this.isModalOpen=()=>!this.getPluginState().isHidden||!1,this.requestCloseModal=()=>this.opts.onRequestCloseModal?this.opts.onRequestCloseModal():this.closeModal(),this.setDarkModeCapability=o=>{let{capabilities:a}=this.uppy.getState();this.uppy.setState({capabilities:{...a,darkMode:o}})},this.handleSystemDarkModeChange=o=>{let a=o.matches;this.uppy.log(`[Dashboard] Dark mode is ${a?\"on\":\"off\"}`),this.setDarkModeCapability(a)},this.toggleFileCard=(o,a)=>{let l=this.uppy.getFile(a);o?this.uppy.emit(\"dashboard:file-edit-start\",l):this.uppy.emit(\"dashboard:file-edit-complete\",l),this.setPluginState({fileCardFor:o?a:null,activeOverlayType:o?\"FileCard\":null})},this.toggleAddFilesPanel=o=>{this.setPluginState({showAddFilesPanel:o,activeOverlayType:o?\"AddFiles\":null})},this.addFiles=o=>{let a=o.map(l=>({source:this.id,name:l.name,type:l.type,data:l,meta:{relativePath:l.relativePath||l.webkitRelativePath||null}}));try{this.uppy.addFiles(a)}catch(l){this.uppy.log(l)}},this.startListeningToResize=()=>{this.resizeObserver=new ResizeObserver(o=>{let a=o[0],{width:l,height:h}=a.contentRect;this.setPluginState({containerWidth:l,containerHeight:h,areInsidesReadyToBeVisible:!0})}),this.resizeObserver.observe(this.el.querySelector(\".uppy-Dashboard-inner\")),this.makeDashboardInsidesVisibleAnywayTimeout=setTimeout(()=>{let o=this.getPluginState(),a=!this.opts.inline&&o.isHidden;!o.areInsidesReadyToBeVisible&&!a&&(this.uppy.log(\"[Dashboard] resize event didn\\u2019t fire on time: defaulted to mobile layout\",\"warning\"),this.setPluginState({areInsidesReadyToBeVisible:!0}))},1e3)},this.stopListeningToResize=()=>{this.resizeObserver.disconnect(),clearTimeout(this.makeDashboardInsidesVisibleAnywayTimeout)},this.recordIfFocusedOnUppyRecently=o=>{this.el.contains(o.target)?this.ifFocusedOnUppyRecently=!0:(this.ifFocusedOnUppyRecently=!1,this.superFocus.cancel())},this.disableInteractiveElements=o=>{var a;let l=[\"a[href]\",\"input:not([disabled])\",\"select:not([disabled])\",\"textarea:not([disabled])\",\"button:not([disabled])\",'[role=\"button\"]:not([disabled])'],h=(a=Ae(this,ks)[ks])!=null?a:Qe(this.el.querySelectorAll(l)).filter(p=>!p.classList.contains(\"uppy-Dashboard-close\"));for(let p of h)p.tagName===\"A\"?p.setAttribute(\"aria-disabled\",o):p.disabled=o;o?Ae(this,ks)[ks]=h:Ae(this,ks)[ks]=null,this.dashboardIsDisabled=o},this.updateBrowserHistory=()=>{var o;(o=history.state)!=null&&o[this.modalName]||history.pushState({...history.state,[this.modalName]:!0},\"\"),window.addEventListener(\"popstate\",this.handlePopState,!1)},this.handlePopState=o=>{var a;this.isModalOpen()&&(!o.state||!o.state[this.modalName])&&this.closeModal({manualClose:!1}),!this.isModalOpen()&&(a=o.state)!=null&&a[this.modalName]&&history.back()},this.handleKeyDownInModal=o=>{o.keyCode===RS&&this.requestCloseModal(o),o.keyCode===Ey&&xd(o,this.getPluginState().activeOverlayType,this.el)},this.handleClickOutside=()=>{this.opts.closeModalOnClickOutside&&this.requestCloseModal()},this.handlePaste=o=>{this.uppy.iteratePlugins(l=>{l.type===\"acquirer\"&&(l.handleRootPaste==null||l.handleRootPaste(o))});let a=Qe(o.clipboardData.files);a.length>0&&(this.uppy.log(\"[Dashboard] Files pasted\"),this.addFiles(a))},this.handleInputChange=o=>{o.preventDefault();let a=Qe(o.target.files);a.length>0&&(this.uppy.log(\"[Dashboard] Files selected through input\"),this.addFiles(a))},this.handleDragOver=o=>{var a,l;o.preventDefault(),o.stopPropagation();let h=n(()=>{let y=!0;return this.uppy.iteratePlugins(b=>{b.canHandleRootDrop!=null&&b.canHandleRootDrop(o)&&(y=!0)}),y},\"canSomePluginHandleRootDrop\"),p=n(()=>{let{types:y}=o.dataTransfer;return y.some(b=>b===\"Files\")},\"doesEventHaveFiles\"),d=h(o),f=p(o);if(!d&&!f||this.opts.disabled||this.opts.disableLocalFiles&&(f||!d)||!this.uppy.getState().allowNewUpload){o.dataTransfer.dropEffect=\"none\",clearTimeout(this.removeDragOverClassTimeout);return}o.dataTransfer.dropEffect=\"copy\",clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!0}),(a=(l=this.opts).onDragOver)==null||a.call(l,o)},this.handleDragLeave=o=>{var a,l;o.preventDefault(),o.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.removeDragOverClassTimeout=setTimeout(()=>{this.setPluginState({isDraggingOver:!1})},50),(a=(l=this.opts).onDragLeave)==null||a.call(l,o)},this.handleDrop=async o=>{var a,l;o.preventDefault(),o.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins(f=>{f.type===\"acquirer\"&&(f.handleRootDrop==null||f.handleRootDrop(o))});let h=!1,p=n(f=>{this.uppy.log(f,\"error\"),h||(this.uppy.info(f.message,\"error\"),h=!0)},\"logDropError\");this.uppy.log(\"[Dashboard] Processing dropped files\");let d=await As(o.dataTransfer,{logDropError:p});d.length>0&&(this.uppy.log(\"[Dashboard] Files dropped\"),this.addFiles(d)),(a=(l=this.opts).onDrop)==null||a.call(l,o)},this.handleRequestThumbnail=o=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit(\"thumbnail:request\",o)},this.handleCancelThumbnail=o=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit(\"thumbnail:cancel\",o)},this.handleKeyDownInInline=o=>{o.keyCode===Ey&&Zg(o,this.getPluginState().activeOverlayType,this.el)},this.handlePasteOnBody=o=>{this.el.contains(document.activeElement)&&this.handlePaste(o)},this.handleComplete=o=>{let{failed:a}=o;this.opts.closeAfterFinish&&a.length===0&&this.requestCloseModal()},this.handleCancelRestore=()=>{this.uppy.emit(\"restore-canceled\")},Object.defineProperty(this,Tr,{writable:!0,value:()=>{if(this.opts.disableThumbnailGenerator)return;let o=600,a=this.uppy.getFiles();if(a.length===1){let l=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);l?.setOptions({thumbnailWidth:o});let h={...a[0],preview:void 0};l.requestThumbnail(h).then(()=>{l?.setOptions({thumbnailWidth:this.opts.thumbnailWidth})})}}}),Object.defineProperty(this,va,{writable:!0,value:o=>{let a=o[0];this.canEditFile(a)&&this.openFileEditor(a)}}),this.initEvents=()=>{if(this.opts.trigger&&!this.opts.inline){let o=Ou(this.opts.trigger);o?o.forEach(a=>a.addEventListener(\"click\",this.openModal)):this.uppy.log(\"Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself\",\"warning\")}this.startListeningToResize(),document.addEventListener(\"paste\",this.handlePasteOnBody),this.uppy.on(\"plugin-added\",Ae(this,Is)[Is]),this.uppy.on(\"plugin-remove\",this.removeTarget),this.uppy.on(\"file-added\",this.hideAllPanels),this.uppy.on(\"dashboard:modal-closed\",this.hideAllPanels),this.uppy.on(\"file-editor:complete\",this.hideAllPanels),this.uppy.on(\"complete\",this.handleComplete),this.uppy.on(\"files-added\",Ae(this,Tr)[Tr]),this.uppy.on(\"file-removed\",Ae(this,Tr)[Tr]),document.addEventListener(\"focus\",this.recordIfFocusedOnUppyRecently,!0),document.addEventListener(\"click\",this.recordIfFocusedOnUppyRecently,!0),this.opts.inline&&this.el.addEventListener(\"keydown\",this.handleKeyDownInInline),this.opts.autoOpenFileEditor&&this.uppy.on(\"files-added\",Ae(this,va)[va])},this.removeEvents=()=>{let o=Ou(this.opts.trigger);!this.opts.inline&&o&&o.forEach(a=>a.removeEventListener(\"click\",this.openModal)),this.stopListeningToResize(),document.removeEventListener(\"paste\",this.handlePasteOnBody),window.removeEventListener(\"popstate\",this.handlePopState,!1),this.uppy.off(\"plugin-added\",Ae(this,Is)[Is]),this.uppy.off(\"plugin-remove\",this.removeTarget),this.uppy.off(\"file-added\",this.hideAllPanels),this.uppy.off(\"dashboard:modal-closed\",this.hideAllPanels),this.uppy.off(\"file-editor:complete\",this.hideAllPanels),this.uppy.off(\"complete\",this.handleComplete),this.uppy.off(\"files-added\",Ae(this,Tr)[Tr]),this.uppy.off(\"file-removed\",Ae(this,Tr)[Tr]),document.removeEventListener(\"focus\",this.recordIfFocusedOnUppyRecently),document.removeEventListener(\"click\",this.recordIfFocusedOnUppyRecently),this.opts.inline&&this.el.removeEventListener(\"keydown\",this.handleKeyDownInInline),this.opts.autoOpenFileEditor&&this.uppy.off(\"files-added\",Ae(this,va)[va])},this.superFocusOnEachUpdate=()=>{let o=this.el.contains(document.activeElement),a=document.activeElement===document.body||document.activeElement===null,l=this.uppy.getState().info.length===0,h=!this.opts.inline;l&&(h||o||a&&this.ifFocusedOnUppyRecently)?this.superFocus(this.el,this.getPluginState().activeOverlayType):this.superFocus.cancel()},this.afterUpdate=()=>{if(this.opts.disabled&&!this.dashboardIsDisabled){this.disableInteractiveElements(!0);return}!this.opts.disabled&&this.dashboardIsDisabled&&this.disableInteractiveElements(!1),this.superFocusOnEachUpdate()},this.saveFileCard=(o,a)=>{this.uppy.setFileMeta(a,o),this.toggleFileCard(!1,a)},Object.defineProperty(this,Ds,{writable:!0,value:o=>{let a=this.uppy.getPlugin(o.id);return{...o,icon:a.icon||this.opts.defaultPickerIcon,render:a.render}}}),Object.defineProperty(this,Bd,{writable:!0,value:o=>{let a=this.uppy.getPlugin(o.id);return typeof a.isSupported!=\"function\"?!0:a.isSupported()}}),Object.defineProperty(this,zd,{writable:!0,value:Ld(o=>o.filter(a=>a.type===\"acquirer\"&&Ae(this,Bd)[Bd](a)).map(Ae(this,Ds)[Ds]))}),Object.defineProperty(this,jd,{writable:!0,value:Ld(o=>o.filter(a=>a.type===\"progressindicator\").map(Ae(this,Ds)[Ds]))}),Object.defineProperty(this,Ar,{writable:!0,value:Ld(o=>o.filter(a=>a.type===\"editor\").map(Ae(this,Ds)[Ds]))}),this.render=o=>{let a=this.getPluginState(),{files:l,capabilities:h,allowNewUpload:p}=o,{newFiles:d,uploadStartedFiles:f,completeFiles:y,erroredFiles:b,inProgressFiles:S,inProgressNotPausedFiles:E,processingFiles:x,isUploadStarted:F,isAllComplete:U,isAllErrored:j,isAllPaused:G}=this.uppy.getObjectOfFilesPerState(),J=Ae(this,zd)[zd](a.targets),B=Ae(this,jd)[jd](a.targets),z=Ae(this,Ar)[Ar](a.targets),K;return this.opts.theme===\"auto\"?K=h.darkMode?\"dark\":\"light\":K=this.opts.theme,[\"files\",\"folders\",\"both\"].indexOf(this.opts.fileManagerSelectionType)<0&&(this.opts.fileManagerSelectionType=\"files\",console.warn(`Unsupported option for \"fileManagerSelectionType\". Using default of \"${this.opts.fileManagerSelectionType}\".`)),Md({state:o,isHidden:a.isHidden,files:l,newFiles:d,uploadStartedFiles:f,completeFiles:y,erroredFiles:b,inProgressFiles:S,inProgressNotPausedFiles:E,processingFiles:x,isUploadStarted:F,isAllComplete:U,isAllErrored:j,isAllPaused:G,totalFileCount:Object.keys(l).length,totalProgress:o.totalProgress,allowNewUpload:p,acquirers:J,theme:K,disabled:this.opts.disabled,disableLocalFiles:this.opts.disableLocalFiles,direction:this.opts.direction,activePickerPanel:a.activePickerPanel,showFileEditor:a.showFileEditor,saveFileEditor:this.saveFileEditor,disableInteractiveElements:this.disableInteractiveElements,animateOpenClose:this.opts.animateOpenClose,isClosing:a.isClosing,progressindicators:B,editors:z,autoProceed:this.uppy.opts.autoProceed,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,i18n:this.i18n,i18nArray:this.i18nArray,uppy:this.uppy,note:this.opts.note,recoveredState:o.recoveredState,metaFields:a.metaFields,resumableUploads:h.resumableUploads||!1,individualCancellation:h.individualCancellation,isMobileDevice:h.isMobileDevice,fileCardFor:a.fileCardFor,toggleFileCard:this.toggleFileCard,toggleAddFilesPanel:this.toggleAddFilesPanel,showAddFilesPanel:a.showAddFilesPanel,saveFileCard:this.saveFileCard,openFileEditor:this.openFileEditor,canEditFile:this.canEditFile,width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,fileManagerSelectionType:this.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,hideCancelButton:this.opts.hideCancelButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,showRemoveButtonAfterComplete:this.opts.showRemoveButtonAfterComplete,containerWidth:a.containerWidth,containerHeight:a.containerHeight,areInsidesReadyToBeVisible:a.areInsidesReadyToBeVisible,isTargetDOMEl:this.isTargetDOMEl,parentElement:this.el,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles,requiredMetaFields:this.uppy.opts.restrictions.requiredMetaFields,showSelectedFiles:this.opts.showSelectedFiles,showNativePhotoCameraButton:this.opts.showNativePhotoCameraButton,showNativeVideoCameraButton:this.opts.showNativeVideoCameraButton,nativeCameraFacingMode:this.opts.nativeCameraFacingMode,singleFileFullScreen:this.opts.singleFileFullScreen,handleCancelRestore:this.handleCancelRestore,handleRequestThumbnail:this.handleRequestThumbnail,handleCancelThumbnail:this.handleCancelThumbnail,isDraggingOver:a.isDraggingOver,handleDragOver:this.handleDragOver,handleDragLeave:this.handleDragLeave,handleDrop:this.handleDrop})},Object.defineProperty(this,Hd,{writable:!0,value:()=>{(this.opts.plugins||[]).forEach(a=>{let l=this.uppy.getPlugin(a);l?l.mount(this,l):this.uppy.log(`[Uppy] Dashboard could not find plugin '${a}', make sure to uppy.use() the plugins you are specifying`,\"warning\")})}}),Object.defineProperty(this,$d,{writable:!0,value:()=>{this.uppy.iteratePlugins(Ae(this,Is)[Is])}}),Object.defineProperty(this,Is,{writable:!0,value:o=>{var a;let l=[\"acquirer\",\"editor\"];o&&!((a=o.opts)!=null&&a.target)&&l.includes(o.type)&&(this.getPluginState().targets.some(p=>o.id===p.id)||o.mount(this,o))}}),this.install=()=>{this.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:!1,showFileEditor:!1,metaFields:this.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});let{inline:o,closeAfterFinish:a}=this.opts;if(o&&a)throw new Error(\"[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.\");let{allowMultipleUploads:l,allowMultipleUploadBatches:h}=this.uppy.opts;(l||h)&&a&&this.uppy.log(\"[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploadBatches` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true\",\"warning\");let{target:p}=this.opts;p&&this.mount(p,this),this.opts.disableStatusBar||this.uppy.use($i,{id:`${this.id}:StatusBar`,target:this,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,showProgressDetails:this.opts.showProgressDetails,hideAfterFinish:this.opts.hideProgressAfterFinish,locale:this.opts.locale,doneButtonHandler:this.opts.doneButtonHandler}),this.opts.disableInformer||this.uppy.use(qi,{id:`${this.id}:Informer`,target:this}),this.opts.disableThumbnailGenerator||this.uppy.use(Cr,{id:`${this.id}:ThumbnailGenerator`,thumbnailWidth:this.opts.thumbnailWidth,thumbnailHeight:this.opts.thumbnailHeight,thumbnailType:this.opts.thumbnailType,waitForThumbnailsBeforeUpload:this.opts.waitForThumbnailsBeforeUpload,lazy:!this.opts.waitForThumbnailsBeforeUpload}),this.darkModeMediaQuery=typeof window<\"u\"&&window.matchMedia?window.matchMedia(\"(prefers-color-scheme: dark)\"):null;let d=this.darkModeMediaQuery?this.darkModeMediaQuery.matches:!1;this.uppy.log(`[Dashboard] Dark mode is ${d?\"on\":\"off\"}`),this.setDarkModeCapability(d),this.opts.theme===\"auto\"&&this.darkModeMediaQuery.addListener(this.handleSystemDarkModeChange),Ae(this,Hd)[Hd](),Ae(this,$d)[$d](),this.initEvents()},this.uninstall=()=>{if(!this.opts.disableInformer){let a=this.uppy.getPlugin(`${this.id}:Informer`);a&&this.uppy.removePlugin(a)}if(!this.opts.disableStatusBar){let a=this.uppy.getPlugin(`${this.id}:StatusBar`);a&&this.uppy.removePlugin(a)}if(!this.opts.disableThumbnailGenerator){let a=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);a&&this.uppy.removePlugin(a)}(this.opts.plugins||[]).forEach(a=>{let l=this.uppy.getPlugin(a);l&&l.unmount()}),this.opts.theme===\"auto\"&&this.darkModeMediaQuery.removeListener(this.handleSystemDarkModeChange),this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove(\"uppy-Dashboard-isFixed\"),this.unmount(),this.removeEvents()},this.id=this.opts.id||\"Dashboard\",this.title=\"Dashboard\",this.type=\"orchestrator\",this.modalName=`uppy-Dashboard-${Pt()}`,this.defaultLocale=Fy;let s={target:\"body\",metaFields:[],trigger:null,inline:!1,width:750,height:550,thumbnailWidth:280,thumbnailType:\"image/jpeg\",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon:ko,showLinkToFileUploadResult:!1,showProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,doneButtonHandler:()=>{this.uppy.clearUploadedFiles(),this.requestCloseModal()},note:null,closeModalOnClickOutside:!1,closeAfterFinish:!1,singleFileFullScreen:!0,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,disablePageScrollWhenModalOpen:!0,animateOpenClose:!0,fileManagerSelectionType:\"files\",proudlyDisplayPoweredByUppy:!0,onRequestCloseModal:()=>this.closeModal(),showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,browserBackButtonClose:!1,showNativePhotoCameraButton:!1,showNativeVideoCameraButton:!1,theme:\"light\",autoOpenFileEditor:!1,disabled:!1,disableLocalFiles:!1};this.opts={...s,...t},this.i18nInit(),this.superFocus=Fd(),this.ifFocusedOnUppyRecently=!1,this.makeDashboardInsidesVisibleAnywayTimeout=null,this.removeDragOverClassTimeout=null}};n(is,\"Dashboard\");is.VERSION=AS.version;var Cy={strings:{dropHereOr:\"Drop here or %{browse}\",browse:\"browse\"}};var US={version:\"3.0.3\"},Gi=class extends Z{constructor(e,t){super(e,t),this.handleDrop=async s=>{var o,a;s.preventDefault(),s.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!1});let l=n(p=>{this.uppy.log(p,\"error\")},\"logDropError\"),h=await As(s.dataTransfer,{logDropError:l});h.length>0&&(this.uppy.log(\"[DragDrop] Files dropped\"),this.addFiles(h)),(o=(a=this.opts).onDrop)==null||o.call(a,s)},this.type=\"acquirer\",this.id=this.opts.id||\"DragDrop\",this.title=\"Drag & Drop\",this.defaultLocale=Cy;let r={target:null,inputName:\"files[]\",width:\"100%\",height:\"100%\",note:null};this.opts={...r,...t},this.i18nInit(),this.isDragDropSupported=fa(),this.removeDragOverClassTimeout=null,this.onInputChange=this.onInputChange.bind(this),this.handleDragOver=this.handleDragOver.bind(this),this.handleDragLeave=this.handleDragLeave.bind(this),this.handleDrop=this.handleDrop.bind(this),this.addFiles=this.addFiles.bind(this),this.render=this.render.bind(this)}addFiles(e){let t=e.map(r=>({source:this.id,name:r.name,type:r.type,data:r,meta:{relativePath:r.relativePath||null}}));try{this.uppy.addFiles(t)}catch(r){this.uppy.log(r)}}onInputChange(e){let t=Qe(e.target.files);t.length>0&&(this.uppy.log(\"[DragDrop] Files selected through input\"),this.addFiles(t)),e.target.value=null}handleDragOver(e){var t,r;e.preventDefault(),e.stopPropagation();let{types:s}=e.dataTransfer,o=s.some(l=>l===\"Files\"),{allowNewUpload:a}=this.uppy.getState();if(!o||!a){e.dataTransfer.dropEffect=\"none\",clearTimeout(this.removeDragOverClassTimeout);return}e.dataTransfer.dropEffect=\"copy\",clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!0}),(t=(r=this.opts).onDragOver)==null||t.call(r,e)}handleDragLeave(e){var t,r;e.preventDefault(),e.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.removeDragOverClassTimeout=setTimeout(()=>{this.setPluginState({isDraggingOver:!1})},50),(t=(r=this.opts).onDragLeave)==null||t.call(r,e)}renderHiddenFileInput(){let{restrictions:e}=this.uppy.opts;return u(\"input\",{className:\"uppy-DragDrop-input\",type:\"file\",hidden:!0,ref:t=>{this.fileInputRef=t},name:this.opts.inputName,multiple:e.maxNumberOfFiles!==1,accept:e.allowedFileTypes,onChange:this.onInputChange})}static renderArrowSvg(){return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon uppy-DragDrop-arrow\",width:\"16\",height:\"16\",viewBox:\"0 0 16 16\"},u(\"path\",{d:\"M11 10V0H5v10H2l6 6 6-6h-3zm0 0\",fillRule:\"evenodd\"}))}renderLabel(){return u(\"div\",{className:\"uppy-DragDrop-label\"},this.i18nArray(\"dropHereOr\",{browse:u(\"span\",{className:\"uppy-DragDrop-browse\"},this.i18n(\"browse\"))}))}renderNote(){return u(\"span\",{className:\"uppy-DragDrop-note\"},this.opts.note)}render(){let e=`uppy-u-reset\n      uppy-DragDrop-container\n      ${this.isDragDropSupported?\"uppy-DragDrop--isDragDropSupported\":\"\"}\n      ${this.getPluginState().isDraggingOver?\"uppy-DragDrop--isDraggingOver\":\"\"}\n    `,t={width:this.opts.width,height:this.opts.height};return u(\"button\",{type:\"button\",className:e,style:t,onClick:()=>this.fileInputRef.click(),onDragOver:this.handleDragOver,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop},this.renderHiddenFileInput(),u(\"div\",{className:\"uppy-DragDrop-inner\"},Gi.renderArrowSvg(),this.renderLabel(),this.renderNote()))}install(){let{target:e}=this.opts;this.setPluginState({isDraggingOver:!1}),e&&this.mount(e,this)}uninstall(){this.unmount()}};n(Gi,\"DragDrop\");Gi.VERSION=US.version;var kS={version:\"2.0.2\"};function qd(i){var e,t;return(e=(t=i.dataTransfer.types)==null?void 0:t.some(r=>r===\"Files\"))!=null?e:!1}n(qd,\"isFileTransfer\");var Ns=class extends ve{constructor(e,t){super(e,t),this.addFiles=s=>{let o=s.map(a=>({source:this.id,name:a.name,type:a.type,data:a,meta:{relativePath:a.relativePath||null}}));try{this.uppy.addFiles(o)}catch(a){this.uppy.log(a)}},this.handleDrop=async s=>{var o,a;if(!qd(s))return;s.preventDefault(),s.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),s.currentTarget.classList.remove(\"uppy-is-drag-over\"),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins(d=>{d.type===\"acquirer\"&&(d.handleRootDrop==null||d.handleRootDrop(s))});let l=!1,h=n(d=>{this.uppy.log(d,\"error\"),l||(this.uppy.info(d.message,\"error\"),l=!0)},\"logDropError\"),p=await As(s.dataTransfer,{logDropError:h});p.length>0&&(this.uppy.log(\"[DropTarget] Files were dropped\"),this.addFiles(p)),(o=(a=this.opts).onDrop)==null||o.call(a,s)},this.handleDragOver=s=>{var o,a;qd(s)&&(s.preventDefault(),s.stopPropagation(),s.dataTransfer.dropEffect=\"copy\",clearTimeout(this.removeDragOverClassTimeout),s.currentTarget.classList.add(\"uppy-is-drag-over\"),this.setPluginState({isDraggingOver:!0}),(o=(a=this.opts).onDragOver)==null||o.call(a,s))},this.handleDragLeave=s=>{var o,a;if(!qd(s))return;s.preventDefault(),s.stopPropagation();let{currentTarget:l}=s;clearTimeout(this.removeDragOverClassTimeout),this.removeDragOverClassTimeout=setTimeout(()=>{l.classList.remove(\"uppy-is-drag-over\"),this.setPluginState({isDraggingOver:!1})},50),(o=(a=this.opts).onDragLeave)==null||o.call(a,s)},this.addListeners=()=>{let{target:s}=this.opts;if(s instanceof Element?this.nodes=[s]:typeof s==\"string\"&&(this.nodes=Qe(document.querySelectorAll(s))),!this.nodes&&!this.nodes.length>0)throw new Error(`\"${s}\" does not match any HTML elements`);this.nodes.forEach(o=>{o.addEventListener(\"dragover\",this.handleDragOver,!1),o.addEventListener(\"dragleave\",this.handleDragLeave,!1),o.addEventListener(\"drop\",this.handleDrop,!1)})},this.removeListeners=()=>{this.nodes&&this.nodes.forEach(s=>{s.removeEventListener(\"dragover\",this.handleDragOver,!1),s.removeEventListener(\"dragleave\",this.handleDragLeave,!1),s.removeEventListener(\"drop\",this.handleDrop,!1)})},this.type=\"acquirer\",this.id=this.opts.id||\"DropTarget\",this.title=\"Drop Target\";let r={target:null};this.opts={...r,...t},this.removeDragOverClassTimeout=null}install(){this.setPluginState({isDraggingOver:!1}),this.addListeners()}uninstall(){this.removeListeners()}};n(Ns,\"DropTarget\");Ns.VERSION=kS.version;var Ty={strings:{chooseFiles:\"Choose files\"}};var DS={version:\"3.0.4\"},rs=class extends Z{constructor(e,t){super(e,t),this.id=this.opts.id||\"FileInput\",this.title=\"File Input\",this.type=\"acquirer\",this.defaultLocale=Ty;let r={target:null,pretty:!0,inputName:\"files[]\"};this.opts={...r,...t},this.i18nInit(),this.render=this.render.bind(this),this.handleInputChange=this.handleInputChange.bind(this),this.handleClick=this.handleClick.bind(this)}addFiles(e){let t=e.map(r=>({source:this.id,name:r.name,type:r.type,data:r}));try{this.uppy.addFiles(t)}catch(r){this.uppy.log(r)}}handleInputChange(e){this.uppy.log(\"[FileInput] Something selected through input...\");let t=Qe(e.target.files);this.addFiles(t),e.target.value=null}handleClick(){this.input.click()}render(){let e={width:\"0.1px\",height:\"0.1px\",opacity:0,overflow:\"hidden\",position:\"absolute\",zIndex:-1},{restrictions:t}=this.uppy.opts,r=t.allowedFileTypes?t.allowedFileTypes.join(\",\"):null;return u(\"div\",{className:\"uppy-FileInput-container\"},u(\"input\",{className:\"uppy-FileInput-input\",style:this.opts.pretty&&e,type:\"file\",name:this.opts.inputName,onChange:this.handleInputChange,multiple:t.maxNumberOfFiles!==1,accept:r,ref:s=>{this.input=s}}),this.opts.pretty&&u(\"button\",{className:\"uppy-FileInput-btn\",type:\"button\",onClick:this.handleClick},this.i18n(\"chooseFiles\")))}install(){let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.unmount()}};n(rs,\"FileInput\");rs.VERSION=DS.version;var Iy=de(Ay(),1);function IS(i,e){let t=i.width/e.width,r=i.height/e.height,s=Math.min(t,r),o=e.width*s,a=e.height*s,l=(i.width-o)/2,h=(i.height-a)/2;return{width:o,height:a,left:l,top:h}}n(IS,\"getCanvasDataThatFitsPerfectlyIntoContainer\");var Ry=IS;function NS(i){return i*(Math.PI/180)}n(NS,\"toRadians\");function MS(i,e,t){let r=Math.abs(NS(t));return Math.max((Math.sin(r)*i+Math.cos(r)*e)/e,(Math.sin(r)*e+Math.cos(r)*i)/i)}n(MS,\"getScaleFactorThatRemovesDarkCorners\");var Uy=MS;function LS(i,e,t){return e.left<i.left?{left:i.left,width:t.width}:e.top<i.top?{top:i.top,height:t.height}:e.left+e.width>i.left+i.width?{left:i.left+i.width-t.width,width:t.width}:e.top+e.height>i.top+i.height?{top:i.top+i.height-t.height,height:t.height}:null}n(LS,\"limitCropboxMovementOnMove\");var ky=LS;function BS(i,e,t){return e.left<i.left?{left:i.left,width:t.left+t.width-i.left}:e.top<i.top?{top:i.top,height:t.top+t.height-i.top}:e.left+e.width>i.left+i.width?{left:t.left,width:i.left+i.width-t.left}:e.top+e.height>i.top+i.height?{top:t.top,height:i.top+i.height-t.top}:null}n(BS,\"limitCropboxMovementOnResize\");var Dy=BS;var qo=class extends we{constructor(e){super(e),this.onRotate90Deg=()=>{let{angle90Deg:t}=this.state,r=t-90;this.setState({angle90Deg:r,angleGranular:0}),this.cropper.scale(1),this.cropper.rotateTo(r);let s=this.cropper.getCanvasData(),o=this.cropper.getContainerData(),a=Ry(o,s);this.cropper.setCanvasData(a),this.cropper.setCropBoxData(a)},this.onRotateGranular=t=>{let r=Number(t.target.value);this.setState({angleGranular:r});let{angle90Deg:s}=this.state,o=s+r;this.cropper.rotateTo(o);let a=this.cropper.getImageData(),l=Uy(a.naturalWidth,a.naturalHeight,r),h=this.cropper.getImageData().scaleX<0?-l:l;this.cropper.scale(h,l)},this.state={angle90Deg:0,angleGranular:0,prevCropboxData:null},this.storePrevCropboxData=this.storePrevCropboxData.bind(this),this.limitCropboxMovement=this.limitCropboxMovement.bind(this)}componentDidMount(){let{opts:e,storeCropperInstance:t}=this.props;this.cropper=new Iy.default(this.imgElement,e.cropperOptions),this.imgElement.addEventListener(\"cropstart\",this.storePrevCropboxData),this.imgElement.addEventListener(\"cropend\",this.limitCropboxMovement),t(this.cropper)}componentWillUnmount(){this.cropper.destroy(),this.imgElement.removeEventListener(\"cropstart\",this.storePrevCropboxData),this.imgElement.removeEventListener(\"cropend\",this.limitCropboxMovement)}storePrevCropboxData(){this.setState({prevCropboxData:this.cropper.getCropBoxData()})}limitCropboxMovement(e){let t=this.cropper.getCanvasData(),r=this.cropper.getCropBoxData(),{prevCropboxData:s}=this.state;if(e.detail.action===\"all\"){let o=ky(t,r,s);o&&this.cropper.setCropBoxData(o)}else{let o=Dy(t,r,s);o&&this.cropper.setCropBoxData(o)}}renderGranularRotate(){let{i18n:e}=this.props,{angleGranular:t}=this.state;return u(\"label\",{role:\"tooltip\",\"aria-label\":`${t}\\xBA`,\"data-microtip-position\":\"top\",className:\"uppy-ImageCropper-rangeWrapper\"},u(\"input\",{className:\"uppy-ImageCropper-range uppy-u-reset\",type:\"range\",onInput:this.onRotateGranular,onChange:this.onRotateGranular,value:t,min:\"-45\",max:\"45\",\"aria-label\":e(\"rotate\")}))}renderRevert(){let{i18n:e}=this.props;return u(\"label\",{role:\"tooltip\",\"aria-label\":e(\"revert\"),\"data-microtip-position\":\"top\"},u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn\",onClick:()=>{this.cropper.reset(),this.cropper.setAspectRatio(0),this.setState({angle90Deg:0,angleGranular:0})}},u(\"svg\",{\"aria-hidden\":\"true\",className:\"uppy-c-icon\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\"},u(\"path\",{d:\"M0 0h24v24H0z\",fill:\"none\"}),u(\"path\",{d:\"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z\"}))))}renderRotate(){let{i18n:e}=this.props;return u(\"label\",{role:\"tooltip\",\"aria-label\":e(\"rotate\"),\"data-microtip-position\":\"top\"},u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn\",onClick:this.onRotate90Deg},u(\"svg\",{\"aria-hidden\":\"true\",className:\"uppy-c-icon\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\"},u(\"path\",{d:\"M0 0h24v24H0V0zm0 0h24v24H0V0z\",fill:\"none\"}),u(\"path\",{d:\"M14 10a2 2 0 012 2v7a2 2 0 01-2 2H6a2 2 0 01-2-2v-7a2 2 0 012-2h8zm0 1.75H6a.25.25 0 00-.243.193L5.75 12v7a.25.25 0 00.193.243L6 19.25h8a.25.25 0 00.243-.193L14.25 19v-7a.25.25 0 00-.193-.243L14 11.75zM12 .76V4c2.3 0 4.61.88 6.36 2.64a8.95 8.95 0 012.634 6.025L21 13a1 1 0 01-1.993.117L19 13h-.003a6.979 6.979 0 00-2.047-4.95 6.97 6.97 0 00-4.652-2.044L12 6v3.24L7.76 5 12 .76z\"}))))}renderFlip(){let{i18n:e}=this.props;return u(\"label\",{role:\"tooltip\",\"aria-label\":e(\"flipHorizontal\"),\"data-microtip-position\":\"top\"},u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn\",onClick:()=>this.cropper.scaleX(-this.cropper.getData().scaleX||-1)},u(\"svg\",{\"aria-hidden\":\"true\",className:\"uppy-c-icon\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\"},u(\"path\",{d:\"M0 0h24v24H0z\",fill:\"none\"}),u(\"path\",{d:\"M15 21h2v-2h-2v2zm4-12h2V7h-2v2zM3 5v14c0 1.1.9 2 2 2h4v-2H5V5h4V3H5c-1.1 0-2 .9-2 2zm16-2v2h2c0-1.1-.9-2-2-2zm-8 20h2V1h-2v22zm8-6h2v-2h-2v2zM15 5h2V3h-2v2zm4 8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2z\"}))))}renderZoomIn(){let{i18n:e}=this.props;return u(\"label\",{role:\"tooltip\",\"aria-label\":e(\"zoomIn\"),\"data-microtip-position\":\"top\"},u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn\",onClick:()=>this.cropper.zoom(.1)},u(\"svg\",{\"aria-hidden\":\"true\",className:\"uppy-c-icon\",height:\"24\",viewBox:\"0 0 24 24\",width:\"24\"},u(\"path\",{d:\"M0 0h24v24H0V0z\",fill:\"none\"}),u(\"path\",{d:\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"}),u(\"path\",{d:\"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z\"}))))}renderZoomOut(){let{i18n:e}=this.props;return u(\"label\",{role:\"tooltip\",\"aria-label\":e(\"zoomOut\"),\"data-microtip-position\":\"top\"},u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn\",onClick:()=>this.cropper.zoom(-.1)},u(\"svg\",{\"aria-hidden\":\"true\",className:\"uppy-c-icon\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\"},u(\"path\",{d:\"M0 0h24v24H0V0z\",fill:\"none\"}),u(\"path\",{d:\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z\"}))))}renderCropSquare(){let{i18n:e}=this.props;return u(\"label\",{role:\"tooltip\",\"aria-label\":e(\"aspectRatioSquare\"),\"data-microtip-position\":\"top\"},u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn\",onClick:()=>this.cropper.setAspectRatio(1)},u(\"svg\",{\"aria-hidden\":\"true\",className:\"uppy-c-icon\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\"},u(\"path\",{d:\"M0 0h24v24H0z\",fill:\"none\"}),u(\"path\",{d:\"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\"}))))}renderCropWidescreen(){let{i18n:e}=this.props;return u(\"label\",{role:\"tooltip\",\"aria-label\":e(\"aspectRatioLandscape\"),\"data-microtip-position\":\"top\"},u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn\",onClick:()=>this.cropper.setAspectRatio(16/9)},u(\"svg\",{\"aria-hidden\":\"true\",className:\"uppy-c-icon\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\"},u(\"path\",{d:\"M 19,4.9999992 V 17.000001 H 4.9999998 V 6.9999992 H 19 m 0,-2 H 4.9999998 c -1.0999999,0 -1.9999999,0.9000001 -1.9999999,2 V 17.000001 c 0,1.1 0.9,2 1.9999999,2 H 19 c 1.1,0 2,-0.9 2,-2 V 6.9999992 c 0,-1.0999999 -0.9,-2 -2,-2 z\"}),u(\"path\",{fill:\"none\",d:\"M0 0h24v24H0z\"}))))}renderCropWidescreenVertical(){let{i18n:e}=this.props;return u(\"label\",{role:\"tooltip\",\"aria-label\":e(\"aspectRatioPortrait\"),\"data-microtip-position\":\"top\"},u(\"button\",{type:\"button\",className:\"uppy-u-reset uppy-c-btn\",onClick:()=>this.cropper.setAspectRatio(9/16)},u(\"svg\",{\"aria-hidden\":\"true\",className:\"uppy-c-icon\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\"},u(\"path\",{d:\"M 19.000001,19 H 6.999999 V 5 h 10.000002 v 14 m 2,0 V 5 c 0,-1.0999999 -0.9,-1.9999999 -2,-1.9999999 H 6.999999 c -1.1,0 -2,0.9 -2,1.9999999 v 14 c 0,1.1 0.9,2 2,2 h 10.000002 c 1.1,0 2,-0.9 2,-2 z\"}),u(\"path\",{d:\"M0 0h24v24H0z\",fill:\"none\"}))))}render(){let{currentImage:e,opts:t}=this.props,{actions:r}=t,s=URL.createObjectURL(e.data);return u(\"div\",{className:\"uppy-ImageCropper\"},u(\"div\",{className:\"uppy-ImageCropper-container\"},u(\"img\",{className:\"uppy-ImageCropper-image\",alt:e.name,src:s,ref:o=>{this.imgElement=o}})),u(\"div\",{className:\"uppy-ImageCropper-controls\"},r.revert&&this.renderRevert(),r.rotate&&this.renderRotate(),r.granularRotate&&this.renderGranularRotate(),r.flip&&this.renderFlip(),r.zoomIn&&this.renderZoomIn(),r.zoomOut&&this.renderZoomOut(),r.cropSquare&&this.renderCropSquare(),r.cropWidescreen&&this.renderCropWidescreen(),r.cropWidescreenVertical&&this.renderCropWidescreenVertical()))}};n(qo,\"Editor\");var Ny={strings:{revert:\"Reset\",rotate:\"Rotate 90\\xB0\",zoomIn:\"Zoom in\",zoomOut:\"Zoom out\",flipHorizontal:\"Flip horizontally\",aspectRatioSquare:\"Crop square\",aspectRatioLandscape:\"Crop landscape (16:9)\",aspectRatioPortrait:\"Crop portrait (9:16)\"}};var zS={version:\"2.3.0\"},ss=class extends Z{constructor(e,t){super(e,t),this.save=()=>{let a=n(p=>{let{currentImage:d}=this.getPluginState();this.uppy.setFileState(d.id,{data:p,size:p.size,preview:null});let f=this.uppy.getFile(d.id);this.uppy.emit(\"thumbnail:request\",f),this.setPluginState({currentImage:f}),this.uppy.emit(\"file-editor:complete\",f)},\"saveBlobCallback\"),{currentImage:l}=this.getPluginState(),h=this.cropper.getCroppedCanvas({});h.width%2!==0&&this.cropper.setData({width:h.width-1}),h.height%2!==0&&this.cropper.setData({height:h.height-1}),this.cropper.getCroppedCanvas(this.opts.cropperOptions.croppedCanvasOptions).toBlob(a,l.type,this.opts.quality)},this.storeCropperInstance=a=>{this.cropper=a},this.selectFile=a=>{this.uppy.emit(\"file-editor:start\",a),this.setPluginState({currentImage:a})},this.id=this.opts.id||\"ImageEditor\",this.title=\"Image Editor\",this.type=\"editor\",this.defaultLocale=Ny;let r={viewMode:0,background:!1,autoCropArea:1,responsive:!0,minCropBoxWidth:70,minCropBoxHeight:70,croppedCanvasOptions:{}},s={revert:!0,rotate:!0,granularRotate:!0,flip:!0,zoomIn:!0,zoomOut:!0,cropSquare:!0,cropWidescreen:!0,cropWidescreenVertical:!0},o={quality:.8};this.opts={...o,...t,actions:{...s,...t?.actions},cropperOptions:{...r,...t?.cropperOptions}},this.i18nInit()}canEditFile(e){if(!e.type||e.isRemote)return!1;let t=e.type.split(\"/\")[1];return!!/^(jpe?g|gif|png|bmp|webp)$/.test(t)}install(){this.setPluginState({currentImage:null});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){let{currentImage:e}=this.getPluginState();if(e){let t=this.uppy.getFile(e.id);this.uppy.emit(\"file-editor:cancel\",t)}this.unmount()}render(){let{currentImage:e}=this.getPluginState();return e===null||e.isRemote?null:u(qo,{currentImage:e,storeCropperInstance:this.storeCropperInstance,save:this.save,opts:this.opts,i18n:this.i18n})}};n(ss,\"ImageEditor\");ss.VERSION=zS.version;var jS={version:\"3.0.4\"},os=class extends Z{constructor(e,t){super(e,t),this.id=this.opts.id||\"ProgressBar\",this.title=\"Progress Bar\",this.type=\"progressindicator\";let r={target:\"body\",fixed:!1,hideAfterFinish:!0};this.opts={...r,...t},this.render=this.render.bind(this)}render(e){let t=e.totalProgress||0,r=(t===0||t===100)&&this.opts.hideAfterFinish;return u(\"div\",{className:\"uppy uppy-ProgressBar\",style:{position:this.opts.fixed?\"fixed\":\"initial\"},\"aria-hidden\":r},u(\"div\",{className:\"uppy-ProgressBar-inner\",style:{width:`${t}%`}}),u(\"div\",{className:\"uppy-ProgressBar-percentage\"},t))}install(){let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.unmount()}};n(os,\"ProgressBar\");os.VERSION=jS.version;var HS={__proto__:null,\"audio/mp3\":\"mp3\",\"audio/mp4\":\"mp4\",\"audio/ogg\":\"ogg\",\"audio/webm\":\"webm\",\"image/gif\":\"gif\",\"image/heic\":\"heic\",\"image/heif\":\"heif\",\"image/jpeg\":\"jpg\",\"image/png\":\"png\",\"image/svg+xml\":\"svg\",\"video/mp4\":\"mp4\",\"video/ogg\":\"ogv\",\"video/quicktime\":\"mov\",\"video/webm\":\"webm\",\"video/x-matroska\":\"mkv\",\"video/x-msvideo\":\"avi\"};function Ki(i){return[i]=i.split(\";\",1),HS[i]||null}n(Ki,\"getFileTypeExtension\");function Gd(){var i;return typeof MediaRecorder==\"function\"&&typeof((i=MediaRecorder.prototype)==null?void 0:i.start)==\"function\"}n(Gd,\"supportsMediaRecorder\");function Kd(i){let{recording:e,onStartRecording:t,onStopRecording:r,i18n:s}=i;return e?u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-Audio-button\",type:\"button\",title:s(\"stopAudioRecording\"),\"aria-label\":s(\"stopAudioRecording\"),onClick:r,\"data-uppy-super-focusable\":!0},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"100\",height:\"100\",viewBox:\"0 0 100 100\"},u(\"rect\",{x:\"15\",y:\"15\",width:\"70\",height:\"70\"}))):u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-Audio-button\",type:\"button\",title:s(\"startAudioRecording\"),\"aria-label\":s(\"startAudioRecording\"),onClick:t,\"data-uppy-super-focusable\":!0},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"14px\",height:\"20px\",viewBox:\"0 0 14 20\"},u(\"path\",{d:\"M7 14c2.21 0 4-1.71 4-3.818V3.818C11 1.71 9.21 0 7 0S3 1.71 3 3.818v6.364C3 12.29 4.79 14 7 14zm6.364-7h-.637a.643.643 0 0 0-.636.65V9.6c0 3.039-2.565 5.477-5.6 5.175-2.645-.264-4.582-2.692-4.582-5.407V7.65c0-.36-.285-.65-.636-.65H.636A.643.643 0 0 0 0 7.65v1.631c0 3.642 2.544 6.888 6.045 7.382v1.387H3.818a.643.643 0 0 0-.636.65v.65c0 .36.285.65.636.65h6.364c.351 0 .636-.29.636-.65v-.65c0-.36-.285-.65-.636-.65H7.955v-1.372C11.363 16.2 14 13.212 14 9.6V7.65c0-.36-.285-.65-.636-.65z\",fill:\"#FFF\",\"fill-rule\":\"nonzero\"})))}n(Kd,\"RecordButton\");function Xd(i){return`${Math.floor(i/60)}:${String(i%60).padStart(2,0)}`}n(Xd,\"formatSeconds\");function Yd(i){let{recordingLengthSeconds:e,i18n:t}=i,r=Xd(e);return u(\"span\",{\"aria-label\":t(\"recordingLength\",{recording_length:r})},r)}n(Yd,\"RecordingLength\");var My=n(i=>{let{currentDeviceId:e,audioSources:t,onChangeSource:r}=i;return u(\"div\",{className:\"uppy-Audio-videoSource\"},u(\"select\",{className:\"uppy-u-reset uppy-Audio-audioSource-select\",onChange:s=>{r(s.target.value)}},t.map(s=>u(\"option\",{key:s.deviceId,value:s.deviceId,selected:s.deviceId===e},s.label))))},\"default\");function $S(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n($S,\"_classPrivateFieldLooseBase\");var qS=0;function VS(i){return\"__private_\"+qS+++\"_\"+i}n(VS,\"_classPrivateFieldLooseKey\");function Ly(i){return typeof i==\"function\"}n(Ly,\"isFunction\");function ba(i){return Ly(i)?i():i}n(ba,\"result\");var Qd=VS(\"draw\"),Vo=class{constructor(e,t){t===void 0&&(t={}),Object.defineProperty(this,Qd,{writable:!0,value:()=>this.draw()});let r=t.canvas||{},s=t.canvasContext||{};this.analyser=null,this.bufferLength=0,this.dataArray=[],this.canvas=e,this.width=ba(r.width)||this.canvas.width,this.height=ba(r.height)||this.canvas.height,this.canvas.width=this.width,this.canvas.height=this.height,this.canvasContext=this.canvas.getContext(\"2d\"),this.canvasContext.fillStyle=ba(s.fillStyle)||\"rgb(255, 255, 255)\",this.canvasContext.strokeStyle=ba(s.strokeStyle)||\"rgb(0, 0, 0)\",this.canvasContext.lineWidth=ba(s.lineWidth)||1,this.onDrawFrame=Ly(t.onDrawFrame)?t.onDrawFrame:()=>{}}addSource(e){this.streamSource=e,this.audioContext=this.streamSource.context,this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2048,this.bufferLength=this.analyser.frequencyBinCount,this.source=this.audioContext.createBufferSource(),this.dataArray=new Uint8Array(this.bufferLength),this.analyser.getByteTimeDomainData(this.dataArray),this.streamSource.connect(this.analyser)}draw(){let{analyser:e,dataArray:t,bufferLength:r}=this,s=this.canvasContext,o=this.width,a=this.height;e&&e.getByteTimeDomainData(t),s.fillRect(0,0,o,a),s.beginPath();let l=o*1/r,h=0;r||s.moveTo(0,this.height/2);for(let p=0;p<r;p++){let f=t[p]/128*(a/2);p===0?s.moveTo(h,f):s.lineTo(h,f),h+=l}s.lineTo(o,a/2),s.stroke(),this.onDrawFrame(this),requestAnimationFrame($S(this,Qd)[Qd])}};n(Vo,\"AudioOscilloscope\");function WS(i){let{onSubmit:e,i18n:t}=i;return u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-Audio-button uppy-Audio-button--submit\",type:\"button\",title:t(\"submitRecordedFile\"),\"aria-label\":t(\"submitRecordedFile\"),onClick:e,\"data-uppy-super-focusable\":!0},u(\"svg\",{width:\"12\",height:\"9\",viewBox:\"0 0 12 9\",xmlns:\"http://www.w3.org/2000/svg\",\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\"},u(\"path\",{fill:\"#fff\",fillRule:\"nonzero\",d:\"M10.66 0L12 1.31 4.136 9 0 4.956l1.34-1.31L4.136 6.38z\"})))}n(WS,\"SubmitButton\");var By=WS;function GS(i){let{onDiscard:e,i18n:t}=i;return u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-Audio-button\",type:\"button\",title:t(\"discardRecordedFile\"),\"aria-label\":t(\"discardRecordedFile\"),onClick:e,\"data-uppy-super-focusable\":!0},u(\"svg\",{width:\"13\",height:\"13\",viewBox:\"0 0 13 13\",xmlns:\"http://www.w3.org/2000/svg\",\"aria-hidden\":\"true\",className:\"uppy-c-icon\"},u(\"g\",{fill:\"#FFF\",fillRule:\"evenodd\"},u(\"path\",{d:\"M.496 11.367L11.103.76l1.414 1.414L1.911 12.781z\"}),u(\"path\",{d:\"M11.104 12.782L.497 2.175 1.911.76l10.607 10.606z\"}))))}n(GS,\"DiscardButton\");var zy=GS;function Jd(i){let{stream:e,recordedAudio:t,onStop:r,recording:s,supportsRecording:o,audioSources:a,showAudioSourceDropdown:l,onSubmit:h,i18n:p,onStartRecording:d,onStopRecording:f,onDiscardRecordedAudio:y,recordingLengthSeconds:b}=i,S=Xh(null),E=Xh(null);Os(()=>()=>{E.current=null,r()},[r]),Os(()=>{if(!t&&(E.current=new Vo(S.current,{canvas:{width:600,height:600},canvasContext:{lineWidth:2,fillStyle:\"rgb(0,0,0)\",strokeStyle:\"green\"}}),E.current.draw(),e)){let G=new AudioContext().createMediaStreamSource(e);E.current.addSource(G)}},[t,e]);let x=t!=null,F=!x&&o,U=l&&!x&&a&&a.length>1;return u(\"div\",{className:\"uppy-Audio-container\"},u(\"div\",{className:\"uppy-Audio-audioContainer\"},x?u(\"audio\",{className:\"uppy-Audio-player\",controls:!0,src:t}):u(\"canvas\",{ref:S,className:\"uppy-Audio-canvas\"})),u(\"div\",{className:\"uppy-Audio-footer\"},u(\"div\",{className:\"uppy-Audio-audioSourceContainer\"},U?My(i):null),u(\"div\",{className:\"uppy-Audio-buttonContainer\"},F&&u(Kd,{recording:s,onStartRecording:d,onStopRecording:f,i18n:p}),x&&u(By,{onSubmit:h,i18n:p}),x&&u(zy,{onDiscard:y,i18n:p})),u(\"div\",{className:\"uppy-Audio-recordingLength\"},!x&&u(Yd,{recordingLengthSeconds:b,i18n:p}))))}n(Jd,\"RecordingScreen\");var jy=n(i=>{let{icon:e,hasAudio:t,i18n:r}=i;return u(\"div\",{className:\"uppy-Audio-permissons\"},u(\"div\",{className:\"uppy-Audio-permissonsIcon\"},e()),u(\"h1\",{className:\"uppy-Audio-title\"},r(t?\"allowAudioAccessTitle\":\"noAudioTitle\")),u(\"p\",null,r(t?\"allowAudioAccessDescription\":\"noAudioDescription\")))},\"default\");var Hy={strings:{pluginNameAudio:\"Audio\",startAudioRecording:\"Begin audio recording\",stopAudioRecording:\"Stop audio recording\",allowAudioAccessTitle:\"Please allow access to your microphone\",allowAudioAccessDescription:\"In order to record audio, please allow microphone access for this site.\",noAudioTitle:\"Microphone Not Available\",noAudioDescription:\"In order to record audio, please connect a microphone or another audio input device\",recordingStoppedMaxSize:\"Recording stopped because the file size is about to exceed the limit\",recordingLength:\"Recording length %{recording_length}\",submitRecordedFile:\"Submit recorded file\",discardRecordedFile:\"Discard recorded file\"}};function oc(){return oc=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},oc.apply(this,arguments)}n(oc,\"_extends\");function H(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(H,\"_classPrivateFieldLooseBase\");var KS=0;function pt(i){return\"__private_\"+KS+++\"_\"+i}n(pt,\"_classPrivateFieldLooseKey\");var XS={version:\"1.1.4\"},dt=pt(\"stream\"),Rr=pt(\"audioActive\"),Ie=pt(\"recordingChunks\"),De=pt(\"recorder\"),Ur=pt(\"capturedMediaFile\"),ct=pt(\"mediaDevices\"),wa=pt(\"supportsUserMedia\"),Zd=pt(\"hasAudioCheck\"),Ms=pt(\"start\"),ec=pt(\"startRecording\"),Sa=pt(\"stopRecording\"),tc=pt(\"discardRecordedAudio\"),ic=pt(\"submit\"),kr=pt(\"stop\"),rc=pt(\"getAudio\"),sc=pt(\"changeSource\"),Ls=pt(\"updateSources\"),ns=class extends Z{constructor(e,t){var r;super(e,t),r=this,Object.defineProperty(this,rc,{value:QS}),Object.defineProperty(this,Zd,{value:YS}),Object.defineProperty(this,dt,{writable:!0,value:null}),Object.defineProperty(this,Rr,{writable:!0,value:!1}),Object.defineProperty(this,Ie,{writable:!0,value:null}),Object.defineProperty(this,De,{writable:!0,value:null}),Object.defineProperty(this,Ur,{writable:!0,value:null}),Object.defineProperty(this,ct,{writable:!0,value:null}),Object.defineProperty(this,wa,{writable:!0,value:null}),Object.defineProperty(this,Ms,{writable:!0,value:function(s){if(s===void 0&&(s=null),!H(r,wa)[wa])return Promise.reject(new Error(\"Microphone access not supported\"));H(r,Rr)[Rr]=!0,H(r,Zd)[Zd]().then(o=>(r.setPluginState({hasAudio:o}),H(r,ct)[ct].getUserMedia({audio:!0}).then(a=>{H(r,dt)[dt]=a;let l=null,h=a.getAudioTracks();!s||!s.deviceId?l=h[0].getSettings().deviceId:h.forEach(p=>{p.getSettings().deviceId===s.deviceId&&(l=p.getSettings().deviceId)}),H(r,Ls)[Ls](),r.setPluginState({currentDeviceId:l,audioReady:!0})}).catch(a=>{r.setPluginState({audioReady:!1,cameraError:a}),r.uppy.info(a.message,\"error\")})))}}),Object.defineProperty(this,ec,{writable:!0,value:()=>{H(this,De)[De]=new MediaRecorder(H(this,dt)[dt]),H(this,Ie)[Ie]=[];let s=!1;H(this,De)[De].addEventListener(\"dataavailable\",o=>{H(this,Ie)[Ie].push(o.data);let{restrictions:a}=this.uppy.opts;if(H(this,Ie)[Ie].length>1&&a.maxFileSize!=null&&!s){let l=H(this,Ie)[Ie].reduce((f,y)=>f+y.size,0),p=(l-H(this,Ie)[Ie][0].size)/(H(this,Ie)[Ie].length-1)*3,d=Math.max(0,a.maxFileSize-p);l>d&&(s=!0,this.uppy.info(this.i18n(\"recordingStoppedMaxSize\"),\"warning\",4e3),H(this,Sa)[Sa]())}}),H(this,De)[De].start(500),this.recordingLengthTimer=setInterval(()=>{let o=this.getPluginState().recordingLengthSeconds;this.setPluginState({recordingLengthSeconds:o+1})},1e3),this.setPluginState({isRecording:!0})}}),Object.defineProperty(this,Sa,{writable:!0,value:()=>new Promise(o=>{H(this,De)[De].addEventListener(\"stop\",()=>{o()}),H(this,De)[De].stop(),clearInterval(this.recordingLengthTimer),this.setPluginState({recordingLengthSeconds:0})}).then(()=>(this.setPluginState({isRecording:!1}),H(this,rc)[rc]())).then(o=>{try{H(this,Ur)[Ur]=o,this.setPluginState({recordedAudio:URL.createObjectURL(o.data)})}catch(a){a.isRestriction||this.uppy.log(a)}}).then(()=>{H(this,Ie)[Ie]=null,H(this,De)[De]=null},o=>{throw H(this,Ie)[Ie]=null,H(this,De)[De]=null,o})}),Object.defineProperty(this,tc,{writable:!0,value:()=>{this.setPluginState({recordedAudio:null}),H(this,Ur)[Ur]=null}}),Object.defineProperty(this,ic,{writable:!0,value:()=>{try{H(this,Ur)[Ur]&&this.uppy.addFile(H(this,Ur)[Ur])}catch(s){s.isRestriction||this.uppy.log(s,\"warning\")}}}),Object.defineProperty(this,kr,{writable:!0,value:async()=>{H(this,dt)[dt]&&H(this,dt)[dt].getAudioTracks().forEach(o=>o.stop()),H(this,De)[De]&&await new Promise(s=>{H(this,De)[De].addEventListener(\"stop\",s,{once:!0}),H(this,De)[De].stop(),clearInterval(this.recordingLengthTimer)}),H(this,Ie)[Ie]=null,H(this,De)[De]=null,H(this,Rr)[Rr]=!1,H(this,dt)[dt]=null,this.setPluginState({recordedAudio:null,isRecording:!1,recordingLengthSeconds:0})}}),Object.defineProperty(this,sc,{writable:!0,value:s=>{H(this,kr)[kr](),H(this,Ms)[Ms]({deviceId:s})}}),Object.defineProperty(this,Ls,{writable:!0,value:()=>{H(this,ct)[ct].enumerateDevices().then(s=>{this.setPluginState({audioSources:s.filter(o=>o.kind===\"audioinput\")})})}}),H(this,ct)[ct]=navigator.mediaDevices,H(this,wa)[wa]=H(this,ct)[ct]!=null,this.id=this.opts.id||\"Audio\",this.type=\"acquirer\",this.icon=()=>u(\"svg\",{className:\"uppy-DashboardTab-iconAudio\",\"aria-hidden\":\"true\",focusable:\"false\",width:\"32px\",height:\"32px\",viewBox:\"0 0 32 32\"},u(\"path\",{d:\"M21.143 12.297c.473 0 .857.383.857.857v2.572c0 3.016-2.24 5.513-5.143 5.931v2.64h2.572a.857.857 0 110 1.714H12.57a.857.857 0 110-1.714h2.572v-2.64C12.24 21.24 10 18.742 10 15.726v-2.572a.857.857 0 111.714 0v2.572A4.29 4.29 0 0016 20.01a4.29 4.29 0 004.286-4.285v-2.572c0-.474.384-.857.857-.857zM16 6.5a3 3 0 013 3v6a3 3 0 01-6 0v-6a3 3 0 013-3z\",fill:\"currentcolor\",\"fill-rule\":\"nonzero\"})),this.defaultLocale=Hy,this.opts={...t},this.i18nInit(),this.title=this.i18n(\"pluginNameAudio\"),this.setPluginState({hasAudio:!1,audioReady:!1,cameraError:null,recordingLengthSeconds:0,audioSources:[],currentDeviceId:null})}render(){H(this,Rr)[Rr]||H(this,Ms)[Ms]();let e=this.getPluginState();return!e.audioReady||!e.hasAudio?u(jy,{icon:this.icon,i18n:this.i18n,hasAudio:e.hasAudio}):u(Jd,oc({},e,{audioActive:H(this,Rr)[Rr],onChangeSource:H(this,sc)[sc],onStartRecording:H(this,ec)[ec],onStopRecording:H(this,Sa)[Sa],onDiscardRecordedAudio:H(this,tc)[tc],onSubmit:H(this,ic)[ic],onStop:H(this,kr)[kr],i18n:this.i18n,showAudioSourceDropdown:this.opts.showAudioSourceDropdown,supportsRecording:Gd(),recording:e.isRecording,stream:H(this,dt)[dt]}))}install(){this.setPluginState({audioReady:!1,recordingLengthSeconds:0});let{target:e}=this.opts;e&&this.mount(e,this),H(this,ct)[ct]&&(H(this,Ls)[Ls](),H(this,ct)[ct].ondevicechange=()=>{if(H(this,Ls)[Ls](),H(this,dt)[dt]){let t=!0,{audioSources:r,currentDeviceId:s}=this.getPluginState();r.forEach(o=>{s===o.deviceId&&(t=!1)}),t&&(H(this,kr)[kr](),H(this,Ms)[Ms]())}})}uninstall(){H(this,dt)[dt]&&H(this,kr)[kr](),this.unmount()}};n(ns,\"Audio\");function YS(){return H(this,ct)[ct]?H(this,ct)[ct].enumerateDevices().then(i=>i.some(e=>e.kind===\"audioinput\")):Promise.resolve(!1)}n(YS,\"_hasAudioCheck2\");function QS(){let i=H(this,Ie)[Ie].find(o=>{var a;return((a=o.type)==null?void 0:a.length)>0}).type,e=Ki(i);if(!e)return Promise.reject(new Error(`Could not retrieve recording: Unsupported media type \"${i}\"`));let t=`audio-${Date.now()}.${e}`,r=new Blob(H(this,Ie)[Ie],{type:i}),s={source:this.id,name:t,data:new Blob([r],{type:i}),type:i};return Promise.resolve(s)}n(QS,\"_getAudio2\");ns.VERSION=XS.version;var $y={strings:{pluginNameBox:\"Box\"}};var JS={version:\"2.1.4\"},Xi=class extends Z{constructor(e,t){super(e,t),this.id=this.opts.id||\"Box\",be.initPlugin(this,t),this.title=this.opts.title||\"Box\",this.icon=()=>u(\"svg\",{className:\"uppy-DashboardTab-iconBox\",\"aria-hidden\":\"true\",focusable:\"false\",width:\"32\",height:\"32\",viewBox:\"0 0 32 32\"},u(\"g\",{fill:\"currentcolor\",fillRule:\"nonzero\"},u(\"path\",{d:\"m16.4 13.5c-1.6 0-3 0.9-3.7 2.2-0.7-1.3-2.1-2.2-3.7-2.2-1 0-1.8 0.3-2.5 0.8v-3.6c-0.1-0.3-0.5-0.7-1-0.7s-0.8 0.4-0.8 0.8v7c0 2.3 1.9 4.2 4.2 4.2 1.6 0 3-0.9 3.7-2.2 0.7 1.3 2.1 2.2 3.7 2.2 2.3 0 4.2-1.9 4.2-4.2 0.1-2.4-1.8-4.3-4.1-4.3m-7.5 6.8c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5m7.5 0c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5\"}),u(\"path\",{d:\"m27.2 20.6l-2.3-2.8 2.3-2.8c0.3-0.4 0.2-0.9-0.2-1.2s-1-0.2-1.3 0.2l-2 2.4-2-2.4c-0.3-0.4-0.9-0.4-1.3-0.2-0.4 0.3-0.5 0.8-0.2 1.2l2.3 2.8-2.3 2.8c-0.3 0.4-0.2 0.9 0.2 1.2s1 0.2 1.3-0.2l2-2.4 2 2.4c0.3 0.4 0.9 0.4 1.3 0.2 0.4-0.3 0.4-0.8 0.2-1.2\"}))),this.provider=new be(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:\"box\",pluginId:this.id}),this.defaultLocale=$y,this.i18nInit(),this.title=this.i18n(\"pluginNameBox\"),this.onFirstRender=this.onFirstRender.bind(this),this.render=this.render.bind(this)}install(){this.view=new Te(this,{provider:this.provider,loadAllFiles:!0});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}onFirstRender(){return this.view.getFolder()}render(e){return this.view.render(e)}};n(Xi,\"Box\");Xi.VERSION=JS.version;var qy={strings:{pluginNameDropbox:\"Dropbox\"}};var ZS={version:\"3.1.4\"},Yi=class extends Z{constructor(e,t){super(e,t),this.id=this.opts.id||\"Dropbox\",be.initPlugin(this,t),this.title=this.opts.title||\"Dropbox\",this.icon=()=>u(\"svg\",{className:\"uppy-DashboardTab-iconDropbox\",\"aria-hidden\":\"true\",focusable:\"false\",width:\"32\",height:\"32\",viewBox:\"0 0 32 32\"},u(\"path\",{d:\"M10.5 7.5L5 10.955l5.5 3.454 5.5-3.454 5.5 3.454 5.5-3.454L21.5 7.5 16 10.955zM10.5 21.319L5 17.864l5.5-3.455 5.5 3.455zM16 17.864l5.5-3.455 5.5 3.455-5.5 3.455zM16 25.925l-5.5-3.455 5.5-3.454 5.5 3.454z\",fill:\"currentcolor\",fillRule:\"nonzero\"})),this.provider=new be(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:\"dropbox\",pluginId:this.id}),this.defaultLocale=qy,this.i18nInit(),this.title=this.i18n(\"pluginNameDropbox\"),this.onFirstRender=this.onFirstRender.bind(this),this.render=this.render.bind(this)}install(){this.view=new Te(this,{provider:this.provider,loadAllFiles:!0});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}onFirstRender(){return Promise.all([this.provider.fetchPreAuthToken(),this.view.getFolder()])}render(e){return this.view.render(e)}};n(Yi,\"Dropbox\");Yi.VERSION=ZS.version;var Vy={strings:{pluginNameFacebook:\"Facebook\"}};var eP={version:\"3.1.3\"},Qi=class extends Z{constructor(e,t){super(e,t),this.id=this.opts.id||\"Facebook\",be.initPlugin(this,t),this.title=this.opts.title||\"Facebook\",this.icon=()=>u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"32\",height:\"32\",viewBox:\"0 0 32 32\"},u(\"g\",{fill:\"none\",fillRule:\"evenodd\"},u(\"path\",{d:\"M27 16c0-6.075-4.925-11-11-11S5 9.925 5 16c0 5.49 4.023 10.041 9.281 10.866V19.18h-2.793V16h2.793v-2.423c0-2.757 1.642-4.28 4.155-4.28 1.204 0 2.462.215 2.462.215v2.707h-1.387c-1.366 0-1.792.848-1.792 1.718V16h3.05l-.487 3.18h-2.563v7.686C22.977 26.041 27 21.49 27 16\",fill:\"#1777F2\"}),u(\"path\",{d:\"M20.282 19.18L20.77 16h-3.051v-2.063c0-.87.426-1.718 1.792-1.718h1.387V9.512s-1.258-.215-2.462-.215c-2.513 0-4.155 1.523-4.155 4.28V16h-2.793v3.18h2.793v7.686a11.082 11.082 0 003.438 0V19.18h2.563\",fill:\"#FFFFFE\"}))),this.provider=new be(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:\"facebook\",pluginId:this.id}),this.defaultLocale=Vy,this.i18nInit(),this.title=this.i18n(\"pluginNameFacebook\"),this.onFirstRender=this.onFirstRender.bind(this),this.render=this.render.bind(this)}install(){this.view=new Te(this,{provider:this.provider});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}onFirstRender(){return Promise.all([this.provider.fetchPreAuthToken(),this.view.getFolder()])}render(e){let t={};return this.getPluginState().files.length&&!this.getPluginState().folders.length&&(t.viewType=\"grid\",t.showFilter=!1,t.showTitles=!1),this.view.render(e,t)}};n(Qi,\"Facebook\");Qi.VERSION=eP.version;var Wo=class extends Te{toggleCheckbox(e,t){e.stopPropagation(),e.preventDefault(),t.custom.isSharedDrive||super.toggleCheckbox(e,t)}};n(Wo,\"DriveProviderViews\");var Wy={strings:{pluginNameGoogleDrive:\"Google Drive\"}};var tP={version:\"3.3.0\"},Ji=class extends Z{constructor(e,t){super(e,t),this.id=this.opts.id||\"GoogleDrive\",this.title=this.opts.title||\"Google Drive\",be.initPlugin(this,t),this.title=this.opts.title||\"Google Drive\",this.icon=()=>u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"32\",height:\"32\",viewBox:\"0 0 32 32\"},u(\"g\",{fillRule:\"nonzero\",fill:\"none\"},u(\"path\",{d:\"M6.663 22.284l.97 1.62c.202.34.492.609.832.804l3.465-5.798H5c0 .378.1.755.302 1.096l1.361 2.278z\",fill:\"#0066DA\"}),u(\"path\",{d:\"M16 12.09l-3.465-5.798c-.34.195-.63.463-.832.804l-6.4 10.718A2.15 2.15 0 005 18.91h6.93L16 12.09z\",fill:\"#00AC47\"}),u(\"path\",{d:\"M23.535 24.708c.34-.195.63-.463.832-.804l.403-.67 1.928-3.228c.201-.34.302-.718.302-1.096h-6.93l1.474 2.802 1.991 2.996z\",fill:\"#EA4335\"}),u(\"path\",{d:\"M16 12.09l3.465-5.798A2.274 2.274 0 0018.331 6h-4.662c-.403 0-.794.11-1.134.292L16 12.09z\",fill:\"#00832D\"}),u(\"path\",{d:\"M20.07 18.91h-8.14l-3.465 5.798c.34.195.73.292 1.134.292h12.802c.403 0 .794-.11 1.134-.292L20.07 18.91z\",fill:\"#2684FC\"}),u(\"path\",{d:\"M23.497 12.455l-3.2-5.359a2.252 2.252 0 00-.832-.804L16 12.09l4.07 6.82h6.917c0-.377-.1-.755-.302-1.096l-3.188-5.359z\",fill:\"#FFBA00\"}))),this.provider=new be(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:\"drive\",pluginId:this.id}),this.defaultLocale=Wy,this.i18nInit(),this.title=this.i18n(\"pluginNameGoogleDrive\"),this.onFirstRender=this.onFirstRender.bind(this),this.render=this.render.bind(this)}install(){this.view=new Wo(this,{provider:this.provider,loadAllFiles:!0});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}onFirstRender(){return Promise.all([this.provider.fetchPreAuthToken(),this.view.getFolder(\"root\")])}render(e){return this.view.render(e)}};n(Ji,\"GoogleDrive\");Ji.VERSION=tP.version;var Gy={strings:{pluginNameInstagram:\"Instagram\"}};var iP={version:\"3.1.3\"},Zi=class extends Z{constructor(e,t){super(e,t),this.id=this.opts.id||\"Instagram\",be.initPlugin(this,t),this.icon=()=>u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"32\",height:\"32\",viewBox:\"0 0 32 32\"},u(\"defs\",null,u(\"path\",{d:\"M16.825 5l.483-.001.799.002c1.168.005 1.598.021 2.407.057 1.17.05 1.97.235 2.67.506.725.28 1.34.655 1.951 1.265.613.61.99 1.223 1.273 1.946.273.7.46 1.498.516 2.67l.025.552.008.205c.029.748.037 1.51.042 3.777l.001.846v.703l-.001.398a50.82 50.82 0 01-.058 2.588c-.05 1.17-.235 1.97-.506 2.67a5.394 5.394 0 01-1.265 1.951c-.61.613-1.222.99-1.946 1.273-.699.273-1.498.46-2.668.516-.243.012-.451.022-.656.03l-.204.007c-.719.026-1.512.034-3.676.038l-.847.001h-1.1a50.279 50.279 0 01-2.587-.059c-1.171-.05-1.971-.235-2.671-.506a5.394 5.394 0 01-1.951-1.265 5.385 5.385 0 01-1.272-1.946c-.274-.699-.46-1.498-.517-2.668a88.15 88.15 0 01-.03-.656l-.007-.205c-.026-.718-.034-1.512-.038-3.674v-2.129c.006-1.168.022-1.597.058-2.406.051-1.171.235-1.971.506-2.672a5.39 5.39 0 011.265-1.95 5.381 5.381 0 011.946-1.272c.699-.274 1.498-.462 2.669-.517l.656-.03.204-.007c.718-.026 1.511-.034 3.674-.038zm.678 1.981h-1.226l-.295.001c-2.307.005-3.016.013-3.777.043l-.21.009-.457.02c-1.072.052-1.654.232-2.042.383-.513.2-.879.44-1.263.825a3.413 3.413 0 00-.82 1.267c-.15.388-.33.97-.375 2.043a48.89 48.89 0 00-.056 2.482v.398 1.565c.006 2.937.018 3.285.073 4.444.05 1.073.231 1.654.382 2.043.2.512.44.878.825 1.263.386.383.753.621 1.267.82.388.15.97.328 2.043.374.207.01.388.017.563.024l.208.007a63.28 63.28 0 002.109.026h1.564c2.938-.006 3.286-.019 4.446-.073 1.071-.051 1.654-.232 2.04-.383.514-.2.88-.44 1.264-.825.384-.386.622-.753.82-1.266.15-.389.328-.971.375-2.044.039-.88.054-1.292.057-2.723v-1.15-.572c-.006-2.936-.019-3.284-.074-4.445-.05-1.071-.23-1.654-.382-2.04-.2-.515-.44-.88-.825-1.264a3.405 3.405 0 00-1.267-.82c-.388-.15-.97-.328-2.042-.375a48.987 48.987 0 00-2.535-.056zm-1.515 3.37a5.65 5.65 0 11.021 11.299 5.65 5.65 0 01-.02-11.3zm.004 1.982a3.667 3.667 0 10.015 7.334 3.667 3.667 0 00-.015-7.334zm5.865-3.536a1.32 1.32 0 11.005 2.64 1.32 1.32 0 01-.005-2.64z\",id:\"a\"})),u(\"g\",{fill:\"none\",\"fill-rule\":\"evenodd\"},u(\"mask\",{id:\"b\",fill:\"#fff\"},u(\"use\",{xlinkHref:\"#a\"})),u(\"image\",{mask:\"url(#b)\",x:\"4\",y:\"4\",width:\"24\",height:\"24\",xlinkHref:\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAALKADAAQAAAABAAAALAAAAAD8buejAAALZklEQVRYCVWZC2LbNhAFCRKykvP0bD1506SxRKIzbwHJoU3jv5h9WICU3P7+6zlG2zZvr8s/rW1tN7U0rMll8aDYufdzbLfc1JHmpv3jpPy8tsO+3O2s/O6YMSjTl/qdCds4mIIG60m8vdq2Z+phm2V4vAb9+o7BbZeuoM0NyYazvTvbvlN1MGjHUAesZ/IWWOsCeF0BOwAK4ITR0WYd/QKHEPv2DEymmorZtiubjOHEMYEzXmC9GMxu+95Kz+kuwxjDBKb8iUoCAdqZoAeyALreW6ZNx9Y4Jz8cLwjTZOEoR+HU05k2RzgP2iafGgfZiEdZbEr94zpX/xkPtDtGAxF+LRcgTsp9CAZg0rnEnXmPqFshY5vLnVWxLXO/bah2sZQgBZppGSe8NbjNPN5kc/WbIYEn8U+jXCOezT4zfgS1eoVEhceVeK74Fe4N6CoYEoLWykzHsd+GMAUqdTTVvvqT1uWqB3lVCLb12/ORAe8/5Zu9mp7lqoEFUCAFDIxqz7i1bq2AY1U9jqq2QK/7DYl+1AeZlAFcEc+U/jkRUqsvCHQ/nyGvjrOl6EuZWRWVGCKUMCkntQ5o+u2AZ3OxakbTcoBZnY0xhgGCUM4Kp1xtBTnBnXM5ASRms/Fs7d9OpX8bXN45pibQY/ML1MmA5G9CINBuCpdftexr6i2c5qd9J441LNJm3zk1GVusJ7v6mPJ7HPxJR0Li/vg9O1XHTEgvsQoSgExU0NnlLF0paK+6d06aOMKE2nCKV0ofNw4WsWmLsWrv6lPLnhGpr9E137QkHOMB/jh/T8MOqOadXarR44zPBW5NvDccnBxVmdK81+7RQ5p6qnQoRDZPh9+xWj0N2XpqxX1HzMty9UlFnKya/h3gulziAsyxwkSmpTIPB8vagKLyktRdDuBEHNGZMm4oCFWgjq31WPHpaC93gGNqpOpP4Ez4spa+nMNvhTWcuPKAJ79fqIxVoUvdjEG9qSy2WhpQlz61yG/gnKEA25IrIOYK6DIsQs2EE9LR/sTKq38Nd1y/X//FXG0QDHkEqSz3EYVV2dhb00rgLPSDcqmrScs55NNOD2zVqKmYnYTFnkACp520dkW5vBxK99BVzr792/iZ+VVo92UkKU2oG5WFTb6mNiA1H2C8KC0E44qaQleR3EQvQNwLrECOVAiSwM5gpF7nvDND0lZvYuQ9JbZfqdTrqCgwMcVrRS0z9QkLu9NWmkgEHb8p2zDRylj9VWA3lXD2vObEdWpT3w5MiFqQ1W/lteG4eipastxv2w+TeTBP0ypK84HiOW9fUzLcjRDwCW2b2VxmnGSKTX6uRSwMnC9YX4l05Mh2uwI+QVWdWUOSTWd5Xjjf7/tPYk2stSh053XTGN5RJMCMSajMcS8Trn3j/E1ajthlxCkmJXVi47PSUsyyq+jyexsayQNuv5GVYJaszprNsQD3RkgYiy49kFl2JlJJxlf8Uu/lpkq7+aWqzEzjr5cTVpFaJvSVr8AKRtiTlVPFk5t1nO30W+o6jrbAk76kxFa/tX+dom4C1wDPk03gqCw8HTBSxx4FHxIA+mh2pM3rKu5SNqBAuOSZnHzsB9JwW7DV/ge8dlVsOh375PvH8YO8EALU1HuecIC6qQgXifNuSx9XAoLaoGIYDjkWFrawX1U1XrknuMFw7QBSPtg79XovmBvwqnDICrhClEO6wgKFj9vPqJWlthUvdgH1DOA8+wFMexzQc5BUS1d1IsdBSjEv4Fe1LgBO1CpFPTpV1JuPSFNt4y/trzbtaUfwBWwM3/6JsrL6MSQYwLKXAm9YJBxsM8992MblZ63Gami0+rnwOMyPykVpQsyl9eYNOfVC6kRBkwaop//LgcAKWivkHF791g0JK5kMmCgKPas2QRkUFQsuTvm6R1946Wg95k764ZRLW59yO5UVGsawwELupCfAbdCuAwvcz5Xk18rIVEdgSRBRgO77R206QdXHuA2goaGiCQ0GmUfN1JlmFayjv0IcKGkfYt4HAj0yuQBRGDjzuS/rTmAf29Gov1S+FF7QBayNcpoBOEsMt3vFcIUC7VxOnE+pxmkgqEzduzwsPykrjBszCusgdarsRIAL6CM/KqsqcAf1vj8P1TXFyN6e5G8ao48fjKfDQJYizIdIfb+Xwp6Z2fE2C7mUfUEzMKqSBp4VUV1A49Sz1M2LzVzahEfyHUAcQNltR0nADYkBvHXDZQo8H9dQvHF7qhjPtSolBJ0A/vaLwdRz5YFFGoWBy8E/4aKcjqimaUBXXnjBpzOZnMlIVXsTVEBBUa+dD0BR0xVopgAD70psY0KjMHpmHB2kApea9o23NS83mpsref5OZet4U/0CMhSEDpwnxB9lVKSfk5djllXRFPizQmKcqMpnyZ3ycPntf96Ym9ChzU8vCQnhgWZ2UuySArw+cVBG4gqNCS6YoSEEziRWVStKUpe4FfCd91V0XA/qgOJuF7FpGjjyQgsFoNDtibp8cm+cyXxbB6zh4pMUO4H06yzsv4E/A6rg/uRJRnMRmrhMDIhyOjABX9CMDFhBFxx19KujjqWeim5PwVFU6IBiewfyk7IPETcg52kjXN7nsbaoEykKf/cjUgVxpTZZVtnqFMgv4FHa8oSOisawinMLHfUBzJcK1j8BeqquedKDtgcgnA4bym4P6gBWYVM3W/pn41ku5L4RElFWtlk5SXHEThhOWDiIyVROlQNM+wyHimlgATI/PPIm4BB8qfqwHnhgL89gzs+Ww1xQb4821SZ/4IwOJiRqH/X9u7Hj08JLSZfawOQcpRzwgk1oBNzzcgLn1FBNHspMENik9OG4awIDaUjw9rKNT1KXPl9neua6sSbkgqfs/CNfBdNfDDhQuL4AKXEXeOgZID91eOiRUnEFOIA5rnTkBU0/IT05gByoq5KBJF4Hym4Pxh3UcxZ7HjdhEhKWURbhavNR9rjLBwk3ryDcrGzfvk9I69b1yhMGWQ4bqMwv/RMSplQkjjVKXzZX8wESVcuB7QG0YUCMjk/aOmWgc/vC4oMCVYfghIGP6MT1zpeUhM1rQzOnGxmFKwTCir1Xaj5vN7T7nDZvnbDGHbCKnwji2zofNsOvbold3zlUtKGosBun3PbJSrrReHEaCQVCIDEMaCCBs+P+AbybkbIhmbNecGwF+E5/L2ECuPKCWsUESQkKnyyJ93TGACk7OrAY9P8XG//fGCoM7DAEUGnj5Mw7aQfelySWOm9iPuFyvrL8rKQR6mM6qdCUDQsfNPVu4yv/HaPOT1e/yDaviMKmTkg/I/F7MUG9OlrmDrBLRVd3c8KBJlPEKoVRcIJuhoQAmZDUkPC00W5OI1dOpQ1F61kFNqr9SmFcaHdBheOaDHF6QZMOP6QyiZ804oj98wLiAMIgcWw4UDYkDAWfR+4d5s0zP2GgUZX04i+NeSgYGokvbDhIZYUWHgd9K8zZzir264NxZUFbsfM1jdqpV2naA48tx6hsvBSabE4IMtlcOGgq8PqCjoly2rw2soqy4RJWQtPZl6PUCU14ZUWENuZV2Honn3f+k6R6wrkqgTStyQ0bFY+XAaafMRFgUlVeXxXFUcpLEYfZz3FrVUzZrOOJK+4B/wnIZ8TGRvb9OB8EUM0w8uNYj/oa9iK9AMoy6gA72o02srMxpAPUD+EDnVEF7P5xw896VyAbFk8MgnpVpR3gfLnt/wECq3rYFvYLcKCpqvcI+/hVl8AumXDeApklDRRKJSS+KOaq1Rgg4igOYtiQK1hJy46TBtDjznDp3iqJff5j0/LfSZbYVdauqXccJ9W+czupp0sU9gMlqkQ52lU1E6tUwoDUukAD6YRpAwqDrAErzA8QCRvXm98KEep0xIdY1CN1ye27IP0IHvvYIW18qGz8S7VWUZuMkUOb3P8DHTl67ur/i1UAAAAASUVORK5CYII=\"}))),this.defaultLocale=Gy,this.i18nInit(),this.title=this.i18n(\"pluginNameInstagram\"),this.provider=new be(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:\"instagram\",pluginId:this.id}),this.onFirstRender=this.onFirstRender.bind(this),this.render=this.render.bind(this)}install(){this.view=new Te(this,{provider:this.provider,viewType:\"grid\",showTitles:!1,showFilter:!1,showBreadcrumbs:!1});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}onFirstRender(){return Promise.all([this.provider.fetchPreAuthToken(),this.view.getFolder(\"recent\")])}render(e){return this.view.render(e)}};n(Zi,\"Instagram\");Zi.VERSION=iP.version;var Ky={strings:{pluginNameOneDrive:\"OneDrive\"}};var rP={version:\"3.1.4\"},er=class extends Z{constructor(e,t){super(e,t),this.id=this.opts.id||\"OneDrive\",be.initPlugin(this,t),this.title=this.opts.title||\"OneDrive\",this.icon=()=>u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"32\",height:\"32\",viewBox:\"0 0 32 32\"},u(\"g\",{fill:\"none\",fillRule:\"nonzero\"},u(\"path\",{d:\"M13.39 12.888l4.618 2.747 2.752-1.15a4.478 4.478 0 012.073-.352 6.858 6.858 0 00-5.527-5.04 6.895 6.895 0 00-6.876 2.982l.07-.002a5.5 5.5 0 012.89.815z\",fill:\"#0364B8\"}),u(\"path\",{d:\"M13.39 12.887v.001a5.5 5.5 0 00-2.89-.815l-.07.002a5.502 5.502 0 00-4.822 2.964 5.43 5.43 0 00.38 5.62l4.073-1.702 1.81-.757 4.032-1.685 2.105-.88-4.619-2.748z\",fill:\"#0078D4\"}),u(\"path\",{d:\"M22.833 14.133a4.479 4.479 0 00-2.073.352l-2.752 1.15.798.475 2.616 1.556 1.141.68 3.902 2.321a4.413 4.413 0 00-.022-4.25 4.471 4.471 0 00-3.61-2.284z\",fill:\"#1490DF\"}),u(\"path\",{d:\"M22.563 18.346l-1.141-.68-2.616-1.556-.798-.475-2.105.88L11.87 18.2l-1.81.757-4.073 1.702A5.503 5.503 0 0010.5 23h12.031a4.472 4.472 0 003.934-2.333l-3.902-2.321z\",fill:\"#28A8EA\"}))),this.provider=new be(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionCookiesRule:this.opts.companionCookiesRule,provider:\"onedrive\",pluginId:this.id}),this.defaultLocale=Ky,this.i18nInit(),this.title=this.i18n(\"pluginNameOneDrive\"),this.onFirstRender=this.onFirstRender.bind(this),this.render=this.render.bind(this)}install(){this.view=new Te(this,{provider:this.provider,loadAllFiles:!0});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}onFirstRender(){return Promise.all([this.provider.fetchPreAuthToken(),this.view.getFolder()])}render(e){return this.view.render(e)}};n(er,\"OneDrive\");er.VERSION=rP.version;var sP={version:\"3.2.3\"},tr=class extends Z{constructor(e,t){if(super(e,t),this.id=this.opts.id||\"Unsplash\",this.title=this.opts.title||\"Unsplash\",be.initPlugin(this,t,{}),this.icon=()=>u(\"svg\",{className:\"uppy-DashboardTab-iconUnsplash\",viewBox:\"0 0 32 32\",height:\"32\",width:\"32\",\"aria-hidden\":\"true\"},u(\"g\",{fill:\"currentcolor\"},u(\"path\",{d:\"M46.575 10.883v-9h12v9zm12 5h10v18h-32v-18h10v9h12z\"}),u(\"path\",{d:\"M13 12.5V8h6v4.5zm6 2.5h5v9H8v-9h5v4.5h6z\"}))),!this.opts.companionUrl)throw new Error(\"Companion hostname is required, please consult https://uppy.io/docs/companion\");this.hostname=this.opts.companionUrl,this.provider=new Yr(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionCookiesRule:this.opts.companionCookiesRule,provider:\"unsplash\",pluginId:this.id})}install(){this.view=new ji(this,{provider:this.provider,viewType:\"unsplash\",showFilter:!0});let{target:e}=this.opts;e&&this.mount(e,this)}onFirstRender(){}render(e){return this.view.render(e)}uninstall(){this.unmount()}};n(tr,\"Unsplash\");tr.VERSION=sP.version;function Xy(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(Xy,\"_classPrivateFieldLooseBase\");var oP=0;function nP(i){return\"__private_\"+oP+++\"_\"+i}n(nP,\"_classPrivateFieldLooseKey\");var Pa=nP(\"handleSubmit\"),Iu=class extends we{constructor(e){super(e),this.form=document.createElement(\"form\"),Object.defineProperty(this,Pa,{writable:!0,value:t=>{t.preventDefault();let{addFile:r}=this.props,s=this.input.value.trim();r(s)}}),this.form.id=Pt()}componentDidMount(){this.input.value=\"\",this.form.addEventListener(\"submit\",Xy(this,Pa)[Pa]),document.body.appendChild(this.form)}componentWillUnmount(){this.form.removeEventListener(\"submit\",Xy(this,Pa)[Pa]),document.body.removeChild(this.form)}render(){let{i18n:e}=this.props;return u(\"div\",{className:\"uppy-Url\"},u(\"input\",{className:\"uppy-u-reset uppy-c-textInput uppy-Url-input\",type:\"text\",\"aria-label\":e(\"enterUrlToImport\"),placeholder:e(\"enterUrlToImport\"),ref:t=>{this.input=t},\"data-uppy-super-focusable\":!0,form:this.form.id}),u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Url-importButton\",type:\"submit\",form:this.form.id},e(\"import\")))}};n(Iu,\"UrlUI\");var Yy=Iu;function Nu(i,e,t){let r=Qe(i.items),s;switch(e){case\"paste\":{if(r.some(a=>a.kind===\"file\"))return;s=r.filter(a=>a.kind===\"string\"&&a.type===\"text/plain\");break}case\"drop\":{s=r.filter(o=>o.kind===\"string\"&&o.type===\"text/uri-list\");break}default:throw new Error(`isDropOrPaste must be either 'drop' or 'paste', but it's ${e}`)}s.forEach(o=>{o.getAsString(a=>t(a))})}n(Nu,\"forEachDroppedOrPastedUrl\");var Qy={strings:{import:\"Import\",enterUrlToImport:\"Enter URL to import a file\",failedToFetch:\"Companion failed to fetch this URL, please make sure it\\u2019s correct\",enterCorrectUrl:\"Incorrect URL: Please make sure you are entering a direct link to a file\"}};var aP={version:\"3.4.0\"};function lP(){return u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"32\",height:\"32\",viewBox:\"0 0 32 32\"},u(\"path\",{d:\"M23.637 15.312l-2.474 2.464a3.582 3.582 0 01-.577.491c-.907.657-1.897.986-2.968.986a4.925 4.925 0 01-3.959-1.971c-.248-.329-.164-.902.165-1.149.33-.247.907-.164 1.155.164 1.072 1.478 3.133 1.724 4.618.656a.642.642 0 00.33-.328l2.473-2.463c1.238-1.313 1.238-3.366-.082-4.597a3.348 3.348 0 00-4.618 0l-1.402 1.395a.799.799 0 01-1.154 0 .79.79 0 010-1.15l1.402-1.394a4.843 4.843 0 016.843 0c2.062 1.805 2.144 5.007.248 6.896zm-8.081 5.664l-1.402 1.395a3.348 3.348 0 01-4.618 0c-1.319-1.23-1.319-3.365-.082-4.596l2.475-2.464.328-.328c.743-.492 1.567-.739 2.475-.657.906.165 1.648.574 2.143 1.314.248.329.825.411 1.155.165.33-.248.412-.822.165-1.15-.825-1.068-1.98-1.724-3.216-1.888-1.238-.247-2.556.082-3.628.902l-.495.493-2.474 2.464c-1.897 1.969-1.814 5.09.083 6.977.99.904 2.226 1.396 3.463 1.396s2.473-.492 3.463-1.395l1.402-1.396a.79.79 0 000-1.15c-.33-.328-.908-.41-1.237-.082z\",fill:\"#FF753E\",\"fill-rule\":\"nonzero\"}))}n(lP,\"UrlIcon\");function uP(i){let e=/^[a-z0-9]+:\\/\\//,t=\"http://\";return e.test(i)?i:t+i}n(uP,\"addProtocolToURL\");function hP(i){return Qe(i.dataTransfer.items).filter(r=>r.kind===\"string\"&&r.type===\"text/uri-list\").length>0}n(hP,\"canHandleRootDrop\");function dP(i){if(!i)return!1;let e=i.match(/^([a-z0-9]+):\\/\\//)[1];return!(e!==\"http\"&&e!==\"https\")}n(dP,\"checkIfCorrectURL\");function cP(i){let{pathname:e}=new URL(i);return e.substring(e.lastIndexOf(\"/\")+1)}n(cP,\"getFileNameFromUrl\");var Ti=class extends Z{constructor(e,t){super(e,t),this.id=this.opts.id||\"Url\",this.title=this.opts.title||\"Link\",this.type=\"acquirer\",this.icon=()=>u(lP,null),this.defaultLocale=Qy;let r={};if(this.opts={...r,...t},this.i18nInit(),this.hostname=this.opts.companionUrl,!this.hostname)throw new Error(\"Companion hostname is required, please consult https://uppy.io/docs/companion\");this.getMeta=this.getMeta.bind(this),this.addFile=this.addFile.bind(this),this.handleRootDrop=this.handleRootDrop.bind(this),this.handleRootPaste=this.handleRootPaste.bind(this),this.client=new tt(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionCookiesRule:this.opts.companionCookiesRule})}getMeta(e){return this.client.post(\"url/meta\",{url:e}).then(t=>{if(t.error)throw this.uppy.log(\"[URL] Error:\"),this.uppy.log(t.error),new Error(\"Failed to fetch the file\");return t})}async addFile(e,t){t===void 0&&(t=void 0);let r=uP(e);if(!dP(r)){this.uppy.log(`[URL] Incorrect URL entered: ${r}`),this.uppy.info(this.i18n(\"enterCorrectUrl\"),\"error\",4e3);return}try{let s=await this.getMeta(r),o={meta:t,source:this.id,name:s.name||cP(r),type:s.type,data:{size:s.size},isRemote:!0,body:{url:r},remote:{companionUrl:this.opts.companionUrl,url:`${this.hostname}/url/get`,body:{fileId:r,url:r}}};Object.defineProperty(o.remote,\"requestClient\",{value:this.client,enumerable:!1}),this.uppy.log(\"[Url] Adding remote file\");try{return this.uppy.addFile(o)}catch(a){return a.isRestriction||this.uppy.log(a),a}}catch(s){return this.uppy.log(s),this.uppy.info({message:this.i18n(\"failedToFetch\"),details:s},\"error\",4e3),s}}handleRootDrop(e){Nu(e.dataTransfer,\"drop\",t=>{this.uppy.log(`[URL] Adding file from dropped url: ${t}`),this.addFile(t)})}handleRootPaste(e){Nu(e.clipboardData,\"paste\",t=>{this.uppy.log(`[URL] Adding file from pasted url: ${t}`),this.addFile(t)})}render(){return u(Yy,{i18n:this.i18n,addFile:this.addFile})}install(){let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.unmount()}};n(Ti,\"Url\");Ti.VERSION=aP.version;Ti.prototype.canHandleRootDrop=hP;var Jy={strings:{pluginNameZoom:\"Zoom\"}};var pP={version:\"2.1.3\"},ir=class extends Z{constructor(e,t){super(e,t),this.id=this.opts.id||\"Zoom\",be.initPlugin(this,t),this.title=this.opts.title||\"Zoom\",this.icon=()=>u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"32\",height:\"32\",viewBox:\"0 0 32 32\"},u(\"path\",{d:\"M24.5 11.125l-2.75 2.063c-.473.353-.75.91-.75 1.5v3.124c0 .59.277 1.147.75 1.5l2.75 2.063a.938.938 0 001.5-.75v-8.75a.938.938 0 00-1.5-.75zm-4.75 9.5c0 1.035-.84 1.875-1.875 1.875H9.75A3.75 3.75 0 016 18.75v-6.875C6 10.84 6.84 10 7.875 10H16a3.75 3.75 0 013.75 3.75v6.875z\",fill:\"#2E8CFF\",\"fill-rule\":\"evenodd\"})),this.provider=new be(e,{companionUrl:this.opts.companionUrl,companionHeaders:this.opts.companionHeaders,companionKeysParams:this.opts.companionKeysParams,companionCookiesRule:this.opts.companionCookiesRule,provider:\"zoom\",pluginId:this.id}),this.defaultLocale=Jy,this.i18nInit(),this.title=this.i18n(\"pluginNameZoom\"),this.onFirstRender=this.onFirstRender.bind(this),this.render=this.render.bind(this)}install(){this.view=new Te(this,{provider:this.provider});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.view.tearDown(),this.unmount()}onFirstRender(){return Promise.all([this.provider.fetchPreAuthToken(),this.view.getFolder()])}render(e){return this.view.render(e)}};n(ir,\"Zoom\");ir.VERSION=pP.version;function nc(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(nc,\"_classPrivateFieldLooseBase\");var fP=0;function mP(i){return\"__private_\"+fP+++\"_\"+i}n(mP,\"_classPrivateFieldLooseKey\");var gP={version:\"1.1.0\"},ac={__proto__:null,Box:Xi,Dropbox:Yi,Facebook:Qi,GoogleDrive:Ji,Instagram:Zi,OneDrive:er,Unsplash:tr,Url:Ti,Zoom:ir},Bs=mP(\"installedPlugins\"),zs=class extends ve{constructor(e,t){super(e,t),Object.defineProperty(this,Bs,{writable:!0,value:new Set}),this.id=this.opts.id||\"RemoteSources\",this.type=\"preset\";let r={sources:Object.keys(ac)};if(this.opts={...r,...t},this.opts.companionUrl==null)throw new Error(\"Please specify companionUrl for RemoteSources to work, see https://uppy.io/docs/remote-sources#companionUrl\")}setOptions(e){this.uninstall(),super.setOptions(e),this.install()}install(){this.opts.sources.forEach(e=>{let t={...this.opts,sources:void 0},r=ac[e];if(r==null){let s=Object.keys(ac),o=new Intl.ListFormat(\"en\",{style:\"long\",type:\"disjunction\"});throw new Error(`Invalid plugin: \"${e}\" is not one of: ${o.format(s)}.`)}this.uppy.use(r,t),nc(this,Bs)[Bs].add(this.uppy.getPlugin(e))})}uninstall(){for(let e of nc(this,Bs)[Bs])this.uppy.removePlugin(e);nc(this,Bs)[Bs].clear()}};n(zs,\"RemoteSources\");zs.VERSION=gP.version;var Zy=n(()=>u(\"svg\",{className:\"uppy-DashboardTab-iconScreenRec\",\"aria-hidden\":\"true\",focusable:\"false\",width:\"32\",height:\"32\",viewBox:\"0 0 32 32\"},u(\"g\",{fill:\"currentcolor\",fillRule:\"evenodd\"},u(\"path\",{d:\"M24.182 9H7.818C6.81 9 6 9.742 6 10.667v10c0 .916.81 1.666 1.818 1.666h4.546V24h7.272v-1.667h4.546c1 0 1.809-.75 1.809-1.666l.009-10C26 9.742 25.182 9 24.182 9zM24 21H8V11h16v10z\"}),u(\"circle\",{cx:\"16\",cy:\"16\",r:\"2\"}))),\"default\");function lc(i){let{recording:e,onStartRecording:t,onStopRecording:r,i18n:s}=i;return e?u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--video uppy-ScreenCapture-button--stop-rec\",type:\"button\",title:s(\"stopCapturing\"),\"aria-label\":s(\"stopCapturing\"),onClick:r,\"data-uppy-super-focusable\":!0},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"100\",height:\"100\",viewBox:\"0 0 100 100\"},u(\"rect\",{x:\"15\",y:\"15\",width:\"70\",height:\"70\"}))):u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--video\",type:\"button\",title:s(\"startCapturing\"),\"aria-label\":s(\"startCapturing\"),onClick:t,\"data-uppy-super-focusable\":!0},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"100\",height:\"100\",viewBox:\"0 0 100 100\"},u(\"circle\",{cx:\"50\",cy:\"50\",r:\"40\"})))}n(lc,\"RecordButton\");function uc(i){let{recording:e,recordedVideo:t,onSubmit:r,i18n:s}=i;return t&&!e?u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-ScreenCapture-button uppy-ScreenCapture-button--submit\",type:\"button\",title:s(\"submitRecordedFile\"),\"aria-label\":s(\"submitRecordedFile\"),onClick:r,\"data-uppy-super-focusable\":!0},u(\"svg\",{width:\"12\",height:\"9\",viewBox:\"0 0 12 9\",xmlns:\"http://www.w3.org/2000/svg\",\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\"},u(\"path\",{fill:\"#fff\",fillRule:\"nonzero\",d:\"M10.66 0L12 1.31 4.136 9 0 4.956l1.34-1.31L4.136 6.38z\"}))):null}n(uc,\"SubmitButton\");var Mu=class extends we{constructor(e){super(e),this.state={elapsedTime:0},this.wrapperStyle={width:\"100%\",height:\"100%\",display:\"flex\"},this.overlayStyle={position:\"absolute\",width:\"100%\",height:\"100%\",background:\"black\",opacity:.7},this.infoContainerStyle={marginLeft:\"auto\",marginRight:\"auto\",marginTop:\"auto\",marginBottom:\"auto\",zIndex:1,color:\"white\"},this.infotextStyle={marginLeft:\"auto\",marginRight:\"auto\",marginBottom:\"1rem\",fontSize:\"1.5rem\"},this.timeStyle={display:\"block\",fontWeight:\"bold\",marginLeft:\"auto\",marginRight:\"auto\",fontSize:\"3rem\",fontFamily:\"Courier New\"}}startTimer(){this.timerTick(),this.timerRunning=!0}resetTimer(){clearTimeout(this.timer),this.setState({elapsedTime:0}),this.timerRunning=!1}timerTick(){this.timer=setTimeout(()=>{this.setState(e=>({elapsedTime:e.elapsedTime+1})),this.timerTick()},1e3)}fmtMSS(e){return(e-(e%=60))/60+(e>9?\":\":\":0\")+e}render(){let{recording:e,i18n:t}={...this.props},{elapsedTime:r}=this.state,s=this.fmtMSS(r);return e&&!this.timerRunning&&this.startTimer(),!e&&this.timerRunning&&this.resetTimer(),e?u(\"div\",{style:this.wrapperStyle},u(\"div\",{style:this.overlayStyle}),u(\"div\",{style:this.infoContainerStyle},u(\"div\",{style:this.infotextStyle},t(\"recording\")),u(\"div\",{style:this.timeStyle},s))):null}};n(Mu,\"StopWatch\");var ev=Mu;var tv=n(i=>{let{streamActive:e,i18n:t}=i;return e?u(\"div\",{title:t(\"streamActive\"),\"aria-label\":t(\"streamActive\"),className:\"uppy-ScreenCapture-icon--stream uppy-ScreenCapture-icon--streamActive\"},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\"},u(\"path\",{d:\"M0 0h24v24H0z\",opacity:\".1\",fill:\"none\"}),u(\"path\",{d:\"M0 0h24v24H0z\",fill:\"none\"}),u(\"path\",{d:\"M1 18v3h3c0-1.66-1.34-3-3-3zm0-4v2c2.76 0 5 2.24 5 5h2c0-3.87-3.13-7-7-7zm18-7H5v1.63c3.96 1.28 7.09 4.41 8.37 8.37H19V7zM1 10v2c4.97 0 9 4.03 9 9h2c0-6.08-4.93-11-11-11zm20-7H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\"}))):u(\"div\",{title:t(\"streamPassive\"),\"aria-label\":t(\"streamPassive\"),className:\"uppy-ScreenCapture-icon--stream\"},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"24\",height:\"24\",viewBox:\"0 0 24 24\"},u(\"path\",{d:\"M0 0h24v24H0z\",opacity:\".1\",fill:\"none\"}),u(\"path\",{d:\"M0 0h24v24H0z\",fill:\"none\"}),u(\"path\",{d:\"M21 3H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM1 18v3h3c0-1.66-1.34-3-3-3zm0-4v2c2.76 0 5 2.24 5 5h2c0-3.87-3.13-7-7-7zm0-4v2c4.97 0 9 4.03 9 9h2c0-6.08-4.93-11-11-11z\"})))},\"default\");function hc(){return hc=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},hc.apply(this,arguments)}n(hc,\"_extends\");var Lu=class extends we{componentWillUnmount(){let{onStop:e}=this.props;e()}render(){let{recording:e,stream:t,recordedVideo:r}=this.props,s={playsinline:!0};return(e||!r&&!e)&&(s.muted=!0,s.autoplay=!0,s.srcObject=t),r&&!e&&(s.muted=!1,s.controls=!0,s.src=r,this.videoElement&&(this.videoElement.srcObject=void 0)),u(\"div\",{className:\"uppy uppy-ScreenCapture-container\"},u(\"div\",{className:\"uppy-ScreenCapture-videoContainer\"},u(tv,this.props),u(\"video\",hc({ref:o=>{this.videoElement=o},className:\"uppy-ScreenCapture-video\"},s)),u(ev,this.props)),u(\"div\",{className:\"uppy-ScreenCapture-buttonContainer\"},u(lc,this.props),u(uc,this.props)))}};n(Lu,\"RecorderScreen\");var iv=Lu;var rv={strings:{startCapturing:\"Begin screen capturing\",stopCapturing:\"Stop screen capturing\",submitRecordedFile:\"Submit recorded file\",streamActive:\"Stream active\",streamPassive:\"Stream passive\",micDisabled:\"Microphone access denied by user\",recording:\"Recording\"}};function dc(){return dc=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},dc.apply(this,arguments)}n(dc,\"_extends\");var yP={version:\"3.1.3\"};function vP(){var i;return window.MediaRecorder&&((i=navigator.mediaDevices)==null?void 0:i.getDisplayMedia)}n(vP,\"isScreenRecordingSupported\");function bP(){return window.MediaRecorder&&navigator.mediaDevices}n(bP,\"getMediaDevices\");var as=class extends Z{constructor(e,t){super(e,t),this.mediaDevices=bP(),this.protocol=location.protocol===\"https:\"?\"https\":\"http\",this.id=this.opts.id||\"ScreenCapture\",this.title=this.opts.title||\"Screencast\",this.type=\"acquirer\",this.icon=Zy,this.defaultLocale=rv;let r={displayMediaConstraints:{video:{width:1280,height:720,frameRate:{ideal:3,max:5},cursor:\"motion\",displaySurface:\"monitor\"}},userMediaConstraints:{audio:!0},preferredVideoMimeType:\"video/webm\"};this.opts={...r,...t},this.i18nInit(),this.install=this.install.bind(this),this.setPluginState=this.setPluginState.bind(this),this.render=this.render.bind(this),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.startRecording=this.startRecording.bind(this),this.stopRecording=this.stopRecording.bind(this),this.submit=this.submit.bind(this),this.streamInterrupted=this.streamInactivated.bind(this),this.captureActive=!1,this.capturedMediaFile=null}install(){if(!vP())return this.uppy.log(\"Screen recorder access is not supported\",\"warning\"),null;this.setPluginState({streamActive:!1,audioStreamActive:!1});let{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){this.videoStream&&this.stop(),this.unmount()}start(){return this.mediaDevices?(this.captureActive=!0,this.selectAudioStreamSource(),this.selectVideoStreamSource().then(e=>{e===!1&&this.parent&&this.parent.hideAllPanels&&(this.parent.hideAllPanels(),this.captureActive=!1)})):Promise.reject(new Error(\"Screen recorder access not supported\"))}selectVideoStreamSource(){return this.videoStream?new Promise(e=>e(this.videoStream)):this.mediaDevices.getDisplayMedia(this.opts.displayMediaConstraints).then(e=>(this.videoStream=e,this.videoStream.addEventListener(\"inactive\",()=>{this.streamInactivated()}),this.setPluginState({streamActive:!0}),e)).catch(e=>(this.setPluginState({screenRecError:e}),this.userDenied=!0,setTimeout(()=>{this.userDenied=!1},1e3),!1))}selectAudioStreamSource(){return this.audioStream?new Promise(e=>e(this.audioStream)):this.mediaDevices.getUserMedia(this.opts.userMediaConstraints).then(e=>(this.audioStream=e,this.setPluginState({audioStreamActive:!0}),e)).catch(e=>(e.name===\"NotAllowedError\"&&(this.uppy.info(this.i18n(\"micDisabled\"),\"error\",5e3),this.uppy.log(this.i18n(\"micDisabled\"),\"warning\")),!1))}startRecording(){let e={};this.capturedMediaFile=null,this.recordingChunks=[];let{preferredVideoMimeType:t}=this.opts;this.selectVideoStreamSource().then(r=>{t&&MediaRecorder.isTypeSupported(t)&&Ki(t)&&(e.mimeType=t);let s=[r.getVideoTracks()[0]];this.audioStream&&s.push(this.audioStream.getAudioTracks()[0]),this.outputStream=new MediaStream(s),this.recorder=new MediaRecorder(this.outputStream,e),this.recorder.addEventListener(\"dataavailable\",o=>{this.recordingChunks.push(o.data)}),this.recorder.start(),this.setPluginState({recording:!0})}).catch(r=>{this.uppy.log(r,\"error\")})}streamInactivated(){let{recordedVideo:e,recording:t}={...this.getPluginState()};!e&&!t?this.parent&&this.parent.hideAllPanels&&this.parent.hideAllPanels():t&&(this.uppy.log(\"Capture stream inactive \\u2014 stop recording\"),this.stopRecording()),this.videoStream=null,this.audioStream=null,this.setPluginState({streamActive:!1,audioStreamActive:!1})}stopRecording(){return new Promise(t=>{this.recorder.addEventListener(\"stop\",()=>{t()}),this.recorder.stop()}).then(()=>(this.setPluginState({recording:!1}),this.getVideo())).then(t=>{this.capturedMediaFile=t,this.setPluginState({recordedVideo:URL.createObjectURL(t.data)})}).then(()=>{this.recordingChunks=null,this.recorder=null},t=>{throw this.recordingChunks=null,this.recorder=null,t})}submit(){try{this.capturedMediaFile&&this.uppy.addFile(this.capturedMediaFile)}catch(e){e.isRestriction||this.uppy.log(e,\"warning\")}}stop(){this.videoStream&&(this.videoStream.getVideoTracks().forEach(e=>{e.stop()}),this.videoStream.getAudioTracks().forEach(e=>{e.stop()}),this.videoStream=null),this.audioStream&&(this.audioStream.getAudioTracks().forEach(e=>{e.stop()}),this.audioStream.getVideoTracks().forEach(e=>{e.stop()}),this.audioStream=null),this.outputStream&&(this.outputStream.getAudioTracks().forEach(e=>{e.stop()}),this.outputStream.getVideoTracks().forEach(e=>{e.stop()}),this.outputStream=null),this.setPluginState({recordedVideo:null}),this.captureActive=!1}getVideo(){let e=this.recordingChunks[0].type,t=Ki(e);if(!t)return Promise.reject(new Error(`Could not retrieve recording: Unsupported media type \"${e}\"`));let r=`screencap-${Date.now()}.${t}`,s=new Blob(this.recordingChunks,{type:e}),o={source:this.id,name:r,data:new Blob([s],{type:e}),type:e};return Promise.resolve(o)}render(){let e=this.getPluginState();return!e.streamActive&&!this.captureActive&&!this.userDenied&&this.start(),u(iv,dc({},e,{onStartRecording:this.startRecording,onStopRecording:this.stopRecording,onStop:this.stop,onSubmit:this.submit,i18n:this.i18n,stream:this.videoStream}))}};n(as,\"ScreenCapture\");as.VERSION=yP.version;var pv=de(sv(),1);function pc(i,e,t){return new Promise(r=>{i.toBlob(r,e,t)})}n(pc,\"canvasToBlob\");function fc(){return typeof MediaRecorder==\"function\"&&!!MediaRecorder.prototype&&typeof MediaRecorder.prototype.start==\"function\"}n(fc,\"supportsMediaRecorder\");var zu=n(()=>u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",fill:\"#0097DC\",width:\"66\",height:\"55\",viewBox:\"0 0 66 55\"},u(\"path\",{d:\"M57.3 8.433c4.59 0 8.1 3.51 8.1 8.1v29.7c0 4.59-3.51 8.1-8.1 8.1H8.7c-4.59 0-8.1-3.51-8.1-8.1v-29.7c0-4.59 3.51-8.1 8.1-8.1h9.45l4.59-7.02c.54-.54 1.35-1.08 2.16-1.08h16.2c.81 0 1.62.54 2.16 1.08l4.59 7.02h9.45zM33 14.64c-8.62 0-15.393 6.773-15.393 15.393 0 8.62 6.773 15.393 15.393 15.393 8.62 0 15.393-6.773 15.393-15.393 0-8.62-6.773-15.393-15.393-15.393zM33 40c-5.648 0-9.966-4.319-9.966-9.967 0-5.647 4.318-9.966 9.966-9.966s9.966 4.319 9.966 9.966C42.966 35.681 38.648 40 33 40z\",fillRule:\"evenodd\"})),\"default\");var ov=n(i=>{let{onSnapshot:e,i18n:t}=i;return u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--picture\",type:\"button\",title:t(\"takePicture\"),\"aria-label\":t(\"takePicture\"),onClick:e,\"data-uppy-super-focusable\":!0},zu())},\"default\");function mc(i){let{recording:e,onStartRecording:t,onStopRecording:r,i18n:s}=i;return e?u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-Webcam-button\",type:\"button\",title:s(\"stopRecording\"),\"aria-label\":s(\"stopRecording\"),onClick:r,\"data-uppy-super-focusable\":!0},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"100\",height:\"100\",viewBox:\"0 0 100 100\"},u(\"rect\",{x:\"15\",y:\"15\",width:\"70\",height:\"70\"}))):u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-Webcam-button\",type:\"button\",title:s(\"startRecording\"),\"aria-label\":s(\"startRecording\"),onClick:t,\"data-uppy-super-focusable\":!0},u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\",width:\"100\",height:\"100\",viewBox:\"0 0 100 100\"},u(\"circle\",{cx:\"50\",cy:\"50\",r:\"40\"})))}n(mc,\"RecordButton\");function gc(i){return`${Math.floor(i/60)}:${String(i%60).padStart(2,0)}`}n(gc,\"formatSeconds\");function yc(i){let{recordingLengthSeconds:e,i18n:t}=i,r=gc(e);return u(\"span\",{\"aria-label\":t(\"recordingLength\",{recording_length:r})},r)}n(yc,\"RecordingLength\");var nv=n(i=>{let{currentDeviceId:e,videoSources:t,onChangeVideoSource:r}=i;return u(\"div\",{className:\"uppy-Webcam-videoSource\"},u(\"select\",{className:\"uppy-u-reset uppy-Webcam-videoSource-select\",onChange:s=>{r(s.target.value)}},t.map(s=>u(\"option\",{key:s.deviceId,value:s.deviceId,selected:s.deviceId===e},s.label))))},\"default\");function _P(i){let{onSubmit:e,i18n:t}=i;return u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--submit\",type:\"button\",title:t(\"submitRecordedFile\"),\"aria-label\":t(\"submitRecordedFile\"),onClick:e,\"data-uppy-super-focusable\":!0},u(\"svg\",{width:\"12\",height:\"9\",viewBox:\"0 0 12 9\",xmlns:\"http://www.w3.org/2000/svg\",\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\"},u(\"path\",{fill:\"#fff\",fillRule:\"nonzero\",d:\"M10.66 0L12 1.31 4.136 9 0 4.956l1.34-1.31L4.136 6.38z\"})))}n(_P,\"SubmitButton\");var av=_P;function xP(i){let{onDiscard:e,i18n:t}=i;return u(\"button\",{className:\"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--discard\",type:\"button\",title:t(\"discardRecordedFile\"),\"aria-label\":t(\"discardRecordedFile\"),onClick:e,\"data-uppy-super-focusable\":!0},u(\"svg\",{width:\"13\",height:\"13\",viewBox:\"0 0 13 13\",xmlns:\"http://www.w3.org/2000/svg\",\"aria-hidden\":\"true\",focusable:\"false\",className:\"uppy-c-icon\"},u(\"g\",{fill:\"#FFF\",fillRule:\"evenodd\"},u(\"path\",{d:\"M.496 11.367L11.103.76l1.414 1.414L1.911 12.781z\"}),u(\"path\",{d:\"M11.104 12.782L.497 2.175 1.911.76l10.607 10.606z\"}))))}n(xP,\"DiscardButton\");var lv=xP;function vc(){return vc=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},vc.apply(this,arguments)}n(vc,\"_extends\");function ju(i,e){return i.includes(e)}n(ju,\"isModeAvailable\");var Hu=class extends we{componentDidMount(){let{onFocus:e}=this.props;e()}componentWillUnmount(){let{onStop:e}=this.props;e()}render(){let{src:e,recordedVideo:t,recording:r,modes:s,supportsRecording:o,videoSources:a,showVideoSourceDropdown:l,showRecordingLength:h,onSubmit:p,i18n:d,mirror:f,onSnapshot:y,onStartRecording:b,onStopRecording:S,onDiscardRecordedVideo:E,recordingLengthSeconds:x}=this.props,F=!!t,U=!F&&o&&(ju(s,\"video-only\")||ju(s,\"audio-only\")||ju(s,\"video-audio\")),j=!F&&ju(s,\"picture\"),G=o&&h&&!F,J=l&&a&&a.length>1,B={playsinline:!0};return t?(B.muted=!1,B.controls=!0,B.src=t,this.videoElement&&(this.videoElement.srcObject=void 0)):(B.muted=!0,B.autoplay=!0,B.srcObject=e),u(\"div\",{className:\"uppy uppy-Webcam-container\"},u(\"div\",{className:\"uppy-Webcam-videoContainer\"},u(\"video\",vc({ref:z=>this.videoElement=z,className:`uppy-Webcam-video  ${f?\"uppy-Webcam-video--mirrored\":\"\"}`},B))),u(\"div\",{className:\"uppy-Webcam-footer\"},u(\"div\",{className:\"uppy-Webcam-videoSourceContainer\"},J?nv(this.props):null),u(\"div\",{className:\"uppy-Webcam-buttonContainer\"},j&&u(ov,{onSnapshot:y,i18n:d}),U&&u(mc,{recording:r,onStartRecording:b,onStopRecording:S,i18n:d}),F&&u(av,{onSubmit:p,i18n:d}),F&&u(lv,{onDiscard:E,i18n:d})),u(\"div\",{className:\"uppy-Webcam-recordingLength\"},G&&u(yc,{recordingLengthSeconds:x,i18n:d}))))}};n(Hu,\"CameraScreen\");var uv=Hu;var hv=n(i=>{let{icon:e,i18n:t,hasCamera:r}=i;return u(\"div\",{className:\"uppy-Webcam-permissons\"},u(\"div\",{className:\"uppy-Webcam-permissonsIcon\"},e()),u(\"h1\",{className:\"uppy-Webcam-title\"},t(r?\"allowAccessTitle\":\"noCameraTitle\")),u(\"p\",null,t(r?\"allowAccessDescription\":\"noCameraDescription\")))},\"default\");var dv={strings:{pluginNameCamera:\"Camera\",noCameraTitle:\"Camera Not Available\",noCameraDescription:\"In order to take pictures or record video, please connect a camera device\",recordingStoppedMaxSize:\"Recording stopped because the file size is about to exceed the limit\",submitRecordedFile:\"Submit recorded file\",discardRecordedFile:\"Discard recorded file\",smile:\"Smile!\",takePicture:\"Take a picture\",startRecording:\"Begin video recording\",stopRecording:\"Stop video recording\",recordingLength:\"Recording length %{recording_length}\",allowAccessTitle:\"Please allow access to your camera\",allowAccessDescription:\"In order to take pictures or record video with your camera, please allow camera access for this site.\"}};function wc(){return wc=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},wc.apply(this,arguments)}n(wc,\"_extends\");function _a(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(_a,\"_classPrivateFieldLooseBase\");var FP=0;function EP(i){return\"__private_\"+FP+++\"_\"+i}n(EP,\"_classPrivateFieldLooseKey\");var OP={version:\"3.3.4\"};function cv(i){return i[0]===\".\"?fn[i.slice(1)]:i}n(cv,\"toMimeType\");function CP(i){return/^video\\/[^*]+$/.test(i)}n(CP,\"isVideoMimeType\");function TP(i){return/^image\\/[^*]+$/.test(i)}n(TP,\"isImageMimeType\");function AP(){return navigator.mediaDevices}n(AP,\"getMediaDevices\");function bc(i,e){return i.includes(e)}n(bc,\"isModeAvailable\");var Ai=EP(\"enableMirror\"),ls=class extends Z{constructor(e,t){super(e,t),Object.defineProperty(this,Ai,{writable:!0,value:void 0}),this.mediaDevices=AP(),this.supportsUserMedia=!!this.mediaDevices,this.protocol=location.protocol.match(/https/i)?\"https\":\"http\",this.id=this.opts.id||\"Webcam\",this.type=\"acquirer\",this.capturedMediaFile=null,this.icon=()=>u(\"svg\",{\"aria-hidden\":\"true\",focusable:\"false\",width:\"32\",height:\"32\",viewBox:\"0 0 32 32\"},u(\"path\",{d:\"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z\",fill:\"#02B383\",fillRule:\"nonzero\"})),this.defaultLocale=dv;let r={onBeforeSnapshot:()=>Promise.resolve(),countdown:!1,modes:[\"video-audio\",\"video-only\",\"audio-only\",\"picture\"],mirror:!0,showVideoSourceDropdown:!1,facingMode:\"user\",videoConstraints:void 0,preferredImageMimeType:null,preferredVideoMimeType:null,showRecordingLength:!1,mobileNativeCamera:(0,pv.default)({tablet:!0})};this.opts={...r,...t},this.i18nInit(),this.title=this.i18n(\"pluginNameCamera\"),_a(this,Ai)[Ai]=this.opts.mirror,this.install=this.install.bind(this),this.setPluginState=this.setPluginState.bind(this),this.render=this.render.bind(this),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.takeSnapshot=this.takeSnapshot.bind(this),this.startRecording=this.startRecording.bind(this),this.stopRecording=this.stopRecording.bind(this),this.discardRecordedVideo=this.discardRecordedVideo.bind(this),this.submit=this.submit.bind(this),this.oneTwoThreeSmile=this.oneTwoThreeSmile.bind(this),this.focus=this.focus.bind(this),this.changeVideoSource=this.changeVideoSource.bind(this),this.webcamActive=!1,this.opts.countdown&&(this.opts.onBeforeSnapshot=this.oneTwoThreeSmile),this.setPluginState({hasCamera:!1,cameraReady:!1,cameraError:null,recordingLengthSeconds:0,videoSources:[],currentDeviceId:null})}setOptions(e){super.setOptions({...e,videoConstraints:{...this.opts.videoConstraints,...e?.videoConstraints}})}hasCameraCheck(){return this.mediaDevices?this.mediaDevices.enumerateDevices().then(e=>e.some(t=>t.kind===\"videoinput\")):Promise.resolve(!1)}isAudioOnly(){return this.opts.modes.length===1&&this.opts.modes[0]===\"audio-only\"}getConstraints(e){e===void 0&&(e=null);let t=this.opts.modes.indexOf(\"video-audio\")!==-1||this.opts.modes.indexOf(\"audio-only\")!==-1,r=!this.isAudioOnly()&&(this.opts.modes.indexOf(\"video-audio\")!==-1||this.opts.modes.indexOf(\"video-only\")!==-1||this.opts.modes.indexOf(\"picture\")!==-1),s={...this.opts.videoConstraints||{facingMode:this.opts.facingMode},...e?{deviceId:e,facingMode:null}:{}};return{audio:t,video:r?s:!1}}start(e){if(e===void 0&&(e=null),!this.supportsUserMedia)return Promise.reject(new Error(\"Webcam access not supported\"));this.webcamActive=!0,this.opts.mirror&&(_a(this,Ai)[Ai]=!0);let t=this.getConstraints(e&&e.deviceId?e.deviceId:null);this.hasCameraCheck().then(r=>(this.setPluginState({hasCamera:r}),this.mediaDevices.getUserMedia(t).then(s=>{this.stream=s;let o=null,a=this.isAudioOnly()?s.getAudioTracks():s.getVideoTracks();!e||!e.deviceId?o=a[0].getSettings().deviceId:a.forEach(l=>{l.getSettings().deviceId===e.deviceId&&(o=l.getSettings().deviceId)}),this.updateVideoSources(),this.setPluginState({currentDeviceId:o,cameraReady:!0})}).catch(s=>{this.setPluginState({cameraReady:!1,cameraError:s}),this.uppy.info(s.message,\"error\")})))}getMediaRecorderOptions(){let e={};if(MediaRecorder.isTypeSupported){let{restrictions:t}=this.uppy.opts,r=[];this.opts.preferredVideoMimeType?r=[this.opts.preferredVideoMimeType]:t.allowedFileTypes&&(r=t.allowedFileTypes.map(cv).filter(CP));let s=n(a=>MediaRecorder.isTypeSupported(a)&&Ki(a),\"filterSupportedTypes\"),o=r.filter(s);o.length>0&&(e.mimeType=o[0])}return e}startRecording(){this.recorder=new MediaRecorder(this.stream,this.getMediaRecorderOptions()),this.recordingChunks=[];let e=!1;this.recorder.addEventListener(\"dataavailable\",t=>{this.recordingChunks.push(t.data);let{restrictions:r}=this.uppy.opts;if(this.recordingChunks.length>1&&r.maxFileSize!=null&&!e){let s=this.recordingChunks.reduce((h,p)=>h+p.size,0),a=(s-this.recordingChunks[0].size)/(this.recordingChunks.length-1)*3,l=Math.max(0,r.maxFileSize-a);s>l&&(e=!0,this.uppy.info(this.i18n(\"recordingStoppedMaxSize\"),\"warning\",4e3),this.stopRecording())}}),this.recorder.start(500),this.opts.showRecordingLength&&(this.recordingLengthTimer=setInterval(()=>{let t=this.getPluginState().recordingLengthSeconds;this.setPluginState({recordingLengthSeconds:t+1})},1e3)),this.setPluginState({isRecording:!0})}stopRecording(){return new Promise(t=>{this.recorder.addEventListener(\"stop\",()=>{t()}),this.recorder.stop(),this.opts.showRecordingLength&&(clearInterval(this.recordingLengthTimer),this.setPluginState({recordingLengthSeconds:0}))}).then(()=>(this.setPluginState({isRecording:!1}),this.getVideo())).then(t=>{try{this.capturedMediaFile=t,this.setPluginState({recordedVideo:URL.createObjectURL(t.data)}),_a(this,Ai)[Ai]=!1}catch(r){r.isRestriction||this.uppy.log(r)}}).then(()=>{this.recordingChunks=null,this.recorder=null},t=>{throw this.recordingChunks=null,this.recorder=null,t})}discardRecordedVideo(){this.setPluginState({recordedVideo:null}),this.opts.mirror&&(_a(this,Ai)[Ai]=!0),this.capturedMediaFile=null}submit(){try{this.capturedMediaFile&&this.uppy.addFile(this.capturedMediaFile)}catch(e){e.isRestriction||this.uppy.log(e,\"error\")}}async stop(){if(this.stream){let e=this.stream.getAudioTracks(),t=this.stream.getVideoTracks();e.concat(t).forEach(r=>r.stop())}this.recorder&&await new Promise(e=>{this.recorder.addEventListener(\"stop\",e,{once:!0}),this.recorder.stop(),this.opts.showRecordingLength&&clearInterval(this.recordingLengthTimer)}),this.recordingChunks=null,this.recorder=null,this.webcamActive=!1,this.stream=null,this.setPluginState({recordedVideo:null,isRecording:!1,recordingLengthSeconds:0})}getVideoElement(){return this.el.querySelector(\".uppy-Webcam-video\")}oneTwoThreeSmile(){return new Promise((e,t)=>{let r=this.opts.countdown,s=setInterval(()=>{if(!this.webcamActive)return clearInterval(s),this.captureInProgress=!1,t(new Error(\"Webcam is not active\"));r>0?(this.uppy.info(`${r}...`,\"warning\",800),r--):(clearInterval(s),this.uppy.info(this.i18n(\"smile\"),\"success\",1500),setTimeout(()=>e(),1500))},1e3)})}takeSnapshot(){this.captureInProgress||(this.captureInProgress=!0,this.opts.onBeforeSnapshot().catch(e=>{let t=typeof e==\"object\"?e.message:e;return this.uppy.info(t,\"error\",5e3),Promise.reject(new Error(`onBeforeSnapshot: ${t}`))}).then(()=>this.getImage()).then(e=>{this.captureInProgress=!1;try{this.uppy.addFile(e)}catch(t){t.isRestriction||this.uppy.log(t)}},e=>{throw this.captureInProgress=!1,e}))}getImage(){let e=this.getVideoElement();if(!e)return Promise.reject(new Error(\"No video element found, likely due to the Webcam tab being closed.\"));let t=e.videoWidth,r=e.videoHeight,s=document.createElement(\"canvas\");s.width=t,s.height=r,s.getContext(\"2d\").drawImage(e,0,0);let{restrictions:a}=this.uppy.opts,l=[];this.opts.preferredImageMimeType?l=[this.opts.preferredImageMimeType]:a.allowedFileTypes&&(l=a.allowedFileTypes.map(cv).filter(TP));let h=l[0]||\"image/jpeg\",p=Ki(h)||\"jpg\",d=`cam-${Date.now()}.${p}`;return pc(s,h).then(f=>({source:this.id,name:d,data:new Blob([f],{type:h}),type:h}))}getVideo(){let e=this.recordingChunks.find(a=>{var l;return((l=a.type)==null?void 0:l.length)>0}).type,t=Ki(e);if(!t)return Promise.reject(new Error(`Could not retrieve recording: Unsupported media type \"${e}\"`));let r=`webcam-${Date.now()}.${t}`,s=new Blob(this.recordingChunks,{type:e}),o={source:this.id,name:r,data:new Blob([s],{type:e}),type:e};return Promise.resolve(o)}focus(){this.opts.countdown&&setTimeout(()=>{this.uppy.info(this.i18n(\"smile\"),\"success\",1500)},1e3)}changeVideoSource(e){this.stop(),this.start({deviceId:e})}updateVideoSources(){this.mediaDevices.enumerateDevices().then(e=>{this.setPluginState({videoSources:e.filter(t=>t.kind===\"videoinput\")})})}render(){this.webcamActive||this.start();let e=this.getPluginState();return!e.cameraReady||!e.hasCamera?u(hv,{icon:zu,i18n:this.i18n,hasCamera:e.hasCamera}):u(uv,wc({},e,{onChangeVideoSource:this.changeVideoSource,onSnapshot:this.takeSnapshot,onStartRecording:this.startRecording,onStopRecording:this.stopRecording,onDiscardRecordedVideo:this.discardRecordedVideo,onSubmit:this.submit,onFocus:this.focus,onStop:this.stop,i18n:this.i18n,modes:this.opts.modes,showRecordingLength:this.opts.showRecordingLength,showVideoSourceDropdown:this.opts.showVideoSourceDropdown,supportsRecording:fc(),recording:e.isRecording,mirror:_a(this,Ai)[Ai],src:this.stream}))}install(){let{mobileNativeCamera:e,modes:t,facingMode:r,videoConstraints:s}=this.opts,{target:o}=this.opts;if(e&&o){var a;(a=this.getTargetPlugin(o))==null||a.setOptions({showNativeVideoCameraButton:bc(t,\"video-only\")||bc(t,\"video-audio\"),showNativePhotoCameraButton:bc(t,\"picture\"),nativeCameraFacingMode:s?.facingMode||r});return}this.setPluginState({cameraReady:!1,recordingLengthSeconds:0}),o&&this.mount(o,this),this.mediaDevices&&(this.updateVideoSources(),this.mediaDevices.ondevicechange=()=>{if(this.updateVideoSources(),this.stream){let l=!0,{videoSources:h,currentDeviceId:p}=this.getPluginState();h.forEach(d=>{p===d.deviceId&&(l=!1)}),l&&(this.stop(),this.start())}})}uninstall(){this.stop(),this.unmount()}onUnmount(){this.stop()}};n(ls,\"Webcam\");ls.VERSION=OP.version;function Dr(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(Dr,\"_classPrivateFieldLooseBase\");var RP=0;function fv(i){return\"__private_\"+RP+++\"_\"+i}n(fv,\"_classPrivateFieldLooseKey\");var Dt=fv(\"uppy\"),xa=fv(\"events\"),mi=class{constructor(e){Object.defineProperty(this,Dt,{writable:!0,value:void 0}),Object.defineProperty(this,xa,{writable:!0,value:[]}),Dr(this,Dt)[Dt]=e}on(e,t){return Dr(this,xa)[xa].push([e,t]),Dr(this,Dt)[Dt].on(e,t)}remove(){for(let[e,t]of Dr(this,xa)[xa].splice(0))Dr(this,Dt)[Dt].off(e,t)}onFilePause(e,t){this.on(\"upload-pause\",(r,s)=>{e===r&&t(s)})}onFileRemove(e,t){this.on(\"file-removed\",r=>{e===r.id&&t(r.id)})}onPause(e,t){this.on(\"upload-pause\",(r,s)=>{e===r&&t(s)})}onRetry(e,t){this.on(\"upload-retry\",r=>{e===r&&t()})}onRetryAll(e,t){this.on(\"retry-all\",()=>{Dr(this,Dt)[Dt].getFile(e)&&t()})}onPauseAll(e,t){this.on(\"pause-all\",()=>{Dr(this,Dt)[Dt].getFile(e)&&t()})}onCancelAll(e,t){var r=this;this.on(\"cancel-all\",function(){Dr(r,Dt)[Dt].getFile(e)&&t(...arguments)})}onResumeAll(e,t){this.on(\"resume-all\",()=>{Dr(this,Dt)[Dt].getFile(e)&&t()})}};n(mi,\"EventManager\");function Y(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(Y,\"_classPrivateFieldLooseBase\");var UP=0;function qt(i){return\"__private_\"+UP+++\"_\"+i}n(qt,\"_classPrivateFieldLooseKey\");function kP(i){return new Error(\"Cancelled\",{cause:i})}n(kP,\"createCancelError\");function mv(i){if(i!=null){var e;let t=n(()=>this.abort(i.reason),\"abortPromise\");i.addEventListener(\"abort\",t,{once:!0});let r=n(()=>{i.removeEventListener(\"abort\",t)},\"removeAbortListener\");(e=this.then)==null||e.call(this,r,r)}return this}n(mv,\"abortOn\");var ii=qt(\"activeRequests\"),Nt=qt(\"queuedHandlers\"),ti=qt(\"paused\"),js=qt(\"pauseTimer\"),It=qt(\"downLimit\"),Hs=qt(\"upperLimit\"),Ir=qt(\"rateLimitingTimer\"),Fa=qt(\"call\"),Nr=qt(\"queueNext\"),_c=qt(\"next\"),Sc=qt(\"queue\"),xc=qt(\"dequeue\"),Pc=qt(\"resume\"),$s=qt(\"increaseLimit\"),Mt=class{constructor(e){Object.defineProperty(this,xc,{value:LP}),Object.defineProperty(this,Sc,{value:MP}),Object.defineProperty(this,_c,{value:NP}),Object.defineProperty(this,Nr,{value:IP}),Object.defineProperty(this,Fa,{value:DP}),Object.defineProperty(this,ii,{writable:!0,value:0}),Object.defineProperty(this,Nt,{writable:!0,value:[]}),Object.defineProperty(this,ti,{writable:!0,value:!1}),Object.defineProperty(this,js,{writable:!0,value:void 0}),Object.defineProperty(this,It,{writable:!0,value:1}),Object.defineProperty(this,Hs,{writable:!0,value:void 0}),Object.defineProperty(this,Ir,{writable:!0,value:void 0}),Object.defineProperty(this,Pc,{writable:!0,value:()=>this.resume()}),Object.defineProperty(this,$s,{writable:!0,value:()=>{if(Y(this,ti)[ti]){Y(this,Ir)[Ir]=setTimeout(Y(this,$s)[$s],0);return}Y(this,It)[It]=this.limit,this.limit=Math.ceil((Y(this,Hs)[Hs]+Y(this,It)[It])/2);for(let t=Y(this,It)[It];t<=this.limit;t++)Y(this,Nr)[Nr]();Y(this,Hs)[Hs]-Y(this,It)[It]>3?Y(this,Ir)[Ir]=setTimeout(Y(this,$s)[$s],2e3):Y(this,It)[It]=Math.floor(Y(this,It)[It]/2)}}),typeof e!=\"number\"||e===0?this.limit=1/0:this.limit=e}run(e,t){return!Y(this,ti)[ti]&&Y(this,ii)[ii]<this.limit?Y(this,Fa)[Fa](e):Y(this,Sc)[Sc](e,t)}wrapSyncFunction(e,t){var r=this;return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];let l=r.run(()=>(e(...o),queueMicrotask(()=>l.done()),()=>{}),t);return{abortOn:mv,abort(){l.abort()}}}}wrapPromiseFunction(e,t){var r=this;return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];let l,h=new Promise((p,d)=>{l=r.run(()=>{let f,y;try{y=Promise.resolve(e(...o))}catch(b){y=Promise.reject(b)}return y.then(b=>{f?d(f):(l.done(),p(b))},b=>{f?d(f):(l.done(),d(b))}),b=>{f=kP(b)}},t)});return h.abort=p=>{l.abort(p)},h.abortOn=mv,h}}resume(){Y(this,ti)[ti]=!1,clearTimeout(Y(this,js)[js]);for(let e=0;e<this.limit;e++)Y(this,Nr)[Nr]()}pause(e){e===void 0&&(e=null),Y(this,ti)[ti]=!0,clearTimeout(Y(this,js)[js]),e!=null&&(Y(this,js)[js]=setTimeout(Y(this,Pc)[Pc],e))}rateLimit(e){clearTimeout(Y(this,Ir)[Ir]),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(Y(this,Hs)[Hs]=this.limit-1,this.limit=Y(this,It)[It],Y(this,Ir)[Ir]=setTimeout(Y(this,$s)[$s],e))}get isPaused(){return Y(this,ti)[ti]}};n(Mt,\"RateLimitedQueue\");function DP(i){Y(this,ii)[ii]+=1;let e=!1,t;try{t=i()}catch(r){throw Y(this,ii)[ii]-=1,r}return{abort:r=>{e||(e=!0,Y(this,ii)[ii]-=1,t?.(r),Y(this,Nr)[Nr]())},done:()=>{e||(e=!0,Y(this,ii)[ii]-=1,Y(this,Nr)[Nr]())}}}n(DP,\"_call2\");function IP(){queueMicrotask(()=>Y(this,_c)[_c]())}n(IP,\"_queueNext2\");function NP(){if(Y(this,ti)[ti]||Y(this,ii)[ii]>=this.limit||Y(this,Nt)[Nt].length===0)return;let i=Y(this,Nt)[Nt].shift(),e=Y(this,Fa)[Fa](i.fn);i.abort=e.abort,i.done=e.done}n(NP,\"_next2\");function MP(i,e){e===void 0&&(e={});let t={fn:i,priority:e.priority||0,abort:()=>{Y(this,xc)[xc](t)},done:()=>{throw new Error(\"Cannot mark a queued request as done: this indicates a bug\")}},r=Y(this,Nt)[Nt].findIndex(s=>t.priority>s.priority);return r===-1?Y(this,Nt)[Nt].push(t):Y(this,Nt)[Nt].splice(r,0,t),t}n(MP,\"_queue2\");function LP(i){let e=Y(this,Nt)[Nt].indexOf(i);e!==-1&&Y(this,Nt)[Nt].splice(e,1)}n(LP,\"_dequeue2\");var us=Symbol(\"__queue\");function hs(i){let e=n(t=>\"error\"in t&&!!t.error,\"hasError\");return i.filter(t=>!e(t))}n(hs,\"filterNonFailedFiles\");function ds(i){return i.filter(e=>{var t;return!((t=e.progress)!=null&&t.uploadStarted)||!e.isRestored})}n(ds,\"filterFilesToEmitUploadStarted\");var{AbortController:$u}=globalThis,{AbortSignal:w7}=globalThis,Fc=n(function(i,e){i===void 0&&(i=\"Aborted\");let t=new DOMException(i,\"AbortError\");return e!=null&&Ct(e,\"cause\")&&Object.defineProperty(t,\"cause\",{__proto__:null,configurable:!0,writable:!0,value:e.cause}),t},\"createAbortError\");function $(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n($,\"_classPrivateFieldLooseBase\");var BP=0;function st(i){return\"__private_\"+BP+++\"_\"+i}n(st,\"_classPrivateFieldLooseKey\");var zP=1024*1024,gv={getChunkSize(i){return Math.ceil(i.size/1e4)},onProgress(){},onPartComplete(){},onSuccess(){},onError(i){throw i}};function jP(i){if(typeof i==\"string\")return parseInt(i,10);if(typeof i==\"number\")return i;throw new TypeError(\"Expected a number\")}n(jP,\"ensureInt\");var Ra=Symbol(\"pausing upload, not an actual error\"),ft=st(\"abortController\"),rt=st(\"chunks\"),Lt=st(\"chunkState\"),ri=st(\"data\"),si=st(\"file\"),Ua=st(\"uploadHasStarted\"),Ea=st(\"onError\"),Ws=st(\"onSuccess\"),Mr=st(\"shouldUseMultipart\"),Vs=st(\"isRestoring\"),ka=st(\"onReject\"),qs=st(\"maxMultipartParts\"),Ca=st(\"minPartSize\"),Ec=st(\"initChunks\"),Oc=st(\"createUpload\"),Oa=st(\"resumeUpload\"),Ta=st(\"onPartProgress\"),Aa=st(\"onPartComplete\"),Cc=st(\"abortUpload\"),qu=class{constructor(e,t){var r,s;Object.defineProperty(this,Cc,{value:VP}),Object.defineProperty(this,Oa,{value:qP}),Object.defineProperty(this,Oc,{value:$P}),Object.defineProperty(this,Ec,{value:HP}),Object.defineProperty(this,ft,{writable:!0,value:new $u}),Object.defineProperty(this,rt,{writable:!0,value:void 0}),Object.defineProperty(this,Lt,{writable:!0,value:void 0}),Object.defineProperty(this,ri,{writable:!0,value:void 0}),Object.defineProperty(this,si,{writable:!0,value:void 0}),Object.defineProperty(this,Ua,{writable:!0,value:!1}),Object.defineProperty(this,Ea,{writable:!0,value:void 0}),Object.defineProperty(this,Ws,{writable:!0,value:void 0}),Object.defineProperty(this,Mr,{writable:!0,value:void 0}),Object.defineProperty(this,Vs,{writable:!0,value:void 0}),Object.defineProperty(this,ka,{writable:!0,value:o=>o?.cause===Ra?null:$(this,Ea)[Ea](o)}),Object.defineProperty(this,qs,{writable:!0,value:1e4}),Object.defineProperty(this,Ca,{writable:!0,value:5*zP}),Object.defineProperty(this,Ta,{writable:!0,value:o=>a=>{if(!a.lengthComputable)return;$(this,Lt)[Lt][o].uploaded=jP(a.loaded);let l=$(this,Lt)[Lt].reduce((h,p)=>h+p.uploaded,0);this.options.onProgress(l,$(this,ri)[ri].size)}}),Object.defineProperty(this,Aa,{writable:!0,value:o=>a=>{$(this,rt)[rt][o]=null,$(this,Lt)[Lt][o].etag=a,$(this,Lt)[Lt][o].done=!0;let l={PartNumber:o+1,ETag:a};this.options.onPartComplete(l)}}),this.options={...gv,...t},(s=(r=this.options).getChunkSize)!=null||(r.getChunkSize=gv.getChunkSize),$(this,ri)[ri]=e,$(this,si)[si]=t.file,$(this,Ws)[Ws]=this.options.onSuccess,$(this,Ea)[Ea]=this.options.onError,$(this,Mr)[Mr]=this.options.shouldUseMultipart,$(this,Vs)[Vs]=t.uploadId&&t.key,$(this,Ec)[Ec]()}start(){$(this,Ua)[Ua]?($(this,ft)[ft].signal.aborted||$(this,ft)[ft].abort(Ra),$(this,ft)[ft]=new $u,$(this,Oa)[Oa]()):$(this,Vs)[Vs]?(this.options.companionComm.restoreUploadFile($(this,si)[si],{uploadId:this.options.uploadId,key:this.options.key}),$(this,Oa)[Oa]()):$(this,Oc)[Oc]()}pause(){$(this,ft)[ft].abort(Ra),$(this,ft)[ft]=new $u}abort(e){var t;e===void 0&&(e=void 0),(t=e)!=null&&t.really?$(this,Cc)[Cc]():this.pause()}get chunkState(){return $(this,Lt)[Lt]}};n(qu,\"MultipartUploader\");function HP(){let i=$(this,ri)[ri].size,e=typeof $(this,Mr)[Mr]==\"function\"?$(this,Mr)[Mr]($(this,si)[si]):!!$(this,Mr)[Mr];if(e&&i>$(this,Ca)[Ca]){let t=Math.max(this.options.getChunkSize($(this,ri)[ri]),$(this,Ca)[Ca]),r=Math.floor(i/t);r>$(this,qs)[qs]&&(r=$(this,qs)[qs],t=i/$(this,qs)[qs]),$(this,rt)[rt]=Array(r);for(let s=0,o=0;s<i;s+=t,o++){let a=Math.min(i,s+t),l=n(()=>{let h=s;return $(this,ri)[ri].slice(h,a)},\"getData\");if($(this,rt)[rt][o]={getData:l,onProgress:$(this,Ta)[Ta](o),onComplete:$(this,Aa)[Aa](o),shouldUseMultipart:e},$(this,Vs)[Vs]){let h=s+t>i?i-s:t;$(this,rt)[rt][o].setAsUploaded=()=>{$(this,rt)[rt][o]=null,$(this,Lt)[Lt][o].uploaded=h}}}}else $(this,rt)[rt]=[{getData:()=>$(this,ri)[ri],onProgress:$(this,Ta)[Ta](0),onComplete:$(this,Aa)[Aa](0),shouldUseMultipart:e}];$(this,Lt)[Lt]=$(this,rt)[rt].map(()=>({uploaded:0}))}n(HP,\"_initChunks2\");function $P(){this.options.companionComm.uploadFile($(this,si)[si],$(this,rt)[rt],$(this,ft)[ft].signal).then($(this,Ws)[Ws],$(this,ka)[ka]),$(this,Ua)[Ua]=!0}n($P,\"_createUpload2\");function qP(){this.options.companionComm.resumeUploadFile($(this,si)[si],$(this,rt)[rt],$(this,ft)[ft].signal).then($(this,Ws)[Ws],$(this,ka)[ka])}n(qP,\"_resumeUpload2\");function VP(){$(this,ft)[ft].abort(),this.options.companionComm.abortFileUpload($(this,si)[si]).catch(i=>this.options.log(i))}n(VP,\"_abortUpload2\");var yv=qu;function WP(i){let{method:e=\"PUT\",CanonicalUri:t=\"/\",CanonicalQueryString:r=\"\",SignedHeaders:s,HashedPayload:o}=i,a=Object.keys(s).map(l=>l.toLowerCase()).sort();return[e,t,r,...a.map(l=>`${l}:${s[l]}`),\"\",a.join(\";\"),o].join(`\n`)}n(WP,\"createCanonicalRequest\");var Tc=new TextEncoder,Ac={name:\"HMAC\",hash:\"SHA-256\"};async function GP(i){let{subtle:e}=globalThis.crypto;return e.digest(Ac.hash,Tc.encode(i))}n(GP,\"digest\");async function KP(i){let{subtle:e}=globalThis.crypto;return e.importKey(\"raw\",typeof i==\"string\"?Tc.encode(i):i,Ac,!1,[\"sign\"])}n(KP,\"generateHmacKey\");function vv(i){let e=new Uint8Array(i),t=\"\";for(let r=0;r<e.length;r++)t+=e[r].toString(16).padStart(2,\"0\");return t}n(vv,\"arrayBufferToHexString\");async function Da(i,e){let{subtle:t}=globalThis.crypto;return t.sign(Ac,await KP(i),Tc.encode(e))}n(Da,\"hash\");async function Rc(i){let{accountKey:e,accountSecret:t,sessionToken:r,bucketName:s,Key:o,Region:a,expires:l,uploadId:h,partNumber:p}=i,d=\"s3\",f=`${s}.${d}.${a}.amazonaws.com`,y=`/${encodeURI(o)}`,b=\"UNSIGNED-PAYLOAD\",S=new Date().toISOString().replace(/[-:]|\\.\\d+/g,\"\"),E=S.slice(0,8),x=`${E}/${a}/${d}/aws4_request`,F=new URL(`https://${f}${y}`);F.searchParams.set(\"X-Amz-Algorithm\",\"AWS4-HMAC-SHA256\"),F.searchParams.set(\"X-Amz-Content-Sha256\",b),F.searchParams.set(\"X-Amz-Credential\",`${e}/${x}`),F.searchParams.set(\"X-Amz-Date\",S),F.searchParams.set(\"X-Amz-Expires\",l),F.searchParams.set(\"X-Amz-Security-Token\",r),F.searchParams.set(\"X-Amz-SignedHeaders\",\"host\"),p&&F.searchParams.set(\"partNumber\",p),h&&F.searchParams.set(\"uploadId\",h),F.searchParams.set(\"x-id\",p&&h?\"UploadPart\":\"PutObject\");let U=WP({CanonicalUri:y,CanonicalQueryString:F.search.slice(1),SignedHeaders:{host:f},HashedPayload:b}),j=vv(await GP(U)),G=[\"AWS4-HMAC-SHA256\",S,x,j].join(`\n`),J=await Da(`AWS4${t}`,E),B=await Da(J,a),z=await Da(B,d),K=await Da(z,\"aws4_request\"),oe=vv(await Da(K,G));return F.searchParams.set(\"X-Amz-Signature\",oe),F}n(Rc,\"createSignedURL\");var wv;function N(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(N,\"_classPrivateFieldLooseBase\");var XP=0;function Pe(i){return\"__private_\"+XP+++\"_\"+i}n(Pe,\"_classPrivateFieldLooseKey\");var YP={version:\"3.9.0\"};function Go(i){if(i&&i.error){let e=new Error(i.message);throw Object.assign(e,i.error),e}return i}n(Go,\"assertServerError\");function QP(i){let e=new URL(i);return e.search=\"\",e.hash=\"\",e.href}n(QP,\"removeMetadataFromURL\");function Sv(i){let e=i.Expiration;if(e){let t=Math.floor((new Date(e)-Date.now())/1e3);if(t>9)return t}}n(Sv,\"getExpiry\");function bv(i){let{meta:e,allowedMetaFields:t,querify:r=!1}=i,s=t??Object.keys(e);return e?Object.fromEntries(s.filter(o=>e[o]!=null).map(o=>{let a=r?`metadata[${o}]`:o,l=String(e[o]);return[a,l]})):{}}n(bv,\"getAllowedMetadata\");function xt(i){if(i!=null&&i.aborted)throw Fc(\"The operation was aborted\",{cause:i.reason})}n(xt,\"throwIfAborted\");var Ia=Pe(\"abortMultipartUpload\"),mt=Pe(\"cache\"),Na=Pe(\"createMultipartUpload\"),Ma=Pe(\"fetchSignature\"),Ha=Pe(\"getUploadParameters\"),La=Pe(\"listParts\"),Qs=Pe(\"previousRetryDelay\"),Js=Pe(\"requests\"),Gs=Pe(\"retryDelays\"),Ks=Pe(\"sendCompletionRequest\"),Xs=Pe(\"setS3MultipartState\"),Zs=Pe(\"uploadPartBytes\"),yt=Pe(\"getFile\"),Uc=Pe(\"shouldRetry\"),Ba=Pe(\"nonMultipartUpload\"),Vu=class{constructor(e,t,r,s){Object.defineProperty(this,Ba,{value:ZP}),Object.defineProperty(this,Uc,{value:JP}),Object.defineProperty(this,Ia,{writable:!0,value:void 0}),Object.defineProperty(this,mt,{writable:!0,value:new WeakMap}),Object.defineProperty(this,Na,{writable:!0,value:void 0}),Object.defineProperty(this,Ma,{writable:!0,value:void 0}),Object.defineProperty(this,Ha,{writable:!0,value:void 0}),Object.defineProperty(this,La,{writable:!0,value:void 0}),Object.defineProperty(this,Qs,{writable:!0,value:void 0}),Object.defineProperty(this,Js,{writable:!0,value:void 0}),Object.defineProperty(this,Gs,{writable:!0,value:void 0}),Object.defineProperty(this,Ks,{writable:!0,value:void 0}),Object.defineProperty(this,Xs,{writable:!0,value:void 0}),Object.defineProperty(this,Zs,{writable:!0,value:void 0}),Object.defineProperty(this,yt,{writable:!0,value:void 0}),N(this,Js)[Js]=e,N(this,Xs)[Xs]=r,N(this,yt)[yt]=s,this.setOptions(t)}setOptions(e){let t=N(this,Js)[Js];if(\"abortMultipartUpload\"in e&&(N(this,Ia)[Ia]=t.wrapPromiseFunction(e.abortMultipartUpload,{priority:1})),\"createMultipartUpload\"in e&&(N(this,Na)[Na]=t.wrapPromiseFunction(e.createMultipartUpload,{priority:-1})),\"signPart\"in e&&(N(this,Ma)[Ma]=t.wrapPromiseFunction(e.signPart)),\"listParts\"in e&&(N(this,La)[La]=t.wrapPromiseFunction(e.listParts)),\"completeMultipartUpload\"in e&&(N(this,Ks)[Ks]=t.wrapPromiseFunction(e.completeMultipartUpload,{priority:1})),\"retryDelays\"in e){var r;N(this,Gs)[Gs]=(r=e.retryDelays)!=null?r:[]}\"uploadPartBytes\"in e&&(N(this,Zs)[Zs]=t.wrapPromiseFunction(e.uploadPartBytes,{priority:1/0})),\"getUploadParameters\"in e&&(N(this,Ha)[Ha]=t.wrapPromiseFunction(e.getUploadParameters))}async getUploadId(e,t){let r;for(;(r=N(this,mt)[mt].get(e.data))!=null;)try{return await r}catch{}let s=N(this,Na)[Na](N(this,yt)[yt](e),t),o=n(()=>{s.abort(t.reason),N(this,mt)[mt].delete(e.data)},\"abortPromise\");return t.addEventListener(\"abort\",o,{once:!0}),N(this,mt)[mt].set(e.data,s),s.then(async a=>{t.removeEventListener(\"abort\",o),N(this,Xs)[Xs](e,a),N(this,mt)[mt].set(e.data,a)},()=>{t.removeEventListener(\"abort\",o),N(this,mt)[mt].delete(e.data)}),s}async abortFileUpload(e){let t=N(this,mt)[mt].get(e.data);if(t==null)return;N(this,mt)[mt].delete(e.data),N(this,Xs)[Xs](e,Object.create(null));let r;try{r=await t}catch{return}await N(this,Ia)[Ia](N(this,yt)[yt](e),r)}async uploadFile(e,t,r){if(xt(r),t.length===1&&!t[0].shouldUseMultipart)return N(this,Ba)[Ba](e,t[0],r);let{uploadId:s,key:o}=await this.getUploadId(e,r);xt(r);try{let a=await Promise.all(t.map((l,h)=>this.uploadChunk(e,h+1,l,r)));return xt(r),await N(this,Ks)[Ks](N(this,yt)[yt](e),{key:o,uploadId:s,parts:a,signal:r},r).abortOn(r)}catch(a){throw a?.cause!==Ra&&a?.name!==\"AbortError\"&&this.abortFileUpload(e),a}}restoreUploadFile(e,t){N(this,mt)[mt].set(e.data,t)}async resumeUploadFile(e,t,r){if(xt(r),t.length===1&&t[0]!=null&&!t[0].shouldUseMultipart)return N(this,Ba)[Ba](e,t[0],r);let{uploadId:s,key:o}=await this.getUploadId(e,r);xt(r);let a=await N(this,La)[La](N(this,yt)[yt](e),{uploadId:s,key:o,signal:r},r).abortOn(r);xt(r);let l=await Promise.all(t.map((h,p)=>{let d=p+1,f=a.find(y=>{let{PartNumber:b}=y;return b===d});return f==null?this.uploadChunk(e,d,h,r):(h==null||h.setAsUploaded==null||h.setAsUploaded(),{PartNumber:d,ETag:f.ETag})}));return xt(r),N(this,Ks)[Ks](N(this,yt)[yt](e),{key:o,uploadId:s,parts:l,signal:r},r).abortOn(r)}async uploadChunk(e,t,r,s){xt(s);let{uploadId:o,key:a}=await this.getUploadId(e,s),l=N(this,Gs)[Gs].values(),h=N(this,Gs)[Gs].values(),p=n(()=>{let d=l.next();return d==null||d.done?null:d.value},\"shouldRetrySignature\");for(;;){xt(s);let d=r.getData(),{onProgress:f,onComplete:y}=r,b;try{b=await N(this,Ma)[Ma](N(this,yt)[yt](e),{uploadId:o,key:a,partNumber:t,body:d,signal:s}).abortOn(s)}catch(S){let E=p();if(E==null||s.aborted)throw S;await new Promise(x=>setTimeout(x,E));continue}xt(s);try{return{PartNumber:t,...await N(this,Zs)[Zs]({signature:b,body:d,size:d.size,onProgress:f,onComplete:y,signal:s}).abortOn(s)}}catch(S){if(!await N(this,Uc)[Uc](S,h))throw S}}}};n(Vu,\"HTTPCommunicationQueue\");async function JP(i,e){var t;let r=N(this,Js)[Js],s=i==null||(t=i.source)==null?void 0:t.status;if(s==null)return!1;if(s===403&&i.message===\"Request has expired\"){if(!r.isPaused){if(r.limit===1||N(this,Qs)[Qs]==null){let o=e.next();if(o==null||o.done)return!1;N(this,Qs)[Qs]=o.value}r.rateLimit(0),await new Promise(o=>setTimeout(o,N(this,Qs)[Qs]))}}else if(s===429){if(!r.isPaused){let o=e.next();if(o==null||o.done)return!1;r.rateLimit(o.value)}}else{if(s>400&&s<500&&s!==409)return!1;if(typeof navigator<\"u\"&&navigator.onLine===!1)r.isPaused||(r.pause(),window.addEventListener(\"online\",()=>{r.resume()},{once:!0}));else{let o=e.next();if(o==null||o.done)return!1;await new Promise(a=>setTimeout(a,o.value))}}return!0}n(JP,\"_shouldRetry2\");async function ZP(i,e,t){let{method:r=\"POST\",url:s,fields:o,headers:a}=await N(this,Ha)[Ha](N(this,yt)[yt](i),{signal:t}).abortOn(t),l,h=e.getData();if(r.toUpperCase()===\"POST\"){let y=new FormData;Object.entries(o).forEach(b=>{let[S,E]=b;return y.set(S,E)}),y.set(\"file\",h),l=y}else l=h;let{onProgress:p,onComplete:d}=e,f=await N(this,Zs)[Zs]({signature:{url:s,headers:a,method:r},body:l,size:h.size,onProgress:p,onComplete:d,signal:t}).abortOn(t);return\"location\"in f?f:{location:QP(s),...f}}n(ZP,\"_nonMultipartUpload2\");var eo=Pe(\"companionCommunicationQueue\"),$e=Pe(\"client\"),gt=Pe(\"cachedTemporaryCredentials\"),kc=Pe(\"getTemporarySecurityCredentials\"),Dc=Pe(\"setS3MultipartState\"),to=Pe(\"getFile\"),Ic=Pe(\"uploadLocalFile\"),Nc=Pe(\"getCompanionClientArgs\"),za=Pe(\"upload\"),Ys=Pe(\"setCompanionHeaders\"),Lr=Pe(\"setResumableUploadsCapability\"),ja=Pe(\"resetResumableCapability\");wv=Symbol.for(\"uppy test: getClient\");var Ri=class extends ve{constructor(e,t){var r;super(e,t),Object.defineProperty(this,Nc,{value:i_}),Object.defineProperty(this,Ic,{value:t_}),Object.defineProperty(this,kc,{value:e_}),Object.defineProperty(this,eo,{writable:!0,value:void 0}),Object.defineProperty(this,$e,{writable:!0,value:void 0}),Object.defineProperty(this,gt,{writable:!0,value:void 0}),Object.defineProperty(this,Dc,{writable:!0,value:(o,a)=>{let{key:l,uploadId:h}=a,p=this.uppy.getFile(o.id);p!=null&&this.uppy.setFileState(o.id,{s3Multipart:{...p.s3Multipart,key:l,uploadId:h}})}}),Object.defineProperty(this,to,{writable:!0,value:o=>this.uppy.getFile(o.id)||o}),Object.defineProperty(this,za,{writable:!0,value:async o=>{if(o.length===0)return;let a=this.uppy.getFilesByIds(o),l=hs(a),h=ds(l);this.uppy.emit(\"upload-start\",h);let p=l.map(f=>{if(f.isRemote){let y=n(()=>this.requests,\"getQueue\");N(this,Lr)[Lr](!1);let b=new AbortController,S=n(x=>{x.id===f.id&&b.abort()},\"removedHandler\");this.uppy.on(\"file-removed\",S);let E=f.remote.requestClient.uploadRemoteFile(f,N(this,Nc)[Nc](f),{signal:b.signal,getQueue:y});return this.requests.wrapSyncFunction(()=>{this.uppy.off(\"file-removed\",S)},{priority:-1})(),E}return N(this,Ic)[Ic](f)}),d=await Promise.all(p);return N(this,Lr)[Lr](!0),d}}),Object.defineProperty(this,Ys,{writable:!0,value:()=>{N(this,$e)[$e].setCompanionHeaders(this.opts.companionHeaders)}}),Object.defineProperty(this,Lr,{writable:!0,value:o=>{let{capabilities:a}=this.uppy.getState();this.uppy.setState({capabilities:{...a,resumableUploads:o}})}}),Object.defineProperty(this,ja,{writable:!0,value:()=>{N(this,Lr)[Lr](!0)}}),this.type=\"uploader\",this.id=this.opts.id||\"AwsS3Multipart\",this.title=\"AWS S3 Multipart\",N(this,$e)[$e]=new tt(e,t);let s={allowedMetaFields:null,limit:6,shouldUseMultipart:o=>o.size!==0,retryDelays:[0,1e3,3e3,5e3],createMultipartUpload:this.createMultipartUpload.bind(this),listParts:this.listParts.bind(this),abortMultipartUpload:this.abortMultipartUpload.bind(this),completeMultipartUpload:this.completeMultipartUpload.bind(this),getTemporarySecurityCredentials:!1,signPart:t!=null&&t.getTemporarySecurityCredentials?this.createSignedURL.bind(this):this.signPart.bind(this),uploadPartBytes:Ri.uploadPartBytes,getUploadParameters:t!=null&&t.getTemporarySecurityCredentials?this.createSignedURL.bind(this):this.getUploadParameters.bind(this),companionHeaders:{}};this.opts={...s,...t},t?.prepareUploadParts!=null&&t.signPart==null&&(this.opts.signPart=async(o,a)=>{let{uploadId:l,key:h,partNumber:p,body:d,signal:f}=a,{presignedUrls:y,headers:b}=await t.prepareUploadParts(o,{uploadId:l,key:h,parts:[{number:p,chunk:d}],signal:f});return{url:y?.[p],headers:b?.[p]}}),this.requests=(r=this.opts.rateLimitedQueue)!=null?r:new Mt(this.opts.limit),N(this,eo)[eo]=new Vu(this.requests,this.opts,N(this,Dc)[Dc],N(this,to)[to]),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null),this.uploaderSockets=Object.create(null)}[wv](){return N(this,$e)[$e]}setOptions(e){N(this,eo)[eo].setOptions(e),super.setOptions(e),N(this,Ys)[Ys]()}resetUploaderReferences(e,t){t===void 0&&(t={}),this.uploaders[e]&&(this.uploaders[e].abort({really:t.abort||!1}),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null),this.uploaderSockets[e]&&(this.uploaderSockets[e].close(),this.uploaderSockets[e]=null)}assertHost(e){if(!this.opts.companionUrl)throw new Error(`Expected a \\`companionUrl\\` option containing a Companion address, or if you are not using Companion, a custom \\`${e}\\` implementation.`)}createMultipartUpload(e,t){this.assertHost(\"createMultipartUpload\"),xt(t);let r=bv({meta:e.meta,allowedMetaFields:this.opts.allowedMetaFields});return N(this,$e)[$e].post(\"s3/multipart\",{filename:e.name,type:e.type,metadata:r},{signal:t}).then(Go)}listParts(e,t,r){let{key:s,uploadId:o}=t;this.assertHost(\"listParts\"),xt(r);let a=encodeURIComponent(s);return N(this,$e)[$e].get(`s3/multipart/${o}?key=${a}`,{signal:r}).then(Go)}completeMultipartUpload(e,t,r){let{key:s,uploadId:o,parts:a}=t;this.assertHost(\"completeMultipartUpload\"),xt(r);let l=encodeURIComponent(s),h=encodeURIComponent(o);return N(this,$e)[$e].post(`s3/multipart/${h}/complete?key=${l}`,{parts:a},{signal:r}).then(Go)}async createSignedURL(e,t){let r=await N(this,kc)[kc](t),s=Sv(r.credentials)||604800,{uploadId:o,key:a,partNumber:l,signal:h}=t;return{method:\"PUT\",expires:s,fields:{},url:`${await Rc({accountKey:r.credentials.AccessKeyId,accountSecret:r.credentials.SecretAccessKey,sessionToken:r.credentials.SessionToken,expires:s,bucketName:r.bucket,Region:r.region,Key:a??`${crypto.randomUUID()}-${e.name}`,uploadId:o,partNumber:l,signal:h})}`,headers:{\"Content-Type\":e.type}}}signPart(e,t){let{uploadId:r,key:s,partNumber:o,signal:a}=t;if(this.assertHost(\"signPart\"),xt(a),r==null||s==null||o==null)throw new Error(\"Cannot sign without a key, an uploadId, and a partNumber\");let l=encodeURIComponent(s);return N(this,$e)[$e].get(`s3/multipart/${r}/${o}?key=${l}`,{signal:a}).then(Go)}abortMultipartUpload(e,t,r){let{key:s,uploadId:o}=t;this.assertHost(\"abortMultipartUpload\");let a=encodeURIComponent(s),l=encodeURIComponent(o);return N(this,$e)[$e].delete(`s3/multipart/${l}?key=${a}`,void 0,{signal:r}).then(Go)}getUploadParameters(e,t){let{meta:r}=e,{type:s,name:o}=r,a=bv({meta:r,allowedMetaFields:this.opts.allowedMetaFields,querify:!0}),l=new URLSearchParams({filename:o,type:s,...a});return N(this,$e)[$e].get(`s3/params?${l}`,t)}static async uploadPartBytes(e){let{signature:{url:t,expires:r,headers:s,method:o=\"PUT\"},body:a,size:l=a.size,onProgress:h,onComplete:p,signal:d}=e;if(xt(d),t==null)throw new Error(\"Cannot upload to an undefined URL\");return new Promise((f,y)=>{let b=new XMLHttpRequest;b.open(o,t,!0),s&&Object.keys(s).forEach(x=>{b.setRequestHeader(x,s[x])}),b.responseType=\"text\",typeof r==\"number\"&&(b.timeout=r*1e3);function S(){b.abort()}n(S,\"onabort\");function E(){d.removeEventListener(\"abort\",S)}n(E,\"cleanup\"),d.addEventListener(\"abort\",S),b.upload.addEventListener(\"progress\",x=>{h(x)}),b.addEventListener(\"abort\",()=>{E(),y(Fc())}),b.addEventListener(\"timeout\",()=>{E();let x=new Error(\"Request has expired\");x.source={status:403},y(x)}),b.addEventListener(\"load\",x=>{if(E(),x.target.status===403&&x.target.responseText.includes(\"<Message>Request has expired</Message>\")){let j=new Error(\"Request has expired\");j.source=x.target,y(j);return}if(x.target.status<200||x.target.status>=300){let j=new Error(\"Non 2xx\");j.source=x.target,y(j);return}h?.({loaded:l,lengthComputable:!0});let F=x.target.getResponseHeader(\"ETag\"),U=x.target.getResponseHeader(\"Location\");if(o.toUpperCase()===\"POST\"&&U===null&&console.warn(\"AwsS3/Multipart: Could not read the Location header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions.\"),F===null){y(new Error(\"AwsS3/Multipart: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions.\"));return}p?.(F),f({ETag:F,...U?{location:U}:void 0})}),b.addEventListener(\"error\",x=>{E();let F=new Error(\"Unknown error\");F.source=x.target,y(F)}),b.send(a)})}install(){N(this,Lr)[Lr](!0),this.uppy.addPreProcessor(N(this,Ys)[Ys]),this.uppy.addUploader(N(this,za)[za]),this.uppy.on(\"cancel-all\",N(this,ja)[ja])}uninstall(){this.uppy.removePreProcessor(N(this,Ys)[Ys]),this.uppy.removeUploader(N(this,za)[za]),this.uppy.off(\"cancel-all\",N(this,ja)[ja])}};n(Ri,\"AwsS3Multipart\");async function e_(i){return xt(i?.signal),N(this,gt)[gt]==null&&(this.opts.getTemporarySecurityCredentials===!0?(this.assertHost(\"getTemporarySecurityCredentials\"),N(this,gt)[gt]=N(this,$e)[$e].get(\"s3/sts\",null,i).then(Go)):N(this,gt)[gt]=this.opts.getTemporarySecurityCredentials(i),N(this,gt)[gt]=await N(this,gt)[gt],setTimeout(()=>{N(this,gt)[gt]=null},(Sv(N(this,gt)[gt].credentials)||0)*500)),N(this,gt)[gt]}n(e_,\"_getTemporarySecurityCredentials2\");function t_(i){var e=this;return new Promise((t,r)=>{let s=n((d,f)=>{this.uppy.emit(\"upload-progress\",i,{uploader:this,bytesUploaded:d,bytesTotal:f})},\"onProgress\"),o=n(d=>{this.uppy.log(d),this.uppy.emit(\"upload-error\",i,d),this.resetUploaderReferences(i.id),r(d)},\"onError\"),a=n(d=>{let f={body:{...d},uploadURL:d.location};this.resetUploaderReferences(i.id),this.uppy.emit(\"upload-success\",N(this,to)[to](i),f),d.location&&this.uppy.log(`Download ${i.name} from ${d.location}`),t()},\"onSuccess\"),l=n(d=>{this.uppy.emit(\"s3-multipart:part-uploaded\",N(this,to)[to](i),d)},\"onPartComplete\"),h=new yv(i.data,{companionComm:N(this,eo)[eo],log:function(){return e.uppy.log(...arguments)},getChunkSize:this.opts.getChunkSize?this.opts.getChunkSize.bind(this):null,onProgress:s,onError:o,onSuccess:a,onPartComplete:l,file:i,shouldUseMultipart:this.opts.shouldUseMultipart,...i.s3Multipart});this.uploaders[i.id]=h;let p=new mi(this.uppy);this.uploaderEvents[i.id]=p,p.onFileRemove(i.id,d=>{h.abort(),this.resetUploaderReferences(i.id,{abort:!0}),t(`upload ${d.id} was removed`)}),p.onCancelAll(i.id,function(d){let{reason:f}=d===void 0?{}:d;f===\"user\"&&(h.abort(),e.resetUploaderReferences(i.id,{abort:!0})),t(`upload ${i.id} was canceled`)}),p.onFilePause(i.id,d=>{d?h.pause():h.start()}),p.onPauseAll(i.id,()=>{h.pause()}),p.onResumeAll(i.id,()=>{h.start()}),h.start()})}n(t_,\"_uploadLocalFile2\");function i_(i){return{...i.remote.body,protocol:\"s3-multipart\",size:i.data.size,metadata:i.meta}}n(i_,\"_getCompanionClientArgs2\");Ri.VERSION=YP.version;function gi(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(gi,\"_classPrivateFieldLooseBase\");var r_=0;function Gu(i){return\"__private_\"+r_+++\"_\"+i}n(Gu,\"_classPrivateFieldLooseKey\");var Br=Gu(\"aliveTimer\"),io=Gu(\"isDone\"),$a=Gu(\"onTimedOut\"),ro=Gu(\"timeout\"),Wu=class{constructor(e,t){Object.defineProperty(this,Br,{writable:!0,value:void 0}),Object.defineProperty(this,io,{writable:!0,value:!1}),Object.defineProperty(this,$a,{writable:!0,value:void 0}),Object.defineProperty(this,ro,{writable:!0,value:void 0}),gi(this,ro)[ro]=e,gi(this,$a)[$a]=t}progress(){gi(this,io)[io]||gi(this,ro)[ro]>0&&(clearTimeout(gi(this,Br)[Br]),gi(this,Br)[Br]=setTimeout(gi(this,$a)[$a],gi(this,ro)[ro]))}done(){gi(this,io)[io]||(clearTimeout(gi(this,Br)[Br]),gi(this,Br)[Br]=void 0,gi(this,io)[io]=!0)}};n(Wu,\"ProgressTimeout\");var qa=Wu;function s_(i){return i?i.readyState!==0&&i.readyState!==4||i.status===0:!1}n(s_,\"isNetworkError\");var so=s_;function Pv(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(Pv,\"_classPrivateFieldLooseBase\");var o_=0;function xv(i){return\"__private_\"+o_+++\"_\"+i}n(xv,\"_classPrivateFieldLooseKey\");function _v(i,e){if(so(i))return new Pi(e,i);let t=new vr(\"Upload error\",{cause:e});return t.request=i,t}n(_v,\"buildResponseError\");function n_(i){return i.data.slice(0,i.data.size,i.meta.type)}n(n_,\"setTypeInBlob\");function a_(i,e,t){(Array.isArray(t.allowedMetaFields)?t.allowedMetaFields:Object.keys(e)).forEach(s=>{i.append(s,e[s])})}n(a_,\"addMetadata\");function l_(i,e){let t=new FormData;a_(t,i.meta,e);let r=n_(i);return i.name?t.append(e.fieldName,r,i.meta.name):t.append(e.fieldName,r),t}n(l_,\"createFormDataUpload\");var u_=n(i=>i.data,\"createBareUpload\"),Mc=xv(\"addEventHandlerForFile\"),Lc=xv(\"addEventHandlerIfFileStillExists\"),Ko=class{constructor(e,t){Object.defineProperty(this,Lc,{value:d_}),Object.defineProperty(this,Mc,{value:h_}),this.uppy=e,this.opts={validateStatus(r){return r>=200&&r<300},...t},this.requests=t[us],this.uploaderEvents=Object.create(null),this.i18n=t.i18n}getOptions(e){var t;let{uppy:r}=this,s=r.getState().xhrUpload;return{...this.opts,...s||{},...e.xhrUpload||{},headers:{...this.opts.headers,...s?.headers,...(t=e.xhrUpload)==null?void 0:t.headers}}}uploadLocalFile(e){let t=this.getOptions(e);return new Promise((r,s)=>{let o=t.formData?l_(e,t):u_(e,t),a=new XMLHttpRequest;this.uploaderEvents[e.id]=new mi(this.uppy);let l=new qa(t.timeout,()=>{a.abort(),p.done();let d=new Error(this.i18n(\"timedOut\",{seconds:Math.ceil(t.timeout/1e3)}));this.uppy.emit(\"upload-error\",e,d),s(d)}),h=Pt();a.upload.addEventListener(\"loadstart\",()=>{this.uppy.log(`[AwsS3/XHRUpload] ${h} started`)}),a.upload.addEventListener(\"progress\",d=>{this.uppy.log(`[AwsS3/XHRUpload] ${h} progress: ${d.loaded} / ${d.total}`),l.progress(),d.lengthComputable&&this.uppy.emit(\"upload-progress\",e,{uploader:this,bytesUploaded:d.loaded,bytesTotal:d.total})}),a.addEventListener(\"load\",d=>{if(this.uppy.log(`[AwsS3/XHRUpload] ${h} finished`),l.done(),p.done(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null),t.validateStatus(d.target.status,a.responseText,a)){let S=t.getResponseData(a.responseText,a),E=S[t.responseUrlFieldName],x={status:d.target.status,body:S,uploadURL:E};return this.uppy.emit(\"upload-success\",e,x),E&&this.uppy.log(`Download ${e.name} from ${E}`),r(e)}let f=t.getResponseData(a.responseText,a),y=_v(a,t.getResponseError(a.responseText,a)),b={status:d.target.status,body:f};return this.uppy.emit(\"upload-error\",e,y,b),s(y)}),a.addEventListener(\"error\",()=>{this.uppy.log(`[AwsS3/XHRUpload] ${h} errored`),l.done(),p.done(),this.uploaderEvents[e.id]&&(this.uploaderEvents[e.id].remove(),this.uploaderEvents[e.id]=null);let d=_v(a,t.getResponseError(a.responseText,a));return this.uppy.emit(\"upload-error\",e,d),s(d)}),a.open(t.method.toUpperCase(),t.endpoint,!0),a.withCredentials=!!t.withCredentials,t.responseType!==\"\"&&(a.responseType=t.responseType),Object.keys(t.headers).forEach(d=>{a.setRequestHeader(d,t.headers[d])});let p=this.requests.run(()=>(a.send(o),()=>{l.done(),a.abort()}),{priority:1});Pv(this,Mc)[Mc](\"file-removed\",e.id,()=>{p.abort(),s(new Error(\"File removed\"))}),Pv(this,Lc)[Lc](\"cancel-all\",e.id,function(d){let{reason:f}=d===void 0?{}:d;f===\"user\"&&p.abort(),s(new Error(\"Upload cancelled\"))})})}};n(Ko,\"MiniXHRUpload\");function h_(i,e,t){this.uploaderEvents[e].on(i,r=>{var s;let o=(s=r?.id)!=null?s:r;e===o&&t()})}n(h_,\"_addEventHandlerForFile2\");function d_(i,e,t){var r=this;this.uploaderEvents[e].on(i,function(){r.uppy.getFile(e)&&t(...arguments)})}n(d_,\"_addEventHandlerIfFileStillExists2\");function c_(i){return i.replace(/;.*$/,\"\")}n(c_,\"removeMimeParameters\");function p_(i,e){let t=e.headers?e.headers[\"content-type\"]:e.getResponseHeader(\"Content-Type\");if(typeof t==\"string\"){let r=c_(t).toLowerCase();if(r===\"application/xml\"||r===\"text/xml\"||r===\"text/html\"&&/^<\\?xml /.test(i))return!0}return!1}n(p_,\"isXml\");var Bc=p_;var Fv={strings:{timedOut:\"Upload stalled for %{seconds} seconds, aborting.\"}};var Ov;function ot(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(ot,\"_classPrivateFieldLooseBase\");var f_=0;function Xo(i){return\"__private_\"+f_+++\"_\"+i}n(Xo,\"_classPrivateFieldLooseKey\");var m_={version:\"3.5.0\"};function g_(i,e){return!i&&!e.startsWith(\"https://\")&&!e.startsWith(\"http://\")&&(e=`https://${e}`),new URL(e,i||void 0).toString()}n(g_,\"resolveUrl\");function Ga(i,e){let t=i.indexOf(`<${e}>`),r=i.indexOf(`</${e}>`,t);return t!==-1&&r!==-1?i.slice(t+e.length+2,r):\"\"}n(Ga,\"getXmlValue\");function y_(i){if(i&&i.error){let e=new Error(i.message);throw Object.assign(e,i.error),e}return i}n(y_,\"assertServerError\");function v_(i,e){if(!(e!=null&&typeof e.url==\"string\"&&(typeof e.fields==\"object\"||e.fields==null)))throw new TypeError(`AwsS3: got incorrect result from 'getUploadParameters()' for file '${i.name}', expected an object '{ url, method, fields, headers }' but got '${JSON.stringify(e)}' instead.\nSee https://uppy.io/docs/aws-s3/#getUploadParameters-file for more on the expected format.`);if(!(e.method==null||/^p(u|os)t$/i.test(e.method)))throw new TypeError(`AwsS3: got incorrect method from 'getUploadParameters()' for file '${i.name}', expected  'PUT' or 'POST' but got '${e.method}' instead.\nSee https://uppy.io/docs/aws-s3/#getUploadParameters-file for more on the expected format.`)}n(v_,\"validateParameters\");function b_(i,e){if(!Bc(i,e))return;let t=Ga(i,\"Message\");return new Error(t)}n(b_,\"defaultGetResponseError\");var Ev=!1,oi=Xo(\"client\"),Ui=Xo(\"requests\"),oo=Xo(\"uploader\"),Va=Xo(\"handleUpload\"),Wa=Xo(\"setCompanionHeaders\"),zc=Xo(\"getCompanionClientArgs\");Ov=Symbol.for(\"uppy test: getClient\");var no=class extends ve{constructor(e,t){if(t?.shouldUseMultipart!=null)return new Ri(e,t);super(e,t),Object.defineProperty(this,oi,{writable:!0,value:void 0}),Object.defineProperty(this,Ui,{writable:!0,value:void 0}),Object.defineProperty(this,oo,{writable:!0,value:void 0}),Object.defineProperty(this,Va,{writable:!0,value:async s=>{let o=Object.create(null);function a(y){var b;let{id:S}=y;(b=o[S])==null||b.abort()}n(a,\"onremove\"),this.uppy.on(\"file-removed\",a);let l=this.uppy.getFilesByIds(s),h=hs(l),p=ds(h);this.uppy.emit(\"upload-start\",p);let d=ot(this,Ui)[Ui].wrapPromiseFunction(y=>this.opts.getUploadParameters(y)),f=s.length;return Promise.allSettled(s.map((y,b)=>(o[y]=d(this.uppy.getFile(y)),o[y].then(S=>{delete o[y];let E=this.uppy.getFile(y);v_(E,S);let{method:x=\"POST\",url:F,fields:U,headers:j}=S,G={method:x,formData:x.toUpperCase()===\"POST\",endpoint:F,allowedMetaFields:U?Object.keys(U):[]};return j&&(G.headers=j),this.uppy.setFileState(E.id,{meta:{...E.meta,...U},xhrUpload:G}),this.uploadFile(E.id,b,f)}).catch(S=>{delete o[y];let E=this.uppy.getFile(y);return this.uppy.emit(\"upload-error\",E,S),Promise.reject(S)})))).finally(()=>{this.uppy.off(\"file-removed\",a)})}}),Object.defineProperty(this,Wa,{writable:!0,value:()=>(ot(this,oi)[oi].setCompanionHeaders(this.opts.companionHeaders),Promise.resolve())}),Object.defineProperty(this,zc,{writable:!0,value:s=>{let o=ot(this,oo)[oo].getOptions(s),a=Array.isArray(o.allowedMetaFields)?o.allowedMetaFields:Object.keys(s.meta);return{...s.remote.body,protocol:\"multipart\",endpoint:o.endpoint,size:s.data.size,fieldname:o.fieldName,metadata:Object.fromEntries(a.map(l=>[l,s.meta[l]])),httpMethod:o.method,useFormData:o.formData,headers:typeof o.headers==\"function\"?o.headers(s):o.headers}}}),this.type=\"uploader\",this.id=this.opts.id||\"AwsS3\",this.title=\"AWS S3\",this.defaultLocale=Fv;let r={timeout:30*1e3,limit:0,allowedMetaFields:[],getUploadParameters:this.getUploadParameters.bind(this),shouldUseMultipart:!1,companionHeaders:{}};if(this.opts={...r,...t},t?.allowedMetaFields===void 0&&\"metaFields\"in this.opts)throw new Error(\"The `metaFields` option has been renamed to `allowedMetaFields`.\");this.i18nInit(),ot(this,oi)[oi]=new tt(e,t),ot(this,Ui)[Ui]=new Mt(this.opts.limit)}[Ov](){return ot(this,oi)[oi]}get client(){return ot(this,oi)[oi]}set client(e){ot(this,oi)[oi]=e}getUploadParameters(e){if(!this.opts.companionUrl)throw new Error(\"Expected a `companionUrl` option containing a Companion address.\");let t=e.meta.name,{type:r}=e.meta,s=Object.fromEntries(this.opts.allowedMetaFields.filter(a=>e.meta[a]!=null).map(a=>[`metadata[${a}]`,e.meta[a].toString()])),o=new URLSearchParams({filename:t,type:r,...s});return ot(this,oi)[oi].get(`s3/params?${o}`).then(y_)}uploadFile(e,t,r){let s=this.uppy.getFile(e);if(this.uppy.log(`uploading ${t} of ${r}`),s.error)throw new Error(s.error);if(s.isRemote){let o=n(()=>ot(this,Ui)[Ui],\"getQueue\"),a=new AbortController,l=n(p=>{p.id===s.id&&a.abort()},\"removedHandler\");this.uppy.on(\"file-removed\",l);let h=s.remote.requestClient.uploadRemoteFile(s,ot(this,zc)[zc](s),{signal:a.signal,getQueue:o});return ot(this,Ui)[Ui].wrapSyncFunction(()=>{this.uppy.off(\"file-removed\",l)},{priority:-1})(),h}return ot(this,oo)[oo].uploadLocalFile(s,t,r)}install(){let{uppy:e}=this;e.addPreProcessor(ot(this,Wa)[Wa]),e.addUploader(ot(this,Va)[Va]);function t(s,o){let a=this;return Bc(s,o)?{location:g_(o.responseURL,Ga(s,\"Location\")),bucket:Ga(s,\"Bucket\"),key:Ga(s,\"Key\"),etag:Ga(s,\"ETag\")}:a.method.toUpperCase()===\"POST\"?(Ev||(e.log(\"[AwsS3] No response data found, make sure to set the success_action_status AWS SDK option to 201. See https://uppy.io/docs/aws-s3/#POST-Uploads\",\"warning\"),Ev=!0),{location:null}):o.responseURL?{location:o.responseURL.replace(/\\?.*$/,\"\")}:{location:null}}n(t,\"defaultGetResponseData\");let r={fieldName:\"file\",responseUrlFieldName:\"location\",timeout:this.opts.timeout,[us]:ot(this,Ui)[Ui],responseType:\"text\",getResponseData:this.opts.getResponseData||t,getResponseError:b_};r.i18n=this.i18n,ot(this,oo)[oo]=new Ko(e,r)}uninstall(){this.uppy.removePreProcessor(ot(this,Wa)[Wa]),this.uppy.removeUploader(ot(this,Va)[Va])}};n(no,\"AwsS3\");no.VERSION=m_.version;var kv=\"3.7.2\",w_=kv,S_=typeof atob==\"function\",P_=typeof btoa==\"function\",Qo=typeof Buffer==\"function\",Cv=typeof TextDecoder==\"function\"?new TextDecoder:void 0,Tv=typeof TextEncoder==\"function\"?new TextEncoder:void 0,__=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",Ka=Array.prototype.slice.call(__),Ku=(i=>{let e={};return i.forEach((t,r)=>e[t]=r),e})(Ka),x_=/^(?:[A-Za-z\\d+\\/]{4})*?(?:[A-Za-z\\d+\\/]{2}(?:==)?|[A-Za-z\\d+\\/]{3}=?)?$/,vt=String.fromCharCode.bind(String),Av=typeof Uint8Array.from==\"function\"?Uint8Array.from.bind(Uint8Array):(i,e=t=>t)=>new Uint8Array(Array.prototype.slice.call(i,0).map(e)),Dv=n(i=>i.replace(/=/g,\"\").replace(/[+\\/]/g,e=>e==\"+\"?\"-\":\"_\"),\"_mkUriSafe\"),Iv=n(i=>i.replace(/[^A-Za-z0-9\\+\\/]/g,\"\"),\"_tidyB64\"),Nv=n(i=>{let e,t,r,s,o=\"\",a=i.length%3;for(let l=0;l<i.length;){if((t=i.charCodeAt(l++))>255||(r=i.charCodeAt(l++))>255||(s=i.charCodeAt(l++))>255)throw new TypeError(\"invalid character found\");e=t<<16|r<<8|s,o+=Ka[e>>18&63]+Ka[e>>12&63]+Ka[e>>6&63]+Ka[e&63]}return a?o.slice(0,a-3)+\"===\".substring(a):o},\"btoaPolyfill\"),$c=P_?i=>btoa(i):Qo?i=>Buffer.from(i,\"binary\").toString(\"base64\"):Nv,jc=Qo?i=>Buffer.from(i).toString(\"base64\"):i=>{let t=[];for(let r=0,s=i.length;r<s;r+=4096)t.push(vt.apply(null,i.subarray(r,r+4096)));return $c(t.join(\"\"))},Xu=n((i,e=!1)=>e?Dv(jc(i)):jc(i),\"fromUint8Array\"),F_=n(i=>{if(i.length<2){var e=i.charCodeAt(0);return e<128?i:e<2048?vt(192|e>>>6)+vt(128|e&63):vt(224|e>>>12&15)+vt(128|e>>>6&63)+vt(128|e&63)}else{var e=65536+(i.charCodeAt(0)-55296)*1024+(i.charCodeAt(1)-56320);return vt(240|e>>>18&7)+vt(128|e>>>12&63)+vt(128|e>>>6&63)+vt(128|e&63)}},\"cb_utob\"),E_=/[\\uD800-\\uDBFF][\\uDC00-\\uDFFFF]|[^\\x00-\\x7F]/g,Mv=n(i=>i.replace(E_,F_),\"utob\"),Rv=Qo?i=>Buffer.from(i,\"utf8\").toString(\"base64\"):Tv?i=>jc(Tv.encode(i)):i=>$c(Mv(i)),Yo=n((i,e=!1)=>e?Dv(Rv(i)):Rv(i),\"encode\"),Uv=n(i=>Yo(i,!0),\"encodeURI\"),O_=/[\\xC0-\\xDF][\\x80-\\xBF]|[\\xE0-\\xEF][\\x80-\\xBF]{2}|[\\xF0-\\xF7][\\x80-\\xBF]{3}/g,C_=n(i=>{switch(i.length){case 4:var e=(7&i.charCodeAt(0))<<18|(63&i.charCodeAt(1))<<12|(63&i.charCodeAt(2))<<6|63&i.charCodeAt(3),t=e-65536;return vt((t>>>10)+55296)+vt((t&1023)+56320);case 3:return vt((15&i.charCodeAt(0))<<12|(63&i.charCodeAt(1))<<6|63&i.charCodeAt(2));default:return vt((31&i.charCodeAt(0))<<6|63&i.charCodeAt(1))}},\"cb_btou\"),Lv=n(i=>i.replace(O_,C_),\"btou\"),Bv=n(i=>{if(i=i.replace(/\\s+/g,\"\"),!x_.test(i))throw new TypeError(\"malformed base64.\");i+=\"==\".slice(2-(i.length&3));let e,t=\"\",r,s;for(let o=0;o<i.length;)e=Ku[i.charAt(o++)]<<18|Ku[i.charAt(o++)]<<12|(r=Ku[i.charAt(o++)])<<6|(s=Ku[i.charAt(o++)]),t+=r===64?vt(e>>16&255):s===64?vt(e>>16&255,e>>8&255):vt(e>>16&255,e>>8&255,e&255);return t},\"atobPolyfill\"),qc=S_?i=>atob(Iv(i)):Qo?i=>Buffer.from(i,\"base64\").toString(\"binary\"):Bv,zv=Qo?i=>Av(Buffer.from(i,\"base64\")):i=>Av(qc(i),e=>e.charCodeAt(0)),jv=n(i=>zv(Hv(i)),\"toUint8Array\"),T_=Qo?i=>Buffer.from(i,\"base64\").toString(\"utf8\"):Cv?i=>Cv.decode(zv(i)):i=>Lv(qc(i)),Hv=n(i=>Iv(i.replace(/[-_]/g,e=>e==\"-\"?\"+\":\"/\")),\"_unURI\"),Hc=n(i=>T_(Hv(i)),\"decode\"),A_=n(i=>{if(typeof i!=\"string\")return!1;let e=i.replace(/\\s+/g,\"\").replace(/={0,2}$/,\"\");return!/[^\\s0-9a-zA-Z\\+/]/.test(e)||!/[^\\s0-9a-zA-Z\\-_]/.test(e)},\"isValid\"),$v=n(i=>({value:i,enumerable:!1,writable:!0,configurable:!0}),\"_noEnum\"),qv=n(function(){let i=n((e,t)=>Object.defineProperty(String.prototype,e,$v(t)),\"_add\");i(\"fromBase64\",function(){return Hc(this)}),i(\"toBase64\",function(e){return Yo(this,e)}),i(\"toBase64URI\",function(){return Yo(this,!0)}),i(\"toBase64URL\",function(){return Yo(this,!0)}),i(\"toUint8Array\",function(){return jv(this)})},\"extendString\"),Vv=n(function(){let i=n((e,t)=>Object.defineProperty(Uint8Array.prototype,e,$v(t)),\"_add\");i(\"toBase64\",function(e){return Xu(this,e)}),i(\"toBase64URI\",function(){return Xu(this,!0)}),i(\"toBase64URL\",function(){return Xu(this,!0)})},\"extendUint8Array\"),R_=n(()=>{qv(),Vv()},\"extendBuiltins\"),Wv={version:kv,VERSION:w_,atob:qc,atobPolyfill:Bv,btoa:$c,btoaPolyfill:Nv,fromBase64:Hc,toBase64:Yo,encode:Yo,encodeURI:Uv,encodeURL:Uv,utob:Mv,btou:Lv,decode:Hc,isValid:A_,fromUint8Array:Xu,toUint8Array:jv,extendString:qv,extendUint8Array:Vv,extendBuiltins:R_};var y0=de(o0());function Kc(i){\"@babel/helpers - typeof\";return Kc=typeof Symbol==\"function\"&&typeof Symbol.iterator==\"symbol\"?function(e){return typeof e}:function(e){return e&&typeof Symbol==\"function\"&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},Kc(i)}n(Kc,\"_typeof\");function n0(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}n(n0,\"_defineProperties\");function $_(i,e,t){return e&&n0(i.prototype,e),t&&n0(i,t),Object.defineProperty(i,\"prototype\",{writable:!1}),i}n($_,\"_createClass\");function q_(i,e){if(!(i instanceof e))throw new TypeError(\"Cannot call a class as a function\")}n(q_,\"_classCallCheck\");function V_(i,e){if(typeof e!=\"function\"&&e!==null)throw new TypeError(\"Super expression must either be null or a function\");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,\"prototype\",{writable:!1}),e&&Xa(i,e)}n(V_,\"_inherits\");function W_(i){var e=a0();return n(function(){var r=Ya(i),s;if(e){var o=Ya(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return G_(this,s)},\"_createSuperInternal\")}n(W_,\"_createSuper\");function G_(i,e){if(e&&(Kc(e)===\"object\"||typeof e==\"function\"))return e;if(e!==void 0)throw new TypeError(\"Derived constructors may only return object or undefined\");return K_(i)}n(G_,\"_possibleConstructorReturn\");function K_(i){if(i===void 0)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return i}n(K_,\"_assertThisInitialized\");function Xc(i){var e=typeof Map==\"function\"?new Map:void 0;return Xc=n(function(r){if(r===null||!X_(r))return r;if(typeof r!=\"function\")throw new TypeError(\"Super expression must either be null or a function\");if(typeof e<\"u\"){if(e.has(r))return e.get(r);e.set(r,s)}function s(){return Qu(r,arguments,Ya(this).constructor)}return n(s,\"Wrapper\"),s.prototype=Object.create(r.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),Xa(s,r)},\"_wrapNativeSuper\"),Xc(i)}n(Xc,\"_wrapNativeSuper\");function Qu(i,e,t){return a0()?Qu=Reflect.construct.bind():Qu=n(function(s,o,a){var l=[null];l.push.apply(l,o);var h=Function.bind.apply(s,l),p=new h;return a&&Xa(p,a.prototype),p},\"_construct\"),Qu.apply(null,arguments)}n(Qu,\"_construct\");function a0(){if(typeof Reflect>\"u\"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy==\"function\")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}n(a0,\"_isNativeReflectConstruct\");function X_(i){return Function.toString.call(i).indexOf(\"[native code]\")!==-1}n(X_,\"_isNativeFunction\");function Xa(i,e){return Xa=Object.setPrototypeOf?Object.setPrototypeOf.bind():n(function(r,s){return r.__proto__=s,r},\"_setPrototypeOf\"),Xa(i,e)}n(Xa,\"_setPrototypeOf\");function Ya(i){return Ya=Object.setPrototypeOf?Object.getPrototypeOf.bind():n(function(t){return t.__proto__||Object.getPrototypeOf(t)},\"_getPrototypeOf\"),Ya(i)}n(Ya,\"_getPrototypeOf\");var Y_=function(i){V_(t,i);var e=W_(t);function t(r){var s,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(q_(this,t),s=e.call(this,r),s.originalRequest=a,s.originalResponse=l,s.causingError=o,o!=null&&(r+=\", caused by \".concat(o.toString())),a!=null){var h=a.getHeader(\"X-Request-ID\")||\"n/a\",p=a.getMethod(),d=a.getURL(),f=l?l.getStatus():\"n/a\",y=l?l.getBody()||\"\":\"n/a\";r+=\", originated from request (method: \".concat(p,\", url: \").concat(d,\", response code: \").concat(f,\", response text: \").concat(y,\", request id: \").concat(h,\")\")}return s.message=r,s}return n(t,\"DetailedError\"),$_(t)}(Xc(Error)),Jo=Y_;var Q_=!1;function cs(i){Q_&&console.log(i)}n(cs,\"log\");function Yc(){return\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,function(i){var e=Math.random()*16|0,t=i===\"x\"?e:e&3|8;return t.toString(16)})}n(Yc,\"uuid\");function g0(i,e){return t5(i)||e5(i,e)||Z_(i,e)||J_()}n(g0,\"_slicedToArray\");function J_(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}n(J_,\"_nonIterableRest\");function Z_(i,e){if(i){if(typeof i==\"string\")return l0(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t===\"Object\"&&i.constructor&&(t=i.constructor.name),t===\"Map\"||t===\"Set\")return Array.from(i);if(t===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return l0(i,e)}}n(Z_,\"_unsupportedIterableToArray\");function l0(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=i[t];return r}n(l0,\"_arrayLikeToArray\");function e5(i,e){var t=i==null?null:typeof Symbol<\"u\"&&i[Symbol.iterator]||i[\"@@iterator\"];if(t!=null){var r=[],s=!0,o=!1,a,l;try{for(t=t.call(i);!(s=(a=t.next()).done)&&(r.push(a.value),!(e&&r.length===e));s=!0);}catch(h){o=!0,l=h}finally{try{!s&&t.return!=null&&t.return()}finally{if(o)throw l}}return r}}n(e5,\"_iterableToArrayLimit\");function t5(i){if(Array.isArray(i))return i}n(t5,\"_arrayWithHoles\");function u0(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,r)}return t}n(u0,\"ownKeys\");function Zo(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?u0(Object(t),!0).forEach(function(r){i5(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):u0(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}n(Zo,\"_objectSpread\");function i5(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}n(i5,\"_defineProperty\");function r5(i,e){if(!(i instanceof e))throw new TypeError(\"Cannot call a class as a function\")}n(r5,\"_classCallCheck\");function h0(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}n(h0,\"_defineProperties\");function s5(i,e,t){return e&&h0(i.prototype,e),t&&h0(i,t),Object.defineProperty(i,\"prototype\",{writable:!1}),i}n(s5,\"_createClass\");var o5={endpoint:null,uploadUrl:null,metadata:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,_onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:null,chunkSize:1/0,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null},v0=function(){function i(e,t){r5(this,i),\"resume\"in t&&console.log(\"tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead.\"),this.options=t,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=e,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return n(i,\"BaseUpload\"),s5(i,[{key:\"findPreviousUploads\",value:n(function(){var t=this;return this.options.fingerprint(this.file,this.options).then(function(r){return t._urlStorage.findUploadsByFingerprint(r)})},\"findPreviousUploads\")},{key:\"resumeFromPreviousUpload\",value:n(function(t){this.url=t.uploadUrl||null,this._parallelUploadUrls=t.parallelUploadUrls||null,this._urlStorageKey=t.urlStorageKey},\"resumeFromPreviousUpload\")},{key:\"start\",value:n(function(){var t=this,r=this.file;if(!r){this._emitError(new Error(\"tus: no file or stream to upload provided\"));return}if(!this.options.endpoint&&!this.options.uploadUrl&&!this.url){this._emitError(new Error(\"tus: neither an endpoint or an upload URL is provided\"));return}var s=this.options.retryDelays;if(s!=null&&Object.prototype.toString.call(s)!==\"[object Array]\"){this._emitError(new Error(\"tus: the `retryDelays` option must either be an array or null\"));return}if(this.options.parallelUploads>1)for(var o=0,a=[\"uploadUrl\",\"uploadSize\",\"uploadLengthDeferred\"];o<a.length;o++){var l=a[o];if(this.options[l]){this._emitError(new Error(\"tus: cannot use the \".concat(l,\" option when parallelUploads is enabled\")));return}}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1){this._emitError(new Error(\"tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled\"));return}if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length){this._emitError(new Error(\"tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`\"));return}}this.options.fingerprint(r,this.options).then(function(h){return h==null?cs(\"No fingerprint was calculated meaning that the upload cannot be stored in the URL storage.\"):cs(\"Calculated fingerprint: \".concat(h)),t._fingerprint=h,t._source?t._source:t.options.fileReader.openFile(r,t.options.chunkSize)}).then(function(h){if(t._source=h,t.options.uploadLengthDeferred)t._size=null;else if(t.options.uploadSize!=null){if(t._size=Number(t.options.uploadSize),Number.isNaN(t._size)){t._emitError(new Error(\"tus: cannot convert `uploadSize` option into a number\"));return}}else if(t._size=t._source.size,t._size==null){t._emitError(new Error(\"tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option\"));return}t.options.parallelUploads>1||t._parallelUploadUrls!=null?t._startParallelUpload():t._startSingleUpload()}).catch(function(h){t._emitError(h)})},\"start\")},{key:\"_startParallelUpload\",value:n(function(){var t,r=this,s=this._size,o=0;this._parallelUploads=[];var a=this._parallelUploadUrls!=null?this._parallelUploadUrls.length:this.options.parallelUploads,l=(t=this.options.parallelUploadBoundaries)!==null&&t!==void 0?t:a5(this._source.size,a);this._parallelUploadUrls&&l.forEach(function(d,f){d.uploadUrl=r._parallelUploadUrls[f]||null}),this._parallelUploadUrls=new Array(l.length);var h=l.map(function(d,f){var y=0;return r._source.slice(d.start,d.end).then(function(b){var S=b.value;return new Promise(function(E,x){var F=Zo(Zo({},r.options),{},{uploadUrl:d.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:{},headers:Zo(Zo({},r.options.headers),{},{\"Upload-Concat\":\"partial\"}),onSuccess:E,onError:x,onProgress:n(function(G){o=o-y+G,y=G,r._emitProgress(o,s)},\"onProgress\"),_onUploadUrlAvailable:n(function(){r._parallelUploadUrls[f]=U.url,r._parallelUploadUrls.filter(function(G){return!!G}).length===l.length&&r._saveUploadInUrlStorage()},\"_onUploadUrlAvailable\")}),U=new i(S,F);U.start(),r._parallelUploads.push(U)})})}),p;Promise.all(h).then(function(){p=r._openRequest(\"POST\",r.options.endpoint),p.setHeader(\"Upload-Concat\",\"final;\".concat(r._parallelUploadUrls.join(\" \")));var d=d0(r.options.metadata);return d!==\"\"&&p.setHeader(\"Upload-Metadata\",d),r._sendRequest(p,null)}).then(function(d){if(!en(d.getStatus(),200)){r._emitHttpError(p,d,\"tus: unexpected response while creating upload\");return}var f=d.getHeader(\"Location\");if(f==null){r._emitHttpError(p,d,\"tus: invalid or missing Location header\");return}r.url=m0(r.options.endpoint,f),cs(\"Created upload at \".concat(r.url)),r._emitSuccess()}).catch(function(d){r._emitError(d)})},\"_startParallelUpload\")},{key:\"_startSingleUpload\",value:n(function(){if(this._aborted=!1,this.url!=null){cs(\"Resuming upload from previous URL: \".concat(this.url)),this._resumeUpload();return}if(this.options.uploadUrl!=null){cs(\"Resuming upload from provided URL: \".concat(this.options.uploadUrl)),this.url=this.options.uploadUrl,this._resumeUpload();return}cs(\"Creating a new upload\"),this._createUpload()},\"_startSingleUpload\")},{key:\"abort\",value:n(function(t){var r=this;return this._parallelUploads!=null&&this._parallelUploads.forEach(function(s){s.abort(t)}),this._req!==null&&this._req.abort(),this._aborted=!0,this._retryTimeout!=null&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),!t||this.url==null?Promise.resolve():i.terminate(this.url,this.options).then(function(){return r._removeFromUrlStorage()})},\"abort\")},{key:\"_emitHttpError\",value:n(function(t,r,s,o){this._emitError(new Jo(s,o,t,r))},\"_emitHttpError\")},{key:\"_emitError\",value:n(function(t){var r=this;if(!this._aborted){if(this.options.retryDelays!=null){var s=this._offset!=null&&this._offset>this._offsetBeforeRetry;if(s&&(this._retryAttempt=0),f0(t,this._retryAttempt,this.options)){var o=this.options.retryDelays[this._retryAttempt++];this._offsetBeforeRetry=this._offset,this._retryTimeout=setTimeout(function(){r.start()},o);return}}if(typeof this.options.onError==\"function\")this.options.onError(t);else throw t}},\"_emitError\")},{key:\"_emitSuccess\",value:n(function(){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),typeof this.options.onSuccess==\"function\"&&this.options.onSuccess()},\"_emitSuccess\")},{key:\"_emitProgress\",value:n(function(t,r){typeof this.options.onProgress==\"function\"&&this.options.onProgress(t,r)},\"_emitProgress\")},{key:\"_emitChunkComplete\",value:n(function(t,r,s){typeof this.options.onChunkComplete==\"function\"&&this.options.onChunkComplete(t,r,s)},\"_emitChunkComplete\")},{key:\"_createUpload\",value:n(function(){var t=this;if(!this.options.endpoint){this._emitError(new Error(\"tus: unable to create upload because no endpoint is provided\"));return}var r=this._openRequest(\"POST\",this.options.endpoint);this.options.uploadLengthDeferred?r.setHeader(\"Upload-Defer-Length\",1):r.setHeader(\"Upload-Length\",this._size);var s=d0(this.options.metadata);s!==\"\"&&r.setHeader(\"Upload-Metadata\",s);var o;this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,o=this._addChunkToRequest(r)):o=this._sendRequest(r,null),o.then(function(a){if(!en(a.getStatus(),200)){t._emitHttpError(r,a,\"tus: unexpected response while creating upload\");return}var l=a.getHeader(\"Location\");if(l==null){t._emitHttpError(r,a,\"tus: invalid or missing Location header\");return}if(t.url=m0(t.options.endpoint,l),cs(\"Created upload at \".concat(t.url)),typeof t.options._onUploadUrlAvailable==\"function\"&&t.options._onUploadUrlAvailable(),t._size===0){t._emitSuccess(),t._source.close();return}t._saveUploadInUrlStorage().then(function(){t.options.uploadDataDuringCreation?t._handleUploadResponse(r,a):(t._offset=0,t._performUpload())})}).catch(function(a){t._emitHttpError(r,null,\"tus: failed to create upload\",a)})},\"_createUpload\")},{key:\"_resumeUpload\",value:n(function(){var t=this,r=this._openRequest(\"HEAD\",this.url),s=this._sendRequest(r,null);s.then(function(o){var a=o.getStatus();if(!en(a,200)){if(a===423){t._emitHttpError(r,o,\"tus: upload is currently locked; retry later\");return}if(en(a,400)&&t._removeFromUrlStorage(),!t.options.endpoint){t._emitHttpError(r,o,\"tus: unable to resume upload (new upload cannot be created without an endpoint)\");return}t.url=null,t._createUpload();return}var l=parseInt(o.getHeader(\"Upload-Offset\"),10);if(Number.isNaN(l)){t._emitHttpError(r,o,\"tus: invalid or missing offset value\");return}var h=parseInt(o.getHeader(\"Upload-Length\"),10);if(Number.isNaN(h)&&!t.options.uploadLengthDeferred){t._emitHttpError(r,o,\"tus: invalid or missing length value\");return}typeof t.options._onUploadUrlAvailable==\"function\"&&t.options._onUploadUrlAvailable(),t._saveUploadInUrlStorage().then(function(){if(l===h){t._emitProgress(h,h),t._emitSuccess();return}t._offset=l,t._performUpload()})}).catch(function(o){t._emitHttpError(r,null,\"tus: failed to resume upload\",o)})},\"_resumeUpload\")},{key:\"_performUpload\",value:n(function(){var t=this;if(!this._aborted){var r;this.options.overridePatchMethod?(r=this._openRequest(\"POST\",this.url),r.setHeader(\"X-HTTP-Method-Override\",\"PATCH\")):r=this._openRequest(\"PATCH\",this.url),r.setHeader(\"Upload-Offset\",this._offset);var s=this._addChunkToRequest(r);s.then(function(o){if(!en(o.getStatus(),200)){t._emitHttpError(r,o,\"tus: unexpected response while uploading chunk\");return}t._handleUploadResponse(r,o)}).catch(function(o){t._aborted||t._emitHttpError(r,null,\"tus: failed to upload chunk at offset \".concat(t._offset),o)})}},\"_performUpload\")},{key:\"_addChunkToRequest\",value:n(function(t){var r=this,s=this._offset,o=this._offset+this.options.chunkSize;return t.setProgressHandler(function(a){r._emitProgress(s+a,r._size)}),t.setHeader(\"Content-Type\",\"application/offset+octet-stream\"),(o===1/0||o>this._size)&&!this.options.uploadLengthDeferred&&(o=this._size),this._source.slice(s,o).then(function(a){var l=a.value,h=a.done;return r.options.uploadLengthDeferred&&h&&(r._size=r._offset+(l&&l.size?l.size:0),t.setHeader(\"Upload-Length\",r._size)),l===null?r._sendRequest(t):(r._emitProgress(r._offset,r._size),r._sendRequest(t,l))})},\"_addChunkToRequest\")},{key:\"_handleUploadResponse\",value:n(function(t,r){var s=parseInt(r.getHeader(\"Upload-Offset\"),10);if(Number.isNaN(s)){this._emitHttpError(t,r,\"tus: invalid or missing offset value\");return}if(this._emitProgress(s,this._size),this._emitChunkComplete(s-this._offset,s,this._size),this._offset=s,s===this._size){this._emitSuccess(),this._source.close();return}this._performUpload()},\"_handleUploadResponse\")},{key:\"_openRequest\",value:n(function(t,r){var s=c0(t,r,this.options);return this._req=s,s},\"_openRequest\")},{key:\"_removeFromUrlStorage\",value:n(function(){var t=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(r){t._emitError(r)}),this._urlStorageKey=null)},\"_removeFromUrlStorage\")},{key:\"_saveUploadInUrlStorage\",value:n(function(){var t=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||this._urlStorageKey!==null)return Promise.resolve();var r={size:this._size,metadata:this.options.metadata,creationTime:new Date().toString()};return this._parallelUploads?r.parallelUploadUrls=this._parallelUploadUrls:r.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,r).then(function(s){t._urlStorageKey=s})},\"_saveUploadInUrlStorage\")},{key:\"_sendRequest\",value:n(function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return p0(t,r,this.options)},\"_sendRequest\")}],[{key:\"terminate\",value:n(function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=c0(\"DELETE\",t,r);return p0(s,null,r).then(function(o){if(o.getStatus()!==204)throw new Jo(\"tus: unexpected response while terminating upload\",null,s,o)}).catch(function(o){if(o instanceof Jo||(o=new Jo(\"tus: failed to terminate upload\",o,s,null)),!f0(o,0,r))throw o;var a=r.retryDelays[0],l=r.retryDelays.slice(1),h=Zo(Zo({},r),{},{retryDelays:l});return new Promise(function(p){return setTimeout(p,a)}).then(function(){return i.terminate(t,h)})})},\"terminate\")}]),i}();function d0(i){return Object.entries(i).map(function(e){var t=g0(e,2),r=t[0],s=t[1];return\"\".concat(r,\" \").concat(Wv.encode(String(s)))}).join(\",\")}n(d0,\"encodeMetadata\");function en(i,e){return i>=e&&i<e+100}n(en,\"inStatusCategory\");function c0(i,e,t){var r=t.httpStack.createRequest(i,e);r.setHeader(\"Tus-Resumable\",\"1.0.0\");var s=t.headers||{};if(Object.entries(s).forEach(function(a){var l=g0(a,2),h=l[0],p=l[1];r.setHeader(h,p)}),t.addRequestId){var o=Yc();r.setHeader(\"X-Request-ID\",o)}return r}n(c0,\"openRequest\");function p0(i,e,t){var r=typeof t.onBeforeRequest==\"function\"?Promise.resolve(t.onBeforeRequest(i)):Promise.resolve();return r.then(function(){return i.send(e).then(function(s){var o=typeof t.onAfterResponse==\"function\"?Promise.resolve(t.onAfterResponse(i,s)):Promise.resolve();return o.then(function(){return s})})})}n(p0,\"sendRequest\");function n5(){var i=!0;return typeof window<\"u\"&&\"navigator\"in window&&window.navigator.onLine===!1&&(i=!1),i}n(n5,\"isOnline\");function f0(i,e,t){if(t.retryDelays==null||e>=t.retryDelays.length||i.originalRequest==null)return!1;if(t&&typeof t.onShouldRetry==\"function\")return t.onShouldRetry(i,e,t);var r=i.originalResponse?i.originalResponse.getStatus():0;return(!en(r,400)||r===409||r===423)&&n5()}n(f0,\"shouldRetry\");function m0(i,e){return new y0.default(e,i).toString()}n(m0,\"resolveUrl\");function a5(i,e){for(var t=Math.floor(i/e),r=[],s=0;s<e;s++)r.push({start:t*s,end:t*(s+1)});return r[e-1].end=i,r}n(a5,\"splitSizeIntoParts\");v0.defaultOptions=o5;var Ju=v0;function l5(i,e){if(!(i instanceof e))throw new TypeError(\"Cannot call a class as a function\")}n(l5,\"_classCallCheck\");function b0(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}n(b0,\"_defineProperties\");function u5(i,e,t){return e&&b0(i.prototype,e),t&&b0(i,t),Object.defineProperty(i,\"prototype\",{writable:!1}),i}n(u5,\"_createClass\");var w0=function(){function i(){l5(this,i)}return n(i,\"NoopUrlStorage\"),u5(i,[{key:\"listAllUploads\",value:n(function(){return Promise.resolve([])},\"listAllUploads\")},{key:\"findUploadsByFingerprint\",value:n(function(t){return Promise.resolve([])},\"findUploadsByFingerprint\")},{key:\"removeUpload\",value:n(function(t){return Promise.resolve()},\"removeUpload\")},{key:\"addUpload\",value:n(function(t,r){return Promise.resolve(null)},\"addUpload\")}]),i}();function h5(i,e){if(!(i instanceof e))throw new TypeError(\"Cannot call a class as a function\")}n(h5,\"_classCallCheck\");function S0(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}n(S0,\"_defineProperties\");function d5(i,e,t){return e&&S0(i.prototype,e),t&&S0(i,t),Object.defineProperty(i,\"prototype\",{writable:!1}),i}n(d5,\"_createClass\");var Jc=!1;try{Jc=\"localStorage\"in window,Qc=\"tusSupport\",localStorage.setItem(Qc,localStorage.getItem(Qc))}catch(i){if(i.code===i.SECURITY_ERR||i.code===i.QUOTA_EXCEEDED_ERR)Jc=!1;else throw i}var Qc,P0=Jc,_0=function(){function i(){h5(this,i)}return n(i,\"WebStorageUrlStorage\"),d5(i,[{key:\"findAllUploads\",value:n(function(){var t=this._findEntries(\"tus::\");return Promise.resolve(t)},\"findAllUploads\")},{key:\"findUploadsByFingerprint\",value:n(function(t){var r=this._findEntries(\"tus::\".concat(t,\"::\"));return Promise.resolve(r)},\"findUploadsByFingerprint\")},{key:\"removeUpload\",value:n(function(t){return localStorage.removeItem(t),Promise.resolve()},\"removeUpload\")},{key:\"addUpload\",value:n(function(t,r){var s=Math.round(Math.random()*1e12),o=\"tus::\".concat(t,\"::\").concat(s);return localStorage.setItem(o,JSON.stringify(r)),Promise.resolve(o)},\"addUpload\")},{key:\"_findEntries\",value:n(function(t){for(var r=[],s=0;s<localStorage.length;s++){var o=localStorage.key(s);if(o.indexOf(t)===0)try{var a=JSON.parse(localStorage.getItem(o));a.urlStorageKey=o,r.push(a)}catch{}}return r},\"_findEntries\")}]),i}();function Zc(i,e){if(!(i instanceof e))throw new TypeError(\"Cannot call a class as a function\")}n(Zc,\"_classCallCheck\");function x0(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}n(x0,\"_defineProperties\");function ep(i,e,t){return e&&x0(i.prototype,e),t&&x0(i,t),Object.defineProperty(i,\"prototype\",{writable:!1}),i}n(ep,\"_createClass\");var F0=function(){function i(){Zc(this,i)}return n(i,\"XHRHttpStack\"),ep(i,[{key:\"createRequest\",value:n(function(t,r){return new c5(t,r)},\"createRequest\")},{key:\"getName\",value:n(function(){return\"XHRHttpStack\"},\"getName\")}]),i}();var c5=function(){function i(e,t){Zc(this,i),this._xhr=new XMLHttpRequest,this._xhr.open(e,t,!0),this._method=e,this._url=t,this._headers={}}return n(i,\"Request\"),ep(i,[{key:\"getMethod\",value:n(function(){return this._method},\"getMethod\")},{key:\"getURL\",value:n(function(){return this._url},\"getURL\")},{key:\"setHeader\",value:n(function(t,r){this._xhr.setRequestHeader(t,r),this._headers[t]=r},\"setHeader\")},{key:\"getHeader\",value:n(function(t){return this._headers[t]},\"getHeader\")},{key:\"setProgressHandler\",value:n(function(t){\"upload\"in this._xhr&&(this._xhr.upload.onprogress=function(r){r.lengthComputable&&t(r.loaded)})},\"setProgressHandler\")},{key:\"send\",value:n(function(){var t=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new Promise(function(s,o){t._xhr.onload=function(){s(new p5(t._xhr))},t._xhr.onerror=function(a){o(a)},t._xhr.send(r)})},\"send\")},{key:\"abort\",value:n(function(){return this._xhr.abort(),Promise.resolve()},\"abort\")},{key:\"getUnderlyingObject\",value:n(function(){return this._xhr},\"getUnderlyingObject\")}]),i}(),p5=function(){function i(e){Zc(this,i),this._xhr=e}return n(i,\"Response\"),ep(i,[{key:\"getStatus\",value:n(function(){return this._xhr.status},\"getStatus\")},{key:\"getHeader\",value:n(function(t){return this._xhr.getResponseHeader(t)},\"getHeader\")},{key:\"getBody\",value:n(function(){return this._xhr.responseText},\"getBody\")},{key:\"getUnderlyingObject\",value:n(function(){return this._xhr},\"getUnderlyingObject\")}]),i}();var f5=n(function(){return typeof navigator<\"u\"&&typeof navigator.product==\"string\"&&navigator.product.toLowerCase()===\"reactnative\"},\"isReactNative\"),Zu=f5;function tp(i){return new Promise(function(e,t){var r=new XMLHttpRequest;r.responseType=\"blob\",r.onload=function(){var s=r.response;e(s)},r.onerror=function(s){t(s)},r.open(\"GET\",i),r.send()})}n(tp,\"uriToBlob\");var m5=n(function(){return typeof window<\"u\"&&(typeof window.PhoneGap<\"u\"||typeof window.Cordova<\"u\"||typeof window.cordova<\"u\")},\"isCordova\"),E0=m5;function ip(i){return new Promise(function(e,t){var r=new FileReader;r.onload=function(){var s=new Uint8Array(r.result);e({value:s})},r.onerror=function(s){t(s)},r.readAsArrayBuffer(i)})}n(ip,\"readAsByteArray\");function g5(i,e){if(!(i instanceof e))throw new TypeError(\"Cannot call a class as a function\")}n(g5,\"_classCallCheck\");function O0(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}n(O0,\"_defineProperties\");function y5(i,e,t){return e&&O0(i.prototype,e),t&&O0(i,t),Object.defineProperty(i,\"prototype\",{writable:!1}),i}n(y5,\"_createClass\");var rp=function(){function i(e){g5(this,i),this._file=e,this.size=e.size}return n(i,\"FileSource\"),y5(i,[{key:\"slice\",value:n(function(t,r){if(E0())return ip(this._file.slice(t,r));var s=this._file.slice(t,r);return Promise.resolve({value:s})},\"slice\")},{key:\"close\",value:n(function(){},\"close\")}]),i}();function v5(i,e){if(!(i instanceof e))throw new TypeError(\"Cannot call a class as a function\")}n(v5,\"_classCallCheck\");function C0(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}n(C0,\"_defineProperties\");function b5(i,e,t){return e&&C0(i.prototype,e),t&&C0(i,t),Object.defineProperty(i,\"prototype\",{writable:!1}),i}n(b5,\"_createClass\");function T0(i){return i===void 0?0:i.size!==void 0?i.size:i.length}n(T0,\"len\");function w5(i,e){if(i.concat)return i.concat(e);if(i instanceof Blob)return new Blob([i,e],{type:i.type});if(i.set){var t=new i.constructor(i.length+e.length);return t.set(i),t.set(e,i.length),t}throw new Error(\"Unknown data type\")}n(w5,\"concat\");var A0=function(){function i(e){v5(this,i),this._buffer=void 0,this._bufferOffset=0,this._reader=e,this._done=!1}return n(i,\"StreamSource\"),b5(i,[{key:\"slice\",value:n(function(t,r){return t<this._bufferOffset?Promise.reject(new Error(\"Requested data is before the reader's current offset\")):this._readUntilEnoughDataOrDone(t,r)},\"slice\")},{key:\"_readUntilEnoughDataOrDone\",value:n(function(t,r){var s=this,o=r<=this._bufferOffset+T0(this._buffer);if(this._done||o){var a=this._getDataFromBuffer(t,r),l=a==null?this._done:!1;return Promise.resolve({value:a,done:l})}return this._reader.read().then(function(h){var p=h.value,d=h.done;return d?s._done=!0:s._buffer===void 0?s._buffer=p:s._buffer=w5(s._buffer,p),s._readUntilEnoughDataOrDone(t,r)})},\"_readUntilEnoughDataOrDone\")},{key:\"_getDataFromBuffer\",value:n(function(t,r){t>this._bufferOffset&&(this._buffer=this._buffer.slice(t-this._bufferOffset),this._bufferOffset=t);var s=T0(this._buffer)===0;return this._done&&s?null:this._buffer.slice(0,r-t)},\"_getDataFromBuffer\")},{key:\"close\",value:n(function(){this._reader.cancel&&this._reader.cancel()},\"close\")}]),i}();function S5(i,e){if(!(i instanceof e))throw new TypeError(\"Cannot call a class as a function\")}n(S5,\"_classCallCheck\");function R0(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}n(R0,\"_defineProperties\");function P5(i,e,t){return e&&R0(i.prototype,e),t&&R0(i,t),Object.defineProperty(i,\"prototype\",{writable:!1}),i}n(P5,\"_createClass\");var U0=function(){function i(){S5(this,i)}return n(i,\"FileReader\"),P5(i,[{key:\"openFile\",value:n(function(t,r){return Zu()&&t&&typeof t.uri<\"u\"?tp(t.uri).then(function(s){return new rp(s)}).catch(function(s){throw new Error(\"tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. \".concat(s))}):typeof t.slice==\"function\"&&typeof t.size<\"u\"?Promise.resolve(new rp(t)):typeof t.read==\"function\"?(r=Number(r),Number.isFinite(r)?Promise.resolve(new A0(t,r)):Promise.reject(new Error(\"cannot create source for stream without a finite value for the `chunkSize` option\"))):Promise.reject(new Error(\"source object may only be an instance of File, Blob, or Reader in this environment\"))},\"openFile\")}]),i}();function sp(i,e){return Zu()?Promise.resolve(_5(i,e)):Promise.resolve([\"tus-br\",i.name,i.type,i.size,i.lastModified,e.endpoint].join(\"-\"))}n(sp,\"fingerprint\");function _5(i,e){var t=i.exif?x5(JSON.stringify(i.exif)):\"noexif\";return[\"tus-rn\",i.name||\"noname\",i.size||\"nosize\",t,e.endpoint].join(\"/\")}n(_5,\"reactNativeFingerprint\");function x5(i){var e=0;if(i.length===0)return e;for(var t=0;t<i.length;t++){var r=i.charCodeAt(t);e=(e<<5)-e+r,e&=e}return e}n(x5,\"hashCode\");function op(i){\"@babel/helpers - typeof\";return op=typeof Symbol==\"function\"&&typeof Symbol.iterator==\"symbol\"?function(e){return typeof e}:function(e){return e&&typeof Symbol==\"function\"&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},op(i)}n(op,\"_typeof\");function F5(i,e){if(!(i instanceof e))throw new TypeError(\"Cannot call a class as a function\")}n(F5,\"_classCallCheck\");function k0(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}n(k0,\"_defineProperties\");function E5(i,e,t){return e&&k0(i.prototype,e),t&&k0(i,t),Object.defineProperty(i,\"prototype\",{writable:!1}),i}n(E5,\"_createClass\");function O5(i,e){if(typeof e!=\"function\"&&e!==null)throw new TypeError(\"Super expression must either be null or a function\");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,\"prototype\",{writable:!1}),e&&np(i,e)}n(O5,\"_inherits\");function np(i,e){return np=Object.setPrototypeOf?Object.setPrototypeOf.bind():n(function(r,s){return r.__proto__=s,r},\"_setPrototypeOf\"),np(i,e)}n(np,\"_setPrototypeOf\");function C5(i){var e=R5();return n(function(){var r=eh(i),s;if(e){var o=eh(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return T5(this,s)},\"_createSuperInternal\")}n(C5,\"_createSuper\");function T5(i,e){if(e&&(op(e)===\"object\"||typeof e==\"function\"))return e;if(e!==void 0)throw new TypeError(\"Derived constructors may only return object or undefined\");return A5(i)}n(T5,\"_possibleConstructorReturn\");function A5(i){if(i===void 0)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return i}n(A5,\"_assertThisInitialized\");function R5(){if(typeof Reflect>\"u\"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy==\"function\")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}n(R5,\"_isNativeReflectConstruct\");function eh(i){return eh=Object.setPrototypeOf?Object.getPrototypeOf.bind():n(function(t){return t.__proto__||Object.getPrototypeOf(t)},\"_getPrototypeOf\"),eh(i)}n(eh,\"_getPrototypeOf\");function D0(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,r)}return t}n(D0,\"ownKeys\");function tn(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?D0(Object(t),!0).forEach(function(r){U5(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):D0(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}n(tn,\"_objectSpread\");function U5(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}n(U5,\"_defineProperty\");var th=tn(tn({},Ju.defaultOptions),{},{httpStack:new F0,fileReader:new U0,urlStorage:P0?new _0:new w0,fingerprint:sp}),N0=function(i){O5(t,i);var e=C5(t);function t(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return F5(this,t),s=tn(tn({},th),s),e.call(this,r,s)}return n(t,\"Upload\"),E5(t,null,[{key:\"terminate\",value:n(function(s,o,a){return o=tn(tn({},th),o),Ju.terminate(s,o,a)},\"terminate\")}]),t}(Ju),M0=window,k5=M0.XMLHttpRequest,I0=M0.Blob,fI=k5&&I0&&typeof I0.prototype.slice==\"function\";function D5(){return typeof window<\"u\"&&(typeof window.PhoneGap<\"u\"||typeof window.Cordova<\"u\"||typeof window.cordova<\"u\")}n(D5,\"isCordova\");function I5(){return typeof navigator<\"u\"&&typeof navigator.product==\"string\"&&navigator.product.toLowerCase()===\"reactnative\"}n(I5,\"isReactNative\");function ap(i){return(e,t)=>{if(D5()||I5())return th.fingerprint(e,t);let r=[\"tus\",i.id,t.endpoint].join(\"-\");return Promise.resolve(r)}}n(ap,\"getFingerprint\");function ao(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(ao,\"_classPrivateFieldLooseBase\");var N5=0;function Za(i){return\"__private_\"+N5+++\"_\"+i}n(Za,\"_classPrivateFieldLooseKey\");var M5={version:\"3.4.0\"},B0={endpoint:\"\",uploadUrl:null,metadata:{},uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,overridePatchMethod:!1,headers:{},addRequestId:!1,chunkSize:1/0,retryDelays:[100,1e3,3e3,5e3],parallelUploads:1,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1},Ja=Za(\"retryDelayIterator\"),up=Za(\"uploadLocalFile\"),hp=Za(\"getCompanionClientArgs\"),lp=Za(\"uploadFiles\"),Qa=Za(\"handleUpload\"),or=class extends ve{constructor(e,t){var r,s;super(e,t),Object.defineProperty(this,lp,{value:z5}),Object.defineProperty(this,hp,{value:B5}),Object.defineProperty(this,up,{value:L5}),Object.defineProperty(this,Ja,{writable:!0,value:void 0}),Object.defineProperty(this,Qa,{writable:!0,value:async a=>{if(a.length===0){this.uppy.log(\"[Tus] No files to upload\");return}this.opts.limit===0&&this.uppy.log(\"[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0\",\"warning\"),this.uppy.log(\"[Tus] Uploading...\");let l=this.uppy.getFilesByIds(a);await ao(this,lp)[lp](l)}}),this.type=\"uploader\",this.id=this.opts.id||\"Tus\",this.title=\"Tus\";let o={limit:20,retryDelays:B0.retryDelays,withCredentials:!1};if(this.opts={...o,...t},t?.allowedMetaFields===void 0&&\"metaFields\"in this.opts)throw new Error(\"The `metaFields` option has been renamed to `allowedMetaFields`.\");if(\"autoRetry\"in t)throw new Error(\"The `autoRetry` option was deprecated and has been removed.\");this.requests=(r=this.opts.rateLimitedQueue)!=null?r:new Mt(this.opts.limit),ao(this,Ja)[Ja]=(s=this.opts.retryDelays)==null?void 0:s.values(),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null),this.handleResetProgress=this.handleResetProgress.bind(this)}handleResetProgress(){let e={...this.uppy.getState().files};Object.keys(e).forEach(t=>{if(e[t].tus&&e[t].tus.uploadUrl){let r={...e[t].tus};delete r.uploadUrl,e[t]={...e[t],tus:r}}}),this.uppy.setState({files:e})}resetUploaderReferences(e,t){if(t===void 0&&(t={}),this.uploaders[e]){let r=this.uploaders[e];r.abort(),t.abort&&r.abort(!0),this.uploaders[e]=null}this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null)}onReceiveUploadUrl(e,t){let r=this.uppy.getFile(e.id);r&&(!r.tus||r.tus.uploadUrl!==t)&&(this.uppy.log(\"[Tus] Storing upload url\"),this.uppy.setFileState(r.id,{tus:{...r.tus,uploadUrl:t}}))}install(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!0}}),this.uppy.addUploader(ao(this,Qa)[Qa]),this.uppy.on(\"reset-progress\",this.handleResetProgress)}uninstall(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!1}}),this.uppy.removeUploader(ao(this,Qa)[Qa])}};n(or,\"Tus\");function L5(i){var e=this;return this.resetUploaderReferences(i.id),new Promise((t,r)=>{let s,o,a,l={...this.opts,...i.tus||{}};typeof l.headers==\"function\"&&(l.headers=l.headers(i));let h={...B0,...l};h.fingerprint=ap(i),h.onBeforeRequest=S=>{let E=S.getUnderlyingObject();E.withCredentials=!!l.withCredentials;let x;if(typeof l.onBeforeRequest==\"function\"&&(x=l.onBeforeRequest(S,i)),Ct(s,\"shouldBeRequeued\")){if(!s.shouldBeRequeued)return Promise.reject();let F,U=new Promise(j=>{F=j});return s=this.requests.run(()=>(i.isPaused&&s.abort(),F(),()=>{})),Promise.all([U,x])}return x},h.onError=S=>{var E;this.uppy.log(S);let x=S.originalRequest?S.originalRequest.getUnderlyingObject():null;so(x)&&(S=new Pi(S,x)),this.resetUploaderReferences(i.id),(E=s)==null||E.abort(),this.uppy.emit(\"upload-error\",i,S),typeof l.onError==\"function\"&&l.onError(S),r(S)},h.onProgress=(S,E)=>{this.onReceiveUploadUrl(i,a.url),typeof l.onProgress==\"function\"&&l.onProgress(S,E),this.uppy.emit(\"upload-progress\",i,{uploader:this,bytesUploaded:S,bytesTotal:E})},h.onSuccess=()=>{let S={uploadURL:a.url};this.resetUploaderReferences(i.id),s.done(),this.uppy.emit(\"upload-success\",i,S),a.url&&this.uppy.log(`Download ${a.file.name} from ${a.url}`),typeof l.onSuccess==\"function\"&&l.onSuccess(),t(a)};let p=n(S=>{var E;let x=S==null||(E=S.originalResponse)==null?void 0:E.getStatus();if(x===429){if(!this.requests.isPaused){var F;let U=(F=ao(this,Ja)[Ja])==null?void 0:F.next();if(U==null||U.done)return!1;this.requests.rateLimit(U.value)}}else{if(x>400&&x<500&&x!==409&&x!==423)return!1;typeof navigator<\"u\"&&navigator.onLine===!1&&(this.requests.isPaused||(this.requests.pause(),window.addEventListener(\"online\",()=>{this.requests.resume()},{once:!0})))}return s.abort(),s={shouldBeRequeued:!0,abort(){this.shouldBeRequeued=!1},done(){throw new Error(\"Cannot mark a queued request as done: this indicates a bug\")},fn(){throw new Error(\"Cannot run a queued request: this indicates a bug\")}},!0},\"defaultOnShouldRetry\");l.onShouldRetry!=null?h.onShouldRetry=function(){for(var S=arguments.length,E=new Array(S),x=0;x<S;x++)E[x]=arguments[x];return l.onShouldRetry(...E,p)}:h.onShouldRetry=p;let d=n((S,E,x)=>{Ct(S,E)&&!Ct(S,x)&&(S[x]=S[E])},\"copyProp\"),f={};(Array.isArray(l.allowedMetaFields)?l.allowedMetaFields:Object.keys(i.meta)).forEach(S=>{f[S]=i.meta[S]}),d(f,\"type\",\"filetype\"),d(f,\"name\",\"filename\"),h.metadata=f,a=new N0(i.data,h),this.uploaders[i.id]=a;let b=new mi(this.uppy);this.uploaderEvents[i.id]=b,o=n(()=>(i.isPaused||a.start(),()=>{}),\"qRequest\"),a.findPreviousUploads().then(S=>{let E=S[0];E&&(this.uppy.log(`[Tus] Resuming upload of ${i.id} started at ${E.creationTime}`),a.resumeFromPreviousUpload(E))}),s=this.requests.run(o),b.onFileRemove(i.id,S=>{s.abort(),this.resetUploaderReferences(i.id,{abort:!!a.url}),t(`upload ${S} was removed`)}),b.onPause(i.id,S=>{s.abort(),S?a.abort():s=this.requests.run(o)}),b.onPauseAll(i.id,()=>{s.abort(),a.abort()}),b.onCancelAll(i.id,function(S){let{reason:E}=S===void 0?{}:S;E===\"user\"&&(s.abort(),e.resetUploaderReferences(i.id,{abort:!!a.url})),t(`upload ${i.id} was canceled`)}),b.onResumeAll(i.id,()=>{s.abort(),i.error&&a.abort(),s=this.requests.run(o)})}).catch(t=>{throw this.uppy.emit(\"upload-error\",i,t),t})}n(L5,\"_uploadLocalFile2\");function B5(i){let e={...this.opts};return i.tus&&Object.assign(e,i.tus),{...i.remote.body,endpoint:e.endpoint,uploadUrl:e.uploadUrl,protocol:\"tus\",size:i.data.size,headers:e.headers,metadata:i.meta}}n(B5,\"_getCompanionClientArgs2\");async function z5(i){let e=hs(i),t=ds(e);this.uppy.emit(\"upload-start\",t),await Promise.allSettled(e.map((r,s)=>{let o=s+1,a=i.length;if(r.isRemote){let l=n(()=>this.requests,\"getQueue\"),h=new AbortController,p=n(f=>{f.id===r.id&&h.abort()},\"removedHandler\");this.uppy.on(\"file-removed\",p);let d=r.remote.requestClient.uploadRemoteFile(r,ao(this,hp)[hp](r),{signal:h.signal,getQueue:l});return this.requests.wrapSyncFunction(()=>{this.uppy.off(\"file-removed\",p)},{priority:-1})(),d}return ao(this,up)[up](r,o,a)}))}n(z5,\"_uploadFiles2\");or.VERSION=M5.version;var j0=de(cp(),1);function ce(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(ce,\"_classPrivateFieldLooseBase\");var H5=0;function nr(i){return\"__private_\"+H5+++\"_\"+i}n(nr,\"_classPrivateFieldLooseKey\");var $5=\"ASSEMBLY_UPLOADING\",gp=\"ASSEMBLY_EXECUTING\",yp=\"ASSEMBLY_COMPLETED\",z0=[$5,gp,yp];function ih(i,e){return z0.indexOf(i)>=z0.indexOf(e)}n(ih,\"isStatus\");var uo=nr(\"rateLimitedQueue\"),el=nr(\"fetchWithNetworkError\"),lo=nr(\"previousFetchStatusStillPending\"),qe=nr(\"sse\"),vp=nr(\"onFinished\"),pp=nr(\"connectServerSentEvents\"),ki=nr(\"onError\"),fp=nr(\"beginPolling\"),zr=nr(\"fetchStatus\"),mp=nr(\"diffStatus\"),rh=class extends j0.default{constructor(e,t){super(),Object.defineProperty(this,mp,{value:X5}),Object.defineProperty(this,zr,{value:K5}),Object.defineProperty(this,fp,{value:G5}),Object.defineProperty(this,ki,{value:W5}),Object.defineProperty(this,pp,{value:V5}),Object.defineProperty(this,vp,{value:q5}),Object.defineProperty(this,uo,{writable:!0,value:void 0}),Object.defineProperty(this,el,{writable:!0,value:void 0}),Object.defineProperty(this,lo,{writable:!0,value:!1}),Object.defineProperty(this,qe,{writable:!0,value:void 0}),this.status=e,this.pollInterval=null,this.closed=!1,ce(this,uo)[uo]=t,ce(this,el)[el]=t.wrapPromiseFunction(_s)}connect(){ce(this,pp)[pp](),ce(this,fp)[fp]()}update(){return ce(this,zr)[zr]({diff:!0})}updateStatus(e){ce(this,mp)[mp](this.status,e),this.status=e}close(){this.closed=!0,ce(this,qe)[qe]&&(ce(this,qe)[qe].close(),ce(this,qe)[qe]=null),clearInterval(this.pollInterval),this.pollInterval=null}};n(rh,\"TransloaditAssembly\");function q5(){this.emit(\"finished\"),this.close()}n(q5,\"_onFinished2\");function V5(){ce(this,qe)[qe]=new EventSource(`${this.status.websocket_url}?assembly=${this.status.assembly_id}`),ce(this,qe)[qe].addEventListener(\"open\",()=>{this.socket&&(this.socket.disconnect(),this.socket=null),clearInterval(this.pollInterval),this.pollInterval=null}),ce(this,qe)[qe].addEventListener(\"message\",i=>{i.data===\"assembly_finished\"&&ce(this,vp)[vp](),i.data===\"assembly_uploading_finished\"&&this.emit(\"executing\"),i.data===\"assembly_upload_meta_data_extracted\"&&(this.emit(\"metadata\"),ce(this,zr)[zr]({diff:!1}))}),ce(this,qe)[qe].addEventListener(\"assembly_upload_finished\",i=>{let e=JSON.parse(i.data);this.emit(\"upload\",e),this.status.uploads.push(e)}),ce(this,qe)[qe].addEventListener(\"assembly_result_finished\",i=>{var e,t;let[r,s]=JSON.parse(i.data);this.emit(\"result\",r,s),((t=(e=this.status.results)[r])!=null?t:e[r]=[]).push(s)}),ce(this,qe)[qe].addEventListener(\"assembly_execution_progress\",i=>{let e=JSON.parse(i.data);this.emit(\"execution-progress\",e)}),ce(this,qe)[qe].addEventListener(\"assembly_error\",i=>{try{ce(this,ki)[ki](JSON.parse(i.data))}catch{ce(this,ki)[ki]({msg:i.data})}ce(this,zr)[zr]({diff:!1})})}n(V5,\"_connectServerSentEvents2\");function W5(i){this.emit(\"error\",Object.assign(new Error(i.msg),i)),this.close()}n(W5,\"_onError2\");function G5(){this.pollInterval=setInterval(()=>{ce(this,zr)[zr]()},2e3)}n(G5,\"_beginPolling2\");async function K5(i){let{diff:e=!0}=i===void 0?{}:i;if(!(this.closed||ce(this,uo)[uo].isPaused||ce(this,lo)[lo]))try{ce(this,lo)[lo]=!0;let t=await ce(this,el)[el](this.status.assembly_ssl_url);if(ce(this,lo)[lo]=!1,this.closed)return;if(t.status===429){ce(this,uo)[uo].rateLimit(2e3);return}if(!t.ok){ce(this,ki)[ki](new Pi(t.statusText));return}let r=await t.json();if(this.closed)return;this.emit(\"status\",r),e?this.updateStatus(r):this.status=r}catch(t){ce(this,ki)[ki](t)}}n(K5,\"_fetchStatus2\");function X5(i,e){let t=i.ok,r=e.ok;if(e.error&&!i.error)return ce(this,ki)[ki](e);let s=ih(r,gp)&&!ih(t,gp);s&&this.emit(\"executing\"),Object.keys(e.uploads).filter(o=>!Ct(i.uploads,o)).forEach(o=>{this.emit(\"upload\",e.uploads[o])}),s&&this.emit(\"metadata\"),Object.keys(e.results).forEach(o=>{let a=e.results[o],l=i.results[o];a.filter(h=>!l||!l.some(p=>p.id===h.id)).forEach(h=>{this.emit(\"result\",o,h)})}),ih(r,yp)&&!ih(t,yp)&&this.emit(\"finished\")}n(X5,\"_diffStatus2\");var bp=rh;function Ne(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(Ne,\"_classPrivateFieldLooseBase\");var Y5=0;function sh(i){return\"__private_\"+Y5+++\"_\"+i}n(sh,\"_classPrivateFieldLooseKey\");var H0=\"/assemblies\",Bt=sh(\"headers\"),tl=sh(\"fetchWithNetworkError\"),bt=sh(\"fetchJSON\"),ai=sh(\"reportError\"),rn=class{constructor(e){e===void 0&&(e={}),Object.defineProperty(this,bt,{value:Q5}),Object.defineProperty(this,Bt,{writable:!0,value:{}}),Object.defineProperty(this,tl,{writable:!0,value:void 0}),Object.defineProperty(this,ai,{writable:!0,value:(t,r)=>{if(this.opts.errorReporting===!1)throw t;let s={type:r.type};throw r.assembly&&(s.assembly=r.assembly.assembly_id,s.instance=r.assembly.instance),r.url&&(s.endpoint=r.url),this.submitError(t,s).catch(()=>{}),t}}),this.opts=e,this.opts.client!=null&&(Ne(this,Bt)[Bt][\"Transloadit-Client\"]=this.opts.client),Ne(this,tl)[tl]=this.opts.rateLimitedQueue.wrapPromiseFunction(_s)}createAssembly(e){let{params:t,fields:r,signature:s,expectedFiles:o}=e,a=new FormData;a.append(\"params\",typeof t==\"string\"?t:JSON.stringify(t)),s&&a.append(\"signature\",s),Object.keys(r).forEach(h=>{a.append(h,r[h])}),a.append(\"num_expected_upload_files\",o);let l=new URL(H0,`${this.opts.service}`).href;return Ne(this,bt)[bt](l,{method:\"POST\",headers:Ne(this,Bt)[Bt],body:a}).catch(h=>Ne(this,ai)[ai](h,{url:l,type:\"API_ERROR\"}))}reserveFile(e,t){let r=encodeURIComponent(t.size),s=`${e.assembly_ssl_url}/reserve_file?size=${r}`;return Ne(this,bt)[bt](s,{method:\"POST\",headers:Ne(this,Bt)[Bt]}).catch(o=>Ne(this,ai)[ai](o,{assembly:e,file:t,url:s,type:\"API_ERROR\"}))}addFile(e,t){if(!t.uploadURL)return Promise.reject(new Error(\"File does not have an `uploadURL`.\"));let r=encodeURIComponent(t.size),s=encodeURIComponent(t.uploadURL),o=encodeURIComponent(t.name),l=`size=${r}&filename=${o}&fieldname=file&s3Url=${s}`,h=`${e.assembly_ssl_url}/add_file?${l}`;return Ne(this,bt)[bt](h,{method:\"POST\",headers:Ne(this,Bt)[Bt]}).catch(p=>Ne(this,ai)[ai](p,{assembly:e,file:t,url:h,type:\"API_ERROR\"}))}updateNumberOfFilesInAssembly(e,t){let r=new URL(e.assembly_ssl_url);r.pathname=\"/update_assemblies\";let s=JSON.stringify({assembly_updates:[{assembly_id:e.assembly_id,num_expected_upload_files:t}]});return Ne(this,bt)[bt](r,{method:\"POST\",headers:Ne(this,Bt)[Bt],body:s}).catch(o=>Ne(this,ai)[ai](o,{url:r,type:\"API_ERROR\"}))}cancelAssembly(e){let t=e.assembly_ssl_url;return Ne(this,bt)[bt](t,{method:\"DELETE\",headers:Ne(this,Bt)[Bt]}).catch(r=>Ne(this,ai)[ai](r,{url:t,type:\"API_ERROR\"}))}getAssemblyStatus(e){return Ne(this,bt)[bt](e,{headers:Ne(this,Bt)[Bt]}).catch(t=>Ne(this,ai)[ai](t,{url:e,type:\"STATUS_ERROR\"}))}submitError(e,t){let{endpoint:r,instance:s,assembly:o}=t===void 0?{}:t,a=e.details?`${e.message} (${e.details})`:e.message;return Ne(this,bt)[bt](\"https://transloaditstatus.com/client_error\",{method:\"POST\",body:JSON.stringify({endpoint:r,instance:s,assembly_id:o,agent:typeof navigator<\"u\"?navigator.userAgent:\"\",client:this.opts.client,error:a})})}};n(rn,\"Client\");function Q5(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return Ne(this,tl)[tl](...e).then(r=>{if(r.status===429)return this.opts.rateLimitedQueue.rateLimit(2e3),Ne(this,bt)[bt](...e);if(!r.ok){let s=new Error(r.statusText);return s.statusCode=r.status,`${e[0]}`.endsWith(H0)?r.json().then(o=>{if(!o.error)throw s;let a=new Error(o.error);throw a.details=o.message,a.assembly=o,o.assembly_id&&(a.details+=` Assembly ID: ${o.assembly_id}`),a},o=>{throw o.cause=s,o}):Promise.reject(s)}return r.json()})}n(Q5,\"_fetchJSON2\");function wp(i){if(i==null)throw new Error(\"Transloadit: The `params` option is required.\");if(typeof i==\"string\")try{i=JSON.parse(i)}catch(e){throw new vr(\"Transloadit: The `params` option is a malformed JSON string.\",{cause:e})}if(!i.auth||!i.auth.key)throw new Error(\"Transloadit: The `params.auth.key` option is required. You can find your Transloadit API key at https://transloadit.com/c/template-credentials\")}n(wp,\"validateParams\");function J5(i){let e=Object.create(null);for(let{fileIDs:t,options:r}of i.filter(Boolean)){let s=JSON.stringify(r);s in e?e[s].fileIDArrays.push(t):e[s]={options:r,fileIDArrays:[t]}}return Object.values(e).map(t=>{let{options:r,fileIDArrays:s}=t;return{options:r,fileIDs:s.flat(1)}})}n(J5,\"dedupe\");async function $0(i,e){let t=typeof e.assemblyOptions==\"function\"?await e.assemblyOptions(i,e):e.assemblyOptions;wp(t.params);let{fields:r}=t;return Array.isArray(r)?t.fields=i==null?{}:Object.fromEntries(r.map(s=>[s,i.meta[s]])):r==null&&(t.fields={}),t}n($0,\"getAssemblyOptions\");var oh=class{constructor(e,t){this.files=e,this.opts=t}async build(){let e=this.opts;if(this.files.length>0)return Promise.all(this.files.map(async t=>{if(t==null)return;let r=await $0(t,e);if(t!=null)return{fileIDs:[t.id],options:r}})).then(J5);if(e.alwaysRunAssembly){let t=await $0(null,e);return[{fileIDs:[],options:t}]}return[]}};n(oh,\"AssemblyOptions\");var q0=oh;var V0=de(cp(),1);function se(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(se,\"_classPrivateFieldLooseBase\");var Z5=0;function li(i){return\"__private_\"+Z5+++\"_\"+i}n(li,\"_classPrivateFieldLooseKey\");var il=li(\"assemblyIDs\"),Sp=li(\"reject\"),co=li(\"remaining\"),rl=li(\"resolve\"),Oe=li(\"uppy\"),jr=li(\"watching\"),sl=li(\"onAssemblyComplete\"),ol=li(\"onAssemblyCancel\"),po=li(\"onAssemblyError\"),nl=li(\"onImportError\"),ho=li(\"checkAllComplete\"),_p=li(\"removeListeners\"),Pp=li(\"addListeners\"),nh=class extends V0.default{constructor(e,t){super(),Object.defineProperty(this,Pp,{value:rx}),Object.defineProperty(this,_p,{value:ix}),Object.defineProperty(this,ho,{value:tx}),Object.defineProperty(this,jr,{value:ex}),Object.defineProperty(this,il,{writable:!0,value:void 0}),Object.defineProperty(this,Sp,{writable:!0,value:void 0}),Object.defineProperty(this,co,{writable:!0,value:void 0}),Object.defineProperty(this,rl,{writable:!0,value:void 0}),Object.defineProperty(this,Oe,{writable:!0,value:void 0}),Object.defineProperty(this,sl,{writable:!0,value:r=>{se(this,jr)[jr](r.assembly_id)&&(se(this,Oe)[Oe].log(`[Transloadit] AssemblyWatcher: Got Assembly finish ${r.assembly_id}`),this.emit(\"assembly-complete\",r.assembly_id),se(this,ho)[ho]())}}),Object.defineProperty(this,ol,{writable:!0,value:r=>{se(this,jr)[jr](r.assembly_id)&&se(this,ho)[ho]()}}),Object.defineProperty(this,po,{writable:!0,value:(r,s)=>{se(this,jr)[jr](r.assembly_id)&&(se(this,Oe)[Oe].log(`[Transloadit] AssemblyWatcher: Got Assembly error ${r.assembly_id}`),se(this,Oe)[Oe].log(s),this.emit(\"assembly-error\",r.assembly_id,s),se(this,ho)[ho]())}}),Object.defineProperty(this,nl,{writable:!0,value:(r,s,o)=>{se(this,jr)[jr](r.assembly_id)&&se(this,po)[po](r,o)}}),se(this,Oe)[Oe]=e,se(this,il)[il]=t,se(this,co)[co]=t.length,this.promise=new Promise((r,s)=>{se(this,rl)[rl]=r,se(this,Sp)[Sp]=s}),se(this,Pp)[Pp]()}};n(nh,\"TransloaditAssemblyWatcher\");function ex(i){return se(this,il)[il].indexOf(i)!==-1}n(ex,\"_watching2\");function tx(){se(this,co)[co]-=1,se(this,co)[co]===0&&(se(this,_p)[_p](),se(this,rl)[rl]())}n(tx,\"_checkAllComplete2\");function ix(){se(this,Oe)[Oe].off(\"transloadit:complete\",se(this,sl)[sl]),se(this,Oe)[Oe].off(\"transloadit:assembly-cancel\",se(this,ol)[ol]),se(this,Oe)[Oe].off(\"transloadit:assembly-error\",se(this,po)[po]),se(this,Oe)[Oe].off(\"transloadit:import-error\",se(this,nl)[nl])}n(ix,\"_removeListeners2\");function rx(){se(this,Oe)[Oe].on(\"transloadit:complete\",se(this,sl)[sl]),se(this,Oe)[Oe].on(\"transloadit:assembly-cancel\",se(this,ol)[ol]),se(this,Oe)[Oe].on(\"transloadit:assembly-error\",se(this,po)[po]),se(this,Oe)[Oe].on(\"transloadit:import-error\",se(this,nl)[nl])}n(rx,\"_addListeners2\");var W0=nh;var G0={strings:{creatingAssembly:\"Preparing upload...\",creatingAssemblyFailed:\"Transloadit: Could not create Assembly\",encoding:\"Encoding...\"}};function ae(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(ae,\"_classPrivateFieldLooseBase\");var sx=0;function Le(i){return\"__private_\"+sx+++\"_\"+i}n(Le,\"_classPrivateFieldLooseKey\");var ox={version:\"3.4.0\"},K0=n(i=>e=>{let t=new vr(\"Failed to send error to the client\",{cause:e});console.error(t,i)},\"sendErrorToConsole\"),Ip=\"https://api2.transloadit.com/companion\",Np=/\\.transloadit\\.com$/,nx=/https?:\\/\\/api2(?:-\\w+)?\\.transloadit\\.com\\/companion/,Di=Le(\"rateLimitedQueue\"),xp=Le(\"getClientVersion\"),Up=Le(\"attachAssemblyMetadata\"),Fp=Le(\"createAssembly\"),al=Le(\"createAssemblyWatcher\"),Ep=Le(\"shouldWaitAfterUpload\"),Op=Le(\"reserveFiles\"),ll=Le(\"onFileUploadURLAvailable\"),fl=Le(\"findFile\"),kp=Le(\"onFileUploadComplete\"),Dp=Le(\"onResult\"),pl=Le(\"onAssemblyFinished\"),ml=Le(\"cancelAssembly\"),Cp=Le(\"onCancelAll\"),Tp=Le(\"getPersistentData\"),Ap=Le(\"onRestored\"),ul=Le(\"connectAssembly\"),hl=Le(\"prepareUpload\"),fo=Le(\"afterUpload\"),dl=Le(\"closeAssemblyIfExists\"),cl=Le(\"onError\"),Rp=Le(\"onTusError\"),yi=class extends ve{constructor(e,t){var r,s,o,a;super(e,t),r=this,Object.defineProperty(this,ul,{value:vx}),Object.defineProperty(this,ml,{value:yx}),Object.defineProperty(this,pl,{value:gx}),Object.defineProperty(this,Dp,{value:mx}),Object.defineProperty(this,kp,{value:fx}),Object.defineProperty(this,fl,{value:px}),Object.defineProperty(this,Op,{value:cx}),Object.defineProperty(this,Ep,{value:dx}),Object.defineProperty(this,al,{value:hx}),Object.defineProperty(this,Fp,{value:ux}),Object.defineProperty(this,Up,{value:lx}),Object.defineProperty(this,xp,{value:ax}),Object.defineProperty(this,Di,{writable:!0,value:void 0}),Object.defineProperty(this,ll,{writable:!0,value:h=>{var p;let d=this.uppy.getFile(h.id);if(!(d!=null&&(p=d.transloadit)!=null&&p.assembly))return;let{assemblies:f}=this.getPluginState(),y=f[d.transloadit.assembly];this.client.addFile(y,d).catch(b=>{this.uppy.log(b),this.uppy.emit(\"transloadit:import-error\",y,d.id,b)})}}),Object.defineProperty(this,Cp,{writable:!0,value:async function(h){let{reason:p}=h===void 0?{}:h;try{if(p!==\"user\")return;let{uploadsAssemblies:d}=r.getPluginState(),y=Object.values(d).flat(1).map(b=>r.getAssembly(b));await Promise.all(y.map(b=>ae(r,ml)[ml](b)))}catch(d){r.uppy.log(d)}}}),Object.defineProperty(this,Tp,{writable:!0,value:h=>{let{assemblies:p,uploadsAssemblies:d}=this.getPluginState();h({[this.id]:{assemblies:p,uploadsAssemblies:d}})}}),Object.defineProperty(this,Ap,{writable:!0,value:h=>{let p=h&&h[this.id]?h[this.id]:{},d=p.assemblies||{},f=p.uploadsAssemblies||{};if(Object.keys(f).length===0)return;let y=n(E=>{let x={},F=[];for(let[U,j]of Object.entries(E)){j.uploads.forEach(J=>{let B=ae(this,fl)[fl](J);x[J.id]={id:B.id,assembly:U,uploadedFile:J}});let G=this.getPluginState();Object.keys(j.results).forEach(J=>{for(let B of j.results[J]){let z=G.files[B.original_id];B.localId=z?z.id:null,F.push({id:B.id,result:B,stepName:J,assembly:U})}})}this.setPluginState({assemblies:E,files:x,results:F,uploadsAssemblies:f})},\"restoreState\"),b=n(()=>{let{assemblies:E,uploadsAssemblies:x}=this.getPluginState();Object.keys(x).forEach(U=>{let j=x[U];ae(this,al)[al](j,U)}),Object.keys(E).forEach(U=>{let j=new bp(E[U],ae(this,Di)[Di]);ae(this,ul)[ul](j)})},\"restoreAssemblies\"),S=n(()=>{let{assemblies:E}=this.getPluginState();return Promise.all(Object.keys(E).map(x=>this.activeAssemblies[x].update()))},\"updateAssemblies\");this.restored=Promise.resolve().then(()=>(y(d),b(),S())),this.restored.then(()=>{this.restored=null})}}),Object.defineProperty(this,hl,{writable:!0,value:(h,p)=>{let f=h.map(E=>this.uppy.getFile(E)).filter(E=>E.error?!1:(this.uppy.emit(\"preprocess-progress\",E,{mode:\"indeterminate\",message:this.i18n(\"creatingAssembly\")}),!0)),y=n(async E=>{let{fileIDs:x,options:F}=E;try{let U=await ae(this,Fp)[Fp](x,p,F);return this.opts.importFromUploadURLs&&await ae(this,Op)[Op](U,x),x.forEach(j=>{let G=this.uppy.getFile(j);this.uppy.emit(\"preprocess-complete\",G)}),U}catch(U){throw x.forEach(j=>{let G=this.uppy.getFile(j);this.uppy.emit(\"preprocess-complete\",G),this.uppy.emit(\"upload-error\",G,U)}),U}},\"createAssembly\"),{uploadsAssemblies:b}=this.getPluginState();return this.setPluginState({uploadsAssemblies:{...b,[p]:[]}}),new q0(f,this.opts).build().then(E=>Promise.all(E.map(y))).then(E=>{let x=E.filter(Boolean),F=x.map(U=>U.status.assembly_id);return ae(this,al)[al](F,p),Promise.all(x.map(U=>ae(this,ul)[ul](U)))}).catch(E=>{throw f.forEach(x=>{this.uppy.emit(\"preprocess-complete\",x),this.uppy.emit(\"upload-error\",x,E)}),E})}}),Object.defineProperty(this,fo,{writable:!0,value:(h,p)=>{let d=h.map(F=>this.uppy.getFile(F)),f=d.filter(F=>!F.error).map(F=>F.id),y=this.getPluginState();if(this.restored)return this.restored.then(()=>ae(this,fo)[fo](f,p));let b=y.uploadsAssemblies[p],S=n(()=>{b.forEach(F=>{this.activeAssemblies[F].close(),delete this.activeAssemblies[F]})},\"closeSocketConnections\");if(!ae(this,Ep)[Ep]()){S();let F=b.map(U=>this.getAssembly(U));return this.uppy.addResultData(p,{transloadit:F}),Promise.resolve()}return b.length===0?(this.uppy.addResultData(p,{transloadit:[]}),Promise.resolve()):(d.filter(F=>!Ct(this.completedFiles,F.id)).forEach(F=>{this.uppy.emit(\"postprocess-progress\",F,{mode:\"indeterminate\",message:this.i18n(\"encoding\")})}),this.assemblyWatchers[p].promise.then(()=>{S();let F=b.map(j=>this.getAssembly(j)),U={...this.getPluginState().uploadsAssemblies};delete U[p],this.setPluginState({uploadsAssemblies:U}),this.uppy.addResultData(p,{transloadit:F})}))}}),Object.defineProperty(this,dl,{writable:!0,value:h=>{var p;(p=this.activeAssemblies[h])==null||p.close()}}),Object.defineProperty(this,cl,{writable:!0,value:function(h,p){h===void 0&&(h=null);let f=r.getPluginState().uploadsAssemblies[p];f?.forEach(ae(r,dl)[dl]),r.client.submitError(h).catch(K0(h))}}),Object.defineProperty(this,Rp,{writable:!0,value:(h,p)=>{var d,f;if(ae(this,dl)[dl](h==null||(d=h.transloadit)==null?void 0:d.assembly),p!=null&&(f=p.message)!=null&&f.startsWith(\"tus: \")){var y;let b=(y=p.originalRequest)==null||(y=y.getUnderlyingObject())==null?void 0:y.responseURL;this.client.submitError(p,{endpoint:b,type:\"TUS_ERROR\"}).catch(K0(p))}}}),this.type=\"uploader\",this.id=this.opts.id||\"Transloadit\",this.title=\"Transloadit\",this.defaultLocale=G0;let l={service:\"https://api2.transloadit.com\",errorReporting:!0,waitForEncoding:!1,waitForMetadata:!1,alwaysRunAssembly:!1,importFromUploadURLs:!1,signature:null,params:null,fields:null,getAssemblyOptions:null,limit:20,retryDelays:[7e3,1e4,15e3,2e4]};this.opts={...l,...t},(o=(s=this.opts).assemblyOptions)!=null||(s.assemblyOptions=(a=this.opts.getAssemblyOptions)!=null?a:{params:this.opts.params,signature:this.opts.signature,fields:this.opts.fields}),t?.params!=null&&t.getAssemblyOptions==null&&t.assemblyOptions==null&&wp(this.opts.assemblyOptions.params),ae(this,Di)[Di]=new Mt(this.opts.limit),this.i18nInit(),this.client=new rn({service:this.opts.service,client:ae(this,xp)[xp](),errorReporting:this.opts.errorReporting,rateLimitedQueue:ae(this,Di)[Di]}),this.activeAssemblies={},this.assemblyWatchers={},this.completedFiles=Object.create(null)}install(){this.uppy.addPreProcessor(ae(this,hl)[hl]),this.uppy.addPostProcessor(ae(this,fo)[fo]),this.uppy.on(\"error\",ae(this,cl)[cl]),this.uppy.on(\"cancel-all\",ae(this,Cp)[Cp]),this.uppy.on(\"upload-error\",ae(this,Rp)[Rp]),this.opts.importFromUploadURLs?this.uppy.on(\"upload-success\",ae(this,ll)[ll]):this.uppy.use(or,{storeFingerprintForResuming:!1,allowedMetaFields:[\"assembly_url\",\"filename\",\"fieldname\"],limit:this.opts.limit,rateLimitedQueue:ae(this,Di)[Di],retryDelays:this.opts.retryDelays}),this.uppy.on(\"restore:get-data\",ae(this,Tp)[Tp]),this.uppy.on(\"restored\",ae(this,Ap)[Ap]),this.setPluginState({assemblies:{},uploadsAssemblies:{},files:{},results:[]});let{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!1}})}uninstall(){this.uppy.removePreProcessor(ae(this,hl)[hl]),this.uppy.removePostProcessor(ae(this,fo)[fo]),this.uppy.off(\"error\",ae(this,cl)[cl]),this.opts.importFromUploadURLs&&this.uppy.off(\"upload-success\",ae(this,ll)[ll]);let{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!0}})}getAssembly(e){let{assemblies:t}=this.getPluginState();return t[e]}getAssemblyFiles(e){return this.uppy.getFiles().filter(t=>{var r;return(t==null||(r=t.transloadit)==null?void 0:r.assembly)===e})}};n(yi,\"Transloadit\");function ax(){let i=[`uppy-core:${this.uppy.constructor.VERSION}`,`uppy-transloadit:${this.constructor.VERSION}`,`uppy-tus:${or.VERSION}`],e=n((t,r)=>{let s=this.uppy.getPlugin(t);s&&i.push(`${r}:${s.constructor.VERSION}`)},\"addPluginVersion\");return this.opts.importFromUploadURLs&&(e(\"XHRUpload\",\"uppy-xhr-upload\"),e(\"AwsS3\",\"uppy-aws-s3\"),e(\"AwsS3Multipart\",\"uppy-aws-s3-multipart\")),e(\"Dropbox\",\"uppy-dropbox\"),e(\"Box\",\"uppy-box\"),e(\"Facebook\",\"uppy-facebook\"),e(\"GoogleDrive\",\"uppy-google-drive\"),e(\"Instagram\",\"uppy-instagram\"),e(\"OneDrive\",\"uppy-onedrive\"),e(\"Zoom\",\"uppy-zoom\"),e(\"Url\",\"uppy-url\"),i.join(\",\")}n(ax,\"_getClientVersion2\");function lx(i,e){let t={...i.meta,assembly_url:e.assembly_url,filename:i.name,fieldname:\"file\"},r={...i.tus,endpoint:e.tus_url,addRequestId:!0},{remote:s}=i;if(i.remote&&nx.test(i.remote.companionUrl)){let a=e.companion_url.replace(/\\/$/,\"\"),l=i.remote.url.replace(i.remote.companionUrl,\"\").replace(/^\\//,\"\");s={...i.remote,companionUrl:a,url:`${a}/${l}`}}let o={...i,transloadit:{assembly:e.assembly_id}};return this.opts.importFromUploadURLs||Object.assign(o,{meta:t,tus:r,remote:s}),o}n(lx,\"_attachAssemblyMetadata2\");function ux(i,e,t){return this.uppy.log(\"[Transloadit] Create Assembly\"),this.client.createAssembly({...t,expectedFiles:i.length}).then(async r=>{let s=this.uppy.getFiles().filter(y=>{let{id:b}=y;return i.includes(b)});if(s.length!==i.length){if(s.length===0)return await this.client.cancelAssembly(r),null;await this.client.updateNumberOfFilesInAssembly(r,s.length)}let o=new bp(r,ae(this,Di)[Di]),{status:a}=o,l=a.assembly_id,{assemblies:h,uploadsAssemblies:p}=this.getPluginState();this.setPluginState({assemblies:{...h,[l]:a},uploadsAssemblies:{...p,[e]:[...p[e],l]}});let d={};s.forEach(y=>{d[y.id]=ae(this,Up)[Up](y,a)}),this.uppy.setState({files:{...this.uppy.getState().files,...d}});let f=n((y,b)=>{var S;if(((S=o.status)==null?void 0:S.ok)===\"ASSEMBLY_COMPLETED\"){this.uppy.off(\"file-removed\",f);return}if(b===\"cancel-all\")o.close(),this.uppy.off(\"file-removed\",f);else if(y.id in d){delete d[y.id];let E=Object.keys(d).length;E===0?(o.close(),ae(this,ml)[ml](r).catch(()=>{}),this.uppy.off(\"file-removed\",f)):this.client.updateNumberOfFilesInAssembly(r,E).catch(()=>{})}},\"fileRemovedHandler\");return this.uppy.on(\"file-removed\",f),this.uppy.emit(\"transloadit:assembly-created\",a,i),this.uppy.log(`[Transloadit] Created Assembly ${l}`),o}).catch(r=>{let s=new vr(`${this.i18n(\"creatingAssemblyFailed\")}: ${r.message}`,{cause:r});throw\"details\"in r&&(s.details=r.details),\"assembly\"in r&&(s.assembly=r.assembly),s})}n(ux,\"_createAssembly2\");function hx(i,e){let t=new W0(this.uppy,i);t.on(\"assembly-complete\",r=>{this.getAssemblyFiles(r).forEach(o=>{this.completedFiles[o.id]=!0,this.uppy.emit(\"postprocess-complete\",o)})}),t.on(\"assembly-error\",(r,s)=>{let o=this.getAssemblyFiles(r);o.forEach(l=>{this.uppy.emit(\"upload-error\",l,s),this.uppy.emit(\"postprocess-complete\",l)});let a={...this.uppy.getState().files};o.forEach(l=>delete a[l.id].tus),this.uppy.setState({files:a}),this.uppy.emit(\"error\",s)}),this.assemblyWatchers[e]=t}n(hx,\"_createAssemblyWatcher2\");function dx(){return this.opts.waitForEncoding||this.opts.waitForMetadata}n(dx,\"_shouldWaitAfterUpload2\");function cx(i,e){return Promise.all(e.map(t=>{let r=this.uppy.getFile(t);return this.client.reserveFile(i.status,r)}))}n(cx,\"_reserveFiles2\");function px(i){let e=this.uppy.getFiles();for(let t=0;t<e.length;t++){let r=e[t];if(r.uploadURL===i.tus_upload_url||r.tus&&r.tus.uploadUrl===i.tus_upload_url||!i.is_tus_file&&r.name===i.name&&r.size===i.size)return r}}n(px,\"_findFile2\");function fx(i,e){let t=this.getPluginState(),r=ae(this,fl)[fl](e);if(!r){this.uppy.log(\"[Transloadit] Couldn\\u2019t find the file, it was likely removed in the process\");return}this.setPluginState({files:{...t.files,[e.id]:{assembly:i,id:r.id,uploadedFile:e}}}),this.uppy.emit(\"transloadit:upload\",e,this.getAssembly(i))}n(fx,\"_onFileUploadComplete2\");function mx(i,e,t){let r=this.getPluginState(),s=r.files[t.original_id];t.localId=s?s.id:null;let o={result:t,stepName:e,id:t.id,assembly:i};this.setPluginState({results:[...r.results,o]}),this.uppy.emit(\"transloadit:result\",e,t,this.getAssembly(i))}n(mx,\"_onResult2\");function gx(i){let e=i.assembly_ssl_url;this.client.getAssemblyStatus(e).then(t=>{let r=t.assembly_id,s=this.getPluginState();this.setPluginState({assemblies:{...s.assemblies,[r]:t}}),this.uppy.emit(\"transloadit:complete\",t)})}n(gx,\"_onAssemblyFinished2\");async function yx(i){await this.client.cancelAssembly(i),this.uppy.emit(\"transloadit:assembly-cancelled\",i)}n(yx,\"_cancelAssembly2\");function vx(i){let{status:e}=i,t=e.assembly_id;return this.activeAssemblies[t]=i,i.on(\"status\",r=>{let{assemblies:s}=this.getPluginState();this.setPluginState({assemblies:{...s,[t]:r}})}),i.on(\"upload\",r=>{ae(this,kp)[kp](t,r)}),i.on(\"error\",r=>{r.assembly=i.status,this.uppy.emit(\"transloadit:assembly-error\",i.status,r)}),i.on(\"executing\",()=>{this.uppy.emit(\"transloadit:assembly-executing\",i.status)}),i.on(\"execution-progress\",r=>{if(this.uppy.emit(\"transloadit:execution-progress\",r),r.progress_combined!=null)for(let s of this.uppy.getFiles())this.uppy.emit(\"postprocess-progress\",s,{mode:\"determinate\",value:r.progress_combined/100,message:this.i18n(\"encoding\")})}),this.opts.waitForEncoding&&i.on(\"result\",(r,s)=>{ae(this,Dp)[Dp](t,r,s)}),this.opts.waitForEncoding?i.on(\"finished\",()=>{ae(this,pl)[pl](i.status)}):this.opts.waitForMetadata&&i.on(\"metadata\",()=>{ae(this,pl)[pl](i.status)}),i.ok===\"ASSEMBLY_COMPLETE\"||i.connect(),i}n(vx,\"_connectAssembly2\");yi.VERSION=ox.version;yi.COMPANION=Ip;yi.COMPANION_PATTERN=Np;var X0={strings:{uploadStalled:\"Upload has not made any progress for %{seconds} seconds. You may want to retry it.\"}};function sn(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(sn,\"_classPrivateFieldLooseBase\");var bx=0;function yl(i){return\"__private_\"+bx+++\"_\"+i}n(yl,\"_classPrivateFieldLooseKey\");var wx={version:\"3.5.0\"};function Y0(i,e){let t=e;return t||(t=new Error(\"Upload error\")),typeof t==\"string\"&&(t=new Error(t)),t instanceof Error||(t=Object.assign(new Error(\"Upload error\"),{data:t})),so(i)?(t=new Pi(t,i),t):(t.request=i,t)}n(Y0,\"buildResponseError\");function Q0(i){return i.data.slice(0,i.data.size,i.meta.type)}n(Q0,\"setTypeInBlob\");var Bp=yl(\"uploadLocalFile\"),Mp=yl(\"uploadBundle\"),zp=yl(\"getCompanionClientArgs\"),Lp=yl(\"uploadFiles\"),gl=yl(\"handleUpload\"),mo=class extends ve{constructor(e,t){super(e,t),Object.defineProperty(this,Lp,{value:xx}),Object.defineProperty(this,zp,{value:_x}),Object.defineProperty(this,Mp,{value:Px}),Object.defineProperty(this,Bp,{value:Sx}),Object.defineProperty(this,gl,{writable:!0,value:async s=>{if(s.length===0){this.uppy.log(\"[XHRUpload] No files to upload!\");return}this.opts.limit===0&&!this.opts[us]&&this.uppy.log(\"[XHRUpload] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/xhr-upload/#limit-0\",\"warning\"),this.uppy.log(\"[XHRUpload] Uploading...\");let o=this.uppy.getFilesByIds(s),a=hs(o),l=ds(a);if(this.uppy.emit(\"upload-start\",l),this.opts.bundle){if(a.some(p=>p.isRemote))throw new Error(\"Can\\u2019t upload remote files when the `bundle: true` option is set\");if(typeof this.opts.headers==\"function\")throw new TypeError(\"`headers` may not be a function when the `bundle: true` option is set\");await sn(this,Mp)[Mp](a)}else await sn(this,Lp)[Lp](a)}}),this.type=\"uploader\",this.id=this.opts.id||\"XHRUpload\",this.title=\"XHRUpload\",this.defaultLocale=X0;let r={formData:!0,fieldName:t.bundle?\"files[]\":\"file\",method:\"post\",allowedMetaFields:null,responseUrlFieldName:\"url\",bundle:!1,headers:{},timeout:30*1e3,limit:5,withCredentials:!1,responseType:\"\",getResponseData(s){let o={};try{o=JSON.parse(s)}catch(a){e.log(a)}return o},getResponseError(s,o){let a=new Error(\"Upload error\");return so(o)&&(a=new Pi(a,o)),a},validateStatus(s){return s>=200&&s<300}};if(this.opts={...r,...t},this.i18nInit(),us in this.opts?this.requests=this.opts[us]:this.requests=new Mt(this.opts.limit),this.opts.bundle&&!this.opts.formData)throw new Error(\"`opts.formData` must be true when `opts.bundle` is enabled.\");if(t?.allowedMetaFields===void 0&&\"metaFields\"in this.opts)throw new Error(\"The `metaFields` option has been renamed to `allowedMetaFields`.\");this.uploaderEvents=Object.create(null)}getOptions(e){let t=this.uppy.getState().xhrUpload,{headers:r}=this.opts,s={...this.opts,...t||{},...e.xhrUpload||{},headers:{}};return typeof r==\"function\"?s.headers=r(e):Object.assign(s.headers,this.opts.headers),t&&Object.assign(s.headers,t.headers),e.xhrUpload&&Object.assign(s.headers,e.xhrUpload.headers),s}addMetadata(e,t,r){(Array.isArray(r.allowedMetaFields)?r.allowedMetaFields:Object.keys(t)).forEach(o=>{Array.isArray(t[o])?t[o].forEach(a=>e.append(o,a)):e.append(o,t[o])})}createFormDataUpload(e,t){let r=new FormData;this.addMetadata(r,e.meta,t);let s=Q0(e);return e.name?r.append(t.fieldName,s,e.meta.name):r.append(t.fieldName,s),r}createBundledUpload(e,t){let r=new FormData,{meta:s}=this.uppy.getState();return this.addMetadata(r,s,t),e.forEach(o=>{let a=this.getOptions(o),l=Q0(o);o.name?r.append(a.fieldName,l,o.name):r.append(a.fieldName,l)}),r}install(){if(this.opts.bundle){let{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!1}})}this.uppy.addUploader(sn(this,gl)[gl])}uninstall(){if(this.opts.bundle){let{capabilities:e}=this.uppy.getState();this.uppy.setState({capabilities:{...e,individualCancellation:!0}})}this.uppy.removeUploader(sn(this,gl)[gl])}};n(mo,\"XHRUpload\");async function Sx(i,e,t){let r=this.getOptions(i);return this.uppy.log(`uploading ${e} of ${t}`),new Promise((s,o)=>{let a=r.formData?this.createFormDataUpload(i,r):i.data,l=new XMLHttpRequest,h=new mi(this.uppy);this.uploaderEvents[i.id]=h;let p,d=new qa(r.timeout,()=>{let y=new Error(this.i18n(\"uploadStalled\",{seconds:Math.ceil(r.timeout/1e3)}));this.uppy.emit(\"upload-stalled\",y,[i])}),f=Pt();l.upload.addEventListener(\"loadstart\",()=>{this.uppy.log(`[XHRUpload] ${f} started`)}),l.upload.addEventListener(\"progress\",y=>{this.uppy.log(`[XHRUpload] ${f} progress: ${y.loaded} / ${y.total}`),d.progress(),y.lengthComputable&&this.uppy.emit(\"upload-progress\",i,{uploader:this,bytesUploaded:y.loaded,bytesTotal:y.total})}),l.addEventListener(\"load\",()=>{if(this.uppy.log(`[XHRUpload] ${f} finished`),d.done(),p.done(),this.uploaderEvents[i.id]&&(this.uploaderEvents[i.id].remove(),this.uploaderEvents[i.id]=null),r.validateStatus(l.status,l.responseText,l)){let E=r.getResponseData(l.responseText,l),x=E[r.responseUrlFieldName],F={status:l.status,body:E,uploadURL:x};return this.uppy.emit(\"upload-success\",i,F),x&&this.uppy.log(`Download ${i.name} from ${x}`),s(i)}let y=r.getResponseData(l.responseText,l),b=Y0(l,r.getResponseError(l.responseText,l)),S={status:l.status,body:y};return this.uppy.emit(\"upload-error\",i,b,S),o(b)}),l.addEventListener(\"error\",()=>{this.uppy.log(`[XHRUpload] ${f} errored`),d.done(),p.done(),this.uploaderEvents[i.id]&&(this.uploaderEvents[i.id].remove(),this.uploaderEvents[i.id]=null);let y=Y0(l,r.getResponseError(l.responseText,l));return this.uppy.emit(\"upload-error\",i,y),o(y)}),l.open(r.method.toUpperCase(),r.endpoint,!0),l.withCredentials=r.withCredentials,r.responseType!==\"\"&&(l.responseType=r.responseType),p=this.requests.run(()=>{let y=this.getOptions(i);return Object.keys(y.headers).forEach(b=>{l.setRequestHeader(b,y.headers[b])}),l.send(a),()=>{d.done(),l.abort()}}),h.onFileRemove(i.id,()=>{p.abort(),o(new Error(\"File removed\"))}),h.onCancelAll(i.id,y=>{let{reason:b}=y;b===\"user\"&&p.abort(),o(new Error(\"Upload cancelled\"))})})}n(Sx,\"_uploadLocalFile2\");function Px(i){return new Promise((e,t)=>{let{endpoint:r}=this.opts,{method:s}=this.opts,o=this.uppy.getState().xhrUpload,a=this.createBundledUpload(i,{...this.opts,...o||{}}),l=new XMLHttpRequest,h=n(d=>{i.forEach(f=>{this.uppy.emit(\"upload-error\",f,d)})},\"emitError\"),p=new qa(this.opts.timeout,()=>{let d=new Error(this.i18n(\"uploadStalled\",{seconds:Math.ceil(this.opts.timeout/1e3)}));this.uppy.emit(\"upload-stalled\",d,i)});l.upload.addEventListener(\"loadstart\",()=>{this.uppy.log(\"[XHRUpload] started uploading bundle\"),p.progress()}),l.upload.addEventListener(\"progress\",d=>{p.progress(),d.lengthComputable&&i.forEach(f=>{this.uppy.emit(\"upload-progress\",f,{uploader:this,bytesUploaded:d.loaded/d.total*f.size,bytesTotal:f.size})})}),l.addEventListener(\"load\",d=>{if(p.done(),this.opts.validateStatus(d.target.status,l.responseText,l)){let y=this.opts.getResponseData(l.responseText,l),b={status:d.target.status,body:y};return i.forEach(S=>{this.uppy.emit(\"upload-success\",S,b)}),e()}let f=this.opts.getResponseError(l.responseText,l)||new Error(\"Upload error\");return f.request=l,h(f),t(f)}),l.addEventListener(\"error\",()=>{p.done();let d=this.opts.getResponseError(l.responseText,l)||new Error(\"Upload error\");return h(d),t(d)}),this.uppy.on(\"cancel-all\",function(d){let{reason:f}=d===void 0?{}:d;f===\"user\"&&(p.done(),l.abort())}),l.open(s.toUpperCase(),r,!0),l.withCredentials=this.opts.withCredentials,this.opts.responseType!==\"\"&&(l.responseType=this.opts.responseType),Object.keys(this.opts.headers).forEach(d=>{l.setRequestHeader(d,this.opts.headers[d])}),l.send(a)})}n(Px,\"_uploadBundle2\");function _x(i){let e=this.getOptions(i),t=Array.isArray(e.allowedMetaFields)?e.allowedMetaFields:Object.keys(i.meta);return{...i.remote.body,protocol:\"multipart\",endpoint:e.endpoint,size:i.data.size,fieldname:e.fieldName,metadata:Object.fromEntries(t.map(r=>[r,i.meta[r]])),httpMethod:e.method,useFormData:e.formData,headers:e.headers}}n(_x,\"_getCompanionClientArgs2\");async function xx(i){await Promise.allSettled(i.map((e,t)=>{let r=parseInt(t,10)+1,s=i.length;if(e.isRemote){let o=n(()=>this.requests,\"getQueue\"),a=new AbortController,l=n(p=>{p.id===e.id&&a.abort()},\"removedHandler\");this.uppy.on(\"file-removed\",l);let h=e.remote.requestClient.uploadRemoteFile(e,sn(this,zp)[zp](e),{signal:a.signal,getQueue:o});return this.requests.wrapSyncFunction(()=>{this.uppy.off(\"file-removed\",l)},{priority:-1})(),h}return sn(this,Bp)[Bp](e,r,s)}))}n(xx,\"_uploadFiles2\");mo.VERSION=wx.version;var $p=de(Il(),1),tb=de(J0(),1);var Z0={strings:{compressingImages:\"Compressing images...\",compressedX:\"Saved %{size} by compressing images\"}};function eb(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(eb,\"_classPrivateFieldLooseBase\");var Fx=0;function Ex(i){return\"__private_\"+Fx+++\"_\"+i}n(Ex,\"_classPrivateFieldLooseKey\");var vl=Ex(\"RateLimitedQueue\"),on=class extends ve{constructor(e,t){super(e,t),Object.defineProperty(this,vl,{writable:!0,value:void 0}),this.id=this.opts.id||\"Compressor\",this.type=\"modifier\",this.defaultLocale=Z0;let r={quality:.6,limit:10};this.opts={...r,...t},eb(this,vl)[vl]=new Mt(this.opts.limit),this.i18nInit(),this.prepareUpload=this.prepareUpload.bind(this),this.compress=this.compress.bind(this)}compress(e){return new Promise((t,r)=>{new tb.default(e,{...this.opts,success:t,error:r})})}async prepareUpload(e){let t=0,r=[],s=eb(this,vl)[vl].wrapPromiseFunction(async a=>{try{let l=await this.compress(a.data),h=a.data.size-l.size;this.uppy.log(`[Image Compressor] Image ${a.id} compressed by ${(0,$p.default)(h)}`),t+=h;let{name:p,type:d,size:f}=l,y=Bi(p),S=`${Bi(a.meta.name).name}.${y.extension}`;this.uppy.setFileState(a.id,{...p&&{name:p},...y.extension&&{extension:y.extension},...d&&{type:d},...f&&{size:f},data:l,meta:{...a.meta,type:d,name:S}}),r.push(a)}catch(l){this.uppy.log(`[Image Compressor] Failed to compress ${a.id}:`,\"warning\"),this.uppy.log(l,\"warning\")}}),o=e.map(a=>{let l=this.uppy.getFile(a);return this.uppy.emit(\"preprocess-progress\",l,{mode:\"indeterminate\",message:this.i18n(\"compressingImages\")}),l.isRemote||(l.data.type||(l.data=l.data.slice(0,l.data.size,l.type)),!l.type.startsWith(\"image/\"))?Promise.resolve():s(l)});await Promise.all(o),this.uppy.emit(\"compressor:complete\",r),t>1024&&this.uppy.info(this.i18n(\"compressedX\",{size:(0,$p.default)(t)}),\"info\");for(let a of e){let l=this.uppy.getFile(a);this.uppy.emit(\"preprocess-complete\",l)}}install(){this.uppy.addPreProcessor(this.prepareUpload)}uninstall(){this.uppy.removePreProcessor(this.prepareUpload)}};n(on,\"Compressor\");function ah(){return ah=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},ah.apply(this,arguments)}n(ah,\"_extends\");var Ox={\"[object HTMLCollection]\":!0,\"[object NodeList]\":!0,\"[object RadioNodeList]\":!0},Cx={button:!0,fieldset:!0,reset:!0,submit:!0},Tx={checkbox:!0,radio:!0},Ax=/^\\s+|\\s+$/g,Rx=Array.prototype.slice,ib=Object.prototype.toString;function lh(i,e){if(!i)throw new Error(\"A form is required by getFormData, was given form=\"+i);e=ah({includeDisabled:!1,trim:!1},e);for(var t={},r,s=[],o={},a=0,l=i.elements.length;a<l;a++){var h=i.elements[a];Cx[h.type]||h.disabled&&!e.includeDisabled||(r=h.name||h.id,r&&!o[r]&&(s.push(r),o[r]=!0))}for(var p=0,d=s.length;p<d;p++){r=s[p];var f=sb(i,r,e);f!=null&&(t[r]=f)}return t}n(lh,\"getFormData\");function sb(i,e,t){if(!i)throw new Error(\"A form is required by getFieldData, was given form=\"+i);if(!e&&ib.call(e)!==\"[object String]\")throw new Error(\"A field name is required by getFieldData, was given fieldName=\"+e);t=ah({includeDisabled:!1,trim:!1},t);var r=i.elements[e];if(!r||r.disabled&&!t.includeDisabled)return null;if(!Ox[ib.call(r)])return rb(r,t.trim);for(var s=[],o=!0,a=0,l=r.length;a<l;a++)if(!(r[a].disabled&&!t.includeDisabled)){o&&r[a].type!==\"radio\"&&(o=!1);var h=rb(r[a],t.trim);h!=null&&(s=s.concat(h))}return o&&s.length===1?s[0]:s.length>0?s:null}n(sb,\"getFieldData\");function rb(i,e){var t=null,r=i.type;if(r===\"select-one\")return i.options.length&&(t=i.options[i.selectedIndex].value),t;if(r===\"select-multiple\"){t=[];for(var s=0,o=i.options.length;s<o;s++)i.options[s].selected&&t.push(i.options[s].value);return t.length===0&&(t=null),t}return r===\"file\"&&\"files\"in i?(i.multiple?(t=Rx.call(i.files),t.length===0&&(t=null)):t=i.files[0],t):(Tx[r]?i.checked&&(r===\"checkbox\"&&!i.hasAttribute(\"value\")?t=!0:t=i.value):t=e?i.value.replace(Ax,\"\"):i.value,t)}n(rb,\"getFormElementValue\");lh.getFieldData=sb;var Ux={version:\"3.0.3\"},go=class extends ve{constructor(e,t){super(e,t),this.type=\"acquirer\",this.id=this.opts.id||\"Form\",this.title=\"Form\";let r={target:null,resultName:\"uppyResult\",getMetaFromForm:!0,addResultToForm:!0,submitOnSuccess:!1,triggerUploadOnSubmit:!1};this.opts={...r,...t},this.handleFormSubmit=this.handleFormSubmit.bind(this),this.handleUploadStart=this.handleUploadStart.bind(this),this.handleSuccess=this.handleSuccess.bind(this),this.addResultToForm=this.addResultToForm.bind(this),this.getMetaFromForm=this.getMetaFromForm.bind(this)}handleUploadStart(){this.opts.getMetaFromForm&&this.getMetaFromForm()}handleSuccess(e){this.opts.addResultToForm&&this.addResultToForm(e),this.opts.submitOnSuccess&&this.form.submit()}handleFormSubmit(e){if(this.opts.triggerUploadOnSubmit){e.preventDefault();let t=Qe(e.target.elements),r=[];t.forEach(s=>{(s.tagName===\"BUTTON\"||s.tagName===\"INPUT\"&&s.type===\"submit\")&&!s.disabled&&(s.disabled=!0,r.push(s))}),this.uppy.upload().then(()=>{r.forEach(s=>{s.disabled=!1})},s=>(r.forEach(o=>{o.disabled=!1}),Promise.reject(s))).catch(s=>{this.uppy.log(s.stack||s.message||s)})}}addResultToForm(e){this.uppy.log(\"[Form] Adding result to the original form:\"),this.uppy.log(e);let t=this.form.querySelector(`[name=\"${this.opts.resultName}\"]`);if(t){let r;try{r=JSON.parse(t.value)}catch{}Array.isArray(r)||(r=[]),r.push(e),t.value=JSON.stringify(r);return}t=document.createElement(\"input\"),t.name=this.opts.resultName,t.type=\"hidden\",t.value=JSON.stringify([e]),this.form.appendChild(t)}getMetaFromForm(){let e=lh(this.form);delete e[this.opts.resultName],this.uppy.setMeta(e)}install(){if(this.form=On(this.opts.target),!this.form||this.form.nodeName!==\"FORM\"){this.uppy.log(\"Form plugin requires a <form> target element passed in options to operate, none was found\",\"error\");return}this.form.addEventListener(\"submit\",this.handleFormSubmit),this.uppy.on(\"upload\",this.handleUploadStart),this.uppy.on(\"complete\",this.handleSuccess)}uninstall(){this.form.removeEventListener(\"submit\",this.handleFormSubmit),this.uppy.off(\"upload\",this.handleUploadStart),this.uppy.off(\"complete\",this.handleSuccess)}};n(go,\"Form\");go.VERSION=Ux.version;var gb=de(Rl(),1);function yo(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(yo,\"_classPrivateFieldLooseBase\");var kx=0;function Dx(i){return\"__private_\"+kx+++\"_\"+i}n(Dx,\"_classPrivateFieldLooseKey\");var ob=typeof navigator<\"u\"&&\"serviceWorker\"in navigator;function Ix(){return new Promise((i,e)=>{ob?navigator.serviceWorker.controller?i():navigator.serviceWorker.addEventListener(\"controllerchange\",()=>{i()}):e(new Error(\"Unsupported\"))})}n(Ix,\"waitForServiceWorker\");var zt=Dx(\"ready\"),bl=class{constructor(e){Object.defineProperty(this,zt,{writable:!0,value:void 0}),yo(this,zt)[zt]=Ix().then(t=>{yo(this,zt)[zt]=t}),this.name=e.storeName}get ready(){return Promise.resolve(yo(this,zt)[zt])}set ready(e){yo(this,zt)[zt]=e}async list(){return await yo(this,zt)[zt],new Promise((e,t)=>{let r=n(s=>{if(s.data.store===this.name)switch(s.data.type){case\"uppy/ALL_FILES\":e(s.data.files),navigator.serviceWorker.removeEventListener(\"message\",r);break;default:t()}},\"onMessage\");navigator.serviceWorker.addEventListener(\"message\",r),navigator.serviceWorker.controller.postMessage({type:\"uppy/GET_FILES\",store:this.name})})}async put(e){await yo(this,zt)[zt],navigator.serviceWorker.controller.postMessage({type:\"uppy/ADD_FILE\",store:this.name,file:e})}async delete(e){await yo(this,zt)[zt],navigator.serviceWorker.controller.postMessage({type:\"uppy/REMOVE_FILE\",store:this.name,fileID:e})}};n(bl,\"ServiceWorkerStore\");bl.isSupported=ob;var nb=bl;function ar(i,e){if(!Object.prototype.hasOwnProperty.call(i,e))throw new TypeError(\"attempted to use private field on non-instance\");return i}n(ar,\"_classPrivateFieldLooseBase\");var Nx=0;function Mx(i){return\"__private_\"+Nx+++\"_\"+i}n(Mx,\"_classPrivateFieldLooseKey\");var db=typeof window<\"u\"&&(window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB),Lx=!!db,ab=\"uppy-blobs\",Vt=\"files\",cb=24*60*60*1e3,Bx=3,lb=1048576;function zx(i){let e=i.openCursor();e.onsuccess=t=>{let r=t.target.result;if(!r)return;let s=r.value;s.expires=Date.now()+cb,r.update(s)}}n(zx,\"migrateExpiration\");function ub(i){let e=db.open(i,Bx);return new Promise((t,r)=>{e.onupgradeneeded=s=>{let o=s.target.result,{transaction:a}=s.currentTarget;if(s.oldVersion<2&&o.createObjectStore(Vt,{keyPath:\"id\"}).createIndex(\"store\",\"store\",{unique:!1}),s.oldVersion<3){let l=a.objectStore(Vt);l.createIndex(\"expires\",\"expires\",{unique:!1}),zx(l)}a.oncomplete=()=>{t(o)}},e.onsuccess=s=>{t(s.target.result)},e.onerror=r})}n(ub,\"connect\");function uh(i){return new Promise((e,t)=>{i.onsuccess=r=>{e(r.target.result)},i.onerror=t})}n(uh,\"waitForRequest\");var hb=!1,Ve=Mx(\"ready\"),vo=class{constructor(e){Object.defineProperty(this,Ve,{writable:!0,value:void 0}),this.opts={dbName:ab,storeName:\"default\",expires:cb,maxFileSize:10*lb,maxTotalSize:300*lb,...e},this.name=this.opts.storeName;let t=n(async()=>{let r=await ub(this.opts.dbName);return ar(this,Ve)[Ve]=r,r},\"createConnection\");hb?ar(this,Ve)[Ve]=t():(hb=!0,ar(this,Ve)[Ve]=vo.cleanup().then(t,t))}get ready(){return Promise.resolve(ar(this,Ve)[Ve])}set ready(e){ar(this,Ve)[Ve]=e}key(e){return`${this.name}!${e}`}async list(){let s=(await ar(this,Ve)[Ve]).transaction([Vt],\"readonly\").objectStore(Vt).index(\"store\").getAll(IDBKeyRange.only(this.name)),o=await uh(s);return Object.fromEntries(o.map(a=>[a.fileID,a.data]))}async get(e){let s=(await ar(this,Ve)[Ve]).transaction([Vt],\"readonly\").objectStore(Vt).get(this.key(e)),{data:o}=await uh(s);return{id:o.fileID,data:o.data}}async getSize(){let s=(await ar(this,Ve)[Ve]).transaction([Vt],\"readonly\").objectStore(Vt).index(\"store\").openCursor(IDBKeyRange.only(this.name));return new Promise((o,a)=>{let l=0;s.onsuccess=h=>{let p=h.target.result;p?(l+=p.value.data.size,p.continue()):o(l)},s.onerror=()=>{a(new Error(\"Could not retrieve stored blobs size\"))}})}async put(e){if(e.data.size>this.opts.maxFileSize)throw new Error(\"File is too big to store.\");if(await this.getSize()>this.opts.maxTotalSize)throw new Error(\"No space left\");let o=ar(this,Ve)[Ve].transaction([Vt],\"readwrite\").objectStore(Vt).add({id:this.key(e.id),fileID:e.id,store:this.name,expires:Date.now()+this.opts.expires,data:e.data});return uh(o)}async delete(e){let s=(await ar(this,Ve)[Ve]).transaction([Vt],\"readwrite\").objectStore(Vt).delete(this.key(e));return uh(s)}static async cleanup(){let e=await ub(ab),s=e.transaction([Vt],\"readwrite\").objectStore(Vt).index(\"expires\").openCursor(IDBKeyRange.upperBound(Date.now()));await new Promise((o,a)=>{s.onsuccess=l=>{let h=l.target.result;h?(h.delete(),h.continue()):o()},s.onerror=a}),e.close()}};n(vo,\"IndexedDBStore\");vo.isSupported=Lx;var pb=vo;function jx(){let i=[];for(let e=0;e<localStorage.length;e++){let t=localStorage.key(e);t.startsWith(\"uppyState:\")&&i.push(t.slice(10))}return i}n(jx,\"findUppyInstances\");function fb(i){try{return JSON.parse(i)}catch{return null}}n(fb,\"maybeParse\");var mb=!1,Ii=class{constructor(e){this.opts={expires:24*60*60*1e3,...e},this.name=`uppyState:${e.storeName}`,mb||(mb=!0,Ii.cleanup())}load(){let e=localStorage.getItem(this.name);if(!e)return null;let t=fb(e);return t?t.metadata?t.metadata:(this.save(t),t):null}save(e){let t=Date.now()+this.opts.expires,r=JSON.stringify({metadata:e,expires:t});localStorage.setItem(this.name,r)}static cleanup(e){if(e){localStorage.removeItem(`uppyState:${e}`);return}let t=jx(),r=Date.now();t.forEach(s=>{let o=localStorage.getItem(`uppyState:${s}`);if(!o)return;let a=fb(o);a&&a.expires&&a.expires<r&&localStorage.removeItem(`uppyState:${s}`)})}};n(Ii,\"MetaDataStore\");var Hx={version:\"3.1.1\"},bo=class extends ve{constructor(e,t){super(e,t),this.addBlobToStores=s=>{s.isRemote||(this.ServiceWorkerStore&&this.ServiceWorkerStore.put(s).catch(o=>{this.uppy.log(\"[GoldenRetriever] Could not store file\",\"warning\"),this.uppy.log(o)}),this.IndexedDBStore.put(s).catch(o=>{this.uppy.log(\"[GoldenRetriever] Could not store file\",\"warning\"),this.uppy.log(o)}))},this.removeBlobFromStores=s=>{this.ServiceWorkerStore&&this.ServiceWorkerStore.delete(s.id).catch(o=>{this.uppy.log(\"[GoldenRetriever] Failed to remove file\",\"warning\"),this.uppy.log(o)}),this.IndexedDBStore.delete(s.id).catch(o=>{this.uppy.log(\"[GoldenRetriever] Failed to remove file\",\"warning\"),this.uppy.log(o)})},this.replaceBlobInStores=s=>{this.removeBlobFromStores(s),this.addBlobToStores(s)},this.handleRestoreConfirmed=()=>{this.uppy.log(\"[GoldenRetriever] Restore confirmed, proceeding...\");let{currentUploads:s}=this.uppy.getState();s&&(this.uppy.resumeAll(),Object.keys(s).forEach(o=>{this.uppy.restore(o,s[o])})),this.uppy.setState({recoveredState:null})},this.abortRestore=()=>{this.uppy.log(\"[GoldenRetriever] Aborting restore...\");let s=Object.keys(this.uppy.getState().files);this.deleteBlobs(s).then(()=>{this.uppy.log(`[GoldenRetriever] Removed ${s.length} files`)}).catch(o=>{this.uppy.log(`[GoldenRetriever] Could not remove ${s.length} files`,\"warning\"),this.uppy.log(o)}),this.uppy.cancelAll(),this.uppy.setState({recoveredState:null}),Ii.cleanup(this.uppy.opts.id)},this.handleComplete=s=>{let{successful:o}=s,a=o.map(l=>l.id);this.deleteBlobs(a).then(()=>{this.uppy.log(`[GoldenRetriever] Removed ${o.length} files that finished uploading`)}).catch(l=>{this.uppy.log(`[GoldenRetriever] Could not remove ${o.length} files that finished uploading`,\"warning\"),this.uppy.log(l)}),this.uppy.setState({recoveredState:null}),Ii.cleanup(this.uppy.opts.id)},this.restoreBlobs=()=>{this.uppy.getFiles().length>0?Promise.all([this.loadFileBlobsFromServiceWorker(),this.loadFileBlobsFromIndexedDB()]).then(s=>{let o={...s[0],...s[1]};this.onBlobsLoaded(o)}):this.uppy.log(\"[GoldenRetriever] No files need to be loaded, only restoring processing state...\")},this.type=\"debugger\",this.id=this.opts.id||\"GoldenRetriever\",this.title=\"Golden Retriever\";let r={expires:24*60*60*1e3,serviceWorker:!1};this.opts={...r,...t},this.MetaDataStore=new Ii({expires:this.opts.expires,storeName:e.getID()}),this.ServiceWorkerStore=null,this.opts.serviceWorker&&(this.ServiceWorkerStore=new nb({storeName:e.getID()})),this.IndexedDBStore=new pb({expires:this.opts.expires,...this.opts.indexedDB||{},storeName:e.getID()}),this.saveFilesStateToLocalStorage=(0,gb.default)(this.saveFilesStateToLocalStorage.bind(this),500,{leading:!0,trailing:!0}),this.restoreState=this.restoreState.bind(this),this.loadFileBlobsFromServiceWorker=this.loadFileBlobsFromServiceWorker.bind(this),this.loadFileBlobsFromIndexedDB=this.loadFileBlobsFromIndexedDB.bind(this),this.onBlobsLoaded=this.onBlobsLoaded.bind(this)}restoreState(){let e=this.MetaDataStore.load();e&&(this.uppy.log(\"[GoldenRetriever] Recovered some state from Local Storage\"),this.uppy.setState({currentUploads:e.currentUploads||{},files:e.files||{},recoveredState:e}),this.savedPluginData=e.pluginData)}getWaitingFiles(){let e={};return this.uppy.getFiles().forEach(t=>{(!t.progress||!t.progress.uploadStarted)&&(e[t.id]=t)}),e}getUploadingFiles(){let e={},{currentUploads:t}=this.uppy.getState();return t&&Object.keys(t).forEach(s=>{t[s].fileIDs.forEach(a=>{e[a]=this.uppy.getFile(a)})}),e}saveFilesStateToLocalStorage(){let e={...this.getWaitingFiles(),...this.getUploadingFiles()},t=Object.entries(e);if(t.length===0){this.uppy.getState().recoveredState!==null&&this.uppy.setState({recoveredState:null}),Ii.cleanup(this.uppy.opts.id);return}let r=Object.fromEntries(t.map(a=>{let[l,h]=a;return[l,h.isRemote?{...h,isRestored:!0}:{...h,isRestored:!0,data:null,preview:null}]})),s={};this.uppy.emit(\"restore:get-data\",a=>{Object.assign(s,a)});let{currentUploads:o}=this.uppy.getState();this.MetaDataStore.save({currentUploads:o,files:r,pluginData:s})}loadFileBlobsFromServiceWorker(){return this.ServiceWorkerStore?this.ServiceWorkerStore.list().then(e=>{let t=Object.keys(e).length;return t>0?(this.uppy.log(`[GoldenRetriever] Successfully recovered ${t} blobs from Service Worker!`),e):(this.uppy.log(\"[GoldenRetriever] No blobs found in Service Worker, trying IndexedDB now...\"),{})}).catch(e=>(this.uppy.log(\"[GoldenRetriever] Failed to recover blobs from Service Worker\",\"warning\"),this.uppy.log(e),{})):Promise.resolve({})}loadFileBlobsFromIndexedDB(){return this.IndexedDBStore.list().then(e=>{let t=Object.keys(e).length;return t>0?(this.uppy.log(`[GoldenRetriever] Successfully recovered ${t} blobs from IndexedDB!`),e):(this.uppy.log(\"[GoldenRetriever] No blobs found in IndexedDB\"),{})}).catch(e=>(this.uppy.log(\"[GoldenRetriever] Failed to recover blobs from IndexedDB\",\"warning\"),this.uppy.log(e),{}))}onBlobsLoaded(e){let t=[],r={...this.uppy.getState().files};Object.keys(e).forEach(s=>{let o=this.uppy.getFile(s);if(!o){t.push(s);return}let l={data:e[s],isRestored:!0,isGhost:!1};r[s]={...o,...l}}),Object.keys(r).forEach(s=>{r[s].data===null&&(r[s]={...r[s],isGhost:!0})}),this.uppy.setState({files:r}),this.uppy.emit(\"restored\",this.savedPluginData),t.length&&this.deleteBlobs(t).then(()=>{this.uppy.log(`[GoldenRetriever] Cleaned up ${t.length} old files`)}).catch(s=>{this.uppy.log(`[GoldenRetriever] Could not clean up ${t.length} old files`,\"warning\"),this.uppy.log(s)})}deleteBlobs(e){return Promise.all(e.map(t=>{var r,s,o;return(r=(s=this.ServiceWorkerStore)==null?void 0:s.delete(t))!=null?r:(o=this.IndexedDBStore)==null?void 0:o.delete(t)}))}install(){this.restoreState(),this.restoreBlobs(),this.uppy.on(\"file-added\",this.addBlobToStores),this.uppy.on(\"file-editor:complete\",this.replaceBlobInStores),this.uppy.on(\"file-removed\",this.removeBlobFromStores),this.uppy.on(\"state-update\",this.saveFilesStateToLocalStorage),this.uppy.on(\"restore-confirmed\",this.handleRestoreConfirmed),this.uppy.on(\"restore-canceled\",this.abortRestore),this.uppy.on(\"complete\",this.handleComplete)}uninstall(){this.uppy.off(\"file-added\",this.addBlobToStores),this.uppy.off(\"file-editor:complete\",this.replaceBlobInStores),this.uppy.off(\"file-removed\",this.removeBlobFromStores),this.uppy.off(\"state-update\",this.saveFilesStateToLocalStorage),this.uppy.off(\"restore-confirmed\",this.handleRestoreConfirmed),this.uppy.off(\"restore-canceled\",this.abortRestore),this.uppy.off(\"complete\",this.handleComplete)}};n(bo,\"GoldenRetriever\");bo.VERSION=Hx.version;var $x={version:\"3.0.3\"},wo=class extends Z{constructor(e,t){super(e,t),this.type=\"debugger\",this.id=this.opts.id||\"ReduxDevTools\",this.title=\"Redux DevTools\";let r={};this.opts={...r,...t},this.handleStateChange=this.handleStateChange.bind(this),this.initDevTools=this.initDevTools.bind(this)}handleStateChange(e,t){this.devTools.send(\"UPPY_STATE_UPDATE\",t)}initDevTools(){this.devTools=window.devToolsExtension.connect(),this.devToolsUnsubscribe=this.devTools.subscribe(e=>{if(e.type===\"DISPATCH\")switch(e.payload.type){case\"RESET\":this.uppy.cancelAll();return;case\"IMPORT_STATE\":{let{computedStates:t}=e.payload.nextLiftedState;this.uppy.store.state={...this.uppy.getState(),...t[t.length-1].state},this.uppy.updateAll(this.uppy.getState());return}case\"JUMP_TO_STATE\":case\"JUMP_TO_ACTION\":this.uppy.store.state={...this.uppy.getState(),...JSON.parse(e.state)},this.uppy.updateAll(this.uppy.getState());break;default:}})}install(){this.withDevTools=typeof window<\"u\"&&window.__REDUX_DEVTOOLS_EXTENSION__,this.withDevTools&&(this.initDevTools(),this.uppy.on(\"state-update\",this.handleStateChange))}uninstall(){this.withDevTools&&(this.devToolsUnsubscribe(),this.uppy.off(\"state-update\",this.handleStateUpdate))}};n(wo,\"ReduxDevTools\");wo.VERSION=$x.version;function qx(){throw new Error(\"Core has been renamed to Uppy\")}n(qx,\"Core\");var Vx={ProviderView:td};yi.COMPANION_URL=Ip;yi.COMPANION_ALLOWED_HOSTS=Np;var Wx={};globalThis.Uppy=qp;})();\n/**\n * Takes a string with placeholder variables like `%{smart_count} file selected`\n * and replaces it with values from options `{smart_count: 5}`\n *\n * @license https://github.com/airbnb/polyglot.js/blob/master/LICENSE\n * taken from https://github.com/airbnb/polyglot.js/blob/master/lib/polyglot.js#L299\n *\n * @param phrase that needs interpolation, with placeholders\n * @param options with values that will be used to replace placeholders\n */\n/*! Bundled license information:\n\nclassnames/index.js:\n  (*!\n    Copyright (c) 2018 Jed Watson.\n    Licensed under the MIT License (MIT), see\n    http://jedwatson.github.io/classnames\n  *)\n\ncropperjs/dist/cropper.js:\n  (*!\n   * Cropper.js v1.5.7\n   * https://fengyuanchen.github.io/cropperjs\n   *\n   * Copyright 2015-present Chen Fengyuan\n   * Released under the MIT license\n   *\n   * Date: 2020-05-23T05:23:00.081Z\n   *)\n\ncompressorjs/dist/compressor.js:\n  (*!\n   * Compressor.js v1.1.1\n   * https://fengyuanchen.github.io/compressorjs\n   *\n   * Copyright 2018-present Chen Fengyuan\n   * Released under the MIT license\n   *\n   * Date: 2021-10-05T02:32:40.212Z\n   *)\n*/\n//# sourceMappingURL=uppy.min.js.map\n","Magento_Bundle/js/price-bundle.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/**\n * @api\n */\ndefine([\n    'jquery',\n    'underscore',\n    'mage/template',\n    'priceUtils',\n    'jquery/jquery.parsequery',\n    'priceBox'\n], function ($, _, mageTemplate, utils) {\n    'use strict';\n\n    var globalOptions = {\n        optionConfig: null,\n        productBundleSelector: 'input.bundle.option, select.bundle.option, textarea.bundle.option',\n        qtyFieldSelector: 'input.qty',\n        priceBoxSelector: '.price-box',\n        optionHandlers: {},\n        optionTemplate: '<%- data.label %>' +\n            '<% if (data.finalPrice.value) { %>' +\n            ' +<%- data.finalPrice.formatted %>' +\n            '<% } %>',\n        controlContainer: 'dd', // should be eliminated\n        priceFormat: {},\n        isFixedPrice: false,\n        optionTierPricesBlocksSelector: '#option-tier-prices-{1} [data-role=\"selection-tier-prices\"]',\n        isOptionsInitialized: false\n    };\n\n    $.widget('mage.priceBundle', {\n        options: globalOptions,\n\n        /**\n         * @private\n         */\n        _init: function initPriceBundle() {\n            var form = this.element,\n                options = $(this.options.productBundleSelector, form),\n                qty = $(this.options.qtyFieldSelector, form);\n\n            // Override defaults with URL query parameters and/or inputs values\n            this._overrideDefaults();\n\n            options.trigger('change');\n            qty.trigger('change');\n        },\n\n        /**\n         * @private\n         */\n        _create: function createPriceBundle() {\n            var form = this.element,\n                options = $(this.options.productBundleSelector, form),\n                priceBox = $(this.options.priceBoxSelector, form),\n                qty = $(this.options.qtyFieldSelector, form);\n\n            this._updatePriceBox();\n            priceBox.on('price-box-initialized', this._updatePriceBox.bind(this));\n            options.on('change', this._onBundleOptionChanged.bind(this));\n            qty.on('change', this._onQtyFieldChanged.bind(this));\n        },\n\n        /**\n         * Override default options values settings with either URL query parameters or\n         * initialized inputs values.\n         * @private\n         */\n        _overrideDefaults: function () {\n            var hashIndex = window.location.href.indexOf('#');\n\n            if (hashIndex !== -1) {\n                this._parseQueryParams(window.location.href.substr(hashIndex + 1));\n            }\n        },\n\n        /**\n         * Parse query parameters from a query string and set options values based on the\n         * key value pairs of the parameters.\n         * @param {*} queryString - URL query string containing query parameters.\n         * @private\n         */\n        _parseQueryParams: function (queryString) {\n            var queryParams = $.parseQuery({\n                    query: queryString\n                }),\n                selectedValues = [],\n                form = this.element,\n                options = $(this.options.productBundleSelector, form),\n                qtys = $(this.options.qtyFieldSelector, form);\n\n            $.each(queryParams, $.proxy(function (key, value) {\n                qtys.each(function (index, qty) {\n                    if (qty.name === key) {\n                        $(qty).val(value);\n                    }\n                });\n                options.each(function (index, option) {\n                    let optionType = $(option).prop('type');\n\n                    if (option.name === key ||\n                        optionType === 'select-multiple'\n                        && key.indexOf(option.name.substr(0, option.name.length - 2)) !== false\n                    ) {\n\n                        switch (optionType) {\n                            case 'radio':\n                                $(option).val() === value ? $(option).prop('checked', true) : '';\n                                break;\n                            case 'checkbox':\n                                $(option).prop('checked', true);\n                                break;\n                            case 'hidden':\n                            case 'select-one':\n                                $(option).val(value);\n                                break;\n                            case 'select-multiple':\n                                selectedValues.push(value);\n                                break;\n                        }\n                        if (optionType === 'select-multiple' && selectedValues.length) {\n                            $(option).val(selectedValues);\n                        }\n                    }\n                });\n            }, this));\n        },\n\n        /**\n         * Update price box config with bundle option prices\n         * @private\n         */\n        _updatePriceBox: function () {\n            var form = this.element,\n                options = $(this.options.productBundleSelector, form),\n                priceBox = $(this.options.priceBoxSelector, form);\n\n            if (!this.options.isOptionsInitialized) {\n                if (priceBox.data('magePriceBox') &&\n                    priceBox.priceBox('option') &&\n                    priceBox.priceBox('option').priceConfig\n                ) {\n                    if (priceBox.priceBox('option').priceConfig.optionTemplate) { //eslint-disable-line max-depth\n                        this._setOption('optionTemplate', priceBox.priceBox('option').priceConfig.optionTemplate);\n                    }\n                    this._setOption('priceFormat', priceBox.priceBox('option').priceConfig.priceFormat);\n                    priceBox.priceBox('setDefault', this.options.optionConfig.prices);\n                    this.options.isOptionsInitialized = true;\n                }\n                this._applyOptionNodeFix(options);\n            }\n\n            return this;\n        },\n\n        /**\n         * Handle change on bundle option inputs\n         * @param {jQuery.Event} event\n         * @private\n         */\n        _onBundleOptionChanged: function onBundleOptionChanged(event) {\n            var changes,\n                bundleOption = $(event.target),\n                priceBox = $(this.options.priceBoxSelector, this.element),\n                handler = this.options.optionHandlers[bundleOption.data('role')];\n\n            bundleOption.data('optionContainer', bundleOption.closest(this.options.controlContainer));\n            bundleOption.data('qtyField', bundleOption.data('optionContainer').find(this.options.qtyFieldSelector));\n\n            if (handler && handler instanceof Function) {\n                changes = handler(bundleOption, this.options.optionConfig, this);\n            } else {\n                changes = defaultGetOptionValue(bundleOption, this.options.optionConfig);//eslint-disable-line\n            }\n\n            // eslint-disable-next-line no-use-before-define\n            if (isValidQty(bundleOption)) {\n                if (changes) {\n                    priceBox.trigger('updatePrice', changes);\n                }\n\n                this._displayTierPriceBlock(bundleOption);\n                this.updateProductSummary();\n            }\n        },\n\n        /**\n         * Handle change on qty inputs near bundle option\n         * @param {jQuery.Event} event\n         * @private\n         */\n        _onQtyFieldChanged: function onQtyFieldChanged(event) {\n            var field = $(event.target),\n                optionInstance,\n                optionConfig;\n\n            if (field.data('optionId') && field.data('optionValueId')) {\n                optionInstance = field.data('option');\n                optionConfig = this.options.optionConfig\n                    .options[field.data('optionId')]\n                    .selections[field.data('optionValueId')];\n                optionConfig.qty = field.val();\n\n                // eslint-disable-next-line no-use-before-define\n                if (isValidQty(optionInstance)) {\n                    optionInstance.trigger('change');\n                }\n            }\n        },\n\n        /**\n         * Helper to fix backend behavior:\n         *  - if default qty large than 1 then backend multiply price in config\n         *\n         * @deprecated\n         * @private\n         */\n        _applyQtyFix: function applyQtyFix() {\n            var config = this.options.optionConfig;\n\n            if (config.isFixedPrice) {\n                _.each(config.options, function (option) {\n                    _.each(option.selections, function (item) {\n                        if (item.qty && item.qty !== 1) {\n                            _.each(item.prices, function (price) {\n                                price.amount /= item.qty;\n                            });\n                        }\n                    });\n                });\n            }\n        },\n\n        /**\n         * Helper to fix issue with option nodes:\n         *  - you can't place any html in option ->\n         *    so you can't style it via CSS\n         * @param {jQuery} options\n         * @private\n         */\n        _applyOptionNodeFix: function applyOptionNodeFix(options) {\n            var config = this.options,\n                format = config.priceFormat,\n                template = config.optionTemplate;\n\n            template = mageTemplate(template);\n            options.filter('select').each(function (index, element) {\n                var $element = $(element),\n                    optionId = utils.findOptionId($element),\n                    optionConfig = config.optionConfig && config.optionConfig.options[optionId].selections,\n                    value;\n\n                $element.find('option').each(function (idx, option) {\n                    var $option,\n                        optionValue,\n                        toTemplate,\n                        prices;\n\n                    $option = $(option);\n                    optionValue = $option.val();\n\n                    if (!optionValue && optionValue !== 0) {\n                        return;\n                    }\n\n                    toTemplate = {\n                        data: {\n                            label: optionConfig[optionValue] && optionConfig[optionValue].name\n                        }\n                    };\n                    prices = optionConfig[optionValue].prices;\n\n                    _.each(prices, function (price, type) {\n                        value = +price.amount;\n                        value += _.reduce(price.adjustments, function (sum, x) {//eslint-disable-line\n                            return sum + x;\n                        }, 0);\n                        toTemplate.data[type] = {\n                            value: value,\n                            formatted: utils.formatPriceLocale(value, format)\n                        };\n                    });\n\n                    $option.html(template(toTemplate));\n                });\n            });\n        },\n\n        /**\n         * Custom behavior on getting options:\n         * now widget able to deep merge accepted configuration with instance options.\n         * @param  {Object}  options\n         * @return {$.Widget}\n         */\n        _setOptions: function setOptions(options) {\n            $.extend(true, this.options, options);\n\n            this._super(options);\n\n            return this;\n        },\n\n        /**\n         * Show or hide option tier prices block\n         *\n         * @param {Object} optionElement\n         * @private\n         */\n        _displayTierPriceBlock: function (optionElement) {\n            var optionType = optionElement.prop('type'),\n                optionId,\n                optionValue,\n                optionTierPricesElements;\n\n            if (optionType === 'select-one') {\n                optionId = utils.findOptionId(optionElement[0]);\n                optionValue = optionElement.val() || null;\n                optionTierPricesElements = $(this.options.optionTierPricesBlocksSelector.replace('{1}', optionId));\n\n                _.each(optionTierPricesElements, function (tierPriceElement) {\n                    var selectionId = $(tierPriceElement).data('selection-id') + '';\n\n                    if (selectionId === optionValue) {\n                        $(tierPriceElement).show();\n                    } else {\n                        $(tierPriceElement).hide();\n                    }\n                });\n            }\n        },\n\n        /**\n         * Handler to update productSummary box\n         */\n        updateProductSummary: function updateProductSummary() {\n            this.element.trigger('updateProductSummary', {\n                config: this.options.optionConfig\n            });\n        }\n    });\n\n    return $.mage.priceBundle;\n\n    /**\n     * Converts option value to priceBox object\n     *\n     * @param   {jQuery} element\n     * @param   {Object} config\n     * @returns {Object|null} - priceBox object with additional prices\n     */\n    function defaultGetOptionValue(element, config) {\n        var changes = {},\n            optionHash,\n            tempChanges,\n            qtyField,\n            optionId = utils.findOptionId(element[0]),\n            optionValue = element.val() || null,\n            optionName = element.prop('name'),\n            optionType = element.prop('type'),\n            optionConfig = config.options[optionId].selections,\n            optionQty = 0,\n            canQtyCustomize = false,\n            selectedIds = config.selected;\n\n        switch (optionType) {\n            case 'radio':\n            case 'select-one':\n\n                if (optionType === 'radio' && !element.is(':checked')) {\n                    return null;\n                }\n\n                qtyField = element.data('qtyField');\n                qtyField.data('option', element);\n\n                if (optionValue) {\n                    optionQty = optionConfig[optionValue].qty || 0;\n                    canQtyCustomize = optionConfig[optionValue].customQty === '1';\n                    toggleQtyField(qtyField, optionQty, optionId, optionValue, canQtyCustomize);//eslint-disable-line\n                    tempChanges = utils.deepClone(optionConfig[optionValue].prices);\n                    tempChanges = applyTierPrice(//eslint-disable-line\n                        tempChanges,\n                        optionQty,\n                        optionConfig[optionValue]\n                    );\n                    tempChanges = applyQty(tempChanges, optionQty);//eslint-disable-line\n                } else {\n                    tempChanges = {};\n                    toggleQtyField(qtyField, '0', optionId, optionValue, false);//eslint-disable-line\n                }\n                optionHash = 'bundle-option-' + optionName;\n                changes[optionHash] = tempChanges;\n                selectedIds[optionId] = [optionValue];\n                break;\n\n            case 'select-multiple':\n                optionValue = _.compact(optionValue);\n\n                _.each(optionConfig, function (row, optionValueCode) {\n                    optionHash = 'bundle-option-' + optionName + '##' + optionValueCode;\n                    optionQty = row.qty || 0;\n                    tempChanges = utils.deepClone(row.prices);\n                    tempChanges = applyTierPrice(tempChanges, optionQty, optionConfig);//eslint-disable-line\n                    tempChanges = applyQty(tempChanges, optionQty);//eslint-disable-line\n                    changes[optionHash] = _.contains(optionValue, optionValueCode) ? tempChanges : {};\n                });\n\n                selectedIds[optionId] = optionValue || [];\n                break;\n\n            case 'checkbox':\n                optionHash = 'bundle-option-' + optionName + '##' + optionValue;\n                optionQty = optionConfig[optionValue].qty || 0;\n                tempChanges = utils.deepClone(optionConfig[optionValue].prices);\n                tempChanges = applyTierPrice(tempChanges, optionQty, optionConfig);//eslint-disable-line\n                tempChanges = applyQty(tempChanges, optionQty);//eslint-disable-line\n                changes[optionHash] = element.is(':checked') ? tempChanges : {};\n\n                selectedIds[optionId] = selectedIds[optionId] || [];\n\n                if (!_.contains(selectedIds[optionId], optionValue) && element.is(':checked')) {\n                    selectedIds[optionId].push(optionValue);\n                } else if (!element.is(':checked')) {\n                    selectedIds[optionId] = _.without(selectedIds[optionId], optionValue);\n                }\n                break;\n\n            case 'hidden':\n                optionHash = 'bundle-option-' + optionName + '##' + optionValue;\n                optionQty = optionConfig[optionValue].qty || 0;\n                canQtyCustomize = optionConfig[optionValue].customQty === '1';\n                qtyField = element.data('qtyField');\n                qtyField.data('option', element);\n                toggleQtyField(qtyField, optionQty, optionId, optionValue, canQtyCustomize);//eslint-disable-line\n                tempChanges = utils.deepClone(optionConfig[optionValue].prices);\n                tempChanges = applyTierPrice(tempChanges, optionQty, optionConfig);//eslint-disable-line\n                tempChanges = applyQty(tempChanges, optionQty);//eslint-disable-line\n\n                optionHash = 'bundle-option-' + optionName;\n                changes[optionHash] = tempChanges;\n                selectedIds[optionId] = [optionValue];\n                break;\n        }\n\n        return changes;\n    }\n\n    /**\n     * Check the quantity field if negative value occurs.\n     *\n     * @param {Object} bundleOption\n     */\n    function isValidQty(bundleOption) {\n        var isValid = true,\n            qtyElem = bundleOption.data('qtyField'),\n            bundleOptionType = bundleOption.prop('type');\n\n        if (['radio', 'select-one'].includes(bundleOptionType) && qtyElem.val() < 0) {\n            isValid = false;\n        }\n\n        return isValid;\n    }\n\n    /**\n     * Helper to toggle qty field\n     * @param {jQuery} element\n     * @param {String|Number} value\n     * @param {String|Number} optionId\n     * @param {String|Number} optionValueId\n     * @param {Boolean} canEdit\n     */\n    function toggleQtyField(element, value, optionId, optionValueId, canEdit) {\n        element\n            .val(value)\n            .data('optionId', optionId)\n            .data('optionValueId', optionValueId)\n            .attr('disabled', !canEdit);\n\n        if (canEdit) {\n            element.removeClass('qty-disabled');\n        } else {\n            element.addClass('qty-disabled');\n        }\n    }\n\n    /**\n     * Helper to multiply on qty\n     *\n     * @param   {Object} prices\n     * @param   {Number} qty\n     * @returns {Object}\n     */\n    function applyQty(prices, qty) {\n        _.each(prices, function (everyPrice) {\n            everyPrice.amount *= qty;\n            _.each(everyPrice.adjustments, function (el, index) {\n                everyPrice.adjustments[index] *= qty;\n            });\n        });\n\n        return prices;\n    }\n\n    /**\n     * Helper to limit price with tier price\n     *\n     * @param {Object} oneItemPrice\n     * @param {Number} qty\n     * @param {Object} optionConfig\n     * @returns {Object}\n     */\n    function applyTierPrice(oneItemPrice, qty, optionConfig) {\n        var tiers = optionConfig.tierPrice,\n            magicKey = _.keys(oneItemPrice)[0],\n            tiersFirstKey = _.keys(optionConfig)[0],\n            lowest = false;\n\n        if (!tiers) {//tiers is undefined when options has only one option\n            tiers = optionConfig[tiersFirstKey].tierPrice;\n        }\n\n        tiers.sort(function (a, b) {//sorting based on \"price_qty\"\n            return a['price_qty'] - b['price_qty'];\n        });\n\n        _.each(tiers, function (tier, index) {\n            if (tier['price_qty'] > qty) {\n                return;\n            }\n\n            if (tier.prices[magicKey].amount < oneItemPrice[magicKey].amount) {\n                lowest = index;\n            }\n        });\n\n        if (lowest !== false) {\n            oneItemPrice = utils.deepClone(tiers[lowest].prices);\n        }\n\n        return oneItemPrice;\n    }\n});\n","Magento_Bundle/js/bundle-product.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/*global FORM_KEY*/\n/*global bSelection*/\n/**\n * @api\n */\ndefine([\n    'jquery',\n    'Magento_Catalog/js/product/weight-handler',\n    'Magento_Ui/js/modal/modal',\n    'jquery/ui',\n    'mage/translate',\n    'Magento_Theme/js/sortable',\n    'prototype'\n], function ($, weightHandler) {\n    'use strict';\n\n    $.widget('mage.bundleProduct', {\n        /** @inheritdoc */\n        _create: function () {\n            this._initOptionBoxes()\n                ._initSortableSelections()\n                ._bindCheckboxHandlers()\n                ._initCheckboxState()\n                ._bindAddSelectionDialog()\n                ._hideProductTypeSwitcher();\n        },\n\n        /**\n         * @return {Object}\n         * @private\n         */\n        _initOptionBoxes: function () {\n            var syncOptionTitle;\n\n            this.element.sortable({\n                axis: 'y',\n                handle: '[data-role=draggable-handle]',\n                items: '.option-box',\n                update: this._updateOptionBoxPositions,\n                tolerance: 'pointer'\n            });\n\n            /**\n             * @param {jQuery.Event} event\n             */\n            syncOptionTitle = function (event) {\n                var originalValue = $(event.target).attr('data-original-value'),\n                    currentValue = $(event.target).val(),\n                    optionBoxTitle = $('.title > span', $(event.target).closest('.option-box')),\n                    newOptionTitle = $.mage.__('New Option');\n\n                optionBoxTitle.text(currentValue === '' && !originalValue.length ? newOptionTitle : currentValue);\n            };\n            this._on({\n                'change .field-option-title input[name$=\"[title]\"]': syncOptionTitle,\n                'keyup .field-option-title input[name$=\"[title]\"]': syncOptionTitle,\n                'paste .field-option-title input[name$=\"[title]\"]': syncOptionTitle\n            });\n\n            return this;\n        },\n\n        /**\n         * @return {Object}\n         * @private\n         */\n        _initSortableSelections: function () {\n            this.element.find('.option-box .form-list tbody').sortable({\n                axis: 'y',\n                handle: '[data-role=draggable-handle]',\n\n                /**\n                 * @param {jQuery.Event} event\n                 * @param {jQuery} ui\n                 * @return {jQuery}\n                 */\n                helper: function (event, ui) {\n                    ui.children().each(function () {\n                        $(this).width($(this).width());\n                    });\n\n                    return ui;\n                },\n                update: this._updateSelectionsPositions,\n                tolerance: 'pointer'\n            });\n\n            return this;\n        },\n\n        /**\n         * @return {Object}\n         * @private\n         */\n        _initCheckboxState: function () {\n            this.element.find('.is-required').each(function () {\n                $(this).prop('checked', $(this).closest('.option-box').find('[name$=\"[required]\"]').val() > 0);\n            });\n\n            this.element.find('.is-user-defined-qty').each(function () {\n                $(this).prop('checked', $(this).closest('.qty-box').find('.select').val() > 0);\n            });\n\n            return this;\n        },\n\n        /**\n         * @return {Object}\n         * @private\n         */\n        _bindAddSelectionDialog: function () {\n            var widget = this;\n\n            this._on({\n                /**\n                 * @param {jQuery.Event} event\n                 */\n                'click .add-selection': function (event) {\n                    var $optionBox = $(event.target).closest('.option-box'),\n                        $selectionGrid = $optionBox.find('.selection-search').clone(),\n                        optionIndex = $optionBox.attr('id').replace('bundle_option_', ''),\n                        productIds = [],\n                        productSkus = [],\n                        selectedProductList = {};\n\n                    $optionBox.find('[name$=\"[product_id]\"]').each(function () {\n                        if (!$(this).closest('tr').find('[name$=\"[delete]\"]').val()) {\n                            productIds.push($(this).val());\n                            productSkus.push($(this).closest('tr').find('.col-sku').text());\n                        }\n                    });\n\n                    bSelection.gridSelection.set(optionIndex, $H({}));\n                    bSelection.gridRemoval = $H({});\n                    bSelection.gridSelectedProductSkus = productSkus;\n\n                    $selectionGrid.on('contentUpdated', bSelection.gridUpdateCallback);\n                    $selectionGrid.on('change', '.col-id input', function () {\n                        var tr = $(this).closest('tr');\n\n                        if ($(this).is(':checked')) {\n                            selectedProductList[$(this).val()] = {\n                                name: tr.find('.col-name').html().trim(),\n                                sku: tr.find('.col-sku').html().trim(),\n                                'product_id': $(this).val(),\n                                'option_id': $('bundle_selection_id_' + optionIndex).val(),\n                                'selection_price_value': 0,\n                                'selection_qty': 1\n                            };\n                        } else {\n                            delete selectedProductList[$(this).val()];\n                        }\n                    });\n\n                    $selectionGrid.modal({\n                        title: $optionBox.find('input[name$=\"[title]\"]').val() === '' ?\n                            $.mage.__('Add Products to New Option') :\n                            $.mage.__('Add Products to Option \"%1\"').replace(\n                                '%1',\n                                $('<div>').text($optionBox.find('input[name$=\"[title]\"]').val()).html()\n                            ),\n                        modalClass: 'bundle',\n                        type: 'slide',\n\n                        /**\n                         * @param {jQuery.Event} e\n                         * @param {Object} modalWindow\n                         */\n                        closed: function (e, modalWindow) {\n                            modalWindow.modal.remove();\n                        },\n                        buttons: [{\n                            text: $.mage.__('Add Selected Products'),\n                            'class': 'action-primary action-add',\n\n                            /** Click action. */\n                            click: function () {\n                                $.each(selectedProductList, function () {\n                                    window.bSelection.addRow(optionIndex, this);\n                                });\n                                bSelection.gridRemoval.each(function (pair) {\n                                    $optionBox.find('.col-sku').filter(function () {\n                                        let text = $(this).text();\n\n                                        return text.trim() === pair.key; // find row by SKU\n                                    }).closest('tr').find('button.delete').trigger('click');\n                                });\n                                widget.refreshSortableElements();\n                                widget._updateSelectionsPositions.apply(widget.element);\n                                $selectionGrid.modal('closeModal');\n                            }\n                        }]\n                    });\n                    $.ajax({\n                        url: bSelection.selectionSearchUrl,\n                        dataType: 'html',\n                        data: {\n                            index: optionIndex,\n                            products: productIds,\n                            'selected_products': productIds,\n                            'form_key': FORM_KEY\n                        },\n\n                        /**\n                         * @param {*} data\n                         */\n                        success: function (data) {\n                            $selectionGrid.html(data).modal('openModal');\n                        },\n                        context: $('body'),\n                        showLoader: true\n                    });\n                }\n            });\n\n            return this;\n        },\n\n        /**\n         * @private\n         */\n        _hideProductTypeSwitcher: function () {\n            weightHandler.hideWeightSwitcher();\n        },\n\n        /**\n         * @return {Object}\n         * @private\n         */\n        _bindCheckboxHandlers: function () {\n            this._on({\n                /**\n                 * @param {jQuery.Event} event\n                 */\n                'change .is-required': function (event) {\n                    var $this = $(event.target);\n\n                    $this.closest('.option-box').find('[name$=\"[required]\"]').val($this.is(':checked') ? 1 : 0);\n                },\n\n                /**\n                 * @param {jQuery.Event} event\n                 */\n                'change .is-user-defined-qty': function (event) {\n                    var $this = $(event.target);\n\n                    $this.closest('.qty-box').find('.select').val($this.is(':checked') ? 1 : 0);\n                }\n            });\n\n            return this;\n        },\n\n        /**\n         * @return {Object}\n         * @private\n         */\n        _updateOptionBoxPositions: function () {\n            $(this).find('[name^=bundle_options][name$=\"[position]\"]').each(function (index) {\n                $(this).val(index);\n            });\n\n            return this;\n        },\n\n        /**\n         * @return {Object}\n         * @private\n         */\n        _updateSelectionsPositions: function () {\n            $(this).find('[name^=bundle_selections][name$=\"[position]\"]').each(function (index) {\n                $(this).val(index);\n            });\n\n            return this;\n        },\n\n        /**\n         *\n         * @return {Object}\n         */\n        refreshSortableElements: function () {\n            this.element.sortable('refresh');\n            this._updateOptionBoxPositions.apply(this.element);\n            this._initSortableSelections();\n            this._initCheckboxState();\n\n            return this;\n        }\n    });\n\n});\n","Magento_Bundle/js/bundle-type-handler.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\ndefine([\n    'jquery',\n    'Magento_Catalog/catalog/type-events',\n    'Magento_Catalog/js/product/weight-handler'\n], function ($, productType, weight) {\n    'use strict';\n\n    return {\n\n        /**\n         * Constructor component\n         */\n        'Magento_Bundle/js/bundle-type-handler': function () {\n            this.bindAll();\n            this._initType();\n        },\n\n        /**\n         * Bind all\n         */\n        bindAll: function () {\n            $(document).on('changeTypeProduct', this._initType.bind(this));\n        },\n\n        /**\n         * Init type\n         * @private\n         */\n        _initType: function () {\n            if (\n                productType.type.init === 'bundle' &&\n                productType.type.current !== 'bundle' &&\n                !weight.isLocked()\n            ) {\n                weight.switchWeight();\n            }\n        }\n    };\n});\n","Magento_Bundle/js/components/bundle-input-type.js":"/**\n * Copyright \u00a9 Magento, Inc. All rights reserved.\n * See COPYING.txt for license details.\n */\n\n/**\n * @deprecated Not used anymore\n * @see Magento_Bundle/js/components/bundle-record\n * @see Magento_Bundle/js/components/bundle-checkbox\n */\ndefine([\n    'Magento_Ui/js/form/element/select',\n    'uiRegistry'\n], function (Select, registry) {\n    'use strict';\n\n    return Select.extend({\n        defaults: {\n            previousType: '',\n            parentContainer: '',\n            selections: '',\n            targetIndex: '',\n            typeMap: {}\n        },\n\n        /**\n         * @inheritdoc\n         */\n        onUpdate: function () {\n            var type = this.typeMap[this.value()];\n\n            if (type !== this.previousType) {\n                this.previousType = type;\n                this.processSelections(type === 'radio');\n            }\n\n            this._super();\n        },\n\n        /**\n         * Toggle 'User Defined' column and clears values\n         * @param {Boolean} isRadio\n         */\n        processSelections: function (isRadio) {\n            var records = registry.get(this.retrieveParentName(this.parentContainer) + '.' + this.selections),\n                checkedFound = false;\n\n            records.elems.each(function (record) {\n                record.elems.filter(function (comp) {\n                    return comp.index === this.userDefinedIndex;\n                }, this).each(function (comp) {\n                    comp.visible(isRadio);\n                });\n\n                if (isRadio) {\n                    record.elems.filter(function (comp) {\n                        return comp.index === this.isDefaultIndex;\n                    }, this).each(function (comp) {\n                        if (comp.checked()) {\n                            if (checkedFound) {\n                                comp.clearing = true;\n                                comp.clear();\n                                comp.clearing = false;\n                            }\n\n                            checkedFound = true;\n                        }\n                    });\n                }\n            }, this);\n        },\n\n        /**\n         * Retrieve name for the most global parent with provided index.\n         *\n         * @param {String} parent - parent name.\n         * @returns {String}\n         */\n        retrieveParentName: function (parent) {\n            return this.name.replace(new RegExp('^(.+?\\\\.)?' + parent + '\\\\..+'), '$1' + parent);\n        }\n    });\n});\n"}
}});
